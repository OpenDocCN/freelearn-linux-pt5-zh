# 第三章：包管理

您已经安装了基础系统，现在是时候安装额外的软件了。或者，如果您在安装时选择了一些任务，您可能想查看已安装的软件，并可能删除一些您不会使用的。也许您的老板要求提供已安装软件的报告。或者安全更新呢？

所有这些以及更多内容，都是 Debian 包管理系统的范畴。在本章中，我们将介绍包管理器、软件选择和维护、如何更新系统以及如何设置自动更新。

### 注意

**针对初学者的注意事项**

本节假设您已经熟悉使用 root 账户。有关访问 root 账户功能的信息，请访问[`wiki.debian.org/Root`](https://wiki.debian.org/Root)，以及 Debian 参考手册中的[`www.debian.org/doc/manuals/debian-reference/`](http://www.debian.org/doc/manuals/debian-reference/)。有关本章中提到的命令（以及大多数 Linux 命令）的快速帮助，可以通过在命令行中执行`man <command name>`或`info <command name>`来获得，或者使用大多数图形应用程序中提供的帮助按钮。Debian 参考手册还包含有关使用本章中包管理器命令的更详细信息。

# 包管理器

Debian 包管理器最初是作为一个简单的命令行工具**dpkg**开始的，另附一个名为**dselect**的工具，通过基于菜单的 curses 界面提供更复杂的包选择和依赖解决方案。最终，开发了更多的工具来提供更好的界面、更好的自动依赖解决，或两者兼具。当前的标准包管理器是 Synaptic，这是一个完全成熟的 GUI 应用程序，运行在图形窗口管理器中，提供广泛的选择和报告功能。

我们从头开始。

## dpkg 和 dselect

这些是 Debian 最初的包管理工具。`dpkg`命令仍然完成所有工作，因为所有更新的工具都将其用作后端。因此，它具有安装、删除、配置和报告包所需的所有功能。它是一个命令行工具。

dpkg 的一个限制是它在依赖关系检查方面做得很少，除了在出现依赖问题时提供错误信息外。它要求用户查看依赖报告并在安装过程中包含必要的包。另一个限制是 dpkg 只对已经下载的包有效。然而，这两个限制都可以通过 dselect 工具来解决。

`dselect` 命令是一个基于菜单的工具，提供访问 Debian 仓库中软件包的信息，并检查和帮助解决软件依赖关系。这大大简化了软件包选择和安装的过程。一旦选择了软件包并且所有依赖关系都得到满足（无论是自动完成还是通过用户帮助），`dpkg` 会自动运行以执行实际安装。

## 高级软件包工具

**高级软件包工具**（**APT**）是为了提供更好的命令行工具而开发的，它可以提供下载和依赖关系解决功能，且无需单独的工具进行安装。可以把它看作是一个全能的命令行工具，能够选择、安装或移除软件包，并自动解决依赖关系。

APT 实际上是一套包含 apt-get 的实用工具集合，apt-get 是基本的软件包安装工具，还包含其他几个以 `apt` 为前缀的命令行工具，提供附加功能，例如报告可用软件以及其他基本的本地仓库维护功能。

### 注意

`man apt` 命令是一个很好的起点，它引用了其他手册页以提供附加命令。Debian 的参考手册也包含了很多关于这些及其他软件包管理命令的信息。

这个工具快速且除非在特殊情况下，否则无需用户干预即可处理依赖关系。它是用于自动化、无人值守的软件安装和更新的基本工具。

## aptitude

aptitude 是 APT 工具集的前端，具有附加功能，使其更像 dselect，提供更精细的依赖关系检查，并通过用户帮助而非自动化方式解决依赖关系。因此，它在依赖关系解决时，有时比 dselect 或 apt-get 更成功，能够以更少的重大软件变更解决问题。像 dselect 一样，它是基于菜单的（使用 curses 界面），也有命令行功能。由于有时需要用户协助来解决依赖关系，它不太适合无人值守或自动化的软件更新。然而，它通常会找到更简单的解决方案，涉及较少的变更，和 APT 相比。

## Synaptic

Synaptic 是一个没有命令行功能的完整图形用户界面的软件包管理器。它提供了 aptitude 大部分功能，并且拥有 dselect 的许多仓库处理功能。像基于菜单的 dselect 和 aptitude 工具一样，它提供了一个将软件按兴趣分区的列表，例如数据库、开发、编辑器等，允许管理员更有效地浏览可用软件。它还具有搜索功能，便于查找特定用途的软件包。

### 提示

最佳实践如下：

+   对于一般使用——Synaptic

+   对于自动化安装——APT

+   对于困难情况中的依赖关系解决——aptitude

# 软件包选择和维护

Debian 软件按发行版进行分组。一个发行版中的所有软件都可以作为一套购买的或下载的媒体（CD、DVD，或者在 Debian 7 中，新加入了蓝光光盘）提供，或者作为按包分组的单独软件包在在线仓库中提供。虽然`dpkg`仅适用于已下载的软件包（或本地挂载的媒体上的软件包），其他的包管理工具支持离线媒体、本地和远程仓库，并且这些都需要进行配置。

## 配置媒体或仓库

媒体或仓库的所有配置都位于`/etc/apt`目录下，具体在一个名为`sources.list`的文件中，此外，`/etc/apt/sources.list.d`目录下的所有以`.list`扩展名结尾的文件也包含配置。这些文件可以通过你喜欢的编辑器手动修改，也可以通过各种 APT 工具（如`apt-add-repository`或`apt-spy`）进行操作，或者通过 Synaptic 图形界面中的菜单项来进行配置。关于每种方法如何工作的详细信息可以在各种手册页中找到，例如`sources.list`、`apt-add-repository`和`apt-spy`的手册页，或者 Synaptic 的帮助文件中也有相关内容。然而，由于它们都依赖于相同的配置文件和格式，因此所需的条目是相似的。

每行包括指示仓库是包含二进制包还是源代码包（从源代码包可以构建二进制包）、仓库的位置、发行版的身份标识以及可以选择软件的部分。通常，你在安装过程中使用的媒体来源条目会在安装时自动添加，如果在安装过程中还使用了在线仓库，也会同时添加相关条目。

所有软件包源通过 URI 进行标识，具体描述可以参考`sources.list`的手册页。发行版通过其发行版名称进行标识（例如 Debian 6 的**squeeze**，或 Debian 7 的**wheezy**），也可以通过类似“stable”这样的通用术语进行标识，指当前的稳定版。

### 说明

当前的 Debian 稳定版是 Debian 7，代号为 wheezy，于 2013 年 5 月 4 日发布。撰写时，stable 是 wheezy 的同义词。Debian 的发布版名称是为了简化各种发行版的镜像过程。迄今为止的代号均来源于电影*玩具总动员*。这一传统显然始于 1996 年，当时在 Pixar 工作的 Bruce Perens 接管了 Debian 项目。

综合来看，可能出现在`/etc/apt/sources.list`中的一组仓库会是如下所示：

```
# deb cdrom:[Debian GNU/Linux 7.0.0 "Wheezy" - Official amd64 \ NETINST Binary-1 20130504-14:43]/ stable main
deb http://ftp.us.debian.org/debian/ wheezy main non-free contrib
deb-src http://ftp.us.debian.org/debian/ wheezy main non-free \ contrib

deb http://security.debian.org/ wheezy/updates main contrib \ non-free
deb-src http://security.debian.org/ wheezy/updates main contrib \ non-free

# wheezy-updates, previously known as 'volatile'
deb http://ftp.us.debian.org/debian/ wheezy-updates main contrib \ non-free
deb-src http://ftp.us.debian.org/debian/ wheezy-updates main \ contrib non-free

```

### 说明

**初学者说明**

示例中的某些行过长，因此分为两行，使用常见的约定方法，即在第一行的末尾添加反斜杠（\）表示该行被继续。实际上，在 APT 源配置文件中，这些行不应被拆分。

让我们逐行分析。

第一行以`#`开始，表示该条目被禁用。此条目由网络安装创建，在这种安装中，一个最小的 CD 被挂载，并安装了基础软件，以便剩余的软件可以从后续行中列出的在线仓库安装。只需要主部分，如行末所示。

接下来的两行是二进制包（`deb`）和源代码包（`deb-src`），可以从 HTTP 服务器（[`ftp.us.debian.org/debian`](http://ftp.us.debian.org/debian)）获取。该发行版是 wheezy，所有三个部分——main、contrib 和 non-free——都可以使用。在主仓库行之后是两行用于二进制包和源包更新的内容。这里是获取稳定版本安全更新的地方。

### 提示

即使你更倾向于使用媒体进行发布，而不是在线仓库，你也应该包括更新仓库，因为这是获取必要的安全修复的唯一途径。

最后是一个注释，还有两行曾经被称为“volatile”仓库的内容，现在仅由发行版代号后跟`-updates`来表示。这个仓库包含在发行版生命周期中经常更新的包，更新频率远高于安全更新仓库。包含病毒定义的包就是该仓库中的软件示例。

虽然配置仓库的各种方法略有不同，但无论你使用哪种方法，所需的基本信息都是相同的。此外，由于所有工具都使用相同的配置文件和格式，通过一种方法输入、删除或修改的信息会立即在所有工具中可见。

所有前面的行都是由安装程序预配置的，无需修改。然而，通常有理由修改或添加仓库。你可能想添加一些 Debian 中无法直接获得的软件仓库，或者修改 URL 以使用不同的、更高效的服务器或不同的访问方式。

### 注意

例如，HTTP 对网络延迟或错误的抵抗力更强，而 FTP 稍微快一些。此外，并非所有镜像都支持这两种方法，因此如果你更换服务器，可能也需要更改访问方式。

有一些非 Debian 仓库包含不在标准 Debian 发行版中的软件。通常，这是由于许可问题，或者因为开发工作在 Debian 项目的政策之外进行，并且没有赞助商将其集成到 Debian 中。以下是一些更有用的仓库：

+   **Deb Multimedia**：顾名思义，这是一个主要用于多媒体的包，不能包含在正常的发行版中。

+   **Webmin**：这是一个基于 Web 的系统管理软件。

+   **Oracle**：提供 Oracle Express 软件。

+   **Skype**：提供 Skype 软件。

+   **MongoDB**：这是来自 NoSQL MongoDB 项目的软件

作为示例，以下是前面提到的 Webmin 仓库的 `/etc/apt/sources.list.d/webmin.list` 文件：

```
deb http://download.webmin.com/download/repository sarge contrib
deb http://webmin.mirror.somersettechsolutions.co.uk/repository \ sarge contrib

```

通常，提供此类仓库的网站会包含如何配置其仓库的源列表文件的说明。

## 发行版名称的重要性

除了添加非 Debian 仓库之外，通常进行的一个更为微妙的更改具有非常重要的意义。请注意，在之前的 Debian 发行版 `sources.list` 中，大多数行的发行版名称是 wheezy。这意味着通过包管理器可用的软件包将始终来自 Debian 7 版本。一些管理员将发行版名称更改为 stable。这既有优点，也有缺点。

一个优点是，当发布新主版本时，您的包管理器会立即识别并更新软件包列表和依赖关系。相关的缺点是，主版本通常会涉及软件包依赖关系的重大变化。虽然包管理器可以处理这些变化，但此类重大变化通常会导致许多新软件包被安装以满足新依赖关系，许多旧软件包由于依赖关系变化或过时而被删除，同时主版本的变化通常也会改变软件的行为方式。这些变化可能对服务器操作、开发人员或用户的使用习惯造成很大干扰。

### 提示

为确保稳定性，最佳做法是保持官方发行版名称不变，直到您准备好升级到下一个版本。然后更改包管理器配置中的名称，并执行手动升级。

## 选择软件包

一旦您配置了所需的仓库，您需要获取有关仓库中内容的信息。这不仅包括软件包列表，还包括软件包描述、内容和依赖关系。这可以通过更新软件包缓存来完成，之后您就可以浏览、选择、安装、升级和删除软件包。

## 更新您的软件包缓存

软件包信息的更新只需在 Synaptic 中使用刷新菜单项，或使用 aptitude 或 apt-get 的 `update` 命令来更新软件包信息缓存。应定期执行此操作，以确保您所拥有的可用软件包信息是最新的。一旦您配置好了仓库并更新了软件包信息缓存，就可以根据需要选择并安装来自任何一个或所有仓库的软件包。选择软件包有两种基本方法：命令行和选择列表。

### 命令行选择

这是安装一个或几个包及其依赖关系的最简单和最快的方法，但需要您知道要安装的包。有几个工具可以用来搜索包的名称和描述，这将为您提供查找正确包名称的方法。其中最常见的是`apt-cache`。一旦您知道要安装的包或包，您可以使用 apt-get 或 aptitude 或 dselect 的命令行格式快速下载和安装这些包。

### 选择列表

aptitude 和 dselect 都提供了基本的交互界面。您可以浏览按部门分类的可用包列表，或者可以使用多种标准搜索包。界面基于简单的 curses 库，有时可能显得笨重，但是相比之前提到的命令行工具，它是一种改进。这些界面（以及命令行工具）的一个优点是它们可以在终端环境中使用，无需安装图形桌面环境。它们经常用于安装了高性能服务器的地方，其中安全性或性能原因未安装图形桌面环境。

另一方面，Synaptic 提供了一个完整的 GUI 界面，用于浏览、搜索和选择包，以及配置存储库、选择安装选项，并提供有关可用和已安装包的信息。它需要图形桌面环境，例如 GNOME 或 KDE，才能运行。

### 注意

Synaptic 可以通过安全外壳连接远程运行，从已安装图形窗口管理器的系统中使用。一些管理员在没有图形桌面的服务器上安装 Synaptic，并以这种方式使用它，以避免服务器本身图形环境的安全或性能问题。

## 元包

最有用的包类型之一称为**元包**。这些包本身不包含任何软件，但需要安装其他包，因此为特定目的提供了统一的软件集。这是因为虽然元包中没有实际软件，但包管理器会选择并安装所有必需的依赖包，从而在单个简单的安装步骤中提供完整的功能集。

经常有多个略有不同名称的包，安装了稍有不同的依赖关系。GNOME 就是一个很好的例子。您可以安装 GNOME 元包，它将提供完整的 GNOME 安装，包括许多附加功能。或者，您可以选择安装`gnome-core`，它只提供基本的桌面环境，并从提供附加功能和功能的其他包中进行选择，例如：

+   evolution（类似于 Outlook 的电子邮件软件）

+   gnome-documents（文档管理功能）

+   gnome-games

+   gnome-media（多媒体应用）

+   libreoffice-gnome（办公套件）和其他

元软件包的一个小问题是，找不到它们的简便方法。许多元软件包在其描述中确实包含“meta”字样，这可以帮助某些搜索，但这并不总是适用。前面提到的 GNOME 软件包在 Debian 7 中就没有遵循这一惯例。不过，它们通常还是比较明显，且不难找到。

## 关于依赖项解决

dselect、APT、aptitude 和 Synaptic 都提供某种形式的自动依赖解决。在少数情况下，依赖无法自动解决，需要用户干预。aptitude 会计算出替代方案并要求用户选择。APT 和 Synaptic 通常需要用户手动将软件包添加到命令行或选择列表中。

这种问题通常只出现在测试版和不稳定版本中，软件依赖项会不断更新，某些问题可能直到所有相关软件都已更新并放入发布版后才会完全解决。然而，这个问题也常见于稳定版，原因是依赖于**虚拟软件包**。

虚拟软件包并不是实际软件包的名称，而是一个库或功能的名称，多个软件包都可以提供这个功能。由于通常有多个软件包可以满足该依赖项，用户必须手动选择一个进行安装，之后其余的原始依赖项可以自动解决。这种情况在标准升级过程中很少发生，在发行版升级过程中几乎从不发生，因为这些虚拟软件包会自动选择。

### 注意

通常，你只会在手动安装单个软件包时，且很少发生此问题。

## 删除软件包

删除软件包也可以通过任何软件包管理工具来处理。然而需要注意的是，apt-get 和 Synaptic 在删除依赖它们的软件包后，不会自动移除这些依赖项。应使用命令`apt-get autoremove`来执行此操作，无论是通过哪个包管理器安装和删除软件包。aptitude 会自动完成这一操作。

# 保持最新

在安装完系统所需的软件后，定期检查更新是一种良好的做法。特别是，安全更新会在发现 Debian 软件的安全漏洞后尽快发布。

更新 Debian 系统很简单。在更新软件包缓存（参见前一节关于*更新你的软件包缓存*）以便它包含仓库中所有软件的最新信息后，可以通过 Synaptic 中的“标记所有升级”菜单项，或使用 apt-get 或 aptitude 的`upgrade`命令来更新所有有新版本的软件。

## 自动更新

可以执行自动、无人值守的系统更新，但也存在一些潜在的问题。设置过程非常简单，只需安装`unattended-upgrades`软件包。如果在安装过程中没有询问是否启用自动安全升级，可以运行命令`dpkg-reconfigure -plow unattended-upgrades`。

一般来说，只有安全升级会被自动安装，这将最大限度地减少潜在问题，包括修改过的依赖项和修改软件配置或操作方式的变化。可以通过修改`/etc/apt/apt.conf.d/50unattended-upgrades`中的配置文件来允许其他升级。该文件中有注释，帮助识别所需的修改，通常只需要去掉希望启用的行前面的`//`。请注意，启用安全更新以外的任何内容可能会导致错误（当遇到依赖问题时）或系统中断（当升级修改软件行为或配置时）。特别是使用稳定版名称时，当发布新稳定版时，可能会带来非常大的变化。

### 提示

最佳实践是只允许自动安装安全升级（使用默认配置）。所有软件包的信息缓存无论如何都会更新，因此你可以定期手动升级其他软件包，以便在出现任何异常升级问题时进行处理。

# 外部软件包

如果在 Debian 中没有某个软件包，应该怎么办？有几个选项。之前提到的一个方法是将非 Debian 仓库添加到仓库配置中。在进行 Synaptic 刷新、apt-get 或 aptitude `update` 后，仓库中的所有软件包信息将可以被 Debian 包管理器访问。

然而，如果该软件不包含在任何仓库中，仍然有几种可用的选项。

### 注意

其实还有一个额外的选项：直接从原始来源安装该软件。这种方法不推荐使用，因为它将软件完全置于包管理系统之外。涉及必需库的未来系统升级可能会导致软件出现异常行为，甚至完全损坏，且查找原因可能非常令人沮丧。此方法应仅作为最后手段使用。

## Alien

如果某个软件包存在于其他 Linux 发行版中，通常可以将其转换为 Debian 包。这可以通过一个名为**alien**的软件包来完成。Alien 提供了命令来转换多种包格式（包括 Red Hat RPM、Stampede SLP、Slackware TGZ、Solaris PKG 和 Debian DEB）。

### 提示

在使用 alien 之前，请注意查看手册页中的警告。

通常，转换过程相对简单。虽然结果无法保证，但转换后的包通常可以在 Debian 上成功安装。任何出现的问题很可能是由于库依赖名称不同，或甚至是软件版本标识的差异。

然而，当发生这种情况时，所有的工作并没有白费。Alien 可以执行部分转换，本质上是在它创建了一个临时目录后停止，通常该目录是从中构建 Debian 包的目录。然后，您可以进入该目录并进行必要的修改，之后手动完成构建。

## 手动构建

您也可以自行构建 Debian 包，无论是从部分 alien 转换（如前所述）还是从原始软件开始构建。该过程可能从简单到复杂不等，取决于包要提供的内容，并且在 Debian 维护者指南和 Debian 政策手册中有详细说明，这些手册可以在线获取或作为可安装的包在 Debian 中使用，也可以在许多其他在线资源中找到。一个好的在线起点是 Debian 打包 Wiki 页面：[`wiki.debian.org/HowToPackageForDebian`](https://wiki.debian.org/HowToPackageForDebian)。

### 提示

手动构建，无论是从头开始还是从部分 alien 转换开始，都是处理无法以标准 Debian 格式获取的软件的推荐方法。

具体细节因实际使用的软件而异。通常，包是从源代码构建的，但也可以仅从二进制软件版本构建包。一般的构建过程如下：

1.  获取源代码（或二进制文件），并将其放入适当的包构建目录中。

1.  创建必要的 Debian 打包文件，包括必要时的额外文档、特定于 Debian 包的可选脚本文件、控制打包过程的文件，以及 Debian 包管理器所需的文件。

1.  测试构建。如果必要，添加补丁以修正打包中的任何问题，或是为了在 Debian 环境中正确编译或运行软件所需的补丁。

1.  重复步骤 2 和 3，直到最终产品在您的发行版上安装并运行。

可供 Debian 开发者使用的软件包已经包含在发行版中，任何人都可以使用。用于构建自己包的主要工具包括：

+   build-essential（构建 Debian 包所需的核心包）

+   dpkg-dev（包开发工具）

+   fakeroot（允许用户像 root 用户一样进行构建）

+   dh-make（用于在 Debian 包构建目录中创建文件的工具）

+   debhelper（Debian/rules 文件的辅助程序）

+   cdbs（可选的、用于 Debian/rules 文件的附加辅助程序）

+   quilt（Debian 包补丁管理）

几乎不可能给出任何通用示例，因为每个软件包在除了第一步之外的所有步骤中都会有所不同。然而，网上有许多很好的示例和教程，而且所有 Debian 发行版中包含的软件包的完整源代码都可以供任何人查看和学习。

# 升级你的系统

如前所述，更新系统是非常简单的。升级系统到下一个官方版本的命令（或菜单项）与标准更新命令不同。apt-get 命令`dist-upgrade`或 aptitude 的`full-upgrade`会在更新软件包信息缓存后，执行必要的特殊计算，以便升级到下一个主要版本（通过正常的`update`命令，如果你已将发布名称配置为稳定版，或者在更改为新的发布名称并执行`update`命令后）。之所以需要这些特殊命令，是因为官方发布版本之间存在包依赖关系的重大变化，某些软件配置的方式，以及淘汰过时软件包的方式，这些都需要特别的计算，而不是普通包升级所涉及的内容。

### 注意

Synaptic 也可以处理完整的发行版升级，但它并不是通过不同的命令来处理，而是在首选项中将‘智能升级’设置为默认升级时进行此类升级。

## 升级前

**阅读发布说明！** 这一点必须强调。Debian 开发者会仔细地将版本间的变化和升级过程前后所需的特别步骤包含在发布说明中。

处理重大升级有两种方式：一次性升级和分步升级（我们称之为部分升级）。一次性升级基本上涉及一个更新所有软件包的命令。部分升级方法则是选择一组软件包，更新它们及其依赖关系。这将依赖关系计算减少到一个更易处理的子集。通常，选择其中一个元包，如 GNOME 或 Apache2，或选择一组软件包进行更新，并使用`install`命令通过 apt-get 或 aptitude，或在 dselect、aptitude 或 Synaptic 中选择软件包。升级后，选择下一组软件包进行更新，直到所有软件包以及所需的新依赖关系或删除项都被更新为止。在大多数软件已经升级后，剩下的升级可以一次性处理。

选择软件包的子集相当简单。apt-get `dist-upgrade` 命令和 aptitude `full-upgrade` 命令将提供关于将添加、升级和移除的信息，并要求您确认选择。在这一点上，您可以告诉它们不要执行升级，然后检查建议升级的软件包，并选择一个或多个与 apt-get 或 aptitude 命令行 `install` 命令一起使用（这会升级已安装的软件包）。类似的过程适用于 Synaptic。

### 提示

简化升级过程的一种方法是首先执行标准的软件包升级。这将执行那些不需要进行主要依赖更改的简单标准软件包升级。完成此步骤后，完整的发行版升级将涉及更少的软件包。

## 升级期间

你已选择升级的软件包（或者正在执行一次性升级），并开始了这个过程。首先要注意的是哪些软件包将被移除。如果其中有一个或多个是你需要的软件包，请与要安装的软件包进行交叉检查，看看它们是否被一个具有类似功能的新软件包替代。如果没有，记得在升级完成后另行安装所需的软件包。

在发行版升级期间，系统通常可以继续运行，尽管当某个软件包要求重新启动某些服务或加载库时会有轻微的中断。

### 提示

这些中断比正常升级更严重，特别是在一个软件包被移除并替换为完成相同功能的不同软件包，或者因其过时而被移除的情况下。因此，您可能希望在升级之前通知用户，并将系统活动保持最低限度。

下一个要注意的是升级说明。一些软件工作方式的重大更改会显示出来（并发送到 root 账户以便稍后检查），以便通知安装程序需要采取的必要的安装后步骤。

最后，当管理员对软件包的配置进行更改后，升级过程将通知他/她非默认配置，并要求帮助解决差异。这涉及保留当前的本地版本、替换为开发者版本，或者暂停安装以便手动检查和解决差异。

### 提示

常常有新的选项或默认设置应添加到旧的配置中。最佳实践是立即解决这些更改，或保留旧的配置，并稍后与新的默认配置进行交叉检查（新的默认配置以修改后的名称放置在同一目录中，以使其处于非活动状态但仅供这个原因使用）。

## 升级后

一旦分发版升级完成，仍然有一些步骤需要执行。首先，如果在安装过程中未解决配置文件的问题，现在是时候进行处理了。新文件与旧文件放在相同的位置，且文件名带有`dpkg-new`扩展名。如果安装程序选择了开发者版本，旧配置文件则带有`dpkg-old`扩展名。无论哪种情况，管理员可以检查它们的差异，并进行必要的更改。

接下来，如果软件操作发生重大变化，任何使用该软件的应用程序都应该进行修改，或者更新配置以尽可能恢复旧的行为。一个很好的例子是 PHP 操作方式的重大变化，这通常需要重新编写使用了已更改特性的网页，或者在支持以遗留模式运行时修改配置。其他重大变化可能会影响用户，例如从 GNOME 2 到 GNOME 3 的变化，这涉及到用户体验的重大变化。此外，发布说明中提到的任何后安装步骤也应该执行。

# 总结

Debian 中的包管理器使得升级软件包变得非常简单，甚至可以升级到新的主要版本级别。升级不需要长时间的服务器停机，尽管如果涉及到修改软件配置或行为的重大软件更改，可能需要在升级后进行额外的工作以恢复服务到正常状态。可以添加非 Debian 仓库，以便包管理器可以像更新官方 Debian 包一样轻松地更新非 Debian 软件。如果某个软件没有 Debian 格式，可以使用 Debian 开发者使用的相同工具进行打包，这样 Debian 的包管理器也能处理它。

通常，在安装或升级之后，需要执行一些额外的步骤。最主要的是包配置，我们将在下一章中详细讨论。
