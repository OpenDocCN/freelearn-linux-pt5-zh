["```\n [donnie@localhost home]$ sudo useradd charlie\n [sudo] password for donnie:\n [donnie@localhost home]$\n [donnie@localhost home]$ ls -l\n total 0\n drwx------. 2 charlie charlie 59 Oct 1 15:25 charlie\n drwx------. 2 donnie donnie 79 Sep 27 00:24 donnie\n drwx------. 2 frank frank 59 Oct 1 15:25 frank\n [donnie@localhost home]$\n```", "```\nCREATE_HOME yes\nUMASK 077\n```", "```\nUMASK           022\n```", "```\nHOME_MODE       0700\n```", "```\nsudo useradd -m -d /home/frank -s /bin/bash frank\n```", "```\n donnie@packt:/home$ ls -l\n total 8\n drwxr-xr-x 3 donnie donnie 4096 Oct 2 00:23 donnie\n drwxr-xr-x 2 frank frank 4096 Oct 1 23:58 frank\n donnie@packt:/home$\n```", "```\n cd /home\n sudo chmod 700 *\n```", "```\n donnie@packt:/home$ ls -l\n total 8\n drwx------ 3 donnie donnie 4096 Oct 2 00:23 donnie\n drwx------ 2 frank frank 4096 Oct 1 23:58 frank\n donnie@packt:/home$\n```", "```\nUMASK 022\n```", "```\nUMASK 077\n```", "```\nHOME_MODE       0750\n```", "```\nDIR_MODE=750\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo apt install ecryptfs-utils\ndonnie@ubuntu-steemnode:~$ sudo adduser --encrypt-home cleopatra\n [sudo] password for donnie:\n Adding user `cleopatra' ...\n Adding new group `cleopatra' (1004) ...\n Adding new user `cleopatra' (1004) with group `cleopatra' ...\n Creating home directory `/home/cleopatra' ...\n Setting up encryption ...\n ************************************************************************\n YOU SHOULD RECORD YOUR MOUNT PASSPHRASE AND STORE IT IN A SAFE LOCATION.\n  ecryptfs-unwrap-passphrase ~/.ecryptfs/wrapped-passphrase\n THIS WILL BE REQUIRED IF YOU NEED TO RECOVER YOUR DATA AT A LATER TIME.\n ********************************************************************\nDone configuring.\n Copying files from `/etc/skel' ...\n Enter new UNIX password:\n Retype new UNIX password:\n passwd: password updated successfully\n Changing the user information for cleopatra\n Enter the new value, or press ENTER for the default\n  Full Name []: Cleopatra Tabby Cat\n  Room Number []: 1\n  Work Phone []: 555-5556\n  Home Phone []: 555-5555\n  Other []:\n Is the information correct? [Y/n] Y\n donnie@ubuntu-steemnode:~$\nThe first time that Cleopatra logs in, she'll need to run the ecryptfs-unwrap-passphrase command that's mentioned in the preceding output. She'll then want to write her passphrase down and store it in a safe place:\n cleopatra@ubuntu-steemnode:~$ ecryptfs-unwrap-passphrase\n Passphrase:\n d2a6cf0c3e7e46fd856286c74ab7a412\n cleopatra@ubuntu-steemnode:~$\n```", "```\nsudo apt install ecryptfs-utils\n```", "```\nsudo adduser --encrypt-home cleopatra\nls -l /home\n```", "```\nsu - cleopatra\necryptfs-unwrap-passphrase\nexit\n```", "```\n[donnie@localhost pam.d]$ grep 'pwquality' *\n password-auth:password requisite pam_pwquality.so try_first_pass\n local_users_only retry=3 authtok_type=\n password-auth-ac:password requisite pam_pwquality.so try_first_pass\n local_users_only retry=3 authtok_type=\n system-auth:password requisite pam_pwquality.so try_first_pass\n local_users_only retry=3 authtok_type=\n system-auth-ac:password requisite pam_pwquality.so try_first_pass\n local_users_only retry=3 authtok_type=\n [donnie@localhost pam.d]$\n```", "```\nsudo apt install libpam-pwquality\n```", "```\n# Minimum acceptable size for the new password (plus one if \n# credits are not disabled which is the default). (See pam_cracklib manual.) \n# Cannot be set to lower value than 6\\. \n# minlen = 8 \n```", "```\nminlen = 19\n[donnie@localhost ~]$ sudo passwd katelyn\n Changing password for user katelyn.\n New password:\n BAD PASSWORD: The password is shorter than 18 characters\n Retype new password:\n [donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo passwd katelyn\n Changing password for user katelyn.\n New password:\n BAD PASSWORD: The password is shorter than 17 characters\n Retype new password:\n [donnie@localhost ~]$\n```", "```\n# lcredit = 1 \n```", "```\nlcredit = 0\n```", "```\n[donnie@localhost ~]$ sudo passwd katelyn\n Changing password for user katelyn.\n New password:\n BAD PASSWORD: The password is shorter than 19 characters\n Retype new password:\n [donnie@localhost ~]$\n```", "```\ndcredit = -3\n```", "```\n# minclass = 3\n```", "```\nsudo apt install libpam-pwquality\n```", "```\n minlen = 19\n```", "```\nminclass = 3 \nmaxclassrepeat = 5 \n```", "```\ndonnie@packt:~$ chage -l donnie\n [sudo] password for donnie:\n Last password change : Oct 03, 2017\n Password expires : never\n Password inactive : never\n Account expires : never\n Minimum number of days between password change : 0\n Maximum number of days between password change : 99999\n Number of days of warning before password expires : 7\n donnie@packt:~$\n```", "```\nPASS_MAX_DAYS 99999 \nPASS_MIN_DAYS 0 \nPASS_WARN_AGE 7\n```", "```\n# useradd defaults file\nGROUP=100\nHOME=/home \nINACTIVE=-1 \nEXPIRE= \nSHELL=/bin/bash \nSKEL=/etc/skel \nCREATE_MAIL_SPOOL=yes\n```", "```\nsudo useradd -D -e 2025-12-31\n```", "```\n[donnie@localhost ~]$ sudo useradd -D\n GROUP=100\n HOME=/home\n INACTIVE=-1\n EXPIRE=2023-12-31\n SHELL=/bin/bash\n SKEL=/etc/skel\n CREATE_MAIL_SPOOL=yes\n [donnie@localhost ~]$\n```", "```\nsudo useradd -D -f 5\nsudo useradd -D -s /bin/zsh\n [donnie@localhost ~]$ sudo useradd -D\n GROUP=100\n HOME=/home\n INACTIVE=5\n EXPIRE=2019-12-31\n SHELL=/bin/zsh\n SKEL=/etc/skel\n CREATE_MAIL_SPOOL=yes\n [donnie@localhost ~]$\n```", "```\nsudo useradd -e 2025-12-31 charlie\n```", "```\nsudo useradd -m -d /home/charlie -s /bin/bash -e 2025-12-31 charlie\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo chage -l charlie\n Last password change : Oct 06, 2017\n Password expires : never\n Password inactive : never\n Account expires : Dec 31, 2025\n Minimum number of days between password change : 0\n Maximum number of days between password change : 99999\n Number of days of warning before password expires : 7\n donnie@ubuntu-steemnode:~$\n```", "```\nsudo usermod -e 2026-01-31 charlie\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo chage -l charlie\n Last password change : Oct 06, 2017\n Password expires : never\n Password inactive : never\n Account expires : Jan 31, 2026\n Minimum number of days between password change : 0\n Maximum number of days between password change : 99999\n Number of days of warning before password expires : 7\n donnie@ubuntu-steemnode:~$\n```", "```\nsudo usermod -f 5 charlie\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo chage -E 2026-02-28 -I 4 -m 3 -M 90 -W 4 charlie\ndonnie@ubuntu-steemnode:~$ sudo chage -l charlie\n Last password change : Oct 06, 2019\n Password expires : Jan 04, 2026\n Password inactive : Jan 08, 2026\n Account expires : Feb 28, 2026\n Minimum number of days between password change : 3\n Maximum number of days between password change : 90\n Number of days of warning before password expires : 4\ndonnie@ubuntu-steemnode:~$\n```", "```\nsudo chage -d 0 samson\n or\nsudo passwd -e samson\n\n donnie@ubuntu-steemnode:~$ sudo chage -l samson\n Last password change : password must be changed\n Password expires : password must be changed\n Password inactive : password must be changed\n Account expires : never\n Minimum number of days between password change : 0\n Maximum number of days between password change : 99999\n Number of days of warning before password expires : 7\n donnie@ubuntu-steemnode:~$\n```", "```\nsudo useradd -e 2025-06-30 samson\nsudo chage -l samson\n```", "```\nsudo useradd -m -d /home/samson -s /bin/bash -e 2025-06-30 samson\nsudo chage -l samson\n```", "```\nsudo usermod -e 2025-07-31 samson\nsudo chage -l samson\n```", "```\nsudo passwd samson\nsudo passwd -e samson\nsudo chage -l samson\nsu - samson\nexit\n```", "```\nsudo chage -m 5 -M 90 -I 2 -W 5 samson\nsudo chage -l samson\n```", "```\nEXAMPLES\n Add the following line to /etc/pam.d/login to lock the account after\n4 failed logins. Root account will be locked as well. The accounts will be\nautomatically unlocked after 20 minutes. The module does not have to be\ncalled in the account phase because the login calls pam_setcred(3)\ncorrectly.\n auth required pam_securetty.so\n auth required pam_tally2.so deny=4 even_deny_root\nunlock_time=1200\n auth required pam_env.so\n auth required pam_unix.so\n auth required pam_nologin.so\n account required pam_unix.so\n password required pam_unix.so\n session required pam_limits.so\n session required pam_unix.so\n session required pam_lastlog.so nowtmp\n session optional pam_mail.so standard\n```", "```\ndonnie@centos7:~$ sudo pam_tally2\n Login Failures Latest failure From\n charlie 5 10/07/17 16:38:19\n donnie@centos7:~$ sudo pam_tally2 --user=charlie --reset\n Login Failures Latest failure From\n charlie 5 10/07/17 16:38:19\n donnie@centos7:~$ sudo pam_tally2\n donnie@centos7:~$\n```", "```\nauth required pam_tally2.so deny=4 even_deny_root unlock_time=1200\n```", "```\nsudo pam_tally2\n```", "```\nsudo pam_tally2 --user=samson --reset\nsudo pam_tally2\n```", "```\n[donnie@localhost ~]$ sudo authselect list\n- minimal    Local users only for minimal installations\n- sssd       Enable SSSD for system authentication (also for local users only)\n- winbind    Enable winbind for system authentication\n[donnie@localhost ~]$\n```", "```\n[donnie@localhost ~]$ sudo authselect list-features minimal\n. . .\n. . .\nwith-faillock\n. . .\n. . .\n[donnie@localhost ~]$\n```", "```\nsudo authselect select minimal --force\n```", "```\nsudo authselect enable-feature with-faillock\n```", "```\n# silent\n# deny = 3\n# unlock_time = 600\n# even_deny_root\n```", "```\nsudo useradd vicky\nsudo passwd vicky\n```", "```\n[donnie@localhost ~]$ sudo faillock\ndonnie:\nWhen                Type  Source                                           Valid\nvicky:\nWhen                Type  Source                                           Valid\n2022-10-12 15:54:35 RHOST 192.168.0.16                                         V\n2022-10-12 15:54:42 RHOST 192.168.0.16                                         V\n2022-10-12 15:54:46 RHOST 192.168.0.16                                         V\n[donnie@localhost ~]$\n```", "```\nsudo faillock --reset --user vicky\n```", "```\nauth        required                                     pam_faillock.so preauth silent\n       auth        required                                     pam_faillock.so authfail\n```", "```\naccount     required                                     pam_faillock.so\n```", "```\nsudo usermod -L katelyn\n```", "```\nkatelyn:!$6$uA5ecH1A$MZ6q5U.cyY2SRSJezV000AudP.ckXXndBNsXUdMI1vPO8aFmlLXcbGV25K5HSSaCv4RlDilwzlXq/hKvXRkpB/:17446:0:99999:7:::\n```", "```\nsudo usermod -U katelyn\n```", "```\nsudo passwd -l katelyn\n```", "```\ndonnie@ubuntu-steemnode:~$ sudo passwd -l katelyn\n passwd: password expiry information changed.\n donnie@ubuntu-steemnode:~$\n```", "```\n[donnie@localhost ~]$ sudo passwd -l katelyn\n Locking password for user katelyn.\n passwd: Success\n [donnie@localhost ~]$\n```", "```\nsudo passwd -u katelyn\n```", "```\nsudo passwd -l root\n```", "```\n maggie@192.168.0.100's password:\n Last login: Sat Oct 7 20:51:09 2017\n Warning: Authorized Users Only!\n All others will be prosecuted.\n [maggie@localhost ~]$\nmotd stands for Message of the Day.\n```", "```\nWelcome to Ubuntu 22.04.1 LTS (GNU/Linux 5.15.0-48-generic x86_64)\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n  System information as of Thu Oct 13 06:20:54 PM UTC 2022\n  System load:  0.0               Processes:               103\n  Usage of /:   47.8% of 9.75GB   Users logged in:         1\n  Memory usage: 12%               IPv4 address for enp0s3: 192.168.0.11\n  Swap usage:   0%\n39 updates can be applied immediately.\nTo see these additional updates run: apt list --upgradable\nWarning!!! Authorized users only!\nLast login: Thu Oct 13 17:14:52 2022 from 192.168.0.16\nThe Warning!!! Authorized users only! line is what I placed into the /etc/motd file.\n```", "```\nUbuntu 22.04.1 LTS \\n \\l\n```", "```\n\\S\nKernel \\r on an \\m\n```", "```\ncurl https://api.pwnedpasswords.com/range/21BD1\n```", "```\n [donnie@fedora-teaching ~]$ curl https://api.pwnedpasswords.com/range/21BD1\n 0018A45C4D1DEF81644B54AB7F969B88D65:1\n 00D4F6E8FA6EECAD2A3AA415EEC418D38EC:2\n 011053FD0102E94D6AE2F8B83D76FAF94F6:1\n 012A7CA357541F0AC487871FEEC1891C49C:2\n 0136E006E24E7D152139815FB0FC6A50B15:3\n 01A85766CD276B17DE6DA022AA3CADAC3CE:3\n 024067E46835A540D6454DF5D1764F6AA63:3\n 02551CADE5DDB7F0819C22BFBAAC6705182:1\n 025B243055753383B479EF34B44B562701D:2\n 02A56D549B5929D7CD58EEFA97BFA3DDDB3:8\n 02F1C470B30D5DDFF9E914B90D35AB7A38F:3\n 03052B53A891BDEA802D11691B9748C12DC:6\n. . .\n. . .\n```", "```\n [donnie@fedora-teaching ~]$ curl https://api.pwnedpasswords.com/range/21BD1 | wc -l\n % Total % Received % Xferd Average Speed Time Time Time Current\n Dload Upload Total Spent Left Speed\n 100 20592 0 20592 0 0 197k 0 --:--:-- --:--:-- --:--:-- 199k\n 526\n [donnie@fedora-teaching ~]$\n```", "```\n#!/bin/bash\ncandidate_password=$1\necho \"Candidate password: $candidate_password\"\nfull_hash=$(echo -n $candidate_password | sha1sum | awk '{print substr($1, 0, 32)}')\nprefix=$(echo $full_hash | awk '{print substr($1, 0, 5)}')\nsuffix=$(echo $full_hash | awk '{print substr($1, 6, 26)}')\nif curl https://api.pwnedpasswords.com/range/$prefix | grep -i $suffix;\n then echo \"Candidate password is compromised\";\n else echo \"Candidate password is OK for use\";\nfi\n```", "```\nchmod u+x pwnedpasswords.sh\n```", "```\n [donnie@fedora-teaching ~]$ ./pwnedpasswords.sh TurkeyLips\n Candidate password: TurkeyLips\n % Total % Received % Xferd Average Speed Time Time Time Current\n Dload Upload Total Spent Left Speed\n 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 09FDEDF4CA44D6B432645D6C1D3A8D4A16BD:2\n 100 21483 0 21483 0 0 107k 0 --:--:-- --:--:-- --:--:-- 107k\n Candidate password is compromised\n [donnie@fedora-teaching ~]$\n```", "```\n [donnie@fedora-teaching ~]$ ./pwnedpasswords.sh TurkeyLips98\n Candidate password: TurkeyLips98\n % Total % Received % Xferd Average Speed Time Time Time Current\n Dload Upload Total Spent Left Speed\n 100 20790 0 20790 0 0 110k 0 --:--:-- --:--:-- --:--:-- 110k\n Candidate password is OK for use\n [donnie@fedora-teaching ~]$\n```", "```\ncurl https://api.pwnedpasswords.com/range/21BD1\n```", "```\n#!/bin/bash\ncandidate_password=$1\necho \"Candidate password: $candidate_password\"\nfull_hash=$(echo -n $candidate_password | sha1sum | awk '{print substr($1, 0, 32)}')\nprefix=$(echo $full_hash | awk '{print substr($1, 0, 5)}')\nsuffix=$(echo $full_hash | awk '{print substr($1, 6, 26)}')\nif curl https://api.pwnedpasswords.com/range/$prefix | grep -i $suffix;\n        then echo \"Candidate password is compromised\";\n        else echo \"Candidate password is OK for use\";\nfi\n```", "```\nchmod u+x pwnedpasswords.sh\n```", "```\n./pwnedpasswords.sh TurkeyLips\n```"]