<html><head></head><body><div class="chapter" title="Chapter&#xA0;9.&#xA0;Running a MySQL Database Server"><div class="titlepage"><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Running a MySQL Database Server</h1></div></div></div><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Installing the MySQL database server</li><li class="listitem" style="list-style-type: disc">Allowing access to MySQL over the network</li><li class="listitem" style="list-style-type: disc">Accessing your MySQL server over an SSH tunnel</li><li class="listitem" style="list-style-type: disc">Creating a new database</li><li class="listitem" style="list-style-type: disc">Creating users and granting permissions to databases</li><li class="listitem" style="list-style-type: disc">Creating a backup of your database</li><li class="listitem" style="list-style-type: disc">Executing custom SQL commands</li><li class="listitem" style="list-style-type: disc">Restoring database from the backup</li><li class="listitem" style="list-style-type: disc">Editing the structure of your database</li><li class="listitem" style="list-style-type: disc">Editing records in a database</li><li class="listitem" style="list-style-type: disc">Checking who is using your database server</li><li class="listitem" style="list-style-type: disc">Installing phpMyAdmin</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec95"/>Introduction</h1></div></div></div><p>MySQL<a id="id646" class="indexterm"/> is a powerful open source database management system. MySQL servers are easy to set up and scale quite well. This database system powers some of the world's largest websites including Facebook, Twitter, and Wikipedia.</p><p>MySQL employs a distributed client-server architecture. A single server can provide database services to multiple client programs simultaneously. Clients running on the same machine as the server usually connect using a Unix socket. Clients can also run on separate machines and connect to the database server over the network. MySQL uses TCP connections, and the server's default listening port is 3306.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note51"/>Note</h3><p>Unix domain sockets are channels used for inter-process communication. Different programs running on the same machine can read and write information to a socket, enabling communication between the programs. Unix sockets are represented as nodes of the filesystem, so you can find a socket by listing the contents of a directory in which it was created.</p></div></div><p>The permissions system of <a id="id647" class="indexterm"/>MySQL is very granular. Each client can have access limited to a subset of databases and be allowed to execute a different set of SQL commands on each database.</p><p>The database server maintains a list of client accounts, which are separate from the system user accounts. Each client account is defined not only by a username and password, but also by the host from which the user is connecting. Thanks to this solution, complex permission definitions are possible. For instance, the same username and password may be used locally to perform administrative tasks, but allowed only to view the server state remotely.</p><p>The default MySQL installation creates an administrative superuser called <code class="literal">root</code> as well as an anonymous account, which makes it possible to connect to the database server without authentication. It's important to equip the <code class="literal">root</code> account with a strong password and disable anonymous accounts on a production system.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note52"/>Note</h3><p>In addition to a username and password, MySQL may require the client to provide a certificate for increased security.</p></div></div><p>Webmin's support for MySQL is excellent and allows you to perform most tasks related to the running of the database server. In this chapter, we will demonstrate how Webmin can help you install MySQL, set up access to the server over a network, manage user accounts, create databases, and edit the structure and data of databases. We'll also demonstrate how to automatically backup databases and restore backup files. If you find that you need an even more advanced web-based management tool, we will demonstrate how to set up phpMyAdmin on your server.</p></div></div>
<div class="section" title="Installing the MySQL database server"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec96"/>Installing the MySQL database server</h1></div></div></div><p>Practically all operating systems that come with a package management solution for open source software make MySQL packages available for installation. In this recipe, we will install MySQL from a package and set it up on your system. The server package automatically installs MySQL's command-line client package as well.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec309"/>How to do it...</h2></div></div></div><p>Follow these <a id="id648" class="indexterm"/>steps<a id="id649" class="indexterm"/> to set up MySQL on your server:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Follow the steps described in the <span class="emphasis"><em>Installing software packages</em></span> recipe in <a class="link" href="ch01.html" title="Chapter 1. Setting Up Your System">Chapter 1</a>, <span class="emphasis"><em>Setting Up Your System</em></span>, to find and install the MySQL database server package.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note53"/>Note</h3><p>Most distributions make multiple versions of MySQL available in their package repositories. On some systems, you will find a meta-package called <code class="literal">mysql-server</code> that installs the latest version. On other systems, you will find packages with version numbers in the name, for instance <code class="literal">mysql-server-5.5</code> or <code class="literal">mysql55-server</code> for version 5.5.x. Pick the package with the latest version unless you have reasons to stick to an older one.</p></div></div></li><li class="listitem">Navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Bootup and Shutdown</strong></span>.</li><li class="listitem">Select the checkbox next to the init script for the MySQL database server (it will be named <code class="literal">mysql</code>, <code class="literal">mysqld</code>, <code class="literal">mysql-server</code>, or similarly).</li><li class="listitem">Click the <span class="strong"><strong>Start Now and On Boot</strong></span> button.</li><li class="listitem">Click the <span class="strong"><strong>Refresh Modules</strong></span> link at the bottom of Webmin's main menu and reload the browser to update the menu.</li><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li></ol></div><p>Webmin should be able to connect to your MySQL server. You will see a list of databases that, at this stage, should include default databases such as <code class="literal">information_schema</code> and <code class="literal">mysql</code>.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip84"/>Tip</h3><p>If you see <span class="strong"><strong>Warning: The Perl modules DBI and DBD::mysql are not installed on your system</strong></span>, click the link and follow Webmin's instructions to install the missing Perl modules.</p></div></div><p>The default MySQL setup is fine for a development or testing server. However, if you plan to use the database in production or on a shared server, please continue reading the <span class="emphasis"><em>There's more</em></span> section of this recipe.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec310"/>How it works...</h2></div></div></div><p>Webmin helps you find and install the <code class="literal">mysql-server</code> package from your distribution's repositories. The package contains an init script, which we enabled in order to start the database server whenever your machine boots.</p><p>The default MySQL installation contains a number of convenient features, such as anonymous user accounts or the ability to log in as root without providing a password. These default options make it easier to get started with MySQL. However, they should never be<a id="id650" class="indexterm"/> used <a id="id651" class="indexterm"/>in production because they constitute a major security risk.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec311"/>There's more...</h2></div></div></div><p>Perform the following steps to make MySQL more secure for use in a production setting.</p><div class="section" title="Making MySQL ready for production use"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec104"/>Making MySQL ready for production use</h3></div></div></div><p>Follow these steps to provide <a id="id652" class="indexterm"/>basic security for your MySQL server:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Connect to your server using a terminal emulator, for instance over SSH.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip85"/>Tip</h3><p>You may also use Webmin's <span class="strong"><strong>Text Login</strong></span> module.</p></div></div></li><li class="listitem">Type in the following command: <code class="literal">mysql_secure_installation</code>.</li><li class="listitem">Answer yes to all questions by pressing <span class="emphasis"><em>Y</em></span> and then <span class="emphasis"><em>Enter</em></span>, unless you know that you want settings other then the recommended ones.</li></ol></div><p>The <code class="literal">mysql_secure_installation</code> script<a id="id653" class="indexterm"/> performs the following tasks:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Sets a password for the database <code class="literal">root</code> user</li><li class="listitem" style="list-style-type: disc">Removes anonymous access to the database; MySQL will only allow authorized users access from now on</li><li class="listitem" style="list-style-type: disc">Disallows remote login by the <code class="literal">root</code> user, because this user should normally only access the database from the same computer</li><li class="listitem" style="list-style-type: disc">Removes the <code class="literal">test</code> database.</li></ul></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec312"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If you want to allow other computers access to your databases, take a look at the <span class="emphasis"><em>Allowing access to MySQL over the network</em></span> recipe of this chapter.</li></ul></div></div></div>
<div class="section" title="Allowing access to MySQL over the network"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec97"/>Allowing access to MySQL over the network</h1></div></div></div><p>Programs that access MySQL databases, which are called clients, may be running on the same machine as the server. In this case, the client and server will communicate most efficiently using a Unix domain socket, which is a channel of inter-process communication accessed through the filesystem like a file or directory. Access to a socket is controlled by the filesystem's permissions.</p><p>Other client programs may be able to communicate only over TCP network sockets. These clients may connect to the local server using the loopback interface and IP address of 127.0.0.1. In this case, the MySQL server must be compiled with networking support and configured to listen for connections on the loopback interface.</p><p>However, if the <a id="id654" class="indexterm"/>client program is located on a machine other than the server, then communication between them must take place over the network using the TCP protocol. In order to make this communication possible, you will need to open an exception in your firewall and instruct MySQL to listen for incoming network connections on a physical network interface.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip86"/>Tip</h3><p>You may also tunnel MySQL traffic over SSH, which may be a more secure solution. Take a look at the <span class="emphasis"><em>Accessing your database server remotely over an SSH tunnel</em></span> recipe for more information.</p></div></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec313"/>Getting ready</h2></div></div></div><p>If you plan to make your database server available over the network, you should definitely take measures to secure it. Take a look at the <span class="emphasis"><em>Making MySQL ready for production use</em></span> section of the <span class="emphasis"><em>Installing the MySQL database server</em></span> recipe in this chapter for more information.</p><p>Before starting, follow steps described in the <span class="emphasis"><em>Allowing access to a service through the firewall</em></span> recipe in <a class="link" href="ch03.html" title="Chapter 3. Securing Your System">Chapter 3</a>, <span class="emphasis"><em>Securing your system</em></span>, to allow incoming TCP traffic to port <code class="literal">3306</code> through your firewall as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/5849_09_01.jpg" alt="Getting ready"/></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec314"/>How to do it...</h2></div></div></div><p>Steps in this recipe will be divided into the following four sections:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">First, we'll instruct MySQL to listen for incoming network connections on the standard MySQL port (<code class="literal">3306</code>)</li><li class="listitem" style="list-style-type: disc">Then, we'll create a database user named <code class="literal">dbuser</code></li><li class="listitem" style="list-style-type: disc">We will grant access to a database named <code class="literal">testdb</code></li><li class="listitem" style="list-style-type: disc">Finally, we will test the setup by connecting to our server from a secondary client machine</li></ul></div><div class="section" title="Instructing MySQL server to listen for network connections"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec105"/>Instructing MySQL server to listen for network connections</h3></div></div></div><p>For MySQL to accept <a id="id655" class="indexterm"/>incoming network connections, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>MySQL Server Configuration</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>MySQL server listening address</strong></span> to <span class="strong"><strong>Any</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Save and Restart MySQL</strong></span> button.</li></ol></div></div><div class="section" title="Creating a new user"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec106"/>Creating a new user</h3></div></div></div><p>In order to create a <a id="id656" class="indexterm"/>new user, perform the following steps: </p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>User Permissions</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create new user</strong></span> link.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to <code class="literal">dbuser</code>, <span class="strong"><strong>Password</strong></span> to a strong password, and <span class="strong"><strong>Hosts</strong></span> to <span class="strong"><strong>Any</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div><p>
</p></div><div class="section" title="Granting user access to database"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec107"/>Granting user access to database</h3></div></div></div><p>In order to grant user <a id="id657" class="indexterm"/>access to database, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to<a id="id658" class="indexterm"/> <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>Database Permissions</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create new database permissions</strong></span> link.</li><li class="listitem">In the <span class="strong"><strong>Databases</strong></span> line, choose <span class="strong"><strong>Selected</strong></span> and select your <code class="literal">testdb</code> database.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to the name of the created user, that is, <code class="literal">dbuser</code>.</li><li class="listitem">Set <span class="strong"><strong>Hosts</strong></span> to <span class="strong"><strong>Any</strong></span> to allow the user to connect from anywhere.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip87"/>Tip</h3><p>For added security, you should specify an IP address or domain name from which the user will be able to connect. You can use <code class="literal">%</code> as part of the address to specify a wildcard. For example, <code class="literal">192.168.0.%</code> would denote the entire <code class="literal">192.168.0.1/24</code> subnet, while <code class="literal">%.example.com</code> would include all hosts within a domain.</p></div></div></li><li class="listitem">Select all the permissions in the <span class="strong"><strong>Permissions</strong></span> list.</li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="Testing the connection"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec108"/>Testing the connection</h3></div></div></div><p>Try to connect to your<a id="id659" class="indexterm"/> database server from a second machine on the network. If your other machine has the MySQL command-line client installed, you can test the connection by typing in this command at the terminal, but substitute <code class="literal">mysql-host</code> with the IP or domain name of your MySQL server:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysql -u dbuser -p -h mysql-host -D testdb</strong></span>
</pre></div><p>If the connection is successful, you will see the following welcome message including the server's MySQL version:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Welcome to the MySQL monitor.  Commands end with ; or \g.</strong></span>
<span class="strong"><strong>Your MySQL connection id is 58</strong></span>
<span class="strong"><strong>Server version: 5.5.31-0+wheezy1 (Debian)</strong></span>
<span class="strong"><strong>mysql&gt; exit</strong></span>
<span class="strong"><strong>Bye</strong></span>
</pre></div><p>When you arrive at the <code class="literal">mysql&gt;</code> prompt, you can start executing SQL commands. Type <code class="literal">exit</code> and press <span class="emphasis"><em>Enter</em></span> to disconnect.</p></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec315"/>How it works...</h2></div></div></div><p>In order to allow the <a id="id660" class="indexterm"/>MySQL server to accept incoming network connections, Webmin edits your server's configuration file (usually located in <code class="literal">/etc/my.cnf</code>, <code class="literal">/var/db/mysql/my.cnf</code> or <code class="literal">/etc/mysql/my.cnf</code>).</p><p>There are two lines in the server's configuration that specify what connections the server will accept. For instance, if we only want to accept local connections, these lines could read like the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>socket=/var/lib/mysql/mysql.sock</strong></span>
<span class="strong"><strong>bind-address=127.0.0.1</strong></span>
</pre></div><p>The first line instructs MySQL to create a local Unix socket for communication with other programs on the same machine, while the second line instructs it to listen for incoming connections on the local loopback interface (<code class="literal">127.0.0.1</code>). In order to make the server listen to incoming network connections on all interfaces, Webmin simply removes the <code class="literal">bind-address</code> line.</p><p>We tested our connection by issuing the following command on another computer attached to the same network:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysql -u dbuser -p -h mysql-host -D testdb</strong></span>
</pre></div><p>This command starts the MySQL command-line client. The options specified are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">-u</code>: This option specifies which user is trying to connect to the server</li><li class="listitem" style="list-style-type: disc"><code class="literal">-p</code>: This option states that we want to be prompted for a password</li><li class="listitem" style="list-style-type: disc"><code class="literal">-h</code>: This option specifies the host to which we're trying to connect</li><li class="listitem" style="list-style-type: disc"><code class="literal">-D</code>: This option states which database we want to use once we are connected</li></ul></div><p>In order to create database users and grant them permissions, Webmin operates directly on the data stored in MySQL's internal configuration databases. If you wanted to perform the same operations manually, you could connect to the MySQL server by using the command-line client and issuing the following commands.</p><p>First, connect to the local database server as <code class="literal">root</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysql -u root -p</strong></span>
</pre></div><p>Next, issue the <a id="id661" class="indexterm"/>following MySQL commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt; CREATE USER 'dbuser'@'%' IDENTIFIED BY 'strongpassword';</strong></span>
<span class="strong"><strong>mysql&gt; GRANT ALL PRIVILEGES ON testdb.* TO 'dbuser'@'%';</strong></span>
<span class="strong"><strong>mysql&gt; FLUSH PRIVILEGES;</strong></span>
</pre></div><p>The first command creates a user named <code class="literal">dbuser</code>, while the second gives this user complete access to the <code class="literal">testdb</code> database. The final command forces your MySQL server to reload information about users and privileges so that the new user can connect.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip88"/>Tip</h3><p>The MySQL command-line client stores a history of all the entered commands in a file. If we execute the commands listed earlier, the history file will contain the password of our newly created user. To avoid this, we can instruct MySQL not to save history during this session by issuing the following command before connecting to the server:</p><div class="informalexample"><pre class="programlisting">$ export MYSQL_HISTFILE=/dev/null</pre></div></div></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec316"/>There's more...</h2></div></div></div><p>This recipe allows a user to access a single database remotely. For security reasons, the primary management account (<code class="literal">root</code>) should not be allowed to connect to your server from another computer. If you would nevertheless like to allow some remote management of the database server (creating databases, users, and so on), you can perform the following outlined steps.</p><div class="section" title="Managing databases remotely"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec109"/>Managing databases remotely</h3></div></div></div><p>Follow these steps to create an <a id="id662" class="indexterm"/>account that you will use for remote administration:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>User Permissions</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create new user</strong></span> link.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to an administrative account name. Try to choose a username that will be harder to guess than <code class="literal">admin</code>.</li><li class="listitem">Set <span class="strong"><strong>Password</strong></span> to a very strong password.</li><li class="listitem">Set <span class="strong"><strong>Hosts</strong></span> to the IP address range from which your administrative user will connect.</li><li class="listitem">From the <span class="strong"><strong>Permissions</strong></span> list, carefully choose only those permissions that you are sure you need to access remotely.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note54"/>Note</h3><p>More information about the significance of each permission can be found in the <span class="emphasis"><em>Privileges Provided by MySQL</em></span> section of MySQL's documentation at the following link:</p><p>
<a class="ulink" href="http://dev.mysql.com/doc/refman/5.6/en/privileges-provided.html">http://dev.mysql.com/doc/refman/5.6/en/privileges-provided.html</a>
</p></div></div></li><li class="listitem">Click the <a id="id663" class="indexterm"/><span class="strong"><strong>Create</strong></span> button.<p>You should now be able to connect to your server (<code class="literal">mysql-host</code>) from a remote client computer. You do not need to specify a database name when you connect:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysql -u administrative_user -p -h mysql-host</strong></span>
</pre></div></li></ol></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec317"/>See also</h2></div></div></div><p>In order to make remote access and management of your MySQL databases more secure, you can tunnel your connection over SSH.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Take a look at the <span class="emphasis"><em>Accessing your MySQL server over an SSH tunnel</em></span> recipe of this chapter for instructions.</li></ul></div></div></div>
<div class="section" title="Accessing your MySQL server over an SSH tunnel"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec98"/>Accessing your MySQL server over an SSH tunnel</h1></div></div></div><p>If your server is <a id="id664" class="indexterm"/>hosting a website on the Internet and running a <a id="id665" class="indexterm"/>database system on the same machine, it is safer to disable remote network access to MySQL. On the other hand, you may still want to manage your databases remotely, and you can do so by tunneling MySQL traffic over an SSH connection.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note55"/>Note</h3><p>One of the most important aspects of a database system is the speed with which it can find and return the data that you ask for. Tunneling traffic over SSH will add significant overhead to this communication. This solution is great for intermittent management tasks, but is typically not suitable as a replacement for a direct connection to your database system.</p></div></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec318"/>Getting ready</h2></div></div></div><p>The server you <a id="id666" class="indexterm"/>want to connect to must run both the MySQL <a id="id667" class="indexterm"/>server and an SSH server. The remote client machine must have an SSH client and MySQL client software installed. Make a note of the IP address or domain name of the server (<code class="literal">mysql-host</code>), the SSH username (<code class="literal">ssh-user</code>), MySQL user (<code class="literal">mysql-user</code>), and database name (<code class="literal">database-name</code>). Substitute them in this recipe.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec319"/>How to do it...</h2></div></div></div><p>In order to create an SSH tunnel for MySQL, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Issue the following command on your client machine:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ ssh -L 15000:localhost:3306 ssh-user@mysql-host</strong></span>
</pre></div><p>This creates a tunnel between the port <code class="literal">15000</code> on your client machine and the port <code class="literal">3306</code> of the server. You can now access the remote database by making a MySQL connection to your client computer's local port <code class="literal">15000</code>. </p></li><li class="listitem">Issue the following command on the client system to test the connection:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysql -u mysql-user -p  -D database-name -h 127.0.0.1 -P 15000</strong></span>
</pre></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec320"/>How it works...</h2></div></div></div><p>The SSH client acts as an intermediator in communication between a MySQL client running on your machine and the remote server. It opens port <code class="literal">15000</code> and listens for incoming connections. All packets arriving at port <code class="literal">15000</code> are encrypted and forwarded over SSH to the server. On the server side, SSH receives the packets, decrypts them, and sends them to port <code class="literal">3306</code>. Answers are sent back in the opposite direction over the same channel.</p><p>You can find more information about SSH tunnels in the <span class="emphasis"><em>Connecting to Webmin securely over an SSH tunnel</em></span> recipe in <a class="link" href="ch03.html" title="Chapter 3. Securing Your System">Chapter 3</a>, <span class="emphasis"><em>Securing Your System</em></span>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec321"/>There's more...</h2></div></div></div><p>Some MySQL clients incorporate the ability to set up an SSH tunnel when connecting to a remote database.</p><div class="section" title="Making an SSH tunnel in MySQL Workbench"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec110"/>Making an SSH tunnel in MySQL Workbench</h3></div></div></div><p>Popular GUI clients <a id="id668" class="indexterm"/>such as MySQL Workbench or Sequel Pro<a id="id669" class="indexterm"/> allow you to specify the SSH connection settings in the same window as the database connection settings. The procedure is similar in all cases. In MySQL Workbench you would set up the connection as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Run MySQL Workbench on your client computer.</li><li class="listitem">Select <span class="strong"><strong>Connect to database</strong></span> from the <span class="strong"><strong>Database</strong></span> menu.</li><li class="listitem">Set <span class="strong"><strong>Connection Method</strong></span> to <span class="strong"><strong>Standard TCP/IP over SSH</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>SSH Hostname</strong></span> to the remote server's IP address or domain name.</li><li class="listitem">Set <span class="strong"><strong>SSH Username</strong></span> to a system user with SSH access.</li><li class="listitem">Set <span class="strong"><strong>MySQL Hostname</strong></span> to <code class="literal">127.0.0.1</code>.</li><li class="listitem">Set <span class="strong"><strong>MySQL Server Port</strong></span> to <code class="literal">3306</code>.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to the name of a MySQL user.</li><li class="listitem">Click the <span class="strong"><strong>Test Connection</strong></span> button. Consider the following screenshot:<div class="mediaobject"><img src="graphics/5849_09_02.jpg" alt="Making an SSH tunnel in MySQL Workbench"/></div></li></ol></div><p>You will be asked <a id="id670" class="indexterm"/>for the password of the SSH user and then the <a id="id671" class="indexterm"/>password of the MySQL user. If all goes well, you will see a message indicating that the connection parameters are correct.</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec322"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">There are many tools that allow you to connect to and control your MySQL databases. Webmin provides a wide range of tools to perform most of the common tasks, and these are described in recipes later in this chapter. An even more powerful web-based solution that is dedicated to MySQL is phpMyAdmin. It is discussed in the <span class="emphasis"><em>Installing phpMyAdmin</em></span> recipe of this chapter.</li><li class="listitem" style="list-style-type: disc">You can download the GUI clients mentioned in this recipe from the following sites:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>MySQL Workbench</strong></span>: <a class="ulink" href="http://dev.mysql.com/downloads/tools/workbench">http://dev.mysql.com/downloads/tools/workbench</a>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Sequel Pro (OS X only)</strong></span>: <a class="ulink" href="http://www.sequelpro.com/download">http://www.sequelpro.com/download</a>.</li></ul></div></li><li class="listitem" style="list-style-type: disc">More information about SSH tunnels is provided in the <span class="emphasis"><em>Connecting to Webmin securely over an SSH tunnel</em></span> recipe in <a class="link" href="ch03.html" title="Chapter 3. Securing Your System">Chapter 3</a>, <span class="emphasis"><em>Securing Your System</em></span>.</li></ul></div></div></div>
<div class="section" title="Creating a new database"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec99"/>Creating a new database</h1></div></div></div><p>Creating a new MySQL database<a id="id672" class="indexterm"/> through Webmin's interface is very quick and simple.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec323"/>How to do it...</h2></div></div></div><p>Follow these steps to create a new database:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create a new database</strong></span> link.</li><li class="listitem">Enter <span class="strong"><strong>Database name</strong></span>, for instance, <code class="literal">new_db</code>.</li><li class="listitem">Set <span class="strong"><strong>Character set</strong></span> to <span class="strong"><strong>utf8 (UTF-8 Unicode)</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Collation order</strong></span> to <span class="strong"><strong>utf8_unicode_ci (UTF-8 Unicode)</strong></span>.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note56"/>Note</h3><p>The character set specifies how letter characters are stored in your database and the <code class="literal">utf8</code> character set contains all the letters of most alphabets. The collation order, on the other hand, specifies what order the letters should be placed in when sorting alphabetically. The <code class="literal">utf8_unicode_ci</code> collation aims to be universal, but there may be regional variations that make a local collation such as <code class="literal">utf8_polish_ci</code> more appropriate for your situation.</p></div></div></li><li class="listitem">Set <span class="strong"><strong>Initial table</strong></span> to <span class="strong"><strong>None</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec324"/>How it works...</h2></div></div></div><p>Webmin takes the information that you provide and creates a new database by connecting to the MySQL server and executing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt; CREATE DATABASE `new_db` CHARACTER SET utf8 COLLATE utf8_unicode_ci;</strong></span>
</pre></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec325"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In order to make the database useful, you would want to grant users permissions to access it. Take a look at the <span class="emphasis"><em>Creating users and granting permissions to databases</em></span> recipe of this chapter for instructions.</li><li class="listitem" style="list-style-type: disc">If you have an initial database structure or contents, you can upload them to the server using a SQL commands file. Take a look at the <span class="emphasis"><em>Executing custom SQL commands</em></span> recipe of this chapter for more information.</li><li class="listitem" style="list-style-type: disc">More information about character sets and collations can be found in MySQL's manual at the following link: <a class="ulink" href="https://dev.mysql.com/doc/refman/5.7/en/charset-charsets.html">https://dev.mysql.com/doc/refman/5.7/en/charset-charsets.html</a></li></ul></div></div></div>
<div class="section" title="Creating users and granting permissions to databases"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec100"/>Creating users and granting permissions to databases</h1></div></div></div><p>Because of MySQL's <a id="id673" class="indexterm"/>client-server architecture, the server may accept <a id="id674" class="indexterm"/>connections from multiple clients. The connecting clients authenticate themselves to MySQL using a username and password. Information about user accounts and privileges is stored in an internal database called <code class="literal">mysql</code>.</p><p>MySQL accounts are separate from system accounts, which is usually a good thing because more often than not they represent applications running on your server rather than actual users. Each application connecting to your database server should have its own user account, with access privileges limited to only those databases which are needed for the application to run. It would be a bad idea to allow an application root-level access. This is because if the application is compromised, an attacker could steal or damage all databases on your system.</p><p>In addition to a username and password, MySQL accounts are also described by the host from which a user is allowed to connect. This means that <code class="literal">'user'@'localhost'</code> is a different account than <code class="literal">'user'@'remotehost'</code> and these accounts may have different access privileges.</p><p>Unfortunately, this means that multiple accounts have to be created if a user should have access from multiple hosts, or worse yet, if the location of the user changes as he roams around the network. In such cases, you may specify <code class="literal">%</code> as part of the host address as a wildcard. For example, <code class="literal">192.168.0.%</code> would specify the entire <code class="literal">192.168.0.1/24</code> subnet and <code class="literal">%.example.com</code> would specify all hosts within a domain.</p><p>If the location of your users cannot be narrowed down to a network or range of IP addresses, you should consider using SSH tunnels instead of opening access to your database server from the entire Internet. See the <span class="emphasis"><em>Accessing your MySQL server over an SSH tunnel</em></span> recipe in this chapter for more information.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec326"/>Getting ready</h2></div></div></div><p>You should <a id="id675" class="indexterm"/>remove MySQL's anonymous accounts unless you <a id="id676" class="indexterm"/>have a particular reason to use them. Anonymous accounts are created by default for testing purposes, but they may cause difficulties in debugging problems with user privileges.</p><p>Let's say, for example, that you have a user account with access from any location: <code class="literal">'user'@'%'</code>, but you also have an anonymous account with access from the local host <code class="literal">@'localhost'</code>. If you try to connect as <code class="literal">user</code> from the local host, MySQL will first check the privileges entry that specifies the incoming connection's host more precisely (<code class="literal">@'localhost'</code> is more specific then <code class="literal">@'%'</code>). This will cause <code class="literal">user</code> to be assigned privileges of the anonymous account rather than the expected <code class="literal">'user'@'%'</code> account. You can check what user you are connected as by issuing the following MySQL command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt; SELECT CURRENT_USER();</strong></span>
</pre></div><p>You will get the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>+----------------+</strong></span>
<span class="strong"><strong>| CURRENT_USER() |</strong></span>
<span class="strong"><strong>+----------------+</strong></span>
<span class="strong"><strong>| @localhost     |</strong></span>
<span class="strong"><strong>+----------------+</strong></span>
</pre></div><p>The output shows that we are being treated as an anonymous user <code class="literal">@'localhost'</code>. The solution to this situation is to add a second account for <code class="literal">user</code> as <code class="literal">'user'@'localhost'</code>. Then, when we log in again, we will see the following output of the same command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>+----------------+</strong></span>
<span class="strong"><strong>| CURRENT_USER() |</strong></span>
<span class="strong"><strong>+----------------+</strong></span>
<span class="strong"><strong>| user@localhost |</strong></span>
<span class="strong"><strong>+----------------+</strong></span>
</pre></div><p>If you don't need them for any specific purpose, it's safer and more convenient to remove anonymous accounts altogether.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec327"/>How to do it...</h2></div></div></div><p>In this recipe, we will create a user named <code class="literal">dbuser</code> with access from the local machine to the database <code class="literal">testdb</code>. The user will have to authenticate using a strong password. Prepare the username, database name, and password for your particular case.</p><div class="section" title="Creating a user account"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec111"/>Creating a user account</h3></div></div></div><p>In order to create a<a id="id677" class="indexterm"/> user account, perform the following <a id="id678" class="indexterm"/>steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>User Permissions</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create new user</strong></span> link.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to <code class="literal">dbuser</code>.</li><li class="listitem">Set <span class="strong"><strong>Password</strong></span> to a strong password.</li><li class="listitem">Set <span class="strong"><strong>Hosts</strong></span> to <code class="literal">localhost</code>.</li><li class="listitem">In the <span class="strong"><strong>Permissions</strong></span> list, do not select any permissions.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note57"/>Note</h3><p>We do not need to grant any global permission to the account, as the user will have access limited to a specific database.</p></div></div></li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="Granting privileges"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec112"/>Granting privileges</h3></div></div></div><p>In order to <a id="id679" class="indexterm"/>grant privileges, <a id="id680" class="indexterm"/>perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>Database Permissions</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create new database permissions</strong></span> link.</li><li class="listitem">Set <span class="strong"><strong>Databases</strong></span> to <span class="strong"><strong>Selected</strong></span> and choose <span class="strong"><strong>testdb</strong></span> from the list.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to <code class="literal">dbuser</code>.</li><li class="listitem">Set <span class="strong"><strong>Hosts</strong></span> to <code class="literal">localhost</code>.</li><li class="listitem">In the <span class="strong"><strong>Permissions</strong></span> list, select all permissions as shown in the following screenshot:<div class="mediaobject"><img src="graphics/5849_09_03.jpg" alt="Granting privileges"/></div></li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div><p>The created<a id="id681" class="indexterm"/> account and privileges will <a id="id682" class="indexterm"/>allow <code class="literal">dbuser</code> to connect to and have full control over the <code class="literal">testdb</code> database when connecting to the local MySQL server.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip89"/>Tip</h3><p>The MySQL server will use accounts associated with the <code class="literal">localhost</code> when a client connects from the local machine, regardless of whether the connection is made over a socket or TCP. However, if you create an account associated with <code class="literal">127.0.0.1</code>, it will be used when connecting over TCP, but not when connecting on a socket. When connecting over TCP using IPv6, a third option comes into play, namely the IPv6 address of the local machine <code class="literal">::1</code>. It's best to set up accounts for <code class="literal">localhost</code> to avoid this confusion.</p></div></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec328"/>How it works...</h2></div></div></div><p>Webmin creates accounts and grants privileges by manipulating the <code class="literal">mysql</code> database directly. In particular, it adds a row to the <code class="literal">user</code> and <code class="literal">db</code> tables and then executes the <code class="literal">FLUSH PRIVILEGES</code> command.</p><p>If you wanted to perform the same operations manually, you could connect to the MySQL server using its command-line client and issue the following commands.</p><p>First connect to the local database server as root:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysql -u root -p</strong></span>
</pre></div><p>Next issue the MySQL commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt; CREATE USER 'dbuser'@'localhost' IDENTIFIED BY 'strongpassword';</strong></span>
<span class="strong"><strong>mysql&gt; GRANT ALL PRIVILEGES ON testdb.* TO 'dbuser'@'localhost';</strong></span>
<span class="strong"><strong>mysql&gt; FLUSH PRIVILEGES;</strong></span>
</pre></div><p>The first command creates a user named <code class="literal">dbuser</code>, the second gives this user complete access to the <code class="literal">testdb</code> database. The final command forces your MySQL server to reload information about users and privileges so that the new user can connect.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec329"/>There's more...</h2></div></div></div><p>Webmin allows you to specify more granular access permissions—at the level of a database table or even a specific column within a database table. It also allows you to automatically create MySQL accounts for the new system users that are created via Webmin.</p><div class="section" title="Granting permissions to a specific database table"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec113"/>Granting permissions to a specific database table</h3></div></div></div><p>In order to grant permissions<a id="id683" class="indexterm"/> to a specific database table, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>Table Permissions</strong></span>.</li><li class="listitem">Select a database from the list and click the <span class="strong"><strong>Add new permissions in database</strong></span> button.</li><li class="listitem">Select a database <span class="strong"><strong>Table</strong></span> from the list.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to the name of a previously defined MySQL user.</li><li class="listitem">Set <span class="strong"><strong>Host</strong></span> to the name of the host associated with the user account.</li><li class="listitem">Select the permissions you wish to grant from the <span class="strong"><strong>Table permissions</strong></span> and <span class="strong"><strong>Field permissions</strong></span> lists as shown in the following screenshot:<div class="mediaobject"><img src="graphics/5849_08_18.jpg" alt="Granting permissions to a specific database table"/></div></li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="Granting permissions to a specific column in a database table"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec114"/>Granting permissions to a specific column in a database table</h3></div></div></div><p>To grant permissions to a <a id="id684" class="indexterm"/>specific column in a database table, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>Field Permissions</strong></span>.</li><li class="listitem">Select a database and table from the list and click the <span class="strong"><strong>Add new permissions in database and table</strong></span> button.</li><li class="listitem">Select a database table <span class="strong"><strong>Field</strong></span> from the list.</li><li class="listitem">Set <span class="strong"><strong>Username</strong></span> to the name of a previously defined MySQL user.</li><li class="listitem">Set <span class="strong"><strong>Host</strong></span> to the name of the host associated with the user account.</li><li class="listitem">Select the permissions you wish to grant from the <span class="strong"><strong>Permissions</strong></span> list.</li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="Automatically granting new system users access to MySQL"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec115"/>Automatically granting new system users access to MySQL</h3></div></div></div><p>To automatically <a id="id685" class="indexterm"/>grant all system users access to MySQL, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span> | <span class="strong"><strong>User Permissions</strong></span>.</li><li class="listitem">Select all three checkboxes in the <span class="strong"><strong>When to synchronize</strong></span> section.</li><li class="listitem">Select permissions in the <span class="strong"><strong>Permissions for new users</strong></span> list. For instance, if you want every user of your system to be a MySQL administrator, select all permissions. Use this with caution.</li><li class="listitem">Set <span class="strong"><strong>Create new users with hosts</strong></span> to <span class="strong"><strong>Specific host</strong></span> and enter <code class="literal">localhost</code>.<div class="mediaobject"><img src="graphics/5849_09_04.jpg" alt="Automatically granting new system users access to MySQL"/></div></li><li class="listitem">Click the <span class="strong"><strong>Save</strong></span> button.</li></ol></div><p>From now on, <a id="id686" class="indexterm"/>every new user account created through Webmin will automatically receive a corresponding MySQL account with the same password as the system password. Passwords will be updated if changed through Webmin, and the MySQL account will be deleted if the corresponding system account is also deleted through Webmin.</p></div></div></div>
<div class="section" title="Creating a backup of your database"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec101"/>Creating a backup of your database</h1></div></div></div><p>Webmin can help you make<a id="id687" class="indexterm"/> backups of your MySQL databases. With<a id="id688" class="indexterm"/> just a few clicks, you can make a backup of any database. Webmin can also help you set up cron jobs to create backups automatically on a regular schedule.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec330"/>Getting ready</h2></div></div></div><p>Before starting, create a directory to store local backup files. You can keep these files in <code class="literal">/backups</code> in the root directory <code class="literal">/root/backups</code>, or in any location that you find convenient.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip90"/>Tip</h3><p>Backup files created by Webmin will be readable by all users of your system. This may be a security risk, since database backups often contain sensitive data such as hashed user passwords. You should remove all permissions on the backups directory for users outside of root's group. You can do that by issuing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo chmod o-rwx /backups</strong></span>
</pre></div><p>If your file system supports access control lists, you can additionally set the default mask for newly created files in this directory in such a way that they are not readable by users outside of the group. You can set the default ACL for <code class="literal">/backups</code> by issuing the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ sudo setfacl -d -m other:- /backups</strong></span>
</pre></div></div></div><p>
Take a look at the <span class="emphasis"><em>Changing file ownership and permissions</em></span> recipe in <a class="link" href="ch06.html" title="Chapter 6. Managing Files on Your System">Chapter 6</a>, <span class="emphasis"><em>Managing Files on Your System
</em></span>, for more information.
</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec331"/>How to do it...</h2></div></div></div><p>Follow these steps to create a database backup:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the database you would like to back up.</li><li class="listitem">Click the <span class="strong"><strong>Backup Database</strong></span> button.</li><li class="listitem">Set <span class="strong"><strong>Backup to file</strong></span> to a path such as <code class="literal">/backups/database-name.sql.bz2</code>.</li><li class="listitem">Set <span class="strong"><strong>Tables to backup</strong></span> to <span class="strong"><strong>All tables</strong></span>.</li><li class="listitem">Open the <span class="strong"><strong>Other backup options</strong></span> section.</li><li class="listitem">Set <span class="strong"><strong>Add drop table statements to backup?</strong></span> to <span class="strong"><strong>Yes</strong></span>.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note58"/>Note</h3><p>This helps you import the created backup into an existing database. Tables with the same names will be deleted (dropped) before importing the ones stored in the backup.</p></div></div></li><li class="listitem">Set <span class="strong"><strong>Character set for backup</strong></span> to <span class="strong"><strong>UTF-8 Unicode</strong></span>.</li><li class="listitem">Choose <span class="strong"><strong>Compression format</strong></span> to <span class="strong"><strong>Bzip2</strong></span>.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note59"/>Note</h3><p>Bzip2 gives really good compression for text such as SQL command files.</p></div></div></li><li class="listitem">Click the <span class="strong"><strong>Backup Now</strong></span> button.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec332"/>How it works...</h2></div></div></div><p>Webmin <a id="id689" class="indexterm"/>executes the <code class="literal">mysqldump</code> command to <a id="id690" class="indexterm"/>output a series of SQL commands that would be needed to create the entire database. The database "dump" is then piped through the bzip2 compression algorithm and saved to an output file. If you wanted to do the same kind of backup in the terminal, you could run a command similar to the following (make sure you set the <code class="literal">mysqldump</code> options correctly):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysqldump --add-drop-table --routines database-name | bzip2 -c &gt; /backups/database-name.sql.bz2</strong></span>
</pre></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec333"/>There's more...</h2></div></div></div><p>Webmin is quite a capable tool for making backups. Here are a few other, easily accessible functions.</p><div class="section" title="Backing up all databases automatically"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec116"/>Backing up all databases automatically</h3></div></div></div><p>Webmin can help you make <a id="id691" class="indexterm"/>an automated backup of some or all databases hosted by your server. These backups will be executed on a regular schedule by cron. For more information about scheduling commands take a look at the <span class="emphasis"><em>Scheduling a command to run regularly with cron</em></span> recipe in <a class="link" href="ch04.html" title="Chapter 4. Controlling Your System">Chapter 4</a>, <span class="emphasis"><em>Controlling Your System</em></span>. In order to back up all databases automatically, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Backup Databases</strong></span> button.</li><li class="listitem">Set <span class="strong"><strong>Backup to directory</strong></span> to the location of your backup directory, for instance, <code class="literal">/backups</code>.</li><li class="listitem">Open the <span class="strong"><strong>Other backup options</strong></span> section.</li><li class="listitem">Set <span class="strong"><strong>Add drop table statements to backup?</strong></span> to <span class="strong"><strong>Yes</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Character set for backup</strong></span> to <span class="strong"><strong>UTF-8 Unicode</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Compression format</strong></span> to <span class="strong"><strong>Bzip2</strong></span>.</li><li class="listitem">Open the <span class="strong"><strong>Backup schedule</strong></span> section.</li><li class="listitem">Set <span class="strong"><strong>Send backup status email to</strong></span> to your e-mail address.</li><li class="listitem">Set <span class="strong"><strong>Scheduled backup enabled?</strong></span> to <span class="strong"><strong>Yes, at times chosen below</strong></span>, set <span class="strong"><strong>Simple schedule</strong></span> and select <span class="strong"><strong>Daily (at midnight)</strong></span>.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note60"/>Note</h3><p>Note that many things may be scheduled to start at midnight on your system, so you can choose another time if your system resources are limited. Choose a more complex schedule by marking the minutes, hours, and days of the month at which the job is to be performed.</p></div></div></li><li class="listitem">Click the<a id="id692" class="indexterm"/> <span class="strong"><strong>Save</strong></span> button.</li></ol></div></div><div class="section" title="Exporting a database table to CSV"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec117"/>Exporting a database table to CSV</h3></div></div></div><p>Webmin can export a single table of <a id="id693" class="indexterm"/>your database into a <span class="strong"><strong>comma-separated-values</strong></span> (<span class="strong"><strong>CSV</strong></span>) file <a id="id694" class="indexterm"/>that can be opened by spreadsheet programs, such as Excel, Calc, or Gnumeric. To export a database table to CSV, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon of the database, which contains the table.</li><li class="listitem">Click the icon of the table you would like to export.</li><li class="listitem">Click the <span class="strong"><strong>Export to CSV</strong></span> button.</li><li class="listitem">Set <span class="strong"><strong>File format</strong></span> to <span class="strong"><strong>CSV with quotes</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Include column names in CSV?</strong></span> to <span class="strong"><strong>Yes</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Export destination</strong></span> to <span class="strong"><strong>Display in browser</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Export Now</strong></span> button.</li></ol></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec334"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You can easily perform backups to a remote host by using a network file sharing protocol such as NFS or CIFS. You start by creating a network volume on the remote server, and then mount the volume on your server. You can then back up to directories on the remote system just as easily as if they were stored locally. Take a look at <a class="link" href="ch06.html" title="Chapter 6. Managing Files on Your System">Chapter 6</a>,<span class="emphasis"><em> Managing Files on Your System</em></span>, for instructions on the setting up of network file sharing using NFS or CIFS.</li><li class="listitem" style="list-style-type: disc">Another way to store spare copies of your databases remotely is to send your backup directory to a remote server using the SSH protocol. Take a look at the <span class="emphasis"><em>Backing up to a remote host</em></span> recipe in <a class="link" href="ch07.html" title="Chapter 7. Backing Up Your System">Chapter 7</a>, <span class="emphasis"><em>Backing Up Your System</em></span>, for more information.</li></ul></div></div></div>
<div class="section" title="Executing custom SQL commands"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec102"/>Executing custom SQL commands</h1></div></div></div><p>Webmin provides a simple <a id="id695" class="indexterm"/>interface to your MySQL database server that allows you to execute arbitrary SQL commands. This can be a useful feature when you want to quickly find something in a database or perform a bulk update of multiple rows of data.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec335"/>How to do it...</h2></div></div></div><p>Follow these steps to execute an SQL command on your database:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the database you would like to use, for instance, <code class="literal">mysql</code>.</li><li class="listitem">Click the <span class="strong"><strong>Execute SQL</strong></span> button.</li><li class="listitem">Enter an SQL command in the text area, for instance:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>SELECT host,user FROM user;</strong></span>
</pre></div><div class="mediaobject"><img src="graphics/5849_09_07.jpg" alt="How to do it..."/></div></li><li class="listitem">Click the <span class="strong"><strong>Execute</strong></span> button.</li></ol></div><p>You will be presented with a sortable display of data returned by the <code class="literal">SELECT</code> command.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec336"/>How it works...</h2></div></div></div><p>Webmin simply<a id="id696" class="indexterm"/> passes the SQL command to the database server. If the command returns an error, it will be displayed on screen. If the command returns rows of data, Webmin will convert them into an HTML page and display them on screen. Please note that Webmin is running as the root user, so caution should be used when executing commands.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec337"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Webmin can also help you to execute an entire SQL script saved in a file. See the <span class="emphasis"><em>Restoring database from the backup</em></span> recipe of this chapter for more information.</li><li class="listitem" style="list-style-type: disc">You can save commands you execute often in an easy-to-use control panel in Webmin. Take a look at the <span class="emphasis"><em>Creating a panel with the database commands that you execute often</em></span> recipe in <a class="link" href="ch04.html" title="Chapter 4. Controlling Your System">Chapter 4</a>, <span class="emphasis"><em>Controlling Your System</em></span>, for more information.</li><li class="listitem" style="list-style-type: disc">If you find that you need a more full-fledged, web-based MySQL management tool, consider installing phpMyAdmin. This is described in the <span class="emphasis"><em>Installing phpMyAdmin</em></span> recipe in this chapter.</li></ul></div></div></div>
<div class="section" title="Restoring database from the backup"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec103"/>Restoring database from the backup</h1></div></div></div><p>Databases may be stored<a id="id697" class="indexterm"/> as text files that contain SQL instructions which rebuild them. If you have a SQL backup file, you can use Webmin to restore it.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec338"/>Getting ready</h2></div></div></div><p>Large backups should be uploaded to the server before being executed. If your backup file is large, upload it to the server and note its location. Take a look at the <span class="emphasis"><em>Uploading files to the server</em></span> recipe in <a class="link" href="ch06.html" title="Chapter 6. Managing Files on Your System">Chapter 6</a>, <span class="emphasis"><em>Managing Files on Your System</em></span>, for more information.</p><p>We will restore the backup to an existing database. If you haven't created the database yet, follow instructions in the <span class="emphasis"><em>Creating a new database</em></span> recipe before starting.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec339"/>How to do it...</h2></div></div></div><p>Follow these steps to restore a<a id="id698" class="indexterm"/> database from backup or execute a SQL script saved in a file:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the database you would like to restore the backup to.</li><li class="listitem">Click the <span class="strong"><strong>Execute SQL</strong></span> button.</li><li class="listitem">Select the <span class="strong"><strong>Run SQL from file</strong></span> tab.</li><li class="listitem">If you have uploaded the file onto the server, select <span class="strong"><strong>From local file</strong></span> and enter the file's location in the text box. Otherwise, select <span class="strong"><strong>From uploaded file</strong></span> and choose a file from your disk.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip92"/>Tip</h3><p>Webmin can handle SQL files that are compressed using gzip or bzip2.</p></div></div></li><li class="listitem">Click the <span class="strong"><strong>Execute</strong></span> button.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec340"/>How it works...</h2></div></div></div><p>Webmin pipes the entire SQL instructions file into the MySQL server. The server executes every instruction stored in the file, rebuilding the database line by line.</p><p>If you wanted to perform the same task in the terminal, you could use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>$ mysql database-name &lt; backup-file.sql</strong></span>
</pre></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec341"/>There's more...</h2></div></div></div><p>Webmin can import a single table into your database from a CSV file that can be created by a spreadsheet program such as Excel, Calc, or Gnumeric.</p><p>Follow these steps to import a CSV file:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the database to which you would like to restore the backup.</li><li class="listitem">Click the <span class="strong"><strong>Execute SQL</strong></span> button.</li><li class="listitem">Select the <span class="strong"><strong>Import text file</strong></span> tab.</li><li class="listitem">If you have uploaded the file onto the server, select <span class="strong"><strong>From local file</strong></span> and enter the file's location in the text box. Otherwise, select <span class="strong"><strong>From uploaded file</strong></span> and choose a file from your disk.</li><li class="listitem">Select a table from the <span class="strong"><strong>Table to import data into</strong></span> dropdown.</li><li class="listitem">Set <span class="strong"><strong>Character set</strong></span> to <span class="strong"><strong>utf8 (UTF-8 Unicode)</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Execute</strong></span> button.</li></ol></div><p>You will be presented with an information screen that describes how many rows were successfully imported or what errors were encountered.</p></div></div>
<div class="section" title="Editing the structure of your database"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec104"/>Editing the structure of your database</h1></div></div></div><p>Webmin allows you to <a id="id699" class="indexterm"/>quickly modify the structure of tables in your MySQL database through an easy-to-use interface. In this recipe, we will demonstrate how to perform the following list of tasks:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Create a table in a database</li><li class="listitem" style="list-style-type: disc">Add a column to a database table</li><li class="listitem" style="list-style-type: disc">Edit a column</li><li class="listitem" style="list-style-type: disc">Create an index</li><li class="listitem" style="list-style-type: disc">Delete an index</li><li class="listitem" style="list-style-type: disc">Delete a column</li><li class="listitem" style="list-style-type: disc">Delete a table from the database</li></ul></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec342"/>Getting ready</h2></div></div></div><p>For demonstration purposes, we will be using a database called <code class="literal">testdb</code>. You can create a database with this name through Webmin by following the steps described in the <span class="emphasis"><em>Creating a new database</em></span> recipe of this chapter.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec343"/>How to do it...</h2></div></div></div><p>In the <code class="literal">testdb</code> database, we'll create a table called <code class="literal">people</code> and add a column called <code class="literal">name</code> to the table. We'll then change the width of the field, turn it into a unique index, and finally delete the index, field, and table from the database.</p><div class="section" title="Creating a table in a database"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec118"/>Creating a table in a database</h3></div></div></div><p>To create a <a id="id700" class="indexterm"/>table in a database, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the <span class="strong"><strong>Create a new table</strong></span> button.</li><li class="listitem">Specify <code class="literal">people</code> as <span class="strong"><strong>Table name</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Type of table</strong></span> to <span class="strong"><strong>myisam</strong></span>.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note61"/>Note</h3><p>The table type option specifies which storage engine is used by this table. This determines what features are available for your table, for instance <span class="strong"><strong>myisam</strong></span> allows for full-text search indexes, while <span class="strong"><strong>innodb</strong></span> supports transactions. You can find more information on storage engines in MySQL's manual:</p><p>
<a class="ulink" href="http://dev.mysql.com/doc/refman/5.6/en/storage-engines.html">http://dev.mysql.com/doc/refman/5.6/en/storage-engines.html</a>
</p></div></div></li><li class="listitem">Provide the <a id="id701" class="indexterm"/>definition of one field that will be the primary key for this table. Fill in the following field definitions:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Field name</strong></span>: <code class="literal">id</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Data type</strong></span>: <span class="strong"><strong>int</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Type width</strong></span>: <code class="literal">11</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Key</strong></span>: <span class="strong"><strong>Yes</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Auto increment</strong></span>: <span class="strong"><strong>Yes</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Allow nulls</strong></span>: <span class="strong"><strong>No</strong></span></li></ul></div><div class="mediaobject"><img src="graphics/5849_09_05.jpg" alt="Creating a table in a database"/></div></li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="Adding a field to a database table"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec119"/>Adding a field to a database table</h3></div></div></div><p>In order to add a field to the<a id="id702" class="indexterm"/> database table, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Select <code class="literal">varchar</code> from the types drop-down menu and click the <span class="strong"><strong>Add field of type</strong></span> button.</li><li class="listitem">Fill in the following field definitions:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Field name</strong></span>: <code class="literal">name</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Type width</strong></span>: <code class="literal">80</code></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Type options</strong></span>: <span class="strong"><strong>Case insensitive</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Allow nulls</strong></span>: <span class="strong"><strong>Yes</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Default value</strong></span>: <span class="strong"><strong>NULL</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Part of primary key?</strong></span>: <span class="strong"><strong>No</strong></span></li></ul></div></li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="Editing a field"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec120"/>Editing a field</h3></div></div></div><p>To edit a field, perform <a id="id703" class="indexterm"/>the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Click the link for field <code class="literal">name</code>.</li><li class="listitem">Set <span class="strong"><strong>Type width</strong></span> to <code class="literal">128</code>.</li><li class="listitem">Click the <span class="strong"><strong>Save</strong></span> button.</li></ol></div></div><div class="section" title="Creating an index"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec121"/>Creating an index</h3></div></div></div><p>To create an index, <a id="id704" class="indexterm"/>perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Click the <span class="strong"><strong>Create Index</strong></span> button.</li><li class="listitem">Set <span class="strong"><strong>Index name</strong></span> to <code class="literal">unique_name</code>.</li><li class="listitem">Select the field <code class="literal">name</code> in the <span class="strong"><strong>Fields in index</strong></span> list.</li><li class="listitem">Set <span class="strong"><strong>Index type</strong></span> to <span class="strong"><strong>Unique</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button.</li></ol></div></div><div class="section" title="Deleting an index"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec122"/>Deleting an index</h3></div></div></div><p>To delete an index, perform<a id="id705" class="indexterm"/> the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">unique_name</code> index.</li><li class="listitem">Click the <span class="strong"><strong>Delete</strong></span> button.</li></ol></div></div><div class="section" title="Deleting a field"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec123"/>Deleting a field</h3></div></div></div><p>In order to delete <a id="id706" class="indexterm"/>a field, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Click the link for <code class="literal">name</code> field.</li><li class="listitem">Click the <span class="strong"><strong>Delete</strong></span> button.</li></ol></div></div><div class="section" title="Deleting a table from the database"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec124"/>Deleting a table from the database</h3></div></div></div><p>To delete a table <a id="id707" class="indexterm"/>from the database, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Click the <span class="strong"><strong>Drop table</strong></span> button and confirm on the screen that follows it.</li></ol></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec344"/>How it works...</h2></div></div></div><p>Webmin prepares the syntax for the appropriate <code class="literal">CREATE</code>, <code class="literal">DROP</code>, and <code class="literal">ALTER TABLE</code> SQL commands to perform all of the earlier mentioned actions, and then executes those commands on your MySQL server as the <code class="literal">root</code> user.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec345"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If you find that you need a more full-fledged, web-based MySQL management tool, consider installing phpMyAdmin. This is described in the <span class="emphasis"><em>Installing phpMyAdmin</em></span> recipe</li></ul></div></div></div>
<div class="section" title="Editing records in a database"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec105"/>Editing records in a database</h1></div></div></div><p>Webmin allows you to<a id="id708" class="indexterm"/> quickly edit data in your MySQL database through a simple interface. In this recipe, we will demonstrate how to add, edit, and delete records in a database table.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec346"/>Getting ready</h2></div></div></div><p>In this recipe, we will use examples based on the <code class="literal">testdb</code> database created in the <span class="emphasis"><em>Creating a new database</em></span> and <span class="emphasis"><em>Editing the structure of your database</em></span> recipes of this chapter.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec347"/>How to do it...</h2></div></div></div><p>We'll add a record to the <code class="literal">people</code> table of the <code class="literal">testdb</code> database; we'll edit the same record, and finally delete it to show how to perform these actions in Webmin.</p><div class="section" title="Adding a row to database table"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec125"/>Adding a row to database table</h3></div></div></div><p>In order to add a row to <a id="id709" class="indexterm"/>the database table, perfom the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Click the <span class="strong"><strong>View Data</strong></span> button.</li><li class="listitem">Click the <span class="strong"><strong>Add row</strong></span> button.</li><li class="listitem">Fill in a name in the textbox.</li><li class="listitem">Click the <span class="strong"><strong>Save</strong></span> button.</li></ol></div></div><div class="section" title="Editing a row"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec126"/>Editing a row</h3></div></div></div><p>In order to edit a row, <a id="id710" class="indexterm"/>perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Click the <span class="strong"><strong>View Data</strong></span> button.</li><li class="listitem">Mark the checkbox next to the record you would like to edit.</li><li class="listitem">Click the <span class="strong"><strong>Edit selected rows</strong></span> button.</li><li class="listitem">Change the name value in the text box.</li><li class="listitem">Click the <span class="strong"><strong>Save</strong></span> button.</li></ol></div></div><div class="section" title="Deleting a row"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl3sec127"/>Deleting a row</h3></div></div></div><p>In order to delete a <a id="id711" class="indexterm"/>row, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the icon that represents the <code class="literal">testdb</code> database.</li><li class="listitem">Click the icon that represents the <code class="literal">people</code> table.</li><li class="listitem">Click the <span class="strong"><strong>View Data</strong></span> button.</li><li class="listitem">Mark the checkbox next to the record you would like to delete.</li><li class="listitem">Click the <span class="strong"><strong>Delete selected rows</strong></span> button.</li></ol></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec348"/>How it works...</h2></div></div></div><p>Webmin prepares the syntax for the appropriate <code class="literal">INSERT</code>, <code class="literal">UPDATE</code>, and <code class="literal">DELETE</code> SQL commands to perform the preceding actions and executes those commands on your MySQL server as the <code class="literal">root</code> user.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec349"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If you find that you need a more full-fledged, web-based MySQL management tool, consider installing phpMyAdmin. This is described in the <span class="emphasis"><em>Installing phpMyAdmin</em></span> recipe</li></ul></div></div></div>
<div class="section" title="Checking who is using your database server"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec106"/>Checking who is using your database server</h1></div></div></div><p>You may wish to check<a id="id712" class="indexterm"/> who is connected to your database server when debugging network connectivity, auditing security, or simply if you're curious. In Webmin, this information is just a few clicks away.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec350"/>How to do it...</h2></div></div></div><p>Follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Database Connections</strong></span> icon.</li></ol></div><p>You will see a list of active connections or a message that no clients other then Webmin are connected to the database at this time. Consider the following screenshot:</p><div class="mediaobject"><img src="graphics/5849_09_06.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec351"/>How it works...</h2></div></div></div><p>Webmin queries <a id="id713" class="indexterm"/>your MySQL server for information about active client connections. You could gain the same information by running the SQL command <code class="literal">SHOW PROCESSLIST</code> in a MySQL client:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mysql&gt; SHOW PROCESSLIST;</strong></span>
</pre></div><p>You will get the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>+------+------+-----------+------+---------+------------------+</strong></span>
<span class="strong"><strong>| Id   | User | Host      | db   | Command | Info             |</strong></span>
<span class="strong"><strong>+------+------+-----------+------+---------+------------------+</strong></span>
<span class="strong"><strong>| 5797 | root | localhost | NULL | Query   | SHOW PROCESSLIST |</strong></span>
<span class="strong"><strong>+------+------+-----------+------+---------+------------------+</strong></span>
<span class="strong"><strong>1 row in set (0.00 sec)</strong></span>
</pre></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec352"/>There's more...</h2></div></div></div><p>Webmin also makes it easy to close any unnecessary connections. The clients will have to re-establish their connections to continue using the database.</p><p>Follow these steps to close a connection:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>MySQL Database Server</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>Database Connections</strong></span> icon.</li><li class="listitem">Mark the checkbox next to the description of an active connection.</li><li class="listitem">Click the <span class="strong"><strong>Kill Selected Connections</strong></span> button.</li></ol></div></div></div>
<div class="section" title="Installing phpMyAdmin"><div class="titlepage"><div><div><h1 class="title"><a id="ch09lvl1sec107"/>Installing phpMyAdmin</h1></div></div></div><p>phpMyAdmin <a id="id714" class="indexterm"/>is a commonly used database administration tool for MySQL. It is a web-based application, like Webmin itself, but dedicated to all tasks related to the administration of a MySQL server. It's easy to use and can be a helpful tool for your database users and administrators.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note62"/>Note</h3><p>System packages are configured to run phpMyAdmin on Apache. The Apache web server and PHP are installed as package dependencies. If you're not already using Apache and PHP, this exposes a potential attack vector on your database server. Consider the security implications of installing phpMyAdmin and keep it up to date.</p></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec353"/>How to do it...</h2></div></div></div><p>Follow these steps to set up phpMyAdmin on your system:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Install the package named <code class="literal">phpmyadmin</code> (or <code class="literal">phpMyAdmin</code> depending on your system). Refer to the <span class="emphasis"><em>Installing software packages</em></span> recipe in <a class="link" href="ch01.html" title="Chapter 1. Setting Up Your System">Chapter 1</a>, <span class="emphasis"><em>Setting Up Your System</em></span>, for more information.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip93"/>Tip</h3><p>On some systems, you may need to add an additional repository to install the package. For instance, if you're running a Linux distribution from the RedHat family (RHEL, CentOS, Fedora, and so on), you should add the <span class="strong"><strong>Extra Packages for Enterprise Linux</strong></span> (<span class="strong"><strong>EPEL</strong></span>)<a id="id715" class="indexterm"/> repository. Information about the setting up of EPEL can be found in the <span class="emphasis"><em>Giving users access to your server via FTP</em></span> recipe in <a class="link" href="ch06.html" title="Chapter 6. Managing Files on Your System">Chapter 6</a>, <span class="emphasis"><em>Managing Files on Your System</em></span>.</p></div></div></li><li class="listitem">Since phpMyAdmin runs on top of Apache, you should make sure that this server is installed on your system and is accessible to a browser. Follow the <span class="emphasis"><em>Installing Apache on your system</em></span> recipe in <a class="link" href="ch08.html" title="Chapter 8. Running an Apache Web Server">Chapter 8</a>, <span class="emphasis"><em>Running an Apache Web Server</em></span>, to get Apache up and running.</li><li class="listitem">Navigate to the following URL, but substitute <code class="literal">webmin-host</code> for the IP or domain name of your server: <a class="ulink" href="http://webmin-host/phpmyadmin">http://webmin-host/phpmyadmin</a>.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip94"/>Tip</h3><p>On some systems, phpMyAdmin is configured to be accessible to connections that originate from the local host only. If you wish to change this behavior, go to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>Apache Webserver</strong></span> | <span class="strong"><strong>Default Server</strong></span>, select <span class="strong"><strong>Per-Directory Options</strong></span> for phpMyAdmin's directory, and change its <span class="strong"><strong>Access Control</strong></span> settings. More information is provided in the <span class="emphasis"><em>Setting options for directories, files, and locations</em></span> recipe in <a class="link" href="ch08.html" title="Chapter 8. Running an Apache Web Server">Chapter 8</a>, <span class="emphasis"><em>Running an Apache Web Server</em></span>.</p><p>Information about additional steps that may be necessary to set up phpMyAdmin in your system distribution can be found in package documentation files. Refer to the <span class="emphasis"><em>Reading the documentation of the installed software</em></span> recipe in <a class="link" href="ch01.html" title="Chapter 1. Setting Up Your System">Chapter 1</a>, <span class="emphasis"><em>Setting Up Your System</em></span>.</p></div></div></li><li class="listitem">You can now log in using the username and password of a MySQL account.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note63"/>Note</h3><p>phpMyAdmin will log you in as if you were connecting from the local machine, so privileges assigned to an account on <code class="literal">localhost</code> will be used.</p></div></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec354"/>How it works...</h2></div></div></div><p>phpMyAdmin is <a id="id716" class="indexterm"/>an application written in PHP. The main configuration file of<a id="id717" class="indexterm"/> phpMyAdmin is named <code class="literal">config.inc.php</code>, and it is usually installed inside the <code class="literal">/etc/</code> directory. Example locations for different distributions are listed in the following table. The code of the application itself is stored in the form of PHP script files in a directory named phpMyAdmin.</p><p>Because phpMyAdmin is served by Apache, the installation package includes an application-specific configuration file that will be loaded by the web server. This file informs Apache where phpMyAdmin is stored on the disk and which of its directories should be made available on the web.</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>File</p>
</th><th style="text-align: left" valign="bottom">
<p>OS / distro</p>
</th><th style="text-align: left" valign="bottom">
<p>Location</p>
</th></tr></thead><tbody><tr><td rowspan="3" style="text-align: left" valign="top">
<p>phpMyAdmin configuration</p>
</td><td style="text-align: left" valign="top">
<p>Debian</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/etc/phpmyadmin/config.inc.php</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>CentOS</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/etc/phpMyAdmin/config.inc.php</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>OpenSUSE</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/etc/phpMyAdmin/config.inc.php</code>
</p>
</td></tr><tr><td rowspan="3" style="text-align: left" valign="top">
<p>phpMyAdmin files</p>
</td><td style="text-align: left" valign="top">
<p>Debian</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/usr/share/phpmyadmin</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>CentOS</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/usr/share/phpMyAdmin</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>OpenSUSE</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/srv/www/htdocs/phpMyAdmin</code>
</p>
</td></tr><tr><td rowspan="3" style="text-align: left" valign="top">
<p>Apache configuration file for phpMyAdmin</p>
</td><td style="text-align: left" valign="top">
<p>Debian</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/etc/phpmyadmin/apache.conf</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>CentOS</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/etc/httpd/conf.d/phpMyAdmin.conf</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>OpenSUSE</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">/etc/apache2/conf.d/phpMyAdmin.conf</code>
</p>
</td></tr></tbody></table></div><p>Regardless of how package maintainers decided to prepare it, you can tweak the Apache configuration for phpMyAdmin by going to <span class="strong"><strong>Servers</strong></span> | <span class="strong"><strong>Apache Webserver</strong></span> | <span class="strong"><strong>Default Server</strong></span> and selecting <span class="strong"><strong>Per-Directory Options</strong></span> for the phpMyAdmin directory.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch09lvl2sec355"/>There's more...</h2></div></div></div><p>phpMyAdmin is a very capable tool and you can find detailed information about how it can be used in its documentation at: <a class="ulink" href="http://docs.phpmyadmin.net/en/latest/">http://docs.phpmyadmin.net/en/latest/</a>
</p></div></div></body></html>