- en: Chapter 7. Using the Web Interface
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章 使用网页界面
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下内容：
- en: Using the Tactical Overview
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用战术概览
- en: Viewing and interpreting availability reports
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看和解释可用性报告
- en: Viewing and interpreting trends
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看和解释趋势
- en: Viewing and interpreting notification history
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看和解释通知历史
- en: Adding comments on hosts or services in the web interface
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在网页界面中添加主机或服务的注释
- en: Viewing configuration in the web interface
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看网页界面中的配置
- en: Scheduling checks from the web interface
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从网页界面安排检查
- en: Acknowledging a problem via the web interface
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过网页界面确认问题
- en: Introduction
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 简介
- en: The Nagios Core web interface is an administrator's first port of call to see
    the current status of the network being monitored. By way of CGI and PHP scripts,
    it allows an overview of the general performance of all the hosts and services
    being monitored. It also provides information about their current states and how
    checks are performed. This allows considerably more detail than that which is
    normally contained in e-mailed notifications.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Nagios Core 的网页界面是管理员查看被监控网络当前状态的首选方式。通过 CGI 和 PHP 脚本，它可以提供所有被监控主机和服务的总体性能概况。它还提供有关其当前状态的信息以及如何执行检查。这比通常在电子邮件通知中包含的细节要多得多。
- en: '![Introduction](img/5566_07_01.jpg)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![简介](img/5566_07_01.jpg)'
- en: 'In most respects, the Nagios Core web interface (without any addons) is designed
    for the display of information rather than controlling or configuring the server,
    but there are some things that can be done from it to actually change the way
    Nagios Core is running. These include the following:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数方面，Nagios Core 的网页界面（没有任何插件）是为了显示信息而设计的，而不是用来控制或配置服务器，但有些操作可以通过它来实际改变 Nagios
    Core 的运行方式。这些操作包括以下内容：
- en: Disabling or enabling active and passive checks, event handlers, notifications,
    and flap detection, whether for all hosts and services or specific ones
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 禁用或启用主动检查和被动检查、事件处理程序、通知和波动检测，无论是针对所有主机和服务还是特定的主机和服务
- en: Sending custom notifications about a host or service that don't necessarily
    correspond to an actual state change
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发送关于主机或服务的自定义通知，这些通知不一定与实际状态变化相对应
- en: Rescheduling checks, commonly done to prioritize a check when there have been
    problems that the administrator thinks are now resolved and wishes to recheck
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重新安排检查，通常是在管理员认为问题已经解决并希望重新检查时，优先进行检查
- en: Acknowledging problems, to allow administrators to suppress further notifications
    from problems that they're working on fixing
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确认问题，以便管理员可以抑制关于他们正在修复的问题的进一步通知
- en: Scheduling downtime to suppress notifications for a certain time period; this
    was discussed in the *Scheduling downtime for a host or service* recipe in [Chapter
    3](ch03.html "Chapter 3. Working with Checks and States"), *Working with Checks
    and States*
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安排停机时间以抑制某一时间段内的通知；这在[第3章](ch03.html "第3章 与检查和状态的协作")《与检查和状态的协作》中“为主机或服务安排停机时间”的例子中已讨论过
- en: Leaving comments on hosts and services for the information of any other administrator
    who inspects them; many of the other actions in this list will do this implicitly
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为任何其他管理员留下关于主机和服务的注释，供他们检查；列表中的许多其他操作将隐式地执行此操作
- en: We won't offer a comprehensive survey of the web interface here, as much of
    its use is explained in other chapters, or otherwise reasonably self-explanatory.
    Instead, we'll explore a few runtime behavior changes that we can arrange through
    the web interface listed in the preceding section, and on using and interpreting
    the reports available under the **Reports** heading of the left navigation menu.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不会在这里提供网页界面的全面概述，因为它的许多功能在其他章节中已经解释，或者是相当直观的。相反，我们将探索通过网页界面进行的一些运行时行为变化，这些变化列在前一节中，并且在左侧导航菜单中的**报告**部分下使用和解释可用的报告。
- en: Another important and extremely useful part of the web interface, the **Network
    Status Map**, is discussed in several recipes in [Chapter 8](ch08.html "Chapter 8. Managing
    Network Layout"), *Managing Network Layout*. We won't discuss it here, as it's
    so useful that it merits a chapter in itself.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 网页界面的另一个重要且极其有用的部分，**网络状态图**，在[第8章](ch08.html "第8章 管理网络布局")《管理网络布局》中有几个例子进行了讨论。我们在这里不讨论它，因为它非常有用，值得单独成为一个章节。
- en: Using the Tactical Overview
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用战术概览
- en: In this recipe, we'll take a look at the **Tactical** **Overview** screen of
    the Nagios Core web interface. As its name implies, this screen provides a one-page
    summary of the current operating status of both the monitored hosts and services
    and the Nagios Core server itself.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将查看Nagios Core Web界面的**战术概览**屏幕。顾名思义，这个屏幕提供了对当前受监控主机和服务以及Nagios Core服务器本身的运行状态的单页概述。
- en: Getting started
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 入门
- en: You will need access to the Nagios Core web interface. In the QuickStart install,
    the `nagiosadmin` user will have all of the necessary privileges.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要访问Nagios Core的Web界面。在QuickStart安装中，`nagiosadmin`用户将具备所有必要的权限。
- en: How to do it...
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We can take a look at **Tactical Overview** as follows:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以按如下方式查看**战术概览**：
- en: Log in to the Nagios Core web interface.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到Nagios Core Web界面。
- en: Click the **Tactical Overview** item in the left menu:![How to do it...](img/5566_07_02.jpg)
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击左侧菜单中的**战术概览**项：![如何操作...](img/5566_07_02.jpg)
- en: 'You should see the **Tactical Monitoring Overview** screen appear in the right
    frame:'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该能看到**战术监控概览**屏幕出现在右侧框架中：
- en: '![How to do it...](img/5566_07_03.jpg)'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_03.jpg)'
- en: Try clicking on some of the items under **Hosts** and **Services**, for example
    the **Up** count under **Hosts**. Note that you're presented with a listing of
    all the hosts that comprise that section.
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 尝试点击**主机**和**服务**下的一些项，例如**主机**下的**正常**计数。请注意，你会看到该部分所包含的所有主机的列表。
- en: Return to **Tactical Overview**, and try clicking on some of the items under
    the **Monitoring Features** heading, for example the **Enabled** item under **Flap
    Detection**. Note that clicking on these brings you to a screen where you can
    quickly turn the relevant feature on or off (provided your user has the appropriate
    privileges).
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 返回**战术概览**，然后尝试点击**监控功能**标题下的一些项，例如**波动检测**下的**启用**项。请注意，点击这些项会带你到一个可以快速开启或关闭相关功能的屏幕（前提是你的用户具有相应的权限）。
- en: How it works...
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The Tactical Overview is a good first port of call whenever you become aware
    of problems with the monitored network, particularly if you've a reason to believe
    that the problems are on more than one host. It's also a good place to visit to
    adjust monitoring features. For example, if a very large segment of your network
    is going to be down and it's not practical to schedule downtime for all of the
    affected hosts, then you could simply suppress notifications completely for a
    while in order to fix the problem with no distractions.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 战术概览是你在发现受监控网络出现问题时的第一个重要入口，特别是当你有理由相信问题不仅仅出现在一个主机上时。它也是调整监控功能的好地方。例如，如果网络中有大规模的区域将会停机，而对所有受影响的主机安排停机时间不太实际，那么你可以简单地暂时完全抑制通知，以便在解决问题时不受干扰。
- en: Note that the screen includes an overall assessment of the monitoring performance
    of the server in the top-right corner; this can be a useful first place to look
    if you suspect that the monitoring server is struggling to keep up with its tasks,
    or want to get some idea of how many checks it's making.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，屏幕的右上角包含了对服务器监控性能的整体评估；如果你怀疑监控服务器无法跟上任务的处理，或者想了解它进行的检查数量，这里是一个非常有用的起始位置。
- en: Beneath that is a simple bar graph showing the general state of the network.
    It will change its color depending on the severity of the problems; in the preceding
    screenshot, there are serious problems with some of the hosts and services on
    this network, and as a result the bar is short and red.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在其下方是一个简单的条形图，显示网络的总体状态。它会根据问题的严重程度变化颜色；在之前的截图中，网络中部分主机和服务出现了严重问题，因此该条形图较短且为红色。
- en: There's more...
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多内容...
- en: 'If you find the Tactical Overview useful, it may be a good idea to make it
    the home page for the web interface, rather than the default page which mostly
    just shows the Nagios Core branding, version, and some links. We can arrange this
    by changing the value of `$corewindow` in `/usr/local/nagios/share/index.php`
    from `main.php` to `cgi-bin/tac.cgi`:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你觉得**战术概览**很有用，可能可以考虑将其设置为Web界面的首页，而不是默认的页面，后者主要展示Nagios Core的品牌、版本和一些链接。我们可以通过修改`/usr/local/nagios/share/index.php`文件中`$corewindow`的值，将其从`main.php`改为`cgi-bin/tac.cgi`来实现这一点：
- en: '[PRE0]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: With this done, when we visit the `/nagios/` URL on the monitoring host, the
    **Tactical Overview** should come up immediately. This can be done with any of
    the pages in the menu. The **Services** item is another good choice for an alternative
    homepage.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此操作后，当我们访问监控主机上的`/nagios/` URL时，**战术概览**应该会立即显示。可以通过菜单中的任何页面来完成此操作。**服务**项也是一个很好的选择，可以作为备用主页。
- en: See also
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: The *Viewing configuration in the web interface* recipe in this chapter
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的*Web界面中的查看配置*教程
- en: Viewing and interpreting availability reports
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看和解释可用性报告
- en: In this recipe, we'll learn how to use the **Availability Report** to build
    a table showing uptime statistics for a host, hostgroup, service, or servicegroup.
    This is useful as a quick metric of overall availability, perhaps to meet the
    terms of a service-level agreement.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将学习如何使用**可用性报告**来构建一个表格，显示主机、主机组、服务或服务组的正常运行时间统计信息。这对于快速评估整体可用性非常有用，可能用于满足服务级别协议的条款。
- en: Getting started
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 入门
- en: You will need access to the Nagios Core web interface, and permission to run
    commands from the CGIs. The sample configuration installed by following the Quick
    Start Guide grants all the necessary privileges to the `nagiosadmin` user when
    authenticated via `HTTP`.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要访问 Nagios Core Web 界面，并有权限从 CGI 执行命令。通过遵循快速入门指南安装的示例配置，在通过 `HTTP` 身份验证时，`nagiosadmin`
    用户将获得所有必要的权限。
- en: 'If you find that you don''t have this privilege, then check the `authorized_for_all_services`
    and `authorized_for_all_hosts` directives in `/usr/local/nagios/etc/cgi.cfg`,
    and include your username in both; for example, for the user `tom`, the directives
    might look similar to the following:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您发现自己没有此权限，请检查 `/usr/local/nagios/etc/cgi.cfg` 中的 `authorized_for_all_services`
    和 `authorized_for_all_hosts` 指令，并将您的用户名包含在其中；例如，对于用户`tom`，指令可能类似于以下内容：
- en: '[PRE1]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Alternatively, you should also be able to see a host or service's information
    if you are authenticating with the same username as the nominated contact for
    the host or service you want to check. This is explained in the *Using authenticated
    contacts* recipe in [Chapter 10](ch10.html "Chapter 10. Security and Performance"),
    *Security and Performance*.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，如果您使用与您想要检查的主机或服务的指定联系人相同的用户名进行身份验证，您也应该能够看到该主机或服务的信息。有关详细信息，请参见[第10章](ch10.html
    "第10章 安全性和性能")中的*使用经过身份验证的联系人*教程，*安全性和性能*。
- en: In this example, we'll view a month's history for a `PING` service on `troy.naginet`,
    a Linux server.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们将查看`troy.naginet`上的`PING`服务的一个月历史记录，这是一个Linux服务器。
- en: How to do it...
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We can arrange an availability report for the last month for our `troy.naginet`
    server as follows:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以为我们的`troy.naginet`服务器安排上个月的可用性报告，具体如下：
- en: Log in to the Nagios Core web interface.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到Nagios Core Web界面。
- en: Click on the **Availability** link in the left menu, beneath **Reports**:![How
    to do it...](img/5566_07_04.jpg)
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击左侧菜单中的**可用性**链接，位于**报告**下：[如何操作...](img/5566_07_04.jpg)
- en: Select the type of report, either **Host(s)**, **Hostgroup(s)**, **Service(s)**,
    or **Servicegroup(s)**:![How to do it...](img/5566_07_05.jpg)
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择报告类型，可以是**主机(s)**、**主机组(s)**、**服务(s)** 或 **服务组(s)**：[如何操作...](img/5566_07_05.jpg)
- en: Select a specific host or service on which to report, or optionally choose to
    run it for all the hosts, hostgroups, services, or servicegroups:![How to do it...](img/5566_07_06.jpg)
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择一个特定的主机或服务进行报告，或者选择为所有主机、主机组、服务或服务组运行报告：[如何操作...](img/5566_07_06.jpg)
- en: Define some options for the report. The defaults are sensible, so we'll use
    them for now; we'll go over the effect of each of the other fields in the next
    section. Click on **Create Availability Report!** when done:![How to do it...](img/5566_07_07.jpg)
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为报告定义一些选项。默认设置是合理的，所以我们现在使用它们；我们将在下一节中讨论其他字段的影响。完成后点击**创建可用性报告！**：[如何操作...](img/5566_07_07.jpg)
- en: 'You should be presented with a table showing the percentage of time the host
    or service has spent in each state. A healthy service might look similar to the
    following screenshot, with a few blips or none at all:'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您应该看到一个表格，显示主机或服务在每个状态中所花费的时间百分比。一个健康的服务可能类似于以下截图，只有少数几次波动，甚至没有：
- en: '![How to do it...](img/5566_07_08.jpg)'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_08.jpg)'
- en: 'A more problematic service might have large percentages of time in a `WARNING`
    or `CRITICAL` state:'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 一个问题较多的服务可能会有大量时间处于`WARNING`或`CRITICAL`状态：
- en: '![How to do it...](img/5566_07_09.jpg)'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_09.jpg)'
- en: Above the table appears a quick visual summary of the time spent in each state,
    which will link to **Trends Report** with the same criteria if clicked. Additionally,
    below the table are any log entries for the service or host changing state.
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 表格上方显示了每个状态下所花费时间的快速可视化总结，点击后将链接到具有相同标准的**趋势报告**。此外，表格下方显示了服务或主机状态变化的任何日志条目。
- en: How it works...
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'Nagios Core assembles state changes from its log files for the specified time
    period, and constructs the table of state changes by percentage. The availability
    report, therefore, only works for times covered by your archived log files. The
    third step of building the report involves a lot of possible options:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: Nagios Core从其日志文件中汇总指定时间段内的状态变化，并按百分比构建状态变化表格。因此，可用性报告仅适用于归档日志文件覆盖的时间段。构建报告的第三步涉及许多可能的选项：
- en: '**Report Period**: This dropdown allows choosing a fixed period for convenience,
    relative to the current date; alternatively, a custom time period may be used
    by selecting the final **CUSTOM TIME PERIOD** option and selecting dates in the
    two fields that follow:'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**报告时间段**：此下拉菜单允许选择一个相对于当前日期的固定时间段；或者，可以选择最后的**自定义时间段**选项，选择接下来两个字段中的日期：'
- en: '**Start Date (Inclusive)**: This field specifies the date on which the report
    should start, if the custom time period option has been set.'
  id: totrans-67
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**开始日期（包含）**：此字段指定报告应开始的日期，如果已设置自定义时间段选项。'
- en: '**End Date (Inclusive)**: This field specifies the date on which the report
    should end, if the custom time period option has been set.'
  id: totrans-68
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**结束日期（包含）**：此字段指定报告应结束的日期，如果已设置自定义时间段选项。'
- en: '**Report Time Period**: This is the time period for which the availability
    should be assessed. The default is **None**, meaning that the service or host''s
    state at any time will be used in the calculations. You could, for example, set
    this to `workhours` to see the percentage of uptime during a time that the server
    is expected to be busy.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**报告时间段**：这是评估可用性的时间段。默认值为**无**，这意味着将在任何时间点使用服务或主机的状态进行计算。例如，您可以将其设置为`workhours`，以查看服务器预期繁忙期间的正常运行时间百分比。'
- en: '**Assume State Retention**: If Nagios Core was restarted one or more times
    during the reporting period, checking this option would make the report assume
    that the state before any restart was retained by Nagios Core until it started
    again; this is enabled with the `retain_state_information` directive in `nagios.cfg`.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假定状态保持**：如果在报告期间Nagios Core被重启过一次或多次，选中此选项将使报告假设在任何重启之前的状态被Nagios Core保留，直到它重新启动；此选项通过`nagios.cfg`中的`retain_state_information`指令启用。'
- en: '**Assume Initial States**: If Nagios Core can''t figure out the initial state
    of the service at the time the report begins until the first check, it will assume
    it based on the value of the **First Assumed Host State** or **First Assumed Service
    State** fields.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假定初始状态**：如果Nagios Core无法确定报告开始时服务的初始状态，直到第一次检查时，它将基于**首次假定主机状态**或**首次假定服务状态**字段的值来假定状态。'
- en: '**Assume States During Program Downtime**: If Nagios Core finds that it was
    down for a period in its log files, it will assume the final state it read from
    the host or service before it went down.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假定程序停机期间的状态**：如果Nagios Core发现其日志文件中记录了停机时间，它将假定在停机前从主机或服务读取的最终状态。'
- en: '**Include Soft States**: Nagios Core will graph `SOFT` states, meaning that
    it will include state changes that occur, but that return to their previous state,
    before `max_check_attempts` is exhausted. Otherwise, it will only graph states
    that have endured right through the retry checks, or `HARD` states.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**包含软状态**：Nagios Core将绘制`SOFT`状态，这意味着它将包括发生的状态变化，但会在`max_check_attempts`未耗尽之前恢复到其先前的状态。否则，它将只绘制通过重试检查的状态，或`HARD`状态。'
- en: '**First Assumed Host State** or **First Assumed Service State**: This is the
    value Nagios Core should assume for the host or service state, if it can''t determine
    it from the log files.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**首次假定主机状态**或**首次假定服务状态**：如果Nagios Core无法从日志文件中确定主机或服务的状态，则应假定该状态的值。'
- en: '**Backtracked Archives**: This specifies the number of archived log files back
    the Nagios Core process should check to try and find initial states for the host
    or service.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**回溯档案**：此字段指定Nagios Core进程应检查的已归档日志文件的数量，以尝试查找主机或服务的初始状态。'
- en: There's more...
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: You can choose to run the report for a hostgroup or servicegroup as well, which
    will yield an indexed table showing both the per-host or per-service percentage
    state time, and also the average uptime for all the hosts or services in the group.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以选择为主机组或服务组运行报告，这将生成一个索引表，显示每个主机或每个服务的状态时间百分比，以及该组中所有主机或服务的平均正常运行时间。
- en: See also
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Viewing and interpreting trends* and *Viewing and interpreting notification
    history* recipes in this chapter
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的*查看和解释趋势*以及*查看和解释通知历史*教程
- en: The *Using authenticated contacts* recipe in [Chapter 10](ch10.html "Chapter 10. Security
    and Performance"), *Security and Performance*
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的*使用认证联系人*教程见[第10章](ch10.html "第10章. 安全与性能")，*安全与性能*
- en: Viewing and interpreting trends
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看和解释趋势
- en: In this recipe, we'll learn how to use the **Host** and **Service State Trends**
    reporting tool on a host or service to show a graph of states over some fixed
    period of time. This can be useful to determine not only overall availability,
    perhaps to meet the terms of a service-level agreement, but also to ascertain
    whether there are certain intervals or consistent times that the host enters a
    non-`OK` state. It's a good way to look for patterns in the downtime of your hosts.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个教程中，我们将学习如何使用**主机**和**服务状态趋势**报告工具，通过主机或服务显示在一段固定时间内的状态图表。这可以帮助我们不仅确定整体的可用性，或许是为了满足服务级别协议的条款，还能了解是否有特定的时间段或间隔，主机会进入非`OK`状态。这是查看主机停机模式的一个好方法。
- en: Getting started
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开始
- en: You will need access to the Nagios Core web interface, and permission to run
    commands from the CGIs. The sample configuration installed by following the Quick
    Start Guide grants the `nagiosadmin` user all the necessary privileges when authenticated
    via `HTTP`.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要访问Nagios Core Web界面，并且有权限从CGI运行命令。通过快速入门指南安装的示例配置会在通过`HTTP`身份验证时，授予`nagiosadmin`用户所有必要的权限。
- en: 'If you find that you don''t have this privilege, then check the `authorized_for_all_services`
    and `authorized_for_all_hosts` directives in `/usr/local/nagios/etc/cgi.cfg`,
    and include your username in both; for the user `tom`, the directives might look
    similar to the following:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现自己没有这个权限，检查`authorized_for_all_services`和`authorized_for_all_hosts`指令在`/usr/local/nagios/etc/cgi.cfg`中的配置，并在其中添加你的用户名；例如，对于用户`tom`，指令可能如下所示：
- en: '[PRE2]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Alternatively, you should also be able to see a host or service's information
    if you are authenticating with the same username as a nominated contact for the
    host or service you want to check.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，如果你使用的用户名与主机或服务的指定联系人相同，你也应该能够查看该主机或服务的信息。
- en: In this example, we'll view a month's history for the HTTP service on `athens.naginet`,
    a web server for which we've been running checks.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将查看`athens.naginet`（一个我们正在运行检查的Web服务器）上HTTP服务的一个月历史。
- en: How to do it...
  id: totrans-89
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We can arrange a **Service State Trends** report for the last month for our
    `athens.naginet` server as follows:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以为我们的`athens.naginet`服务器安排一个过去一个月的**服务状态趋势**报告，如下所示：
- en: Log in to the Nagios Core web interface.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到Nagios Core Web界面。
- en: Click on the **Trends** link in the left menu, beneath **Reports**:![How to
    do it...](img/5566_07_10.jpg)
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击左侧菜单中的**趋势**链接，位于**报告**下方：![How to do it...](img/5566_07_10.jpg)
- en: Select the type of report, either **Host** or **Service**:![How to do it...](img/5566_07_11.jpg)
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择报告类型，**主机**或**服务**：![How to do it...](img/5566_07_11.jpg)
- en: Select a specific host or service on which you would like to report:![How to
    do it...](img/5566_07_12.jpg)
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你希望报告的特定主机或服务：![How to do it...](img/5566_07_12.jpg)
- en: Define some options for the report. The defaults are sensible, so we'll use
    them for now; we'll go over the effect of each of the other fields in the next
    section. Click on **Create Report** when done:![How to do it...](img/5566_07_13.jpg)
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义报告的一些选项。默认设置是合理的，我们暂时使用这些设置；我们将在下一节中详细说明其他字段的作用。完成后点击**创建报告**：![How to do
    it...](img/5566_07_13.jpg)
- en: You should be presented with a graph showing the state of the host or service
    over time, along with markings of time for when the state changed, and a percentage
    breakdown of the relative states on the right.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该能看到一张展示主机或服务随时间变化的状态图表，并标明状态变化的时间，以及右侧的状态百分比分布。
- en: 'A healthy service might look similar to the following screenshot, with a few
    blips or none at all:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 一个健康的服务可能看起来像下面的截图，只有一些小的波动，或者根本没有：
- en: '![How to do it...](img/5566_07_14.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![How to do it...](img/5566_07_14.jpg)'
- en: 'A more problematic service might have long periods of time in a `WARNING` or
    `CRITICAL` state:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 更具问题性的服务可能会长时间处于`警告`或`严重`状态：
- en: '![How to do it...](img/5566_07_15.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_15.jpg)'
- en: You can click on sections of the graph to "zoom in” on it, provided that you
    did not select the **Suppress image map** option on the **Select Report Options**
    page.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以点击图表的某些部分以进行“缩放”，前提是你没有在**选择报告选项**页面选择**禁止图像映射**选项。
- en: How it works...
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'Nagios Core assembles state changes from its log files for the specified time
    period and constructs the graph of state changes by color, delineating the dates
    on the horizontal axis and at regular intervals. The trends graph, therefore,
    only works for times covered by your archived log files. The third step of building
    the report involves a lot of possible options:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: Nagios Core 从指定时间段的日志文件中汇总状态变化，并通过颜色构建状态变化图，横轴标出日期并按固定间隔划分。因此，趋势图仅适用于存档日志文件所涵盖的时间段。构建报告的第三步涉及许多可能的选项：
- en: '**Report period**: This dropdown allows choosing a fixed period for convenience,
    relative to the current date; alternatively, a custom time period may be used
    by selecting the final **CUSTOM TIME PERIOD** option and selecting dates in the
    two fields that follow:'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**报告周期**：此下拉菜单允许选择一个固定的周期，方便地与当前日期进行比较；或者，可以通过选择**自定义时间周期**选项并在接下来的两个字段中选择日期来使用自定义时间周期：'
- en: '**Start Date (Inclusive)**: This field specifies the date on which the report
    should start, if the custom time period option has been set.'
  id: totrans-105
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**开始日期（包含）**：此字段指定如果设置了自定义时间周期选项，报告应该开始的日期。'
- en: '**End Date (Inclusive)**: This field specifies the date on which the report
    should end, if the custom time period option has been set.'
  id: totrans-106
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**结束日期（包含）**：此字段指定如果设置了自定义时间周期选项，报告应该结束的日期。'
- en: '**Assume State Retention**: If Nagios Core was restarted one or more times
    during the reporting period, checking this option will make the report assume
    that the state before any restart was retained by Nagios Core until it started
    again; this is enabled with the `retain_state_information` directive in `nagios.cfg`.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假设状态保留**：如果 Nagios Core 在报告周期内重启过一次或多次，勾选此选项将使报告假定在任何重启之前的状态被 Nagios Core
    保留，直到它重新启动；此选项通过在 `nagios.cfg` 中启用 `retain_state_information` 指令来启用。'
- en: '**Assume Initial States**: If Nagios Core can''t figure out the initial state
    of the service at the time the report begins until the first check, it will assume
    it based on the value of the **First Assumed Host State** or **First Assumed Service
    State** fields.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假设初始状态**：如果 Nagios Core 无法在报告开始到第一次检查时确定服务的初始状态，它将根据**首次假定主机状态**或**首次假定服务状态**字段的值进行假设。'
- en: '**Assume States During Program Downtime**: If Nagios Core finds that it was
    down for a period in its log files, it will assume the final state it read from
    the host or service while it was down.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**假设程序停机期间的状态**：如果 Nagios Core 在其日志文件中发现它曾在一段时间内停机，它将假定在停机期间从主机或服务读取的最终状态。'
- en: '**Include Soft States**: Nagios Core will graph `SOFT` states, meaning that
    it will include state changes that occur, but that return to their previous states,
    before `max_check_attempts` is exhausted. Otherwise, it will only graph states
    that have endured right through the retry checks, or `HARD` states.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**包括软状态**：Nagios Core 将绘制`软`状态，意味着它会包括发生的状态变化，但这些变化会在`max_check_attempts`未耗尽之前恢复到先前的状态。否则，它只会绘制那些通过重试检查持续存在的状态，或称为`硬`状态。'
- en: '**First Assumed Host State** or **First Assumed Service State**: This is the
    value Nagios Core should assume for the host or service state, if it can''t determine
    it from the log files.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**首次假定主机状态**或**首次假定服务状态**：这是 Nagios Core 在无法从日志文件中确定主机或服务状态时应假定的值。'
- en: '**Backtracked Archives**: This specifies the number of archived log files back
    the Nagios Core process should check to try and find initial states for the host
    or service.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**回溯存档**：此项指定 Nagios Core 进程应回溯多少个存档日志文件，以尝试为主机或服务查找初始状态。'
- en: '**Suppress image map**: This prevents the graph from being clickable to zoom
    in on a particular region of it, perhaps for reasons of browser compatibility.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**禁止图像映射**：这会防止图表被点击以放大特定区域，可能是出于浏览器兼容性原因。'
- en: '**Suppress popups**: This prevents the graph from showing popups when hovering
    over sections of it, perhaps for reasons of browser compatibility.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**禁止弹出窗口**：这会防止图表在悬停时显示弹出窗口，可能是出于浏览器兼容性原因。'
- en: There's more...
  id: totrans-115
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Note that it's important to ensure that checks have actually been running for
    the entire time for which you're running the report, as otherwise the **State
    Breakdowns** section will have distorted statistics. There is not much point running
    a yearly report for a host that has only existed for six months! In general, the
    more frequent and consistent your checks, the more accurate the trends graph will
    be.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，确保在运行报告的整个期间，检查实际上是持续运行的非常重要，否则**状态细分**部分的统计数据会被扭曲。对于仅存在六个月的主机，运行一年的报告是没有意义的！通常，检查越频繁和一致，趋势图的准确性就越高。
- en: See also
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: The *Viewing and interpreting availability reports* *and Viewing and interpreting
    notification history* recipes in this chapter
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的*查看和解释可用性报告* *和查看和解释通知历史* 配方
- en: Viewing and interpreting notification history
  id: totrans-119
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查看和解释通知历史
- en: 'In this recipe, we''ll see how to get both complete listings and convenient
    summaries of the alerts and notifications being generated by Nagios Core in response
    to hosts and services changing state. These options are all available under the
    **Reports** section of the sidebar:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个配方中，我们将看到如何获取由 Nagios Core 对主机和服务状态变化生成的警报和通知的完整列表和方便的摘要。这些选项都可以在侧边栏的**报告**部分下找到：
- en: '![Viewing and interpreting notification history](img/5566_07_16.jpg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![查看和解释通知历史](img/5566_07_16.jpg)'
- en: It's important to distinguish between alerts and notifications in this section.
    An **alert** is generated in response to an event such as a host or service changing
    state. A **notification**, in turn, may or may not be generated as a response
    to that alert, and be sent to the appropriate contacts. `SOFT` state changes constitute
    alerts; only `HARD` state changes generally make notifications.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中区分警报和通知非常重要。**警报**是响应事件（如主机或服务状态变化）生成的。**通知**则可能会或不会作为对该警报的响应生成，并发送给相关联系人。`SOFT`
    状态变化构成警报；通常只有 `HARD` 状态变化才会生成通知。
- en: It's likely that a production monitoring server will not be sending notifications
    for every alert, particularly if you're making good use of the `max_check_attempts`,
    scheduled downtime, and problem acknowledgement features. You should make sure
    you're checking the correct section.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在生产监控服务器中，可能不会为每个警报发送通知，特别是如果你很好地使用了 `max_check_attempts`、计划停机和问题确认功能。你应该确保正在检查正确的部分。
- en: Getting started
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 入门
- en: You will need access to the Nagios Core web interface and permission to run
    commands from the CGIs. The sample configuration installed by following the Quick
    Start Guide grants all the necessary privileges to the `nagiosadmin` user when
    authenticated via `HTTP`.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要访问 Nagios Core 的 web 界面并且拥有从 CGI 执行命令的权限。通过快速入门指南安装的示例配置会在通过 `HTTP` 身份验证时为
    `nagiosadmin` 用户授予所有必要的权限。
- en: How to do it...
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作……
- en: 'We can get an overview of the notifications, alerts, and other events being
    generated on the Nagios Core server as follows:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过以下方式概览在 Nagios Core 服务器上生成的通知、警报和其他事件：
- en: Start with the **Notifications** report. The resulting screen should show you
    the day's notifications as read from the current log file.![How to do it...](img/5566_07_17.jpg)
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**通知**报告开始。结果页面应该显示当前日志文件中读取的当天通知。![如何操作……](img/5566_07_17.jpg)
- en: 'Note that if you''re using the **log rotation** feature of Nagios Core, configured
    with the `log_rotation_method` directive, then you can use the arrows above the
    table to navigate to the previous period''s monitoring (generally 24 hours worth).
    Additionally, note that the information includes the following:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请注意，如果你使用的是 Nagios Core 的**日志轮换**功能，并且已通过 `log_rotation_method` 指令进行配置，那么你可以使用表格上方的箭头导航到前一周期的监控（通常为
    24 小时）。此外，请注意，信息包含以下内容：
- en: Links to the hosts and services that generate them
  id: totrans-130
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生成通知的主机和服务链接
- en: The contacts to which they were sent
  id: totrans-131
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 这些通知发送到的联系人
- en: The notification commands that were run
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行的通知命令
- en: The output of the commands that prompted the alert and notification
  id: totrans-133
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 触发警报和通知的命令输出
- en: 'Also note that you''re able to filter for any particular kind of notification,
    and change the sorting order, using the form in the top-right corner:'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 另外，请注意，你可以使用右上角的表单过滤任何特定类型的通知，并更改排序顺序：
- en: '![How to do it...](img/5566_07_18.jpg)'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作……](img/5566_07_18.jpg)'
- en: Next, move to the **Alerts** or **Alerts | History report**. Rather than a tabular
    format, this shows you all of the alerts generated by hosts and services as a
    list, showing red exclamation icons for `CRITICAL` or `DOWN` states, green icons
    for `OK` states, and others. The list is broken into intervals of one hour:![How
    to do it...](img/5566_07_19.jpg)
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，转到**警报**或**警报 | 历史报告**。与表格格式不同，这会以列表形式展示由主机和服务生成的所有警报，并使用红色感叹号图标表示`CRITICAL`或`DOWN`状态，绿色图标表示`OK`状态，其他状态则显示不同的图标。该列表按一小时的间隔划分：![如何操作...](img/5566_07_19.jpg)
- en: Note that these alerts also include the server being started or shut down. Also
    note that you're again able to filter for specific alert types with the form in
    the top-right corner.
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，这些警报还包括服务器启动或关闭的情况。还要注意，您可以再次使用右上角表单筛选特定的警报类型。
- en: The other two items in the **Alerts** menu allow generating complex reports
    with many criteria. The first, **Summary**, presents its results in tabular format
    according to the criteria entered in a form. For now, try clicking on **Create
    Summary Report** at the bottom of the first page, with all of the fields on their
    defaults, to get a feel for the results it generates:![How to do it...](img/5566_07_20.jpg)
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**警报**菜单中的另外两个选项允许生成包含多个条件的复杂报告。第一个，**摘要**，根据表单中输入的条件以表格格式呈现结果。现在，尝试点击第一页底部的**创建摘要报告**，在所有字段使用默认值的情况下，感受一下它生成的结果：![如何操作...](img/5566_07_20.jpg)'
- en: 'The **Histogram** report generates something similar, showing a breakdown of
    the alerts generated for nominated hosts or services over a fixed period of time:'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**直方图**报告生成类似的内容，展示在固定时间段内为指定主机或服务生成的警报的细分情况：'
- en: '![How to do it...](img/5566_07_21.jpg)'
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_21.jpg)'
- en: How it works...
  id: totrans-141
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的……
- en: Nagios Core saves the data for both alerts and notifications on a long-term
    basis, allowing for reports like this to be generated dynamically from its archives.
    Note that the data presented in these reports is for alerts and notifications,
    not the actual states of the services over time. To get useful statistics such
    as the percentage of uptime, you'll want to generate an availability report, as
    discussed in the *Viewing and interpreting availability reports* recipe in this
    chapter.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: Nagios Core 会长期保存警报和通知的数据，从而允许动态生成此类报告。请注意，这些报告中展示的数据是警报和通知，而不是服务随时间变化的实际状态。要获得有用的统计信息，如正常运行时间百分比，您将需要生成可用性报告，正如本章中的*查看和解释可用性报告*方法所讨论的那样。
- en: The same notifications data can also be translated into a MySQL database format
    via the NDOUtils extension, so that reading the alerts and notifications data
    programmatically to generate custom reports is possible. See the *Reading status
    into a* *MySQL database with NDOUtils* recipe in [Chapter 11](ch11.html "Chapter 11. Automating
    and Extending Nagios Core"), *Automating and Extending Nagios*, for information
    on how to do this.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 相同的通知数据还可以通过 NDOUtils 扩展转换为 MySQL 数据库格式，从而使得能够以编程方式读取警报和通知数据，以生成自定义报告。有关如何操作的详细信息，请参见[第
    11 章](ch11.html "第 11 章：自动化和扩展 Nagios Core")中的*将状态读取到 MySQL 数据库与 NDOUtils*方法，*自动化和扩展
    Nagios*章节。
- en: There's more...
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多……
- en: 'The remaining item in the menu is the **Event Log**, which presents a more
    comprehensive summary of Nagios Core''s overall activity without filtering only
    for alerts or notifications. This screen can include information such as the application
    of external commands. It tends to be quite verbose, but it''s a useful way to
    read the `nagios.log` file from the web interface. Your username will need to
    be included in the `authorized_for_system_information` directive in `/usr/local/nagios/etc/cgi.cfg`
    to use this:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 菜单中的剩余项是**事件日志**，它呈现了 Nagios Core 整体活动的更全面总结，而不仅仅过滤警报或通知。此屏幕可以包括例如外部命令应用等信息。它通常比较冗长，但它是通过
    Web 界面读取`nagios.log`文件的有用方式。要使用此功能，您的用户名需要包含在 `/usr/local/nagios/etc/cgi.cfg`中的`authorized_for_system_information`指令中：
- en: '[PRE3]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: See also
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: The *Viewing and interpreting availability reports* and *Viewing and interpreting
    trends* recipes in this chapter
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的*查看和解释可用性报告*和*查看和解释趋势*方法
- en: The *Reading status into a MySQL database with NDOUtils* recipe in [Chapter
    11](ch11.html "Chapter 11. Automating and Extending Nagios Core"), *Automating
    and Extending Nagios*
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第 11 章](ch11.html "第 11 章：自动化和扩展 Nagios Core")中的*将状态读取到 MySQL 数据库与 NDOUtils*方法，*自动化和扩展
    Nagios*'
- en: Adding comments on hosts or services in the web interface
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Web 界面中添加主机或服务的评论
- en: In this recipe, we'll learn how to add comments to hosts or services in the
    Nagios Core web interface, to keep track of information about them for all the
    web interface users.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将学习如何在 Nagios Core 网页界面中向主机或服务添加评论，以便为所有网页界面用户跟踪相关信息。
- en: Getting started
  id: totrans-152
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 入门
- en: You will need access to the Nagios Core web interface, and permission to run
    commands from the CGIs. The sample configuration installed by following the Quick
    Start Guide grants all the necessary privileges to the `nagiosadmin` user when
    authenticated via `HTTP`. You will also need at least one host or service.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要访问 Nagios Core 网页界面，并且具有从 CGI 运行命令的权限。按照快速入门指南安装的示例配置将为`nagiosadmin`用户授予所有必要的权限，前提是通过`HTTP`进行身份验证。你还需要至少一个主机或服务。
- en: 'If you find that you don''t have this privilege, then check the `authorized_for_all_service_commands`
    and `authorized_for_all_host_commands` directives in `/usr/local/nagios/etc/cgi.cfg`,
    and include your username in both; for example, for the user `tom`, the directives
    might look similar to the following:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现自己没有此权限，请检查`/usr/local/nagios/etc/cgi.cfg`中的`authorized_for_all_service_commands`和`authorized_for_all_host_commands`指令，并将你的用户名添加到两者中；例如，对于用户`tom`，指令可能类似于以下内容：
- en: '[PRE4]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: How to do it...
  id: totrans-156
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We can add a comment to a host or service as follows:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过以下方式向主机或服务添加评论：
- en: Log in to the Nagios Core web interface, and click on the hostname or service
    description on which you wish to leave the comment. You can get to this via the
    **Hosts** or **Services** menu items. Here, I'm leaving a comment on my **sparta.naginet**
    host:![How to do it...](img/5566_07_22.jpg)
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 Nagios Core 网页界面，点击你希望留下评论的主机名或服务描述。你可以通过**主机**或**服务**菜单项进入此页面。在这里，我正在对我的**sparta.naginet**主机添加评论：![如何操作...](img/5566_07_22.jpg)
- en: Click on the **Add a new comment** link at the bottom of the page:![How to do
    it...](img/5566_07_23.jpg)
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击页面底部的**添加新评论**链接：![如何操作...](img/5566_07_23.jpg)
- en: 'Fill out the resulting form and include the following details:'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写结果表单并包括以下细节：
- en: '**Host Name**: This is the host name for the host or service on which the comment
    should be made. This should be filled in automatically.'
  id: totrans-161
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机名**：这是应该添加评论的主机或服务的主机名。此项应自动填写。'
- en: '**Persistent**: Check this box if you would like the comment to remain on the
    host even after Nagios Core is restarted.'
  id: totrans-162
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**持久化**：如果希望即使在重启 Nagios Core 后评论仍然保留在主机上，请勾选此框。'
- en: '**Author (Your Name)**: This is the name of the person acknowledging the fault.
    This should default to your name or username; it may be grayed out and unchangeable,
    depending on the value of `lock_author_names` in `/usr/local/nagios/etc/cgi.cfg`.'
  id: totrans-163
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**作者（你的名字）**：这是确认故障的人的名字。此项应默认为你的名字或用户名；根据`/usr/local/nagios/etc/cgi.cfg`中`lock_author_names`的设置，可能会显示为灰色且不可更改。'
- en: '**Comment**: This is the text of the comment itself.'
  id: totrans-164
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**评论**：这是评论的具体内容。'
- en: 'Note that explanatory notes also appear to the right of the command description.
    Click on **Commit** when done:'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，解释性说明也会出现在命令描述的右侧。完成后，点击**提交**：
- en: '![How to do it...](img/5566_07_24.jpg)'
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_24.jpg)'
- en: 'With this done, a comment should be added to the host or service. It may take
    a little while for the command to be processed. You will find that there is an
    icon added to the host or service''s link in its menu, and that a comment has
    been added:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此操作后，评论应已添加到主机或服务。处理命令可能需要一点时间。你会发现主机或服务的链接菜单中添加了一个图标，并且已添加评论：
- en: '![How to do it...](img/5566_07_25.jpg)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_25.jpg)'
- en: How it works...
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Like most changes issued from the Nagios Core web interface, adding a comment
    to a host or service is a command issued for processing by the server, along with
    its primary task of executing plugins and recording states. This is why it can
    sometimes take a few seconds to apply even on an idle server. This is all written
    to the command file, by default stored at `/usr/local/nagios/var/rw/nagios.cmd`,
    which the Nagios Core system regularly reads.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 与大多数从 Nagios Core 网页界面发出的更改一样，向主机或服务添加评论也是一个发往服务器处理的命令，服务器的主要任务是执行插件和记录状态。这就是为什么即使在空闲服务器上，应用评论有时也需要几秒钟的原因。这些信息会被写入命令文件，默认保存在`/usr/local/nagios/var/rw/nagios.cmd`，Nagios
    Core 系统会定期读取该文件。
- en: When the command is executed, a comment is added to the host or service that
    can be viewed by anyone with appropriate permissions in the web interface.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 当命令被执行时，评论将被添加到主机或服务，任何具有适当权限的用户都可以在网页界面中查看。
- en: There's more...
  id: totrans-172
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'You can view a list of all comments with the **Comments** link in the sidebar:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过侧边栏中的 **评论** 链接查看所有评论的列表：
- en: '![There''s more...](img/5566_07_26.jpg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多...](img/5566_07_26.jpg)'
- en: 'This will bring up a complete list of comments for all hosts and services,
    including both automated and manual ones:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 这将列出所有主机和服务的完整评论，包括自动和手动的评论：
- en: '![There''s more...](img/5566_07_27.jpg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多...](img/5566_07_27.jpg)'
- en: See also
  id: totrans-177
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: The *Acknowledging a problem via the web interface* recipe in this chapter
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的 *通过 web 界面确认问题* 实例
- en: Viewing configuration in the web interface
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 web 界面中查看配置
- en: In this recipe, we'll learn how to view a table of all the objects currently
    configured for the running Nagios Core instance. This is a very convenient way
    to view how the system has understood your configuration. If you use a lot of
    configuration tricks, such as object inheritance and patterns for hostnames, this
    can really help you make sense of things.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个实例中，我们将学习如何查看当前为运行中的 Nagios Core 实例配置的所有对象的表格。这是一个非常方便的方式来查看系统如何理解你的配置。如果你使用了很多配置技巧，比如对象继承和主机名模式，这确实可以帮助你理解配置。
- en: Some administrators aren't aware of this feature, because it's tucked away at
    the bottom of the Nagios Core web interface's navigation menu. It's very simple
    to use as there are only really two steps involved.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 一些管理员可能不了解这个功能，因为它隐藏在 Nagios Core web 界面导航菜单的底部。使用起来非常简单，只有两个步骤。
- en: Getting started
  id: totrans-182
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 入门
- en: You will need access to the Nagios Core web interface, and permission to run
    commands from the CGIs. The sample configuration installed by following the Quick
    Start Guide grants all the necessary privileges to the `nagiosadmin` user when
    authenticated via `HTTP`.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要访问 Nagios Core web 界面，并有权限从 CGI 执行命令。按照快速入门指南安装的示例配置，授予了 `nagiosadmin` 用户通过
    `HTTP` 认证时所需的所有权限。
- en: 'If you find that you don''t have this privilege, then check the `authorized_for_configuration_information`
    directive in `/usr/local/nagios/etc/cgi.cfg`, and include your username in it;
    for example, for the user `tom`, the directives might look like the following:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现自己没有这个权限，可以检查 `/usr/local/nagios/etc/cgi.cfg` 中的 `authorized_for_configuration_information`
    指令，并将你的用户名添加进去；例如，对于用户 `tom`，指令可能如下所示：
- en: '[PRE5]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: How to do it...
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We can view the configuration of different object types in the web interface
    as follows:'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在 web 界面中查看不同对象类型的配置，如下所示：
- en: Log in to the Nagios Core web interface, and click on the **Configuration**
    item in the navigation menu:![How to do it...](img/5566_07_28.jpg)
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 Nagios Core web 界面，并点击导航菜单中的 **配置** 项：![如何操作...](img/5566_07_28.jpg)
- en: Select the object type you wish to view, and click on **Continue**. In this
    example, I want to view all the hosts I have defined:![How to do it...](img/5566_07_29.jpg)
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你希望查看的对象类型，然后点击 **继续**。在这个例子中，我想查看我定义的所有主机：![如何操作...](img/5566_07_29.jpg)
- en: You should be presented with a complete table showing the directive values of
    all the hosts defined in your system. It will likely be wider than the screen,
    and will hence require horizontal scrolling.
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你应该会看到一个完整的表格，显示你系统中所有定义主机的指令值。这个表格可能比屏幕宽，因此需要水平滚动。
- en: '![How to do it...](img/5566_07_30.jpg)'
  id: totrans-191
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_30.jpg)'
- en: How it works...
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'This is simply a convenient shortcut for viewing the configuration of your
    hosts as Nagios Core understands them. The following object types can be viewed:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 这只是一个方便的快捷方式，用于查看 Nagios Core 理解的主机配置。以下对象类型可以查看：
- en: Hosts
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机
- en: Host dependencies
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机依赖
- en: Host escalations
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机升级
- en: Host groups
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机组
- en: Services
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务
- en: Service groups
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务组
- en: Service dependencies
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务依赖
- en: Service escalations
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务升级
- en: Contacts
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 联系人
- en: Contact groups
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 联系人组
- en: Time periods
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时间段
- en: Commands
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 命令
- en: Command expansion
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 命令扩展
- en: This shortcut is particularly convenient for definitions that can sometimes
    be quite complex, such as hosts and services that inherit from templates, or time
    period definitions. It's a good way to check that Nagios Core has interpreted
    your configuration the way you expected.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 这个快捷方式对于有时可能非常复杂的定义尤其方便，比如从模板继承的主机和服务，或时间段定义。这是一个检查 Nagios Core 是否按照预期解读你配置的好方法。
- en: There's more...
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: It's important to note that the output doesn't actually tell you anything about
    the state of hosts or services; it only shows how they're configured. If you need
    to get both the configuration and state information in an accessible format for
    processing by a custom script, an excellent way to arrange this is with the NDOUtils
    addon, which allows you to translate this information into a MySQL database format.
    See the *Reading status into a MySQL database with NDOUtils* recipe in [Chapter
    11](ch11.html "Chapter 11. Automating and Extending Nagios Core"), *Automating
    and Extending Nagios Core* for information on how to do this.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，输出实际上并没有告诉你主机或服务的状态；它仅显示它们的配置。如果你需要以易于处理的格式获取配置和状态信息，可以使用 NDOUtils 插件，它允许你将这些信息转换为
    MySQL 数据库格式。有关如何实现这一点的详细信息，请参阅 [第11章](ch11.html "第11章：自动化与扩展 Nagios Core") 中的
    *将状态读入 MySQL 数据库与 NDOUtils* 章节，*自动化与扩展 Nagios Core*。
- en: See also
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参见
- en: The *Reading status into a MySQL database with NDOUtils* and *Writing customized
    Nagios Core reports* recipes in [Chapter 11](ch11.html "Chapter 11. Automating
    and Extending Nagios Core"), *Automating and Extending Nagios Core*
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第11章](ch11.html "第11章：自动化与扩展 Nagios Core") 中的 *将状态读入 MySQL 数据库与 NDOUtils*
    和 *编写定制的 Nagios Core 报告* 章节，*自动化与扩展 Nagios Core*'
- en: Scheduling checks from the web interface
  id: totrans-212
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从 Web 界面调度检查
- en: In this recipe, we'll learn how to manually schedule checks of hosts and services
    from the web interface, overriding the automatic scheduling normally done by Nagios
    Core. This can be convenient to hurry along checks for hosts or services that
    have just been added, or which have just had problems, or to force a check to
    be made even when active checks are otherwise disabled on a host for whatever
    reason.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将学习如何通过 Web 界面手动调度主机和服务的检查，覆盖 Nagios Core 通常执行的自动调度。这对于加快刚刚添加的主机或服务的检查，或者解决刚发生问题的主机或服务，或者强制进行检查即使主机上的主动检查因为某些原因被禁用，都非常方便。
- en: In this example, we'll schedule a check for a service, but checks for hosts
    can be established in just the same way.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们将调度一个服务的检查，但主机的检查也可以以相同的方式进行。
- en: Getting started
  id: totrans-215
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 入门
- en: You will need access to the Nagios Core web interface, and permission to run
    commands from the CGIs. The sample configuration installed by following the Quick
    Start Guide grants all the necessary privileges to the `nagiosadmin` user when
    authenticated via `HTTP`.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要访问 Nagios Core Web 界面，并有权限从 CGI 运行命令。按照快速入门指南安装的示例配置会在通过 `HTTP` 认证后，授予 `nagiosadmin`
    用户所有必要的权限。
- en: 'If you find that you don''t have this privilege, then check the `authorized_for_all_service_commands`
    and `authorized_for_all_host_commands` directives in `/usr/local/nagios/etc/cgi.cfg`,
    and include your username in both; for example, for the user `tom`, the directives
    might look like the following:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现自己没有这个权限，请检查 `/usr/local/nagios/etc/cgi.cfg` 中的 `authorized_for_all_service_commands`
    和 `authorized_for_all_host_commands` 指令，并将你的用户名加入其中；例如，对于用户 `tom`，这些指令可能看起来像以下这样：
- en: '[PRE6]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: How to do it...
  id: totrans-219
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We can schedule a check for an existing service as follows:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以如下调度一个现有服务的检查：
- en: Log in to the Nagios Core web interface, and find the link to the host or service
    for which you want to schedule a check. In this example, we're forcing a check
    of the **LOAD** service on the **sparta.naginet** host:![How to do it...](img/5566_07_31.jpg)
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 Nagios Core Web 界面，找到你想要调度检查的主机或服务的链接。在这个例子中，我们正在强制对 **sparta.naginet**
    主机上的 **LOAD** 服务进行检查：![如何操作...](img/5566_07_31.jpg)
- en: Click on the **Re-schedule the next check of this service** or **Re-schedule
    the next check of this host** link in the menu on the right:![How to do it...](img/5566_07_32.jpg)
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击右侧菜单中的 **重新调度此服务的下一次检查** 或 **重新调度此主机的下一次检查** 链接：![如何操作...](img/5566_07_32.jpg)
- en: 'Complete the resulting form and include the following details:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成生成的表单并包括以下细节：
- en: '**Host Name**: This is the host name for the host or service having the problem.
    This should be filled in automatically.'
  id: totrans-224
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主机名**：这是出现问题的主机或服务的主机名。此项应该会自动填写。'
- en: '**Service**: This is the service description for the service having problems,
    if applicable. This will also be filled in automatically.'
  id: totrans-225
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务**：这是出现问题的服务的描述（如果适用）。此项同样会自动填写。'
- en: '**Check Time**: This is the time at which Nagios Core should reschedule the
    check.'
  id: totrans-226
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**检查时间**：这是 Nagios Core 应重新调度检查的时间。'
- en: '**Force Check**: This specifies whether it''s required to force a check regardless
    of active checks being disabled for this host or service.'
  id: totrans-227
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**强制检查**：指定是否需要强制执行检查，即使该主机或服务的活动检查已被禁用。'
- en: 'Note that explanatory notes also appear to the right of the command description.
    Click on **Commit** when done:'
  id: totrans-228
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，解释性说明也会显示在命令描述的右侧。完成后点击**提交**：
- en: '![How to do it...](img/5566_07_33.jpg)'
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_33.jpg)'
- en: With this done, after Nagios Core processes the new command, viewing the service
    should show the new time for its next scheduled check, and the check will be run
    at the nominated time and its return values processed normally.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此操作后，在Nagios Core处理新命令后，查看服务时应该会显示下次计划检查的新时间，检查将在指定时间运行，并正常处理返回值。
- en: How it works...
  id: totrans-231
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Scheduling checks in this manner is a means of "jumping the queue” for a particular
    host or service. Check scheduling is otherwise an automated process that Nagios
    Core figures out based on host and service directives such as `check_interval`
    and `retry_interval`.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 以这种方式调度检查是一种为特定主机或服务“跳过队列”的方法。检查调度通常是一个自动化过程，Nagios Core根据主机和服务指令（如`check_interval`和`retry_interval`）来决定。
- en: Like all external commands issued from the web interface, a command is written
    to the commands file, usually at `/usr/local/nagios/var/rw/nagios.cmd`, for processing
    by the system.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 和所有从网络界面发出的外部命令一样，命令会被写入命令文件，通常位于`/usr/local/nagios/var/rw/nagios.cmd`，由系统处理。
- en: There's more...
  id: totrans-234
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多内容...
- en: 'We can inspect the enqueued checks by clicking on the **Scheduling Queue**
    link under the **System** section of the sidebar:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过点击侧边栏**系统**部分下的**调度队列**链接来检查排队的检查任务：
- en: '![There''s more...](img/5566_07_34.jpg)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多内容...](img/5566_07_34.jpg)'
- en: 'This will bring up a list of the pending checks, and the times at which they''ll
    take place:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示待处理检查的列表，以及它们将执行的时间：
- en: '![There''s more...](img/5566_07_35.jpg)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![还有更多内容...](img/5566_07_35.jpg)'
- en: 'We can also get more detailed information about the queuing process and performance
    by using the `-s` flag with the `nagios` command:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以通过使用`nagios`命令的`-s`标志来获取有关排队过程和性能的更详细信息：
- en: '[PRE7]'
  id: totrans-240
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'This will print a lot of information to the terminal, too much to reproduce
    here! It is probably helpful to pipe it through a paging tool like `less` to read
    it:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 这会打印大量信息到终端，太多了，无法在此复述！使用诸如`less`的分页工具可能会更有帮助，方便阅读：
- en: '[PRE8]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: See also
  id: totrans-243
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: The *Viewing and interpreting notification history* recipe in this chapter
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的*查看和解读通知历史*教程
- en: The *Checking Nagios Core performance with Nagiostats* recipe in [Chapter 10](ch10.html
    "Chapter 10. Security and Performance"), *Security and Performance*
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第10章](ch10.html "第10章 安全与性能")中的*使用Nagiostats检查Nagios Core性能*教程，*安全与性能*'
- en: The *Allowing passive checks*, and *Running passive checks from a remote host
    with NSCA* recipes in [Chapter 11](ch11.html "Chapter 11. Automating and Extending
    Nagios Core"), *Automating and Extending Nagios Core*
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第11章](ch11.html "第11章 自动化与扩展Nagios Core")中的*允许被动检查*和*通过NSCA从远程主机运行被动检查*教程，*自动化与扩展Nagios
    Core*'
- en: Acknowledging a problem via the web interface
  id: totrans-247
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过网络界面确认问题
- en: In this recipe, we'll learn how to acknowledge problems with a host or service,
    in order to prevent further notifications coming from it and to signal that the
    problem is being worked on. This is useful if more than one administrator has
    access to the Nagios Core web interface, to prevent more than one administrator
    trying to fix a problem, and to prevent unnecessary notifications for a longer-term
    problem after the operations team has been made aware of it. The exact changes
    in behavior that the acknowledgement causes are defined at the time it's submitted.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在本篇教程中，我们将学习如何确认主机或服务的问题，以防止收到进一步的通知，并标明问题正在处理中。如果有多个管理员可以访问 Nagios Core 网络界面，这个方法尤其有用，可以避免多个管理员同时尝试解决同一个问题，并防止在操作团队已知问题后仍然收到不必要的长期通知。确认时产生的行为变化会在提交时定义。
- en: Getting started
  id: totrans-249
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 入门
- en: To acknowledge a notification, there needs to be at least one host or service
    suffering problems. Any host or service in a `WARNING`, `CRITICAL`, or `UNKNOWN`
    state can be acknowledged.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 要确认一个通知，必须至少有一个主机或服务遇到问题。任何处于`WARNING`、`CRITICAL`或`UNKNOWN`状态的主机或服务都可以进行确认。
- en: You will need access to the Nagios Core web interface, and permission to run
    commands from the CGIs. The Quick Start configuration grants all the necessary
    privileges to the `nagiosadmin` user when authenticated via `HTTP`.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
- en: 'If you find that you don''t have this privilege, check the `authorized_for_all_service_commands`
    and `authorized_for_all_host_commands` directives in `/usr/local/nagios/etc/cgi.cfg`,
    and include your username in both; for example, for the user `tom`, the directives
    might look like the following:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: How to do it...
  id: totrans-254
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We can acknowledge a host or service problem as follows:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
- en: Log in to the Nagios Core web interface, and click on the **Hosts** or **Services**
    section in the left menu, to visit the host or service having problems. In this
    example, I'm acknowledging a problem with the **APT** service on my machine **athens**;
    Nagios Core is reporting upgrades available, but they're not critical and I can't
    run them right now. Hence I'm going to acknowledge them, so that other administrators
    know I've got a plan for the problem:![How to do it...](img/5566_07_36.jpg)
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Acknowledge this service problem** link under the **Service Commands**
    menu:![How to do it...](img/5566_07_37.jpg)
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Complete the resulting form and include the following details:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Host Name**: This is the host name for the host or service having the problem.
    This should be filled in automatically.'
  id: totrans-259
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Service**: This is the service description for the service having problems,
    if applicable. This will also be filled in automatically.'
  id: totrans-260
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Sticky Acknowledgement**: If checked, notifications will be suppressed until
    the problem is resolved; the acknowledgement will not go away if Nagios Core is
    restarted.'
  id: totrans-261
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Send Notification**: If checked, an `ACKNOWLEDGEMENT` notification will be
    sent to all the contacts and contact groups for the host or service.'
  id: totrans-262
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Persistent Comment**: Acknowledgements always leave comments on the host
    or service in question. By default, these are removed when the host or service
    recovers, but if you wish you can check this to arrange to have them take the
    form of a permanent comment.'
  id: totrans-263
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Author (Your Name)**: This is the name of the person acknowledging the fault.
    This should default to your name or username; it may be grayed out and unchangeable,
    depending on the value of `lock_author_names` in `/usr/local/nagios/etc/cgi.cfg`.'
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Comment**: This is an explanation of the acknowledgement; this is generally
    a good place to put expected times to resolution, and what''s being done about
    the problem.'
  id: totrans-265
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Note that explanatory notes also appear to the right of the command description.
    Click on **Commit** when done:'
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![How to do it...](img/5566_07_38.jpg)'
  id: totrans-267
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: 'With this done, the effects you chose for the downtime should take effect shortly.
    It may take a little while for the command to be processed. You will find that
    there is an acknowledgement icon added to the host or service''s link in its menu,
    and that a comment has been added:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
- en: '![How to do it...](img/5566_07_39.jpg)'
  id: totrans-269
  prefs: []
  type: TYPE_IMG
- en: 'Your contacts may also receive an **ACKNOWLEDGEMENT** notification:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 你的联系人可能还会收到一个**确认**通知：
- en: '![How to do it...](img/5566_07_40.jpg)'
  id: totrans-271
  prefs: []
  type: TYPE_IMG
  zh: '![如何操作...](img/5566_07_40.jpg)'
- en: How it works...
  id: totrans-272
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Like most changes issued from the Nagios Core web interface, acknowledging a
    host or service is a command issued for processing by the server, along with its
    primary task of executing plugins and recording states. This is why it can sometimes
    take a few seconds to apply even on an idle server. This is all written to the
    command file, which is by default stored at `/usr/local/nagios/var/rw/nagios.cmd`.
    The Nagios Core system regularly reads this file, provided external command processing
    is enabled in `/usr/local/nagios/etc/nagios.cfg`.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 像大多数通过Nagios Core Web界面发出的更改一样，确认主机或服务是一条命令，由服务器处理，除了执行插件和记录状态这一主要任务外。这就是为什么即使在空闲的服务器上，应用此操作有时也需要几秒钟时间的原因。所有这些操作都会写入命令文件，该文件默认存储在`/usr/local/nagios/var/rw/nagios.cmd`路径下。只要在`/usr/local/nagios/etc/nagios.cfg`中启用了外部命令处理，Nagios
    Core系统会定期读取此文件。
- en: When the command is executed and the **Sticky Acknowledgement** option is selected,
    the effect is that the filters normally applied by Nagios Core will notice that
    the host or service has had its problems acknowledged before dispatching a notification,
    and will therefore prevent the notification from being sent.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 当命令被执行并且选择了**固定确认**选项时，其效果是，Nagios Core通常应用的过滤器会注意到主机或服务在发送通知之前已经确认了问题，因此会阻止通知的发送。
- en: When the host recovers (a `RECOVERY` event), a notification to that effect will
    be sent, and the acknowledgement will be removed as it's no longer needed. Future
    problems with the host or service, even if they're exactly the same problem, will
    need to be themselves acknowledged.
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 当主机恢复（`恢复`事件）时，会发送相应的通知，并且确认会被移除，因为它不再需要。即使主机或服务出现的再次是完全相同的问题，未来的任何问题仍然需要重新确认。
- en: There's more...
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Acknowledging host and service problems is a really good habit to get into for
    administrators, particularly if working in a team, as it may prevent a lot of
    confusion or duplication of work. It's therefore helpful in the same way comments
    are, in keeping your team informed about what's going on with the network.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 确认主机和服务问题对于管理员来说是一个非常好的习惯，尤其是当在团队中工作时，因为这可以避免很多混乱或重复的工作。因此，它与评论一样有帮助，有助于让你的团队了解网络的最新状况。
- en: The distinction between scheduled downtime and acknowledgements is important.
    **Downtime** is intended to be for planned outages to a host or service; an **acknowledgement**
    is intended as a means of notification that an unanticipated problem has occurred,
    and is being worked on.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: 计划停机和确认之间的区别非常重要。**停机时间**是为了主机或服务的计划性停机而设置的；**确认**则是用于通知一个未预见的问题已经发生，并且正在处理中的手段。
- en: 'If we''re getting nagged repeatedly by notifications for problems that we already
    know about, as well as using acknowledgements, then it may be appropriate to review
    the `notification_interval` directive for the applicable hosts or services, to
    limit the frequency with which notifications are sent. For example, to only send
    repeat notifications every four hours, we could write the following code snippet:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们不断收到已经知道的问题的通知，并且已经使用了确认功能，那么可能需要审查适用主机或服务的`notification_interval`指令，以限制通知发送的频率。例如，如果我们只希望每四小时发送一次重复通知，可以编写以下代码片段：
- en: '[PRE10]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: For low-priority hosts, for example, it's perhaps not necessary to send notifications
    every 10 minutes!
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，对于低优先级的主机，可能并不需要每10分钟发送一次通知！
- en: 'Do not confuse this directive with `notification_period`, which is used to
    define the times during which notifications may be sent, another directive that
    may require review:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 不要将此指令与`notification_period`混淆，`notification_period`用于定义可发送通知的时间段，另一个可能需要审查的指令：
- en: '[PRE11]'
  id: totrans-283
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: See also
  id: totrans-284
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: The *Adding comments on hosts or services in the web interface* recipe in this
    chapter
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章中的*在Web界面上为主机或服务添加评论*示例
- en: The *Scheduling downtime for a host or service* recipe in [Chapter 3](ch03.html
    "Chapter 3. Working with Checks and States"), *Working with Checks and States*
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第3章](ch03.html "第3章. 工作与检查和状态")中的*为主机或服务安排停机时间*示例，*工作与检查和状态*'
