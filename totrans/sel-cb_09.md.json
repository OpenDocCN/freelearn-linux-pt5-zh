["```\n    ~# mkdir -p /var/chroot/dev\n    ~# mkdir -p /var/chroot/etc/bind\n    ~# mkdir -p /var/chroot/var/bind/{sec,pri,dyn}\n    ~# mkdir -p /var/chroot/var/{log,run}\n    ~# chown root:named /var/chroot\n    ~# chmod 750 /var/chroot\n    ~# chown -R named:named /var/chroot/var/*\n\n    ```", "```\n    ~# cp /etc/named.conf /var/chroot/etc/\n    ~# cp /etc/localtime /var/chroot/etc/\n    ~# cp -a /var/named/* /var/chroot/var/named/\n\n    ```", "```\n    ~# mknod /var/chroot/dev/null c 1 3\n    ~# mknod /var/chroot/dev/random c 1 8\n    ~# chmod 666 /var/chroot/dev/*\n\n    ```", "```\n    ~# setfiles -r /var/chroot/ /etc/selinux/mcs/contexts/files/file_contexts /var/chroot/\n\n    ```", "```\n    ~# chroot /var/chroot/ su - named -c /usr/sbin/named\n\n    ```", "```\n    corecmd_exec_chroot(named_t)\n    ```", "```\n~# ldd /usr/sbin/named\n linux-vdso.so.1\n liblwres.so.90 => /usr/lib64/liblwres.so.90\n libdns.so.100 => /usr/lib64/libdns.so.100\n libbind9.so.90 => /usr/lib64/libbind9.so.90\n libisccfg.so.90 => /usr/lib64/libisccfg.so.90\n libisccc.so.90 => /usr/lib64/libisccc.so.90\n libisc.so.95 => /usr/lib64/libisc.so.95\n libc.so.6 => /lib64/libc.so.6\n /lib64/ld-linux-x86-64.so.2\n\n```", "```\n    ~# mkdir -p /var/chroot/sys/fs/selinux\n    ~# mount -t selinuxfs none /var/chroot/sys/fs/selinux\n\n    ```", "```\n    ~# cp -a /etc/selinux/ /var/chroot/etc/\n\n    ```", "```\n~# mount -t selinuxfs none /var/chroot/selinux\n\n```", "```\n~# mount -o bind /etc/selinux /var/chroot/etc/selinux\n~# mount -o remount,ro /var/chroot/etc/selinux\n\n```", "```\n    ~# mkdir -p /home/share/\n    ~# chmod 1777 /home/share/\n\n    ```", "```\n    type user_share_t;\n    files_type(user_share_t)\n    ```", "```\n    interface(`userdom_admin_user_share','\n      gen_require(`\n        type user_share_t;\n      ')\n      admin_pattern($1, user_share_t)\n     ')\n    ```", "```\n    ~# semanage fcontext -a -t user_share_t \"/home/share(/.*)?\"\n    ~# restorecon -R /home/share/\n\n    ```", "```\n    userdom_admin_user_share(user_t)\n    ```", "```\n    ~$ cp -r sharedfiles/ /home/share && rm -r sharedfiles/\n\n    ```", "```\n    ~$ setfacl -R -m u:user1:rX /home/share/sharedfiles\n    ~$ setfacl -R -m u:user2:rwX /home/share/sharedfiles\n    ~$ setfacl -m \"default:u:user2:rwX\" /home/share/sharedfiles\n    ~$ setfacl -m \"default:u:user0:rwX\" /home/share/sharedfiles\n    ~$ setfacl -m \"default:u:user1:rX\" /home/share/sharedfiles\n\n    ```", "```\n~$ mv sharedfiles/ /home/share/\n~$ chcon -R -t user_share_t /home/share/sharedfiles/\n\n```", "```\n~$ chgrp -R shrgrp /home/share/sharedfiles/\n~$ find /home/share/sharedfiles/ -type d -exec chmod g+s '{}' \\;\n\n```", "```\n    ~# mkdir /tmp-inst/ /var/tmp/tmp-inst/\n    ~# chmod 000 /tmp-inst/ /var/tmp/tmp-inst/\n\n    ```", "```\n    ~# semanage fcontext -a -t tmp_t -f d /tmp-inst\n    ~# semanage fcontext -a -t tmp_t -f d /var/tmp/tmp-inst\n\n    ```", "```\n    /tmp  /tmp-inst/    level  root,adm\n    /var/tmp  /var/tmp/tmp-inst/  level  root,adm\n    ```", "```\n    session  required  pam_namespace.so\n    ```", "```\n    ~# setsebool -P allow_polyinstantiation on\n\n    ```", "```\n/tmp  /tmp-inst/  level  root,adm\n```", "```\n~# ls -l /tmp-inst/\ndrwxrwxrwt. 2 root root 4096 Jun 22 12:31 system_u:object_r:tmp_t:s0_user1\ndrwxrwxrwt. 2 root root 4096 Jun 22 12:30 system_u:object_r:tmp_t:s0_user2\n\n```", "```\n~# cd /etc/pam.d\n~# grep -l pam_selinux.so *\nsystem-login\n\n```", "```\n    ~# setcap cap_net_raw+ei /bin/ping\n\n    ```", "```\n    cap_net_raw   user1\n    ```", "```\n    allow ping_t self:capability net_raw;\n    ```", "```\n    allow local_login_t self:process setcap;\n    ```", "```\n    auth  required  pam_cap.so\n    ```", "```\n    auditallow domain self:capability net_raw;\n    ```", "```\n~# setcap cap_net_raw+ep /bin/ping\n\n```", "```\n~# setcap cap_net_raw+i /bin/ping\n\n```", "```\n~$ /sbin/capsh --print | grep ^Current\nCurrent: cap_net_raw+i\n\n```", "```\n~$ getcap /bin/ping\n/bin/ping = cap_net_raw+ei\n\n```", "```\n    ~# gpasswd -a user1 dba\n    ~# gpasswd -a user1 dev\n\n    ```", "```\n    ~# semanage login -s dbadm_u %dba\n\n    ```", "```\n    ~# chgrp -R dev /usr/lib/gcc /usr/x86_64-pc-linux-gnu/gcc-bin\n    ~# chmod -R o-rx /usr/lib/gcc /usr/x86_64-pc-linux-gnu/gcc-bin\n\n    ```", "```\n    %dba  ALL=(ALL)  TYPE=dbadm_t ROLE=dbadm_r NOPASSWD: initdb\n    ```", "```\n~# tar xvf /path/to/last_backup.tar.gz etc/named.conf\n~# restorecon /etc/named.conf\n\n```", "```\n~$ getfattr -m . -d named.conf\n# file: named.conf\nsecurity.selinux=\"system_u:object_r:named_conf_t:s0\"\nsystem.posix_acl_access=0sAgAAAAEABgD/////AgAGAOoâ€¦\n\n```", "```\nallow httpd_t http_server_packet_t:packet { send recv };\n```", "```\n    type dnsmasq_server_packet_t;\n    corenet_server_packet(dnsmasq_server_packet_t)\n\n    type named_server_packet_t;\n    corenet_server_packet(named_server_packet_t)\n    ```", "```\n    allow dnsmasq_t dnsmasq_server_packet_t:packet { send recv };\n    allow named_t named_server_packet_t:packet { send recv };\n    ```", "```\n    ~# iptables -t mangle -A INPUT -p tcp -s 10.11.12.0/24 --dport 53 -j SECMARK --selctx \"system_u:object_r:dnsmasq_server_packet_t:s0\"\n    ~# iptables -t mangle -A INPUT -p udp  -s 10.11.12.0/24 --dport 53 -j SECMARK --selctx \"system_u:object_r:dnsmasq_server_packet_t:s0\"\n    ~# iptables -t mangle -A INPUT -p tcp -s 10.13.14.0/24 --dport 53 -j SECMARK --selctx \"system_u:object_r:named_server_packet_t:s0\"\n    ~# iptables -t mangle -A INPUT -p udp -s 10.13.14.0/24 --dport 53 -j SECMARK --selctx \"system_u:object_r:named_server_packet_t:s0\"\n\n    ```", "```\n~# netstat -naptZ | awk '/LISTEN/ {print $4,$6,$7,$8}'\n0.0.0.0:13500 LISTEN 6489/mysqld system_u:system_r:mysqld_t:s0\n0.0.0.0:80 LISTEN 23303/httpd system_u:system_r:httpd_t:s0\n10.11.12.122:53 LISTEN 4432/dnsmasq system_u:system_r:dnsmasq_t:s0\n10.13.14.42:53 LISTEN 5423/named system_u:system_r:named_t:s0\n\n```", "```\n~# sesearch -t dns_server_packet_t -ACTS\nFound 10 semantic av rules:\n allow nova_network_t dns_server_packet_t : packet { send recv } ;\n allow corenet_unconfined_type packet_type : packet { send recv relabelto flow_in flow_out forward_in forward_out } ;\n allow named_t dns_server_packet_t : packet { send recv } ;\n allow vmware_host_t server_packet_type : packet { send recv } ;\n allow dnsmasq_t dns_server_packet_t : packet { send recv } ;\n allow kernel_t packet_type : packet send ;\n allow iptables_t packet_type : packet relabelto ;\nET allow squid_t packet_type : packet { send recv } ; [ squid_connect_any ]\nDT allow icecast_t packet_type : packet { send recv } ; [ icecast_connect_any ]\nDT allow git_session_t server_packet_type : packet { send recv } ; [ git_session_bind_all_unreserved_ports ]\n\n```"]