- en: '15'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '15'
- en: Deploying to the Cloud with AWS and Azure
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用AWS和Azure部署到云
- en: Recent years have seen a significant shift from on-premises computing platforms
    to private and public clouds. In an ever-changing and accelerating world, deploying
    and running applications in a highly scalable, efficient, and secure infrastructure
    is critical for businesses and organizations everywhere. On the other hand, the
    cost and expertise required to maintain the equivalent level of security and performance
    with on-premises computing resources become barely justifiable compared to current
    public cloud offerings. Businesses and teams, small and large, adopt public cloud
    services in increasing numbers, albeit large enterprises are relatively slow to
    make a move.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 近年来，从本地计算平台到私有云和公共云的转变已经显著增加。在这个变化迅速且加速的世界里，在一个高度可扩展、高效且安全的基础设施中部署和运行应用程序对于全球各地的企业和组织至关重要。另一方面，与当前公共云的服务相比，维护本地计算资源所需的成本和专业知识几乎无法证明其合理性。大大小小的企业和团队都在越来越多地采用公共云服务，尽管大企业相对较慢采取行动。
- en: One of the best metaphors for cloud computing is application services *on tap*.
    Do you need more resources for your apps? Just *turn on the tap* and provision
    the virtual machines or instances in any number you require (scale horizontally).
    Or perhaps, for some instances, you require more CPUs or memory (scale vertically).
    When you no longer need resources, just *turn off* *the tap*.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 云计算最好的隐喻之一就是应用服务*随时可用*。需要更多的应用资源吗？只需*打开水龙头*，按需配置虚拟机或实例，数量随意（水平扩展）。或者，对于某些实例，您可能需要更多的CPU或内存（垂直扩展）。当不再需要这些资源时，只需*关闭*
    *水龙头*。
- en: Public cloud services provide all these functions at relatively low rates, taking
    away the operations overhead that you might otherwise have with maintaining the
    on-premises infrastructure accommodating such features.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 公共云服务以相对低廉的价格提供所有这些功能，消除了您在维护本地基础设施时可能面临的运营开销，这些基础设施需要容纳此类功能。
- en: This chapter will introduce you to **Amazon Web Service** (**AWS**) and **Microsoft
    Azure** – two major public cloud providers – and offer some practical guidance
    for deploying your applications in the cloud. In particular, we’ll focus on typical
    cloud management workloads, using both the web administration console and the
    command-line interface.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍**Amazon Web Service**（**AWS**）和**Microsoft Azure**——两大主要公共云提供商——并提供一些有关如何在云中部署应用程序的实用指导。特别是，我们将重点介绍典型的云管理工作负载，使用Web管理控制台和命令行接口。
- en: By the end of this chapter, you’ll know how to use the AWS web console and the
    AWS CLI, as well as the Azure web portal and the Azure CLI, to manage your cloud
    resources with the two most popular cloud providers of our time. You’ll also learn
    how to make a prudent decision about creating and launching your resources in
    the cloud, striking a sensible balance between performance and cost.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 到本章结束时，您将学会如何使用AWS的Web控制台和AWS CLI，以及Azure的Web门户和Azure CLI，来管理您在这两个当今最流行的云提供商的云资源。您还将学会如何在云中创建和启动资源时做出明智的决策，在性能与成本之间找到合理的平衡。
- en: We hope that Linux administrators – novice and experienced alike – will find
    the content in this chapter relevant and refreshing. Our focus is purely practical
    as we explore the AWS and Azure cloud workloads. We will refrain from comparing
    the two since such an endeavor would go beyond this chapter’s scope. To make the
    journey less boring, we’ll also steer away from keeping a perfect symmetry between
    describing AWS and Azure management tasks. We all know AWS blazed the trail into
    the public cloud realm first. Other major cloud providers followed, adopted, and
    occasionally improved the underlying paradigms and workflows. Since we’ll be introducing
    AWS first, we’ll cover more ground on some cloud provisioning concepts (such as
    Regions and **Availability Zones** (**AZs**)), which in many ways are very similar
    to what’s available in Azure.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我们希望Linux管理员——无论是新手还是经验丰富的专家——都能觉得本章内容相关且令人耳目一新。我们的重点纯粹是实践的，我们将探讨AWS和Azure的云工作负载。我们将避免对两者进行比较，因为这超出了本章的范围。为了让内容不至于枯燥，我们还会避免在描述AWS和Azure管理任务时追求完全对称。我们都知道AWS首先开辟了公共云领域的道路，其他主要云提供商随之而来，采纳并有时改进了底层的范式和工作流程。由于我们首先介绍AWS，我们将在一些云资源配置概念（如区域和**可用区**（**AZs**））方面讲解得更为详细，这些在很多方面与Azure中的内容非常相似。
- en: Finally, we’ll leave the ultimate choice between using AWS or Azure up to you.
    We’re giving you the map. The road is yours to take.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们将 AWS 或 Azure 的选择权留给你。我们为你提供了地图，道路由你来走。
- en: 'Here are some of the key topics you’ll learn about:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是你将学习的一些关键主题：
- en: Working with AWS EC2
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 AWS EC2
- en: Working with Microsoft Azure
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Microsoft Azure
- en: Technical requirements
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To complete the tasks in this chapter, you will require the following:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 完成本章任务时，你需要以下内容：
- en: 'AWS and Azure accounts if you want to follow along with the practical examples.
    Both cloud providers provide free subscriptions:'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你想跟随实际示例进行操作，需拥有 AWS 和 Azure 账户。两个云服务提供商都提供免费的订阅服务：
- en: 'AWS free tier: [https://aws.amazon.com/free](https://aws.amazon.com/free)'
  id: totrans-15
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS 免费层：[https://aws.amazon.com/free](https://aws.amazon.com/free)
- en: 'Microsoft Azure free account: [https://azure.microsoft.com/en-us/free/](https://azure.microsoft.com/en-us/free/)'
  id: totrans-16
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microsoft Azure 免费账户：[https://azure.microsoft.com/en-us/free/](https://azure.microsoft.com/en-us/free/)
- en: A local machine with a Linux distribution of your choice to install and experiment
    with the AWS CLI and Azure CLI utilities.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台你选择的 Linux 发行版的本地机器，用于安装和实验 AWS CLI 和 Azure CLI 工具。
- en: A modern web browser (such as Google Chrome or Mozilla Firefox) for the web-console-driven
    management tasks for both AWS and Azure. You can access the related portals on
    any platform.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一款现代的 web 浏览器（例如 Google Chrome 或 Mozilla Firefox），用于执行 AWS 和 Azure 的 web 控制台管理任务。你可以在任何平台上访问相关门户。
- en: A Linux command-line terminal and intermediate-level proficiency using the shell
    to run the AWS and Azure CLI commands.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台 Linux 命令行终端，具备中级水平的 shell 使用能力，以便运行 AWS 和 Azure CLI 命令。
- en: Important note
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: As you proceed, please make sure to shut down your EC2 instances or Azure virtual
    machines after you finish experimenting with them. Failure to do so may result
    in relatively high bills being generated for you.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在操作过程中，请确保在完成实验后关闭你的 EC2 实例或 Azure 虚拟机。如果未关闭，可能会导致相对较高的账单产生。
- en: With this, let’s start with our first contender, AWS EC2.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们从第一个候选者 AWS EC2 开始。
- en: Working with AWS EC2
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 AWS EC2
- en: AWS **Elastic Compute Cloud** (**EC2**) is a scalable computing infrastructure
    that allows users to lease virtual computing platforms and services to run their
    cloud applications. AWS EC2 has gained extreme popularity in recent years due
    to its outstanding performance and scalability combined with relatively cost-effective
    service plans. This section provides some basic functional knowledge to get you
    started with deploying and managing AWS EC2 instances running your applications.
    In particular, we’ll introduce you to EC2 instance types, particularly how you
    can differentiate between various provisioning and related pricing tiers, how
    to use SSH to connect and SCP to transfer files to and from your EC2 instances,
    and how to work with the AWS CLI.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: AWS **弹性计算云**（**EC2**）是一种可扩展的计算基础设施，允许用户租用虚拟计算平台和服务来运行其云应用。近年来，AWS EC2 因其卓越的性能和可扩展性，以及相对具有成本效益的服务计划而获得了极大的普及。本节提供了一些基本功能知识，帮助你开始部署和管理运行应用程序的
    AWS EC2 实例。特别地，我们将介绍 EC2 实例类型，特别是如何区分不同的配置和相关的定价层次，如何使用 SSH 连接并使用 SCP 来传输文件到 EC2
    实例，如何使用 AWS CLI 进行操作。
- en: By the end of this section, you’ll have a basic understanding of AWS EC2 and
    how to choose, deploy, and manage your EC2 instances.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 到本节结束时，你将对 AWS EC2 有基本了解，并能选择、部署和管理你的 EC2 实例。
- en: Introducing and creating AWS EC2 instances
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍并创建 AWS EC2 实例
- en: AWS EC2 provides various instance types, each with its provisioning, capacity,
    pricing, and use case models. Choosing between different EC2 instance types is
    not always trivial. This section will briefly describe each EC2 instance type,
    some pros and cons of using them, and how to choose the most cost-effective solution.
    With each instance type, we’ll show you how to launch one using the AWS console.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: AWS EC2 提供了多种实例类型，每种类型的配置、容量、定价和使用场景都有所不同。选择不同的 EC2 实例类型并非易事。本节将简要描述每种 EC2 实例类型，使用它们的优缺点，以及如何选择最具成本效益的解决方案。针对每种实例类型，我们将展示如何通过
    AWS 控制台启动一个实例。
- en: 'We can look at EC2 instance types from two perspectives. When you decide on
    an EC2 instance, you’ll have to consider both these factors. Let’s look at each
    of these options briefly:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以从两个角度来考虑 EC2 实例类型。决定使用哪种 EC2 实例时，必须同时考虑这两个因素。我们简要介绍一下这两种选择：
- en: '**Provisioning**: The capacity and computing power of your EC2 instance. The
    main differentiating feature of each EC2 instance provisioning type is the computing
    power, which is expressed by vCPU (or CPU), memory (RAM), and storage (disk capacity).'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**配置**：您的 EC2 实例的容量和计算能力。每种 EC2 实例配置类型的主要区别在于计算能力，计算能力通过 vCPU（或 CPU）、内存（RAM）和存储（磁盘容量）来表示。'
- en: Some EC2 instance types also provide **graphical processing unit** (**GPU**)
    or **field programmable gate array** (**FPGA**) computing capabilities. A detailed
    view of EC2 instance provisioning types is beyond the scope of this chapter. You
    can explore the related information at [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html)
    or [https://aws.amazon.com/ec2/instance-types/](https://aws.amazon.com/ec2/instance-types/).
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 一些 EC2 实例类型还提供**图形处理单元**（**GPU**）或**现场可编程门阵列**（**FPGA**）计算能力。关于 EC2 实例配置类型的详细介绍超出了本章的范围。您可以访问
    [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html)
    或 [https://aws.amazon.com/ec2/instance-types/](https://aws.amazon.com/ec2/instance-types/)
    探索相关信息。
- en: '`type` and `region`'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`type` 和 `region`'
- en: '**Spot instances**: These EC2 instances are available for reuse at a lower
    price than on-demand instances'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**抢占实例**：这些 EC2 实例的价格低于按需实例，且可供重新使用。'
- en: '**Dedicated instances**: These EC2 instances run in a **virtual private cloud**
    (**VPC**) assigned to a single-payer account'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**专用实例**：这些 EC2 实例运行在为单一付款账户分配的**虚拟私有云**（**VPC**）中。'
- en: We’ll cover each of these EC2 instance types in the following sections. For
    each of these types, we’ll show an example of how to launch a corresponding instance.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在接下来的章节中介绍这些 EC2 实例类型。对于每种类型，我们将展示如何启动相应的实例。
- en: However, before creating an instance, we’ll look at another key concept regarding
    EC2 instances – **AZs**.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在创建实例之前，我们将先了解关于 EC2 实例的另一个关键概念——**可用区**（AZ）。
- en: EC2 AZs
  id: totrans-36
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: EC2 可用区（AZ）
- en: 'The AWS EC2 service is available in multiple locations around the globe, known
    as **Regions**. Here are some examples of Regions:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: AWS EC2 服务在全球多个地点提供，称为**区域**。以下是一些区域的例子：
- en: '`us-west-2`)'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`us-west-2`)'
- en: '`ap-south-1`)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ap-south-1`)'
- en: EC2 defines multiple AZs in a Region, which are essentially one or more data
    centers. Regions are entirely isolated from each other in terms of the underlying
    infrastructure to provide fault tolerance and high availability. If a Region becomes
    unavailable, only the EC2 instances within the affected Region are unreachable.
    Other Regions with their EC2 instances will continue to work uninterrupted.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: EC2 在一个区域定义了多个可用区（AZ），这些可用区本质上是一个或多个数据中心。区域之间的基础设施完全隔离，以提供故障容忍和高可用性。如果一个区域不可用，只有该区域内的
    EC2 实例无法访问。其他区域及其 EC2 实例将继续正常运行。
- en: Similarly, AZs are connected while providing highly available and fault-tolerant
    EC2 services within a Region. Launching an EC2 instance creates it in the current
    Region selected in the AWS console. An AWS EC2 administrator may switch between
    different Regions when managing EC2 instances. Only instances within the selected
    Region are visible in the EC2 administration console. An EC2 administrator will
    usually choose a Region based on the geographical location of the users accessing
    the EC2 instance.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，在提供高可用性和容错的 EC2 服务时，AZs 之间是相互连接的。启动一个 EC2 实例时，它会在 AWS 控制台中选定的当前区域创建。AWS
    EC2 管理员可以在管理 EC2 实例时在不同区域之间切换。只有所选区域内的实例才会在 EC2 管理控制台中显示。EC2 管理员通常会根据访问 EC2 实例的用户地理位置来选择一个区域。
- en: Now that we have preliminary knowledge of various EC2 instance types, let’s
    look at on-demand instances.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经对各种 EC2 实例类型有了初步了解，让我们来看看按需实例。
- en: EC2 on-demand instances
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: EC2 按需实例
- en: AWS EC2 **on-demand instances** use a *pay-as-you-go* pricing model for resource
    usage per second, without a long-time contract. On-demand instances are best suited
    for experimenting with uncertain workloads where the resource usage is not fully
    known (such as during development). The flexibility of these on-demand instances
    comes with a higher price than reserved instances, for example.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: AWS EC2 **按需实例**采用*按需付费*定价模式，按秒计费，无需长期合同。按需实例最适合用于实验性的不确定工作负载，尤其是在资源使用量不完全确定的情况下（例如在开发过程中）。与预留实例相比，这些按需实例的灵活性虽然较高，但价格也更贵。
- en: 'Let’s launch an on-demand instance:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们启动一个按需实例：
- en: 'First, we must log into our AWS account console at [https://console.aws.amazon.com](https://console.aws.amazon.com).
    The following screenshot shows the default console view, where you will have information
    about the user (**1**), the Region (**2**), and the available – or recently visited
    – services (**3**):'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们必须登录到我们的 AWS 账户控制台，网址为 [https://console.aws.amazon.com](https://console.aws.amazon.com)。下图显示了默认控制台视图，在这里你可以看到用户信息（**1**）、区域（**2**）以及可用的（或最近访问的）服务（**3**）：
- en: '![Figure 15.1 – The AWS management console](img/B19682_15_01.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.1 – AWS 管理控制台](img/B19682_15_01.jpg)'
- en: Figure 15.1 – The AWS management console
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.1 – AWS 管理控制台
- en: 'Next, we must select the EC2 service from the list on the left-hand side, as
    shown in the preceding screenshot. This will lead us to the EC2 dashboard interface,
    as follows:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们必须从左侧列表中选择 EC2 服务，如上图所示。这将引导我们进入 EC2 仪表盘界面，如下所示：
- en: '![Figure 15.2 – The EC2 dashboard](img/B19682_15_02.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.2 – EC2 仪表盘](img/B19682_15_02.jpg)'
- en: Figure 15.2 – The EC2 dashboard
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.2 – EC2 仪表盘
- en: The **Launch instance** button, as shown in the preceding screenshot, will begin
    the step-by-step process of creating our on-demand instance. This will lead us
    to a new interface where we can provide the main configuration options on our
    new instance, such as its name, operating system to use, instance type, login
    key pair, network, and storage settings.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 如上图所示，**启动实例**按钮将启动创建按需实例的逐步过程。这将引导我们进入一个新界面，我们可以在其中提供新实例的主要配置选项，如名称、操作系统、实例类型、登录密钥对、网络和存储设置。
- en: 'Next, we need to choose a name and a tag. First, we will choose a name for
    our instance. In our case, we set the name to `aws_packt_testing_1`:'
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要选择一个名称和标签。首先，我们将为实例选择一个名称。在我们的案例中，我们将名称设置为 `aws_packt_testing_1`：
- en: '![Figure 15.3 – Giving a name to the new EC2 instance](img/B19682_15_03.jpg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.3 – 为新 EC2 实例命名](img/B19682_15_03.jpg)'
- en: Figure 15.3 – Giving a name to the new EC2 instance
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.3 – 为新 EC2 实例命名
- en: 'Alternatively, we can add a new tag. To do this, we must click `env` and a
    value of `packt`. We can add multiple tags (key-value pairs) to a given instance
    if we need to:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，我们可以添加一个新标签。为此，我们必须点击 `env` 并设置值为 `packt`。如果需要，我们可以为给定的实例添加多个标签（键值对）：
- en: '![Figure 15.4 – Adding tags to an EC2 instance](img/B19682_15_04.jpg)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.4 – 向 EC2 实例添加标签](img/B19682_15_04.jpg)'
- en: Figure 15.4 – Adding tags to an EC2 instance
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.4 – 向 EC2 实例添加标签
- en: 'Next, we must choose an operating system. We’ll select Ubuntu 22.04 LTS as
    our Linux distribution for the new EC2 instance, as shown in the following screenshot:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们必须选择一个操作系统。我们将选择 Ubuntu 22.04 LTS 作为新 EC2 实例的 Linux 发行版，如下图所示：
- en: '![Figure 15.5 – Choosing the operating system for the EC2 instance](img/B19682_15_05.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.5 – 为 EC2 实例选择操作系统](img/B19682_15_05.jpg)'
- en: Figure 15.5 – Choosing the operating system for the EC2 instance
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.5 – 为 EC2 实例选择操作系统
- en: There are other operating systems to choose from, including macOS, Microsoft
    Windows, and Linux distributions such as Red Hat Enterprise Linux, SUSE Linux
    Enterprise, or Debian Linux, alongside Amazon Linux and Ubuntu.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他操作系统可供选择，包括 macOS、Microsoft Windows 和 Linux 发行版，如 Red Hat Enterprise Linux、SUSE
    Linux Enterprise 或 Debian Linux，以及 Amazon Linux 和 Ubuntu。
- en: 'Now, we can choose an instance type. Here, we’ll select the instance type based
    on our provisioning needs. In our case, we will select the **t2.micro** type,
    with 1 vCPU and 1 GB of memory:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以选择一个实例类型。在这里，我们将根据我们的配置需求选择实例类型。在我们的案例中，我们将选择 **t2.micro** 类型，配有 1 个
    vCPU 和 1 GB 内存：
- en: '![Figure 15.6 – Choosing an instance type – the t2.micro](img/B19682_15_06.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.6 – 选择实例类型 – t2.micro](img/B19682_15_06.jpg)'
- en: Figure 15.6 – Choosing an instance type – the t2.micro
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.6 – 选择实例类型 – t2.micro
- en: 'Under **Network settings**, we will leave the default settings unchanged for
    now:'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **网络设置** 下，我们将暂时保持默认设置不变：
- en: '![Figure 15.7 – Setting up the network for the new EC2 instance](img/B19682_15_07.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.7 – 设置新 EC2 实例的网络](img/B19682_15_07.jpg)'
- en: Figure 15.7 – Setting up the network for the new EC2 instance
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.7 – 设置新 EC2 实例的网络
- en: 'The next step is to configure storage. By default, the EC2 instance provides
    an 8 GB SSD volume, but you can set it up to 30 GB while using the free tier.
    We will use it with the default 8 GB:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是配置存储。默认情况下，EC2 实例提供一个 8 GB 的 SSD 卷，但在使用免费套餐时，你可以将其设置为 30 GB。我们将使用默认的 8 GB：
- en: '![Figure 15.8 – Setting up storage for the EC2 instance](img/B19682_15_08.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.8 – 设置 EC2 实例的存储](img/B19682_15_08.jpg)'
- en: Figure 15.8 – Setting up storage for the EC2 instance
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.8 – 为EC2实例设置存储
- en: 'The last step before launching the new EC2 instance is to review the detailed
    summary provided and decide if there are any other changes to be made. Once the
    new instance has been tailored to our needs, we can create it by clicking on the
    **Launch instance** button, as shown in the following screenshot:'
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动新EC2实例的最后一步是查看提供的详细摘要，并决定是否需要进行其他更改。一旦新实例根据我们的需求进行定制，就可以通过点击**启动实例**按钮来创建它，如下图所示：
- en: '![Figure 15.9 – Summary of the new EC2 instance and the Launch instance button](img/B19682_15_09.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![图15.9 – 新EC2实例和启动实例按钮的总结](img/B19682_15_09.jpg)'
- en: Figure 15.9 – Summary of the new EC2 instance and the Launch instance button
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.9 – 新EC2实例和启动实例按钮的总结
- en: At this point, we are ready to launch our instance by pressing the **Launch
    instance** button. Alternatively, we could follow further configuration steps
    by revisiting the previous steps; otherwise, EC2 will assign some default values.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们已经准备好通过按下**启动实例**按钮来启动实例。或者，我们可以通过重新访问前面的步骤来继续进行其他配置，否则EC2将分配一些默认值。
- en: 'When launching the EC2 instance, we will be asked to create or select a certificate
    key pair for remote SSH access into our instance. This will highlight the key
    pair section on the screen, where we can click on the `packt_aws_key`, select
    the **RSA** type and the **.pem** file format, and then click on the **Create
    key pair** button in the lower right corner:'
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动EC2实例时，我们需要创建或选择一个证书密钥对，以进行远程SSH访问实例。此时，屏幕上会高亮显示密钥对部分，我们可以点击`packt_aws_key`，选择**RSA**类型和**.pem**文件格式，然后点击右下角的**创建密钥对**按钮：
- en: '![Figure 15.10 – Selecting or creating a certificate key pair for SSH access](img/B19682_15_10.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![图15.10 – 选择或创建用于SSH访问的证书密钥对](img/B19682_15_10.jpg)'
- en: Figure 15.10 – Selecting or creating a certificate key pair for SSH access
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.10 – 选择或创建用于SSH访问的证书密钥对
- en: You will be automatically asked to download the new `.pem` file to a location
    on your local machine.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 系统会自动提示你将新生成的`.pem`文件下载到本地机器上的某个位置。
- en: 'Download the related file (`packt-ec2.pem`) to a secure location on your local
    machine, where you can use it with the `ssh` command to access your EC2 instance:'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将相关文件（`packt-ec2.pem`）下载到本地机器的安全位置，在那里你可以使用`ssh`命令访问EC2实例：
- en: '[PRE0]'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![Figure 15.11 – An EC2 instance in the running state](img/B19682_15_11.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![图15.11 – 处于运行状态的EC2实例](img/B19682_15_11.jpg)'
- en: Figure 15.11 – An EC2 instance in the running state
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.11 – 处于运行状态的EC2实例
- en: For more information about on-demand instances, please visit [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-on-demand-instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-on-demand-instances.html).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 有关按需实例的更多信息，请访问 [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-on-demand-instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-on-demand-instances.html)。
- en: Now that we have learned the basics of launching an on-demand instance, let’s
    look at reserved instances.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经学习了启动按需实例的基础知识，让我们来看看预留实例。
- en: EC2 reserved instances
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: EC2预留实例
- en: 'With **reserved instances**, we lease the EC2 computing capacity of a specific
    type for a specific amount of time. This length of time is called a **term** and
    can either be a 1-year or a 3-year commitment. Here are the main characteristics
    that need to be set upfront when purchasing reserved instances, as shown in *Figure
    15**.12*:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 使用**预留实例**时，我们租用特定类型的EC2计算能力，租期为特定时间。这段时间被称为**期限**，可以是1年或3年的承诺。购买预留实例时需要提前设置的主要特征如*图15.12*所示：
- en: '**Platform**: An example of this is **Linux**.'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**平台**：例如，**Linux**。'
- en: '**Tenancy**: Running on **Default** (shared) or **Dedicated** hardware.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**租赁方式**：运行在**默认**（共享）或**专用**硬件上。'
- en: '**Offering Class**: These are the types of reserved instances that are available.
    The options are as follows:'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**提供类别**：这些是可用的预留实例类型。选项如下：'
- en: '**Standard**: A plain reserved instance with a well-defined set of options'
  id: totrans-91
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准**：一个简单的预留实例，具有明确的一组选项'
- en: '**Convertible**: It allows specific changes, such as modifying the instance
    type (for example, from **t2.large** to **t2.xlarge**)'
  id: totrans-92
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可转换**：它允许进行特定的更改，例如修改实例类型（例如，从**t2.large**更改为**t2.xlarge**）'
- en: '**Instance Type**: An example of this is **t2.large**.'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实例类型**：例如，**t2.large**。'
- en: '**Term**: For example, **1 year.**'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**期限**：例如，**1年**。'
- en: '**Payment option**: **All upfront**, **Partial upfront**, **No upfront**.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**支付选项**：**全部提前支付**，**部分提前支付**，**无提前支付**。'
- en: With each of these options and the different tiers within, your costs depend
    on the cloud computing resources involved and the duration of the service. For
    example, if you choose to pay all upfront, you’ll get a better discount than otherwise.
    Choosing from among the options previously mentioned is ultimately an exercise
    in cost-saving and flexibility.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在这些选项及其不同等级中，你的费用取决于涉及的云计算资源以及服务的持续时间。例如，如果你选择提前支付全部费用，你将获得比其他方式更好的折扣。从前面提到的选项中选择，最终是为了节省成本和提高灵活性。
- en: A close analogy to purchasing reserved instances is a *mobile telephone plan*
    – you decide on all the options you want, and then you commit a certain amount
    of time. With reserved instances, you get less flexibility in terms of making
    changes, but with significant savings in cost – sometimes up to 75%, compared
    to on-demand instances.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 购买保留实例的一个类比是 *移动电话套餐* —— 你决定所有想要的选项，然后承诺一定时间。对于保留实例，你在做更改时的灵活性较小，但可以节省大量成本——有时与按需实例相比，最多可节省
    75%。
- en: 'To launch a reserved instance, go to your EC2 dashboard in the AWS console
    and choose **Reserved Instances** under **Instances** in the left panel, then
    click on the **Purchase Reserved Instances** button. Here is an example of purchasing
    a reserved EC2 instance:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动一个保留实例，进入 AWS 控制台中的 EC2 仪表板，在左侧面板的 **实例** 下选择 **保留实例**，然后点击 **购买保留实例** 按钮。以下是购买保留
    EC2 实例的示例：
- en: '![Figure 15.12 – Purchasing a reserved EC2 instance](img/B19682_15_12.jpg)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.12 —— 购买保留 EC2 实例](img/B19682_15_12.jpg)'
- en: Figure 15.12 – Purchasing a reserved EC2 instance
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.12 —— 购买保留 EC2 实例
- en: For more information about EC2 reserved instances, please visit [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-reserved-instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-reserved-instances.html).
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 关于 EC2 保留实例的更多信息，请访问 [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-reserved-instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-reserved-instances.html)。
- en: We have learned that reserved instances are a cost-effective alternative to
    on-demand EC2 instances. Now, let’s take our journey further and look at yet another
    way to reduce the costs by using spot instances.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经了解到，保留实例是按需 EC2 实例的一个经济实惠的替代方案。现在，让我们进一步了解另一种通过使用 Spot 实例来降低成本的方法。
- en: EC2 spot instances
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: EC2 Spot 实例
- en: A **spot instance** is an unused instance waiting to be leased. The amount of
    time a spot instance is vacant and at your disposal depends on the general availability
    of the requested capacity in EC2, given that the associated costs are not higher
    than the amount you are willing to pay for your spot instance. AWS advertises
    spot instances with an up to 90% discount compared to on-demand EC2 pricing.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '**Spot 实例**是一个空闲实例，等待被租用。Spot 实例的空闲时间以及是否可供你使用，取决于 EC2 中所请求的容量的总体可用性，前提是相关成本不超过你愿意为
    Spot 实例支付的金额。AWS 宣传的 Spot 实例相较于按需 EC2 定价，最多可享受 90% 的折扣。'
- en: The major caveat of using spot instances is the potential *no-vacancy* situation
    when the required capacity is no longer available at the initially agreed-upon
    rate. In such circumstances, the spot instance will shut down (and perhaps be
    leased elsewhere). AWS EC2 is kind enough to give a 2-minute warning before stopping
    the spot instance. This time should be used to properly tear down the application
    workflows running within the instance.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Spot 实例的主要警告是，当所需容量不再按最初商定的价格提供时，可能会出现 *没有空位* 的情况。在这种情况下，Spot 实例将停止（并可能会被租赁到其他地方）。AWS
    EC2 会在停止 Spot 实例前提供 2 分钟的预警。这个时间应当用于妥善关闭实例内运行的应用程序工作流。
- en: Spot instances are best suited for non-critical tasks, where application processing
    could be inadvertently interrupted at any moment and resumed later, without considerable
    damage or data loss. Such jobs may include data analysis, batch processing, and
    optional tasks.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: Spot 实例最适合非关键任务，在这种情况下，应用处理可能会随时被中断，并可以稍后恢复，而不会造成重大损害或数据丢失。这类任务可能包括数据分析、批处理和可选任务。
- en: To launch a spot instance, go to your **EC2** dashboard and choose **Spot Requests**
    in the left-hand menu. Under **Instances**, click on **Request Spot Instances**
    and follow the steps described in the *EC2 on-demand* *instances* section.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动一个 Spot 实例，进入你的 **EC2** 仪表板，在左侧菜单中选择 **Spot 请求**。在 **实例** 下，点击 **请求 Spot
    实例**，并按照 *EC2 按需* *实例* 部分中描述的步骤操作。
- en: A detailed explanation of launching a spot instance is beyond the scope of this
    chapter. The AWS EC2 console does a great job of describing and assisting with
    the related options. For more information about spot instances, please visit [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-spot-instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-spot-instances.html).
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 启动抢占实例的详细说明超出了本章的范围。AWS EC2控制台在描述和协助相关选项方面做得非常好。如需了解有关抢占实例的更多信息，请访问[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-spot-instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-spot-instances.html)。
- en: We know that by default, EC2 instances run on shared hardware, meaning that
    instances owned by multiple AWS customers share the same machine (or virtual machine).
    But what if you wanted to have a dedicated platform to run your EC2 instances?
    We’ll look at dedicated instances next.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 我们知道，默认情况下，EC2实例运行在共享硬件上，这意味着多个AWS客户拥有的实例共享同一台机器（或虚拟机）。但如果你想拥有一个专用平台来运行你的EC2实例呢？接下来我们将介绍专用实例。
- en: EC2 dedicated instances
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: EC2专用实例
- en: Specific businesses require applications to run on dedicated hardware without
    them sharing the platform with anyone. AWS EC2 provides **dedicated hosts** and
    **dedicated instances** to accommodate this use case. As you may expect, dedicated
    instances would cost more than other instance types. So, why should we care about
    leasing such instances?
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 特定企业要求应用程序在专用硬件上运行，并且不与任何人共享平台。AWS EC2提供了**专用主机**和**专用实例**来满足这一需求。如你所料，专用实例的费用会比其他实例类型更高。那么，为什么我们要关注租赁这些实例呢？
- en: There are businesses – especially among financial, health, and governmental
    institutions – required by law to meet strict regulatory requirements for processing
    sensitive data or to acquire hardware-based licenses for running their applications.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 有些企业——特别是在金融、健康和政府机构中——需要依法满足严格的合规要求来处理敏感数据，或者需要获取基于硬件的许可证来运行他们的应用程序。
- en: With dedicated instances *without* a dedicated host, EC2 would guarantee that
    your applications run on a hypervisor exclusively dedicated to you, yet it would
    not enforce a fixed set of machines or hardware. In other words, some of your
    instances may run on different physical hosts. Choosing a dedicated host in addition
    to dedicated instances would always warrant a fully dedicated environment – hypervisors
    and hosts – for running your applications exclusively, without sharing the underlying
    platforms with other AWS customers.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有专用主机，专用实例的EC2会保证你的应用程序运行在专门为你提供的虚拟化管理程序上，但不会强制要求固定的机器或硬件。换句话说，你的一些实例可能会运行在不同的物理主机上。选择专用主机和专用实例将始终确保提供一个完全专用的环境——包括虚拟化管理程序和主机——用于专门运行你的应用程序，不与其他AWS客户共享底层平台。
- en: 'To launch a dedicated instance, you can follow these steps:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 启动专用实例时，你可以按照以下步骤进行：
- en: Start with the same steps that you performed for launching an on-demand EC2
    instance that were described earlier in this chapter, in the *EC2 on-demand* *instances*
    section.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从本章前面描述的启动按需EC2实例的相同步骤开始，参见*EC2按需* *实例*部分。
- en: 'You can add another step to the launching process. To do this, you must open
    the **Advanced details** drop-down section and scroll to the **Tenancy** option,
    where you must choose **Dedicated – run a dedicated instance**, as shown in the
    following screenshot:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以在启动过程中添加另一个步骤。为此，你必须打开**高级详情**下拉部分，并滚动到**租用方式**选项，在那里你必须选择**专用 – 运行专用实例**，如下面的截图所示：
- en: '![Figure 15.13 – Launching a dedicated EC2 instance](img/B19682_15_13.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![图15.13 – 启动专用EC2实例](img/B19682_15_13.jpg)'
- en: Figure 15.13 – Launching a dedicated EC2 instance
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.13 – 启动专用EC2实例
- en: 'If you want to run your dedicated instance on a dedicated host, you must create
    a dedicated host first. To do this, on the **EC2** dashboard, navigate to **Instances**
    | **Dedicated Hosts**:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你想在专用主机上运行专用实例，你必须先创建一个专用主机。为此，在**EC2**仪表板中，导航到**实例** | **专用主机**：
- en: '![Figure 15.14 – Creating a dedicated EC2 host](img/B19682_15_14.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![图15.14 – 创建专用EC2主机](img/B19682_15_14.jpg)'
- en: Figure 15.14 – Creating a dedicated EC2 host
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.14 – 创建专用EC2主机
- en: Follow the EC2 wizard to allocate your dedicated host according to your preferences.
    After creating your host, you may launch your dedicated instance as described
    previously and choose the **Dedicated host – launch this instance on a dedicated
    Host** option for **Tenancy**, as shown in *step 2*.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照 EC2 向导的步骤，根据你的偏好分配专用主机。创建主机后，你可以按照之前的步骤启动专用实例，并选择 **专用主机 – 在专用主机上启动此实例**
    作为 **租用方式**，如 *步骤 2* 所示。
- en: For more information on dedicated hosts, please visit [https://aws.amazon.com/ec2/dedicated-hosts/](https://aws.amazon.com/ec2/dedicated-hosts/).
    For dedicated instances, see [https://aws.amazon.com/ec2/pricing/dedicated-instances/](https://aws.amazon.com/ec2/pricing/dedicated-instances/).
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 有关专用主机的更多信息，请访问[https://aws.amazon.com/ec2/dedicated-hosts/](https://aws.amazon.com/ec2/dedicated-hosts/)。关于专用实例的详细信息，请参见[https://aws.amazon.com/ec2/pricing/dedicated-instances/](https://aws.amazon.com/ec2/pricing/dedicated-instances/)。
- en: We’ll conclude our journey through AWS EC2 instance types here. For more information,
    please visit [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Instances.html).
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在这里结束 AWS EC2 实例类型的学习之旅。更多信息，请访问[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Instances.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Instances.html)。
- en: Next, we’ll look at one of the two essential EC2 deployment features that allow
    you to be proficient and resourceful when deploying and scaling your EC2 instances
    – **Amazon Machine Images** (**AMIs**) and **placement groups**. We will only
    discuss placement groups in this chapter. For more information about AMIs, please
    visit [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html).
    Placement groups control how your instances are spread across the EC2 infrastructure
    for high availability and optimized workloads. We’ll discuss this next.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探讨 EC2 部署的两个关键功能之一，这些功能能够帮助你在部署和扩展 EC2 实例时变得更加高效和资源丰富——**Amazon 机器镜像**（**AMIs**）和**放置组**。本章我们将只讨论放置组。有关
    AMI 的更多信息，请访问[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html)。放置组控制着实例如何在
    EC2 基础设施中分布，以实现高可用性和优化工作负载。接下来我们将讨论这个内容。
- en: Introducing AWS EC2 placement groups
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍 AWS EC2 放置组
- en: '**Placement groups** allow you to specify how your EC2 instances are placed
    across the underlying EC2 hardware or hypervisors, providing strategies to group
    or separate instances depending on your requirements. Placement groups are offered
    free of charge.'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '**放置组**允许你指定 EC2 实例在底层 EC2 硬件或虚拟机监控器上的放置方式，根据你的需求提供将实例分组或分开的策略。放置组是免费的。'
- en: 'There are three types of placement groups to choose from. Let’s quickly go
    through each of these types and look at their use cases:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 有三种放置组可供选择。让我们快速浏览一下这些类型，并查看它们的使用场景：
- en: '**Cluster placement groups**: With cluster placement groups, instances are
    placed within a single AZ (data center). They are best suited for low-latency,
    high-throughput communication between instances, but not with the outside world.
    Applications with high-performance computing or data replication would greatly
    benefit from cluster placement, but web servers, for example, not so much.'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集群放置组**：在集群放置组中，实例被放置在同一个可用区（数据中心）内。它们最适合低延迟、高吞吐量的实例间通信，但不适用于与外部世界的通信。具有高性能计算或数据复制的应用程序会从集群放置中受益，但例如
    web 服务器则不太适用。'
- en: '**Spread placement groups**: When you launch multiple EC2 instances, there’s
    always a possibility that they may end up running on the same physical machine
    or hypervisor. This may not be desirable when a single point of failure (such
    as hardware) would be critical for your applications. Spread placement groups
    provide hardware isolation between instances. In other words, if you launch multiple
    instances in a spread placement group, there’s a guarantee that they will run
    on separate physical machines. In the rare case of an EC2 hardware failure, only
    one of your instances would be affected.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分布式放置组**：当你启动多个 EC2 实例时，它们可能会运行在同一台物理机器或虚拟机监控器上。如果单点故障（如硬件故障）对应用程序至关重要，这种情况可能不太理想。分布式放置组为实例之间提供硬件隔离。换句话说，如果你在分布式放置组中启动多个实例，系统保证它们将运行在不同的物理机器上。在罕见的
    EC2 硬件故障情况下，只有一个实例会受到影响。'
- en: '**Partition placement groups**: Partition placement groups will group your
    instances in logical formations (partitions) with hardware isolation between the
    partitions, but not at the instance level. We can view this model as a hybrid
    between the cluster and spread placement groups. When you launch multiple instances
    within a partition placement group, EC2 will do its best to distribute the instances
    between partitions evenly. For example, if you had four partitions and 12 instances,
    EC2 would place three instances in each node (partition). We can look at a partition
    as a computing unit made of multiple instances. In the case of a hardware failure,
    the isolated partition instances can still communicate with each other but not
    across partitions. Partition placement groups support up to seven instances in
    a single logical partition.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分区放置组**：分区放置组将您的实例按逻辑方式分组（分区），并在分区之间提供硬件隔离，但不在实例级别进行隔离。我们可以将这种模式视为集群放置组和扩展放置组的混合体。当您在分区放置组内启动多个实例时，EC2会尽力在分区之间均匀分配实例。例如，如果您有四个分区和12个实例，EC2会将每个节点（分区）放置三个实例。我们可以将分区视为由多个实例组成的计算单元。在发生硬件故障时，隔离的分区实例仍然可以相互通信，但不能跨分区进行通信。分区放置组最多支持一个逻辑分区内的七个实例。'
- en: 'To create a placement group, navigate to **Network & Security** | **Placement
    Groups** in your **EC2** dashboard’s left menu and click on the **Create Placement
    Group** button. On the next screen, you must specify a name for the **Placement
    Group** option, as well as a **Placement Strategy** value. Optionally, you can
    add tags (key-value pairs) for organizing or identifying your placement group.
    When you’re done, click the **Create** **group** button:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个放置组，请在**EC2**仪表板左侧菜单中导航至**网络与安全** | **放置组**，然后点击**创建放置组**按钮。在接下来的界面中，您必须为**放置组**选项指定一个名称，并设置一个**放置策略**值。您还可以选择添加标签（键值对），用于组织或标识您的放置组。完成后，点击**创建**
    **组**按钮：
- en: '![Figure 15.15 – Creating a placement group](img/B19682_15_15.jpg)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.15 – 创建放置组](img/B19682_15_15.jpg)'
- en: Figure 15.15 – Creating a placement group
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.15 – 创建放置组
- en: For more information on EC2 placement groups, please visit [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/placement-groups.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/placement-groups.html).
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 如需了解更多有关EC2放置组的信息，请访问[https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/placement-groups.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/placement-groups.html)。
- en: Now that we are familiar with various EC2 instance types, let’s look at how
    to use our instances.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经熟悉了各种EC2实例类型，接下来让我们看看如何使用我们的实例。
- en: Using AWS EC2 instances
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用AWS EC2实例
- en: In this section, we’ll briefly go through some essential operations and management
    concepts regarding your instances. First, we’ll look at the life cycle of an EC2
    instance.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将简要介绍一些关于实例的基本操作和管理概念。首先，我们将了解EC2实例的生命周期。
- en: The life cycle of an EC2 instance
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: EC2实例的生命周期
- en: 'When using or managing EC2 instances, it is important to understand the transitional
    stages, from launch to running to hibernation, shutdown, or termination. Each
    of these states affects billing and the way we access our instances:'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用或管理EC2实例时，了解从启动到运行，再到休眠、关机或终止的过渡阶段非常重要。每个状态都会影响计费以及我们访问实例的方式：
- en: '![Figure 15.16 – The life cycle of an EC2 instance](img/B19682_15_16.jpg)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.16 – EC2实例的生命周期](img/B19682_15_16.jpg)'
- en: Figure 15.16 – The life cycle of an EC2 instance
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.16 – EC2实例的生命周期
- en: 'Let’s break this down:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们详细了解一下：
- en: The **PENDING** state corresponds to the boot-up and initialization phase of
    our instance.
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**PENDING**状态对应于实例的启动和初始化阶段。'
- en: Transitioning from **PENDING** to **RUNNING** is not always immediate, and it
    may take a while for the applications running within the instance to become responsive.
    EC2 starts billing our instance in the **RUNNING** state until transitioning to
    the **STOPPED** state.
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从**PENDING**到**RUNNING**的过渡并非总是立刻发生，实例内运行的应用程序可能需要一段时间才能响应。EC2会在实例处于**RUNNING**状态时开始计费，直到过渡到**STOPPED**状态。
- en: In the **RUNNING** state, we can reboot our instance if needed. During the **REBOOTING**
    state, EC2 always brings back our instance on the same host, whereas stopping
    and restarting doesn’t always guarantee the same host for the instance.
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在**RUNNING**状态下，我们可以根据需要重启实例。在**REBOOTING**状态下，EC2始终会在同一主机上重启实例，而停止并重新启动并不总是能保证实例仍在同一主机上。
- en: In the **STOPPED** state, we’ll no longer be charged for the instance, but there
    will be costs related to any additional storage (other than the root volume) attached
    to the instance.
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 **停止（STOPPED）** 状态下，我们将不再为实例收费，但与实例附加的任何额外存储（根卷除外）仍然会产生费用。
- en: When the instance is no longer required, we may choose between the **STOPPING**
    or **HIBERNATING** states. With **HIBERNATING**, we avoid the **PENDING** state’s
    potential latency upon startup. If we no longer use the instance, we may decide
    to terminate it. Upon termination, there are no more charges related to the instance.
    When terminating an instance, it may still show up for a little while in the EC2
    dashboard before it gets permanently removed.
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当实例不再需要时，我们可以选择 **停止（STOPPING）** 或 **休眠（HIBERNATING）** 状态。通过 **休眠（HIBERNATING）**，我们避免了
    **待处理（PENDING）** 状态启动时可能出现的延迟。如果我们不再使用实例，可以选择终止它。终止后，实例将不再产生任何费用。终止实例时，可能会在 EC2
    仪表板中显示一段时间，直到其被永久移除。
- en: We can connect to an EC2 instance in a running state using SSH. In the next
    section, we’ll show you how.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用 SSH 连接到处于运行状态的 EC2 实例。在下一节中，我们将向你展示如何操作。
- en: Connecting to AWS EC2 instances
  id: totrans-150
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 连接到 AWS EC2 实例
- en: 'EC2 instances, in general, serve the purpose of running a specific application
    or a group of applications. The related platform’s administration and maintenance
    usually require terminal access. The way to access these instances (or any other
    service) is determined by how AWS differentiates the available services into two
    different concepts, similar to the ones used in networking – control plane and
    data plane. These are concepts that represent how EC2 instances can be accessed:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，EC2 实例的目的是运行特定的应用程序或一组应用程序。相关平台的管理和维护通常需要终端访问。访问这些实例（或任何其他服务）的方式由 AWS 如何将可用服务区分为两个不同的概念来决定，这些概念类似于网络中的控制平面和数据平面。这些概念代表了如何访问
    EC2 实例：
- en: '**Control plane (or management plane) access**: Using the AWS EC2 console and
    the SSH terminal, we perform administrative tasks on EC2 instances.'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**控制平面（或管理平面）访问**：使用 AWS EC2 控制台和 SSH 终端，我们可以对 EC2 实例执行管理任务。'
- en: '**Data plane access**: Applications running on EC2 instances may also expose
    their specific endpoints (ports) for communicating with the outside world. EC2
    uses security groups to control the related network traffic.'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据平面访问**：运行在 EC2 实例上的应用程序也可能暴露其特定的端点（端口）以便与外部世界进行通信。EC2 使用安全组来控制相关的网络流量。'
- en: In this section, we’ll briefly look at both control plane and data plane access.
    In particular, we’ll discuss how to connect to an EC2 instance using SSH and how
    to use SCP for file transfer with EC2 instances.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将简要了解控制平面和数据平面访问。特别是，我们将讨论如何使用 SSH 连接到 EC2 实例以及如何使用 SCP 进行文件传输。
- en: Connecting via SSH to an EC2 instance
  id: totrans-155
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 通过 SSH 连接到 EC2 实例
- en: 'In control plane access mode, using SSH with our EC2 instance allows us to
    manage it like any on-premises machine on a network. The related SSH command is
    as follows:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在控制平面访问模式下，使用 SSH 与我们的 EC2 实例连接允许我们像管理任何本地网络机器一样管理它。相关的 SSH 命令如下：
- en: '[PRE1]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Let’s break this down to understand it better:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分解这个过程，以便更好地理解：
- en: '`SSH_KEY` represents the private key file on our local system that we created
    and downloaded when launching our instance. See the *EC2 on-demand instances*
    section for more details.'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`SSH_KEY` 代表我们在启动实例时创建并下载的本地系统上的私钥文件。更多详细信息请参见 *EC2 按需实例* 部分。'
- en: '`ec2-user` is the default user assigned by EC2 to our AMI Linux instance. Different
    AMIs may have different usernames to connect with. You should check with the AMI
    vendor of your choice about the default username to use with SSH. For example,
    when using `ec2-user`, when using `ubuntu`, and when using `admin`.'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ec2-user` 是 EC2 默认分配给我们 AMI Linux 实例的用户。不同的 AMI 可能有不同的用户名来进行连接。你应该向你选择的 AMI
    提供商查询默认的 SSH 用户名。例如，使用 `ec2-user`，使用 `ubuntu`，以及使用 `admin`。'
- en: '`EC2_INSTANCE` represents the public IP address or DNS name of our EC2 instance.
    You can find this in the EC2 dashboard for your instance:'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`EC2_INSTANCE` 代表我们 EC2 实例的公共 IP 地址或 DNS 名称。你可以在 EC2 仪表板中找到此信息：'
- en: '![Figure 15.17 – The public IP address and DNS name of an EC2 instance](img/B19682_15_17.jpg)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.17 – EC2 实例的公共 IP 地址和 DNS 名称](img/B19682_15_17.jpg)'
- en: Figure 15.17 – The public IP address and DNS name of an EC2 instance
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.17 – EC2 实例的公共 IP 地址和 DNS 名称
- en: 'In our case, the SSH command is as follows:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，SSH 命令如下：
- en: '[PRE2]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'However, before we connect, we need to set the right permissions for our `private
    key` file so that it’s not publicly viewable:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在我们连接之前，我们需要为 `private key` 文件设置正确的权限，以确保它不会被公开查看：
- en: '[PRE3]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Failing to do this results in an unprotected key file error while attempting
    to connect.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 如果不这样做，在尝试连接时会出现未保护密钥文件的错误。
- en: 'A successful SSH connection to our EC2 instance yields the following output:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 成功的 SSH 连接到我们的 EC2 实例会显示以下输出：
- en: '![Figure 15.18 – Connecting with SSH to an EC2 instance](img/B19682_15_18.jpg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.18 – 通过 SSH 连接到 EC2 实例](img/B19682_15_18.jpg)'
- en: Figure 15.18 – Connecting with SSH to an EC2 instance
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.18 – 通过 SSH 连接到 EC2 实例
- en: At this point, we can interact with our EC2 instance as if it were a standard
    machine.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们可以像操作标准计算机一样与我们的 EC2 实例交互。
- en: Next, let’s look at how to transfer files from an EC2 instance.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们来看看如何从 EC2 实例传输文件。
- en: Using SCP for file transfer
  id: totrans-174
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用 SCP 进行文件传输
- en: To transfer files to and from an EC2 instance in data plane access mode, we
    must use the `scp` utility. `scp` uses the **Secure Copy Protocol** (**SCP**)
    to securely transfer files between network hosts.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 要在数据平面访问模式下将文件传输到 EC2 实例，我们必须使用 `scp` 工具。`scp` 使用 **安全复制协议** (**SCP**) 在网络主机之间安全地传输文件。
- en: 'The following command copies a local file (`README.md`) to our remote EC2 instance
    (so it must be run from our machine, not the EC2 instance):'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令将本地文件（`README.md`）复制到我们的远程 EC2 实例（因此它必须在我们的机器上运行，而不是在 EC2 实例上）：
- en: '[PRE4]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The file is copied to the `ubuntu` user’s home folder (`/home/ubuntu`) on the
    EC2 instance. The reverse operation of transferring the `README.md` file from
    the remote instance to our local directory is as follows:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 文件被复制到 EC2 实例上 `ubuntu` 用户的主文件夹（`/home/ubuntu`）。从远程实例传输 `README.md` 文件到本地目录的反向操作如下：
- en: '[PRE5]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Note that the `scp` command’s invocation is similar to `ssh`, where we specify
    the private key file (`aws/packt-ec2.pem`) via the `-i` (identity file) parameter.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，`scp` 命令的调用方式与 `ssh` 相似，我们通过 `-i`（身份文件）参数指定私钥文件（`aws/packt-ec2.pem`）。
- en: Next, we’ll look at yet another critical aspect of managing and scaling EC2
    instances – storage volumes.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探讨另一个管理和扩展 EC2 实例的关键方面——存储卷。
- en: Using EC2 storage volumes
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 EC2 存储卷
- en: '**Storage volumes** are device mounts within an EC2 instance that provide additional
    disk capacity (at extra cost). You may need additional storage for large file
    caches or extensive logging, for example, or you may choose to mount network-attached
    storage for critical data shared between your EC2 instances. You can think of
    EC2 storage volumes as *modular hard drives*. You mount or unmount them based
    on your needs.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: '**存储卷**是 EC2 实例中的设备挂载，提供额外的磁盘容量（需要额外费用）。例如，你可能需要更多的存储空间来缓存大文件或进行大量日志记录，或者你可能选择挂载网络附加存储以共享关键数据。你可以将
    EC2 存储卷视为*模块化硬盘*。根据需求，你可以挂载或卸载它们。'
- en: 'Two types of storage volumes are provided by EC2:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: EC2 提供两种类型的存储卷：
- en: '**Instance store**'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**实例存储**'
- en: '**Elastic Block** **Store** (**EBS**)'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**弹性块存储** (**EBS**)'
- en: Knowing how to use storage volumes allows you to make better decisions when
    scaling your applications as they grow. Let’s look at instance store volumes first.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 了解如何使用存储卷能帮助你在应用程序扩展时做出更好的决策。首先，让我们来看看实例存储卷。
- en: Introducing instance store volumes
  id: totrans-188
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 介绍实例存储卷
- en: Instance store volumes are disks that are directly (physically) attached to
    your EC2 instance. Consequently, the maximum size and number of instance store
    volumes you can connect to your instance are limited by the instance type. For
    example, a storage-optimized *i3* instance can have up to 8 x 1.9 TB SSD disks
    attached, while a general-purpose *m5d* instance may only grow up to four drives
    of 900 GB each. See [https://aws.amazon.com/ec2/instance-types/](https://aws.amazon.com/ec2/instance-types/)
    for more information on instance capacity.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 实例存储卷是直接（物理）附加到 EC2 实例的磁盘。因此，你可以连接到实例的最大实例存储卷数量和大小受到实例类型的限制。例如，存储优化型 *i3* 实例最多可以附加
    8 个 1.9 TB SSD 磁盘，而通用型 *m5d* 实例最多只能连接四个每个 900 GB 的磁盘。有关实例容量的更多信息，请参见 [https://aws.amazon.com/ec2/instance-types/](https://aws.amazon.com/ec2/instance-types/)。
- en: An instance store volume comes at no additional cost if it’s the root volume
    – the volume with the operating system platform booting the instance.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 如果实例存储卷是根卷，即用于启动实例的操作系统平台卷，则不会产生额外费用。
- en: Not all EC2 instance types support instance store volumes. For example, the
    general-purpose *t2* instance types only support EBS storage volumes. On the other
    hand, if you want to grow your storage beyond the maximum capacity allowed by
    the instance store, you’ll have to use EBS volumes. We’ll look at EBS volumes
    next.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有 EC2 实例类型都支持实例存储卷。例如，通用型的 *t2* 实例类型仅支持 EBS 存储卷。另一方面，如果你希望扩展存储，超出实例存储允许的最大容量，你将必须使用
    EBS 卷。接下来我们将讨论 EBS 卷。
- en: Introducing EBS volumes
  id: totrans-192
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 介绍 EBS 卷
- en: The data on instance store volumes only persists with your EC2 instance. If
    your instance stops or terminates, or there is a failure with it, all of your
    data is lost. To store and persist critical data with your EC2 instances, you’ll
    have to choose EBS.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 实例存储卷上的数据仅在你的 EC2 实例上持久化。如果你的实例停止、终止或发生故障，所有数据将丢失。要在 EC2 实例中存储和持久化关键数据，你必须选择
    EBS。
- en: EBS volumes are flexible and high-performing network-attached storage devices
    that serve both the root volume system and additional volume mounts on your EC2
    instance. An EBS root volume can only be attached to a single EC2 instance at
    a time while an EC2 instance can have multiple EBS volumes attached at any time.
    An EBS volume can also be attached to multiple EC2 instances at a time via *multi-attach*.
    For more information on EBS multi-attach, see [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes-multi.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes-multi.html).
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: EBS 卷是灵活且高性能的网络附加存储设备，既为根卷系统提供支持，也为你的 EC2 实例提供额外的卷挂载。一个 EBS 根卷一次只能附加到一个 EC2
    实例，而一个 EC2 实例可以随时附加多个 EBS 卷。通过 *多重附加*，一个 EBS 卷也可以同时附加到多个 EC2 实例。有关 EBS 多重附加的更多信息，请参见
    [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes-multi.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes-multi.html)。
- en: When you create an EBS volume, it will be automatically replicated within the
    AZ of your instance to minimize latency and data loss. With EBS, you get live
    monitoring of drive health and stats via Amazon CloudWatch free of charge. EBS
    also supports encrypted data storage to meet the latest regulatory standards for
    data encryption.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 当你创建 EBS 卷时，它会在你实例的可用区（AZ）内自动复制，以最小化延迟和数据丢失。使用 EBS，你可以通过 Amazon CloudWatch 免费监控磁盘健康状况和统计信息。EBS
    还支持加密数据存储，以满足最新的数据加密法规标准。
- en: EC2 storage volumes are backed by Amazon’s **Simple Storage Service** (**S3**)
    or **Elastic File System** (**EFS**) infrastructure. For more information on the
    different EC2 storage types, please visit [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Storage.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Storage.html).
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: EC2 存储卷由 Amazon 的 **简单存储服务** (**S3**) 或 **弹性文件系统** (**EFS**) 基础设施支持。有关不同 EC2
    存储类型的更多信息，请访问 [https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Storage.html](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Storage.html)。
- en: Now, let’s create and configure an EBS storage volume and attach it to our EC2
    instance.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们创建并配置一个 EBS 存储卷，并将其附加到我们的 EC2 实例。
- en: Configuring an EBS storage volume
  id: totrans-198
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 配置 EBS 存储卷
- en: 'Here are the steps we’ll follow, starting with creating the EBS volume:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我们将遵循的步骤，首先是创建 EBS 卷：
- en: 'In the **EC2** dashboard, go to **Volumes** under **Elastic Block Store** in
    the left navigation pane, and click on the **Create Volume** button at the top:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **EC2** 仪表板中，转到左侧导航窗格中的 **弹性块存储** 下的 **卷**，然后点击顶部的 **创建卷** 按钮：
- en: '![Figure 15.19 – Creating an EBS volume](img/B19682_15_19.jpg)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.19 – 创建 EBS 卷](img/B19682_15_19.jpg)'
- en: Figure 15.19 – Creating an EBS volume
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.19 – 创建 EBS 卷
- en: Enter the values of your choice for **Volume Type**, **Size**, and **Availability
    Zone**. Make sure you choose the AZ where your EC2 instances are. You could also
    include a **Snapshot ID** value if you want to restore the volume from a previous
    EC2 instance backup (snapshot). We’ll look at backup/restore using EBS snapshots
    later in this chapter.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入你选择的 **卷类型**、**大小** 和 **可用区** 的值。确保选择与你的 EC2 实例所在的 AZ 匹配的可用区。如果你希望从以前的 EC2
    实例备份（快照）恢复该卷，你还可以包含一个 **快照 ID** 值。稍后我们将在本章中讨论使用 EBS 快照进行备份/恢复。
- en: Press the **Create Volume** button when you’re done. You’ll get a **Volume created
    successfully** message that specifies your new EBS volume ID if all goes well.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后点击 **创建卷** 按钮。如果一切顺利，你将看到一个 **卷创建成功** 的消息，其中会指定你的新 EBS 卷 ID。
- en: 'Click on **Volume ID** or select the volume from the left navigation pane,
    under **Elastic Block Store** and **Volumes**. Click on the **Actions** button
    and choose **Attach Volume**:'
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **卷 ID** 或从左侧导航窗格中选择卷，在 **弹性块存储** 和 **卷** 下。点击 **操作** 按钮并选择 **附加卷**：
- en: '![Figure 15.20 – Attaching the EBS volume to an EC2 instance](img/B19682_15_20.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.20 – 将 EBS 卷附加到 EC2 实例](img/B19682_15_20.jpg)'
- en: Figure 15.20 – Attaching the EBS volume to an EC2 instance
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.20 – 将 EBS 卷附加到 EC2 实例
- en: 'On the next screen, enter your EC2 instance ID (or name tag to search for it)
    in the **Instance** field:'
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一个屏幕上，在 **实例** 字段中输入您的 EC2 实例 ID（或名称标签以搜索它）：
- en: '![Figure 15.21 – Entering the EC2 instance ID to attach the volume](img/B19682_15_21.jpg)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.21 – 输入 EC2 实例 ID 以附加卷](img/B19682_15_21.jpg)'
- en: Figure 15.21 – Entering the EC2 instance ID to attach the volume
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.21 – 输入 EC2 实例 ID 以附加卷
- en: Press the **Attach volume** button when you’re done. After a few moments, EC2
    will initialize your EBS volume, and **State** will change to **in-use**. The
    volume device is now ready, but we need to format it with a filesystem so that
    it can be used.
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成后，按下 **附加卷** 按钮。几秒钟后，EC2 将初始化您的 EBS 卷，**状态** 将变为 **正在使用**。卷设备现在已准备好，但我们需要格式化它以便可以使用。
- en: 'Let’s SSH into the EC2 instance where we attached the volume:'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们通过 SSH 连接到我们附加了卷的 EC2 实例：
- en: '[PRE6]'
  id: totrans-213
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: lsblk
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: lsblk
- en: '[PRE7]'
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![Figure 15.22 – The local volumes in our EC2 instance](img/B19682_15_22.jpg)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.22 – 我们 EC2 实例中的本地卷](img/B19682_15_22.jpg)'
- en: Figure 15.22 – The local volumes in our EC2 instance
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.22 – 我们 EC2 实例中的本地卷
- en: Looking at the size of the volumes, we can immediately tell the one we just
    added – `xvdf` with `1G`. The other volume (`xvda`) is the original root volume
    of our `t3.micro` instance.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 查看卷的大小，我们可以立即分辨出刚添加的那个 —— `xvdf`，大小为 `1G`。另一个卷（`xvda`）是我们 `t3.micro` 实例的原始根卷。
- en: 'Now, let’s check if our new EBS volume (`xvdf`) has a filesystem on it:'
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们检查一下我们的新 EBS 卷（`xvdf`）是否有文件系统：
- en: '[PRE8]'
  id: totrans-220
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Let’s build a filesystem on our volume using the `mkfs` (*make filesystem*)
    command-line utility:'
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们使用 `mkfs`（*创建文件系统*）命令行工具在我们的卷上创建文件系统：
- en: '[PRE9]'
  id: totrans-222
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'If we check the filesystem using the following command, we should see the filesystem
    details displayed instead of empty data:'
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们使用以下命令检查文件系统，我们应该能看到文件系统的详细信息，而不是空白数据：
- en: '[PRE10]'
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'The output of all the commands used to check and create a new filesystem is
    shown in the following screenshot:'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 用于检查和创建新文件系统的所有命令的输出如以下截图所示：
- en: '![Figure 15.23 – Creating a new filesystem](img/B19682_15_23.jpg)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.23 – 创建一个新的文件系统](img/B19682_15_23.jpg)'
- en: Figure 15.23 – Creating a new filesystem
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.23 – 创建一个新的文件系统
- en: The volume drive is now formatted.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 卷驱动器现在已格式化。
- en: 'Now, let’s make it accessible to our local filesystem. We’ll name our mount
    point `packt_drive` and create it in the root directory:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使它对我们的本地文件系统可访问。我们将把挂载点命名为 `packt_drive`，并在根目录中创建它：
- en: '[PRE11]'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![Figure 15.24 – Accessing the EBS volume](img/B19682_15_24.jpg)'
  id: totrans-231
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.24 – 访问 EBS 卷](img/B19682_15_24.jpg)'
- en: Figure 15.24 – Accessing the EBS volume
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.24 – 访问 EBS 卷
- en: Working with EBS volumes is similar to working with any volumes on Linux, so
    all the knowledge you’ve received from this chapter will be very useful when you’re
    working with Amazon EC2 instances. Now, let’s look at how to detach an EBS volume.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 EBS 卷类似于使用 Linux 上的任何卷，因此您在本章中获得的所有知识在处理 Amazon EC2 实例时都将非常有用。现在，让我们看看如何卸载一个
    EBS 卷。
- en: Detaching an EBS volume
  id: totrans-234
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 卸载 EBS 卷
- en: 'Before detaching any EBS volume, you need to unmount it. In our case, as we
    are already in the terminal and using the volume, we will type the following command
    to unmount the volume we use:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 在卸载任何 EBS 卷之前，您需要先卸载它。在我们的案例中，由于我们已经在终端中并正在使用该卷，我们将输入以下命令来卸载我们正在使用的卷：
- en: '[PRE12]'
  id: totrans-236
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Now that the volume has been unmounted, we can head to the EC2 dashboard and
    go to **Volumes**, select the corresponding **in-use** volume we want to detach,
    go to **Actions** in the top-right corner, and choose **Detach Volume**. Acknowledge
    the operation and wait for the volume to be detached.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，卷已被卸载，我们可以前往 EC2 控制台，进入 **卷**，选择要卸载的相应 **正在使用** 的卷，点击右上角的 **操作**，选择 **卸载卷**。确认操作并等待卷被卸载。
- en: We’re now at the final step of our backup-restore procedure – that is, attaching
    the new volume containing the snapshot to our EC2 instance.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在进入了备份恢复程序的最后一步——也就是将包含快照的新卷附加到我们的 EC2 实例。
- en: We’ll conclude our exploration of the AWS EC2 console and related management
    operations here. For a comprehensive reference on EC2, please refer to the Amazon
    EC2 documentation at [https://docs.aws.amazon.com/ec2](https://docs.aws.amazon.com/ec2).
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在这里结束对 AWS EC2 控制台及相关管理操作的探讨。如需关于 EC2 的全面参考，请查看 Amazon EC2 文档：[https://docs.aws.amazon.com/ec2](https://docs.aws.amazon.com/ec2)。
- en: The EC2 management tasks we’ve presented so far exclusively used the AWS web
    console. If you’re looking to automate your EC2 workloads, you may want to adopt
    the AWS CLI, which we’ll check out next.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们展示的 EC2 管理任务完全是通过 AWS Web 控制台来完成的。如果你希望自动化你的 EC2 工作负载，你可能想采用 AWS CLI，我们接下来将了解它。
- en: Working with the AWS CLI
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 AWS CLI
- en: The AWS CLI is a unified tool for managing AWS resources. This tool was created
    so that we can manage all the AWS services from a terminal session on our local
    machine. Compared to the AWS web console, which offers visual tools through the
    web browser, the AWS CLI (as its name states) offers all the functionalities inside
    your terminal program on your machine. The AWS CLI is available for all major
    operating systems, such as Linux, macOS, and Windows. In the next section, we
    will show you how to install it on your Linux local machine.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: AWS CLI 是一个统一的工具，用于管理 AWS 资源。该工具的创建目的是让我们能够通过本地机器上的终端会话管理所有的 AWS 服务。与通过浏览器提供可视化工具的
    AWS Web 控制台相比，AWS CLI（顾名思义）将所有功能集成在本地机器的终端程序中。AWS CLI 支持所有主要操作系统，如 Linux、macOS
    和 Windows。在接下来的章节中，我们将展示如何在 Linux 本地机器上安装它。
- en: Installing the AWS CLI
  id: totrans-243
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 安装 AWS CLI
- en: To install the AWS CLI, please visit [https://aws.amazon.com/cli/](https://aws.amazon.com/cli/).
    At the time of writing, the latest release of the AWS CLI is version 2\. For the
    examples in this chapter, we’ll be using a Debian machine to install the AWS CLI
    while following the instructions at [https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html#cliv2-linux-install](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html#cliv2-linux-install).
    This resource link offers instructions for installing the AWS CLI on all major
    operating systems, not only Linux.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装 AWS CLI，请访问[https://aws.amazon.com/cli/](https://aws.amazon.com/cli/)。在撰写本文时，AWS
    CLI 的最新版本是 2。对于本章中的示例，我们将使用一台 Debian 机器来安装 AWS CLI，并遵循[https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html#cliv2-linux-install](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html#cliv2-linux-install)上的说明。该资源链接提供了在所有主要操作系统上安装
    AWS CLI 的说明，不仅仅是 Linux。
- en: 'Follow these steps to install the AWS CLI on Linux:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤在 Linux 上安装 AWS CLI：
- en: 'We’ll start by downloading the AWS CLI v2 package (`awscliv2.zip`):'
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将从下载 AWS CLI v2 包（`awscliv2.zip`）开始：
- en: '[PRE13]'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Next, we’ll unzip and install the AWS CLI:'
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将解压并安装 AWS CLI：
- en: '[PRE14]'
  id: totrans-249
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'help:'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 帮助：
- en: '[PRE15]'
  id: totrans-251
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '[PRE16]'
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: To manage your AWS EC2 resources using the `aws` utility, first, you need to
    configure your local environment to establish the required trust with the AWS
    endpoint. We’ll do that next.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 要使用 `aws` 工具管理你的 AWS EC2 资源，首先需要配置本地环境，以与 AWS 端点建立所需的信任关系。接下来我们将进行配置。
- en: Configuring the AWS CLI
  id: totrans-254
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置 AWS CLI
- en: 'To configure the local AWS environment on your local machine, you will have
    to set up your AWS access key. If you already have it, you can skip this part:'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 要在本地机器上配置 AWS 环境，你需要设置 AWS 访问密钥。如果你已经有了密钥，可以跳过此部分：
- en: The AWS CLI configuration asks for your **AWS Access Key ID** and **AWS Secret
    Access Key** values. You can generate or retrieve these keys by logging into your
    AWS account.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS CLI 配置会要求输入你的**AWS 访问密钥 ID**和**AWS 秘密访问密钥**值。你可以通过登录到你的 AWS 账户来生成或检索这些密钥。
- en: Select the dropdown next to your account name in the top-right corner of the
    AWS web console and choose **Security Credentials**. If you haven’t generated
    your access key yet, go to the **Access keys** tab and click on the **Create access
    key** button. You’ll have to store your AWS key ID and secret in a safe place
    for later reuse.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 AWS Web 控制台的右上角选择你账户名旁边的下拉菜单，然后选择**安全凭证**。如果你还没有生成访问密钥，请进入**访问密钥**标签页，点击**创建访问密钥**按钮。你需要将你的
    AWS 密钥 ID 和密钥保存在安全的地方，以备后用。
- en: 'Now that you have those keys, you can proceed to setting up AWS on your local
    machine. To configure the AWS environment, run the following command:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在你已经有了这些密钥，可以继续在本地机器上配置 AWS 环境。要配置 AWS 环境，请运行以下命令：
- en: '[PRE17]'
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The preceding command will prompt you for a few pieces of information, as suggested
    by the following output:'
  id: totrans-260
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上述命令会提示你输入一些信息，如下所示的输出：
- en: '![Figure 15.25 – Configuring the local AWS CLI environment](img/B19682_15_25.jpg)'
  id: totrans-261
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.25 – 配置本地 AWS CLI 环境](img/B19682_15_25.jpg)'
- en: Figure 15.25 – Configuring the local AWS CLI environment
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.25 – 配置本地 AWS CLI 环境
- en: In the AWS CLI configuration wizard, set `eu-central-1` (Frankfurt, in our case).
    You may want to enter the region of your choice or leave it as the default (`None`).
    If you don’t have a default Region specified, you’ll have to enter it every time
    you invoke the `aws` command.
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 AWS CLI 配置向导中，设置`eu-central-1`（在我们的案例中是法兰克福）。你可以选择输入你自己的区域，或者保持默认设置（`None`）。如果没有指定默认区域，每次调用`aws`命令时都需要输入该区域。
- en: At this point, we’re ready to use the AWS CLI. Let’s start by listing our EC2
    instances.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们已经准备好使用 AWS CLI。让我们从列出 EC2 实例开始。
- en: Querying EC2 instances
  id: totrans-265
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查询 EC2 实例
- en: 'The following command provides detailed information about EC2 instances:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令提供有关 EC2 实例的详细信息：
- en: '[PRE18]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The preceding command provides sizeable JSON output (too long to present in
    a screenshot), with the details of all the EC2 instances we own in our default
    Region (`eu-central-1`). Alternatively, we can specify the Region with the `--``region`
    parameter:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 上述命令提供了庞大的 JSON 输出（截图展示不下），包含我们在默认区域（`eu-central-1`）中的所有 EC2 实例的详细信息。或者，我们可以使用
    `--region` 参数指定区域：
- en: '[PRE19]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'We can get more creative and list only the EC2 instances matching a specific
    key-value tag, such as `env: packt`, that we previously tagged our instances with,
    using the `--``filters` parameter:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '我们还可以更灵活地操作，只列出与特定键值标签匹配的 EC2 实例，比如我们之前用 `env: packt` 标签标记的实例，使用 `--filters`
    参数：'
- en: '[PRE20]'
  id: totrans-271
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: The first `--filters` parameter specifies the key (`tag-key=env`), while the
    second points to the value (`tag-value=packt`).
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个`--filters`参数指定了键（`tag-key=env`），第二个则指向值（`tag-value=packt`）。
- en: 'Combining the `aws` and `jq` (*JSON query*) commands, we can extract the JSON
    fields we want. For example, the following command lists the `InstanceId`, `ImageId`,
    and `BlockDeviceMappings` fields of the EC2 instances tagged with `env:packt`:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 通过结合使用 `aws` 和 `jq`（*JSON 查询*）命令，我们可以提取所需的 JSON 字段。例如，以下命令列出了带有 `env:packt`
    标签的 EC2 实例的 `InstanceId`、`ImageId` 和 `BlockDeviceMappings` 字段：
- en: '[PRE21]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'If the `jq` utility is not present on your Linux machine, install it with the
    following command:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的 Linux 系统上没有安装`jq`工具，可以使用以下命令进行安装：
- en: '[PRE22]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'The output of the preceding `aws` command is as follows:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 上述 `aws` 命令的输出如下：
- en: '![Figure 15.26 – Querying EC2 instances](img/B19682_15_26.jpg)'
  id: totrans-278
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.26 – 查询 EC2 实例](img/B19682_15_26.jpg)'
- en: Figure 15.26 – Querying EC2 instances
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.26 – 查询 EC2 实例
- en: Note the `DeviceName` properties in the output JSON, which reflect only one
    block device (this is `/dev/sdf` since we deleted the EBS volume we attached earlier).
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 注意输出 JSON 中的 `DeviceName` 属性，它只反映了一个块设备（这是 `/dev/sdf`，因为我们删除了之前附加的 EBS 卷）。
- en: 'We can filter the output of the `aws ec2 describe-instances` command by any
    property. For example, the following command filters our EC2 instances by the
    `image-id` AMI:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过任何属性过滤 `aws ec2 describe-instances` 命令的输出。例如，以下命令通过 `image-id` AMI 过滤我们的
    EC2 实例：
- en: '[PRE23]'
  id: totrans-282
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: aws ec2 describe-instances \
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: aws ec2 describe-instances \
- en: --filters "Name=instance-id,Values=i-0f8fe6aced634e71c" \
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: --filters "Name=instance-id,Values=i-0f8fe6aced634e71c" \
- en: --query "Reservations[].Instances[].SecurityGroups[]"
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: --query "Reservations[].Instances[].SecurityGroups[]"
- en: '[PRE24]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: aws ec2 describe-instances \
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: aws ec2 describe-instances \
- en: --filters "Name=instance-id,Values=i-0f8fe6aced634e71c" \
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: --filters "Name=instance-id,Values=i-0f8fe6aced634e71c" \
- en: --query "Reservations[].Instances[].SecurityGroups[].GroupId"
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: --query "Reservations[].Instances[].SecurityGroups[].GroupId"
- en: '[PRE25]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Reservations[].Instances[].SecurityGroups[].GroupId
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: Reservations[].Instances[].SecurityGroups[].GroupId
- en: '[PRE26]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: aws ec2 run-instances --image-id ami-0faab6bdbac9486fb --count 1 --instance-type
    t3.micro --key-name packt_aws_key --security-group-ids sg-0aa7c8ef75503a9aa –placement
    AvailabilityZone=eu-central-1b
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: aws ec2 run-instances --image-id ami-0faab6bdbac9486fb --count 1 --instance-type
    t3.micro --key-name packt_aws_key --security-group-ids sg-0aa7c8ef75503a9aa –placement
    AvailabilityZone=eu-central-1b
- en: '[PRE27]'
  id: totrans-294
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: aws ec2 create-tags --resources i-091e2f515d15c3b0b --tags Key=Name,Value=aws_packt_testing_2
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: aws ec2 create-tags --resources i-091e2f515d15c3b0b --tags Key=Name,Value=aws_packt_testing_2
- en: '[PRE28]'
  id: totrans-296
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: aws ec2 create-tags \
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: aws ec2 create-tags \
- en: --resources i-0e1692c9dfdf07a8d \
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: --resources i-0e1692c9dfdf07a8d \
- en: --tags Key=env,Value=packt
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: --tags Key=env,Value=packt
- en: '[PRE29]'
  id: totrans-300
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: aws ec2 describe-instances \
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: aws ec2 describe-instances \
- en: --filters "Name=tag-key,Values=env" \
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: --filters "Name=tag-key,Values=env" \
- en: --filters "Name=tag-value,Values=packt" \
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: --filters "Name=tag-value,Values=packt" \
- en: --query "Reservations[].Instances[].InstanceId"
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: --query "Reservations[].Instances[].InstanceId"
- en: '[PRE30]'
  id: totrans-305
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'aws ec2 terminate-instances --instance-ids shutting-down (from a previously
    running state):'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: aws ec2 terminate-instances --instance-ids shutting-down (从先前的运行状态停止)：
- en: '![Figure 15.31 – Terminating an instance](img/B19682_15_31.jpg)'
  id: totrans-307
  prefs: []
  type: TYPE_IMG
  zh: '![图15.31 – 终止实例](img/B19682_15_31.jpg)'
- en: Figure 15.31 – Terminating an instance
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.31 – 终止实例
- en: 'The instance will eventually transition to the `terminated` state and will
    no longer be visible in the AWS EC2 console. The AWS CLI will still list it among
    the instances until EC2 finally disposes of it. According to AWS, terminated instances
    can still be visible up to an hour after termination. It’s always a good practice
    to discard the instances in the `terminated` or `shutting-down` state when performing
    queries and management operations via the AWS CLI. The following screenshot of
    the EC2 console shows that the second EC2 instance is in a `terminated` state:'
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 实例最终会过渡到`terminated`状态，并且将不再在AWS EC2控制台中显示。AWS CLI仍然会将其列出在实例列表中，直到EC2最终处理它。根据AWS的说法，终止的实例在终止后最多一个小时内仍然可能可见。在通过AWS
    CLI执行查询和管理操作时，最好丢弃处于`terminated`或`shutting-down`状态的实例。以下EC2控制台的屏幕截图显示第二个EC2实例处于`terminated`状态：
- en: '![Figure 15.32 – Showing the terminated instance in the EC2 console](img/B19682_15_32.jpg)'
  id: totrans-310
  prefs: []
  type: TYPE_IMG
  zh: '![图15.32 – 显示EC2控制台中的终止实例](img/B19682_15_32.jpg)'
- en: Figure 15.32 – Showing the terminated instance in the EC2 console
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 图15.32 – 显示EC2控制台中的终止实例
- en: This is where we’ll wrap up our journey regarding AWS EC2\. Note that we’ve
    only scratched the surface of cloud management workloads in AWS.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们结束关于AWS EC2之旅的地方。请注意，我们仅仅触及了AWS中云管理工作负载的表面。
- en: The topics that were covered in this section provide a basic understanding of
    AWS EC2 cloud resources and help system administrators make better decisions when
    managing the related workloads. Power users may find the AWS CLI examples a good
    starting point for automating their cloud management workflows in EC2.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 本节中涵盖的主题提供了对AWS EC2云资源的基本理解，并帮助系统管理员在管理相关工作负载时做出更好的决策。高级用户可能会发现AWS CLI示例是自动化其EC2云管理工作流的一个良好起点。
- en: Now, let’s turn our focus to our next public cloud services contender, Microsoft
    Azure.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们将注意力转向我们的下一个公共云服务竞争者——Microsoft Azure。
- en: Working with Microsoft Azure
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Microsoft Azure
- en: '**Microsoft Azure**, also known as **Azure**, is a public cloud service by
    Microsoft for building and deploying application services in the cloud. Azure
    provides a full offering of a highly scalable **Infrastructure-as-a-Service**
    (**IaaS**) at relatively low costs, accommodating a wide range of users and business
    requirements, from small teams to large commercial enterprises, including financial,
    health, and governmental institutions.'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: '**Microsoft Azure**，也称为**Azure**，是微软提供的公共云服务，用于在云中构建和部署应用服务。Azure提供全面的、高度可扩展的**基础设施即服务**（**IaaS**），以相对低廉的成本，满足从小团队到大型商业企业、金融、医疗和政府机构等广泛用户和业务需求。'
- en: 'In this section, we’ll explore some very basic deployment workflows using Azure,
    such as the following:'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们将探索一些使用Azure的非常基本的部署工作流，如下所示：
- en: Creating a Linux virtual machine
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建Linux虚拟机
- en: Managing virtual machine sizes
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理虚拟机大小
- en: Adding additional storage to a virtual machine
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向虚拟机添加额外存储
- en: Working with the Azure CLI
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Azure CLI
- en: Once you’ve created your free Azure account, go to [https://portal.azure.com](https://portal.azure.com)
    to access the Azure portal. You may want to enable the docked view of the portal
    navigation menu on the left for quick and easy access to your resources. Throughout
    this chapter, we’ll use the docked view for our screen captures. Go to the **Portal
    settings** cog in the top-right corner and choose **Docked** for the default mode
    of the portal menu.
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你创建了免费的Azure帐户，请访问[https://portal.azure.com](https://portal.azure.com)进入Azure门户。你可能希望启用左侧导航菜单的停靠视图，以便快速便捷地访问你的资源。在本章中，我们将使用停靠视图来进行屏幕截图。进入右上角的**门户设置**齿轮，选择**停靠**作为门户菜单的默认模式。
- en: Now, let’s create our first resource in Azure – an Ubuntu virtual machine.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们在Azure中创建我们的第一个资源——一台Ubuntu虚拟机。
- en: Creating and deploying a virtual machine
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 创建和部署虚拟机
- en: We’ll follow a step-by-step procedure, guided by the resource wizard in the
    Azure portal. Let’s start with the first step, which is creating a compute resource
    for the virtual machine.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将遵循Azure门户中的资源向导，按步骤操作。让我们从第一步开始，即为虚拟机创建计算资源。
- en: '**Creating a compute resource**: Start by clicking on the **Create a resource**
    option in the left navigation menu or under **Azure services** in the main window.
    This will take us to the Azure Marketplace. Here, we can search for our resource
    of choice. You can either search for a relevant keyword or narrow down your selection
    based on the resource type you’re looking for. Let’s narrow down our selection
    by choosing **Compute**, then selecting **Ubuntu Server 22.04 LTS** from the available
    **Popular Marketplace products** options. You may click on **Learn more** for
    a detailed description of the image or click **Create**.'
  id: totrans-326
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**创建计算资源**：首先，点击左侧导航菜单中的**创建资源**选项，或在主窗口中的**Azure 服务**下选择。这将引导我们进入 Azure 市场。在这里，我们可以搜索所需的资源。你可以搜索相关的关键词，或者根据所需的资源类型缩小选择范围。我们可以通过选择**计算**，然后从可用的**热门市场产品**选项中选择**Ubuntu
    Server 22.04 LTS**来缩小选择范围。你可以点击**了解更多**以查看镜像的详细描述，或点击**创建**。'
- en: 'When we select **Ubuntu Server 22.04 LTS**, we’ll be guided through the process
    of configuring and creating our new virtual machine. The setup page looks like
    this:'
  id: totrans-327
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当我们选择**Ubuntu Server 22.04 LTS**时，系统将引导我们完成配置和创建新虚拟机的过程。设置页面如下所示：
- en: '![Figure 15.33 – Creating a virtual machine in Azure](img/B19682_15_33.jpg)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.33 – 在 Azure 中创建虚拟机](img/B19682_15_33.jpg)'
- en: Figure 15.33 – Creating a virtual machine in Azure
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.33 – 在 Azure 中创建虚拟机
- en: In the **Basics** tab, information such as the subscription type, resource group,
    region, image, and architecture is provided. The other tabs include **Disks**,
    **Networking**, **Management**, **Monitoring**, **Advanced**, and **Tags**.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 在**基础**选项卡中，提供了订阅类型、资源组、区域、镜像和架构等信息。其他选项卡包括**磁盘**、**网络**、**管理**、**监控**、**高级**和**标签**。
- en: '`packt-demo`. If we had a previously created resource group, we could specify
    it here.'
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`packt-demo`。如果我们之前创建了资源组，我们可以在这里指定它。'
- en: '`packt-ubuntu-demo` and place it in the `(Europe) France Central` Region, the
    closest to the geographical location where our instance will operate. The size
    of our machine will directly impact the associated costs. The following screenshot
    shows the details that have been specified so far regarding the **Resource group**
    set up, **Virtual machine name**, **Region**, **Availability options**, **Security
    type**, **Image**, **VM architecture**, and **Size**:'
  id: totrans-332
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`packt-ubuntu-demo`，并将其放置在（欧洲）法国中部区域，该区域距离我们实例操作的地理位置最近。虚拟机的大小将直接影响相关费用。以下截图显示了目前已指定的**资源组**设置、**虚拟机名称**、**区域**、**可用性选项**、**安全类型**、**镜像**、**虚拟机架构**和**大小**的详细信息：'
- en: '![Figure 15.34 – Setting up the Azure virtual machine](img/B19682_15_34.jpg)'
  id: totrans-333
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.34 – 设置 Azure 虚拟机](img/B19682_15_34.jpg)'
- en: Figure 15.34 – Setting up the Azure virtual machine
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.34 – 设置 Azure 虚拟机
- en: Alternatively, we could browse different options for **Image** and **Size**
    by choosing **See all images** or **See all sizes**, respectively. Azure also
    provides a *pricing calculator* online tool for various resources at [https://azure.microsoft.com/en-us/pricing/calculator/](https://azure.microsoft.com/en-us/pricing/calculator/).
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，我们也可以通过选择**查看所有镜像**或**查看所有大小**来浏览不同的**镜像**和**大小**选项。Azure 还提供了一个在线工具*定价计算器*，可供查看各种资源的定价：[https://azure.microsoft.com/en-us/pricing/calculator/](https://azure.microsoft.com/en-us/pricing/calculator/)。
- en: '`packt` and `packt-ubuntu-demo_key`. Next, we must set **Inbound port rules**
    for our instance to allow SSH access. If, for example, our machine will run a
    web server application, we can also enable HTTP and HTTPS access:'
  id: totrans-336
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`packt` 和 `packt-ubuntu-demo_key`。接下来，我们需要为我们的实例设置**入站端口规则**，以允许 SSH 访问。例如，如果我们的机器将运行
    Web 服务器应用程序，我们还可以启用 HTTP 和 HTTPS 访问：'
- en: '![Figure 15.35 – Enabling SSH authentication and access to the virtual machine](img/B19682_15_35.jpg)'
  id: totrans-337
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.35 – 启用 SSH 身份验证并访问虚拟机](img/B19682_15_35.jpg)'
- en: Figure 15.35 – Enabling SSH authentication and access to the virtual machine
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.35 – 启用 SSH 身份验证并访问虚拟机
- en: At this point, we are ready to create our virtual machine. The wizard can take
    us further to the additional steps of specifying the *disks* and *networking*
    configuration associated with our instance. For now, we’ll leave them as-is.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们准备好创建虚拟机了。向导可以引导我们进一步进行与实例相关的*磁盘*和*网络*配置的额外步骤。现在，我们将保持现状，不做更改。
- en: '**Validating and deploying the virtual machine**: We can click the **Review
    + create** button to initiate the validation process. Next, the deployment wizard
    will validate our virtual machine configuration. In a few moments, if everything
    goes well, we’ll get a **Validation passed** message specifying the product details
    and our instance’s hourly rate. By clicking **Create**, we agree to the relevant
    terms of use, and our virtual machine will be deployed shortly:'
  id: totrans-340
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**验证并部署虚拟机**：我们可以点击**审查 + 创建**按钮以启动验证过程。接下来，部署向导将验证我们的虚拟机配置。如果一切顺利，几秒钟后我们会看到一个**验证通过**的消息，显示产品详情和实例的每小时费用。点击**创建**后，我们同意相关的使用条款，虚拟机将很快被部署：'
- en: '![Figure 15.36 – Creating the virtual machine](img/B19682_15_36.jpg)'
  id: totrans-341
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.36 – 创建虚拟机](img/B19682_15_36.jpg)'
- en: Figure 15.36 – Creating the virtual machine
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.36 – 创建虚拟机
- en: 'In the process, we’ll be prompted to download the SSH private key for accessing
    our instance:'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个过程中，我们将被提示下载 SSH 私钥以访问我们的实例：
- en: '![Figure 15.37 – Downloading the SSH private key for accessing the virtual
    machine](img/B19682_15_37.jpg)'
  id: totrans-344
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.37 – 下载 SSH 私钥以访问虚拟机](img/B19682_15_37.jpg)'
- en: Figure 15.37 – Downloading the SSH private key for accessing the virtual machine
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.37 – 下载 SSH 私钥以访问虚拟机
- en: '**Deployment completion**: If the deployment completes successfully, we’ll
    get a brief pop-up message stating **Deployment succeeded** and a **Go to resource**
    button that will take us to our new virtual machine:'
  id: totrans-346
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**部署完成**：如果部署成功完成，我们会收到一个简短的弹出消息，显示**部署成功**，并有一个**转到资源**按钮，将我们带到新虚拟机的页面：'
- en: '![Figure 15.38 – Successfully deploying a virtual machine](img/B19682_15_38.jpg)'
  id: totrans-347
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.38 – 成功部署虚拟机](img/B19682_15_38.jpg)'
- en: Figure 15.38 – Successfully deploying a virtual machine
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.38 – 成功部署虚拟机
- en: 'We’ll also get a brief report about the deployment details if we click on the
    relevant drop-down button:'
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 如果点击相关下拉按钮，我们还会得到一个简短的部署详情报告：
- en: '![Figure 15.39 – Deployment details](img/B19682_15_39.jpg)'
  id: totrans-350
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.39 – 部署详情](img/B19682_15_39.jpg)'
- en: Figure 15.39 – Deployment details
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.39 – 部署详情
- en: 'Let’s take a quick look at each of the resources that were created with our
    virtual machine deployment:'
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速浏览一下与虚拟机部署一起创建的每个资源：
- en: '`packt-ubuntu-demo`: The virtual machine host'
  id: totrans-353
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`packt-ubuntu-demo`：虚拟机主机'
- en: '`packt-ubuntu-demo348`: The network interface (or network interface card) of
    the virtual machine'
  id: totrans-354
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`packt-ubuntu-demo348`：虚拟机的网络接口（或网络接口卡）'
- en: '`packt-ubuntu-demo-ip`: The IP address of the virtual machine'
  id: totrans-355
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`packt-ubuntu-demo-ip`：虚拟机的 IP 地址'
- en: '`packt-ubuntu-demo-vnet`: The virtual network associated with the resource
    group (`packt-demo`)'
  id: totrans-356
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`packt-ubuntu-demo-vnet`：与资源组（`packt-demo`）关联的虚拟网络'
- en: '`packt-ubuntu-demo-nsg`: The **Network Security Group** (**NSG**) controlling
    inbound and outbound access to and from our instance'
  id: totrans-357
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`packt-ubuntu-demo-nsg`：控制进出我们实例的**网络安全组**（**NSG**）'
- en: Azure will create a new set of the resource types mentioned previously with
    every virtual machine, except the virtual network corresponding to the resource
    group, when the instance is placed in an existing resource group. Don’t forget
    that we also created a new resource group (`packt-demo`), which is not shown in
    the deployment report.
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
  zh: 当实例被放置在现有资源组中时，Azure 会为每个虚拟机创建一组新的资源类型（前面提到的资源类型），但不会包括与资源组对应的虚拟网络。别忘了我们还创建了一个新的资源组（`packt-demo`），它不会在部署报告中显示。
- en: Let’s try to connect to our newly created instance (`packt-ubuntu-demo`). Go
    to `packt-ubuntu-demo`). In the `20.19.173.232`).
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试连接到我们新创建的实例（`packt-ubuntu-demo`）。前往`packt-ubuntu-demo`）并在`20.19.173.232`中进行连接。
- en: Now that we’ve deployed our virtual machine, we want to make sure we can access
    it via SSH. We’ll do that next.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经部署了虚拟机，我们希望确保能够通过 SSH 访问它。接下来我们就来做这件事。
- en: Connecting with SSH to a virtual machine
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 SSH 连接到虚拟机
- en: 'Before we connect to our virtual machine via SSH, we need to set the permissions
    to our SSH private key file so that it’s not publicly viewable:'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 在通过 SSH 连接到虚拟机之前，我们需要设置 SSH 私钥文件的权限，以确保它不会公开可见：
- en: '[PRE31]'
  id: totrans-363
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Next, we must connect to our Azure Ubuntu instance with the following command:'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们必须使用以下命令连接到我们的 Azure Ubuntu 实例：
- en: '[PRE32]'
  id: totrans-365
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: We must use the SSH key (`packt-ubuntu-demo_key.pem`) and administrator account
    (`packt`) that were specified when we created the instance. Alternatively, you
    can click on the **Connect** button in the virtual machine’s **Overview** tab
    and then click **SSH**. This action will bring up a view where you can see the
    preceding commands and copy and paste them into your terminal.
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 我们必须使用在创建实例时指定的 SSH 密钥（`packt-ubuntu-demo_key.pem`）和管理员帐户（`packt`）。或者，您可以在虚拟机的**概述**选项卡上单击**连接**按钮，然后单击**SSH**。此操作将显示一个视图，您可以在其中查看前面的命令并将其复制粘贴到您的终端中。
- en: 'A successful connection to our Ubuntu instance should yield the following output:'
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 成功连接到我们的 Ubuntu 实例应该会产生以下输出：
- en: '![Figure 15.40 – Connecting to the Azure virtual machine](img/B19682_15_40.jpg)'
  id: totrans-368
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.40 – 连接到 Azure 虚拟机](img/B19682_15_40.jpg)'
- en: Figure 15.40 – Connecting to the Azure virtual machine
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.40 – 连接到 Azure 虚拟机
- en: Now that we’ve created our first virtual machine in Azure, let’s look at some
    of the most common management operations that are performed during a virtual machine’s
    lifetime.
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们在 Azure 中创建了我们的第一个虚拟机，让我们来看看在虚拟机生命周期中执行的一些最常见的管理操作。
- en: Managing virtual machines
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 管理虚拟机
- en: As our applications evolve, so does the computing power and capacity required
    by the virtual machines hosting the applications. As system administrators, we
    should know how cloud resources are being utilized. Azure provides the necessary
    tools for monitoring the health and performance of virtual machines. These tools
    are available on the **Monitoring** tab of the virtual machine’s management page.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
  zh: 随着我们的应用程序的发展，托管应用程序的虚拟机所需的计算能力和容量也在增加。作为系统管理员，我们应该了解云资源的利用情况。Azure 提供了监视虚拟机健康和性能所需的必要工具。这些工具可以在虚拟机管理页面的**监视**选项卡上找到。
- en: A small virtual machine with a relatively low number of virtual CPUs and reduced
    memory may negatively impact application performance. On the other hand, an oversized
    instance would yield unnecessary costs. Resizing a virtual machine is a common
    operation in Azure. Let’s see how we can do it.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 具有相对较少虚拟 CPU 和较少内存的小型虚拟机可能会对应用程序性能产生负面影响。另一方面，过大的实例会导致不必要的成本。在 Azure 中，调整虚拟机大小是一种常见的操作。让我们看看如何做到这一点。
- en: Changing the size of a virtual machine
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 更改虚拟机的大小
- en: 'Azure makes it relatively easy to resize virtual machines. In the portal, go
    to **Virtual Machines**, select your instance, and click **Size** under **Availability
    +** **Scale**:'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 使得调整虚拟机大小变得相对容易。在门户中，转到**虚拟机**，选择您的实例，然后在**可用性 +** **规模**下点击**大小**：
- en: '![Figure 15.41 – Changing the size of a virtual machine](img/B19682_15_41.jpg)'
  id: totrans-376
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.41 – 更改虚拟机的大小](img/B19682_15_41.jpg)'
- en: Figure 15.41 – Changing the size of a virtual machine
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.41 – 更改虚拟机的大小
- en: Our virtual machine (`packt-ubuntu-demo`) is of *B1s* size (1 vCPUs, 1 GB RAM).
    We can choose to size it up or down. For demo purposes, we could resize to the
    lower *B1ls* capacity (1 vCPU, 0.5 GB RAM). We could select the **B1ls** (1 vCPU,
    0.5 GB RAM) option and click the **Resize** button. Lowering the size of our instance
    will also result in cost savings. Azure will stop and restart our virtual machine
    while resizing. It’s always good to stop the machine before changing the size
    to avoid possible data inconsistencies within the instance.
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的虚拟机（`packt-ubuntu-demo`）是*B1s*大小（1 vCPU，1 GB RAM）。我们可以选择将其大小调整到更低的*B1ls*容量（1
    vCPU，0.5 GB RAM）。我们可以选择**B1ls**（1 vCPU，0.5 GB RAM）选项并点击**调整大小**按钮。降低实例的大小也将带来成本节约。在更改大小之前，最好停止虚拟机以避免实例内可能的数据不一致。
- en: One of the remarkable features of virtualized workloads in Azure is the ability
    to scale – including the storage capacity – by adding additional data disks to
    virtual machines. We can add existing data disks or create new ones.
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 中虚拟化工作负载的显著特性之一是可以通过添加额外的数据磁盘来扩展（包括存储容量）。我们可以添加现有的数据磁盘或创建新的磁盘。
- en: Let’s look at how to add a secondary data disk to our virtual machine.
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何向我们的虚拟机添加一个次要数据磁盘。
- en: Adding additional storage
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 添加额外的存储空间
- en: 'Azure can add disks to our instance on the fly, without stopping the machine.
    We can add two types of disks to a virtual machine: **data disks** and **managed
    disks**. In this chapter, we will only provide information on how to add data
    disks. For more information on disk types on Azure, please visit [https://docs.microsoft.com/en-us/azure/virtual-machines/disks-types](https://docs.microsoft.com/en-us/azure/virtual-machines/disks-types).'
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: Azure可以在不停止虚拟机的情况下动态地向实例添加磁盘。我们可以向虚拟机添加两种类型的磁盘：**数据磁盘**和**托管磁盘**。在本章中，我们将仅提供如何添加数据磁盘的信息。有关Azure磁盘类型的更多信息，请访问[https://docs.microsoft.com/en-us/azure/virtual-machines/disks-types](https://docs.microsoft.com/en-us/azure/virtual-machines/disks-types)。
- en: 'Let’s learn how to add a data disk:'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们学习如何添加数据磁盘：
- en: Navigate to **Virtual machines** in the left navigation menu and select your
    instance, click **Disks** under **Settings**, and then click on **Create and attach
    a** **new disk**.
  id: totrans-384
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧导航菜单中，导航到**虚拟机**，选择你的实例，点击**设置**下的**磁盘**，然后点击**创建并附加新磁盘**。
- en: 'In the disk properties, leave the `packt-disk`), **Storage Type**, and **Size**
    (such as **4 GB**) values. Click **Apply** when you’re done:'
  id: totrans-385
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在磁盘属性中，保留`packt-disk`、**存储类型**和**大小**（例如**4 GB**）的值。完成后，点击**应用**：
- en: '![Figure 15.42 – Adding a new data disk](img/B19682_15_42.jpg)'
  id: totrans-386
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.42 – 添加新数据磁盘](img/B19682_15_42.jpg)'
- en: Figure 15.42 – Adding a new data disk
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.42 – 添加新数据磁盘
- en: At this point, the new disk is attached to our virtual machine, but the disk
    hasn’t been initialized with a filesystem yet.
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，新磁盘已附加到我们的虚拟机，但磁盘尚未初始化文件系统。
- en: 'Connect to our virtual machine via SSH:'
  id: totrans-389
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过SSH连接到我们的虚拟机：
- en: '[PRE33]'
  id: totrans-390
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '2.  List the current block devices:'
  id: totrans-391
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 2. 列出当前的块设备：
- en: '[PRE34]'
  id: totrans-392
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '![Figure 15.43 – Identifying the block device for the new data disk](img/B19682_15_43.jpg)'
  id: totrans-393
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.43 – 确定新数据磁盘的块设备](img/B19682_15_43.jpg)'
- en: Figure 15.43 – Identifying the block device for the new data disk
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.43 – 确定新数据磁盘的块设备
- en: 'Verify that the block device is empty:'
  id: totrans-395
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证块设备是否为空：
- en: '[PRE35]'
  id: totrans-396
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE35]'
- en: '2.  Next, initialize the volume with an XFS filesystem:'
  id: totrans-397
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 2. 接下来，使用XFS文件系统初始化卷：
- en: '[PRE36]'
  id: totrans-398
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE36]'
- en: sudo mkdir /packt
  id: totrans-399
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: sudo mkdir /packt
- en: sudo mount /dev/sdc /packt
  id: totrans-400
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: sudo mount /dev/sdc /packt
- en: '[PRE37]'
  id: totrans-401
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE37]'
- en: Now, we can use the new data disk for regular file storage.
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以使用新的数据磁盘进行常规文件存储。
- en: Note that data disks will only be persisted during the lifetime of the virtual
    machine. When the virtual machine is paused, stopped, or terminated, the data
    disk becomes unavailable. When the machine is terminated, the data disk is permanently
    lost. For persistent storage, we need to use *managed disks*, similar in behavior
    to network-attached storage. See the link at the beginning of this section for
    more details.
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，数据磁盘仅在虚拟机的生命周期内被持久化。当虚拟机被暂停、停止或终止时，数据磁盘将变为不可用。当虚拟机终止时，数据磁盘会永久丢失。对于持久化存储，我们需要使用*托管磁盘*，其行为类似于网络附加存储。有关更多详细信息，请参见本节开头的链接。
- en: So far, we have performed all these management operations in the Azure portal.
    But what if you want to automate your workloads in the cloud using scripting?
    This can be done using Azure CLI.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经在Azure门户中执行了所有这些管理操作。但是如果你想使用脚本自动化云中的工作负载怎么办？这可以通过Azure CLI来实现。
- en: Working with the Azure CLI
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Azure CLI
- en: 'Azure CLI is a specialized command-line interface for managing your resources
    in the cloud. First, let’s install the Azure CLI on our platform of choice. Follow
    the instructions at [https://docs.microsoft.com/en-us/cli/azure/install-azure-cli](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli).
    We’ll choose the Azure CLI for Linux and, for demo purposes, install it on a Debian
    machine. The related instructions can be found at [https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-linux](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-linux).
    From the multiple installation options available, we’ll use the following command:'
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: Azure CLI是一个专门的命令行界面，用于管理云中的资源。首先，让我们在我们选择的平台上安装Azure CLI。按照[https://docs.microsoft.com/en-us/cli/azure/install-azure-cli](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli)中的说明进行操作。我们将选择适用于Linux的Azure
    CLI，并为了演示目的，在Debian机器上安装它。相关的安装说明可以在[https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-linux](https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-linux)找到。在多种安装选项中，我们将使用以下命令：
- en: '[PRE38]'
  id: totrans-407
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'After the installation is complete, we can invoke the Azure CLI with the `az`
    command:'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，我们可以使用`az`命令调用Azure CLI：
- en: '[PRE39]'
  id: totrans-409
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'The preceding command displays detailed help information about using the `az`
    utility. However, before performing any management operations, we need to authenticate
    the CLI with our Azure credentials. The following command will set up the local
    Azure CLI environment accordingly:'
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的命令会显示关于如何使用`az`工具的详细帮助信息。然而，在执行任何管理操作之前，我们需要使用我们的Azure凭据对CLI进行身份验证。以下命令将相应地设置本地的Azure
    CLI环境：
- en: '[PRE40]'
  id: totrans-411
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'We’ll be prompted with a message containing an authentication code and the
    URL ([https://microsoft.com/devicelogin](https://microsoft.com/devicelogin)) to
    visit and enter the code:'
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将收到一条包含身份验证代码的消息，以及需要访问的URL（[https://microsoft.com/devicelogin](https://microsoft.com/devicelogin)）并输入该代码：
- en: '![Figure 15.44 – Initializing the Azure CLI environment](img/B19682_15_44.jpg)'
  id: totrans-413
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.44 – 初始化Azure CLI环境](img/B19682_15_44.jpg)'
- en: Figure 15.44 – Initializing the Azure CLI environment
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.44 – 初始化Azure CLI环境
- en: 'At this point, we are ready to use the Azure CLI for management operations.
    Let’s create a new resource group called `packt-dev` in the `West` `US` Region:'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们已准备好使用Azure CLI进行管理操作。让我们在`West` `US`区域创建一个名为`packt-dev`的新资源组：
- en: '[PRE41]'
  id: totrans-416
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'The preceding command yields the following output upon successfully creating
    the resource group:'
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的命令在成功创建资源组后将产生以下输出：
- en: '![Figure 15.45 – Creating a new resource group](img/B19682_15_45.jpg)'
  id: totrans-418
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.45 – 创建新的资源组](img/B19682_15_45.jpg)'
- en: Figure 15.45 – Creating a new resource group
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.45 – 创建新的资源组
- en: 'Next, we must launch an Ubuntu virtual machine named `packt-ubuntu-dev` in
    the Region we just created:'
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们必须在刚刚创建的区域启动一个名为`packt-ubuntu-dev`的Ubuntu虚拟机：
- en: '[PRE42]'
  id: totrans-421
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'Let’s quickly go through each of the preceding command-line options:'
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速浏览一下前面提到的每个命令行选项：
- en: '`resource-group`: The name of the resource group (`packt-dev`) where we create
    our virtual machine'
  id: totrans-423
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`resource-group`：我们创建虚拟机的资源组名称（`packt-dev`）'
- en: '`name`: The name of the virtual machine (`packt-ubuntu-dev`)'
  id: totrans-424
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`name`：虚拟机的名称（`packt-ubuntu-dev`）'
- en: '`image`: The Linux distribution to use (`Ubuntu2204`)'
  id: totrans-425
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`image`：要使用的Linux发行版（`Ubuntu2204`）'
- en: '`admin-username`: The username of the machine’s administrator account (`packt`)'
  id: totrans-426
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`admin-username`：机器管理员账户的用户名（`packt`）'
- en: '`generate-ssh-keys`: This generates a new SSH key pair to access our virtual
    machine'
  id: totrans-427
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`generate-ssh-keys`：这将生成一对新的SSH密钥，用于访问我们的虚拟机'
- en: 'The preceding code produces the following output:'
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的代码会产生以下输出：
- en: '![Figure 15.46 – Creating a new virtual machine](img/B19682_15_46.jpg)'
  id: totrans-429
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.46 – 创建新的虚拟机](img/B19682_15_46.jpg)'
- en: Figure 15.46 – Creating a new virtual machine
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.46 – 创建新的虚拟机
- en: 'As the output suggests, the SSH key files have been automatically generated
    and placed in the local machine’s `~/.ssh` directory to allow SSH access to the
    newly created virtual machine. The JSON output also provides the public IP address
    of the machine:'
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 如输出所示，SSH密钥文件已自动生成并放置在本地机器的`~/.ssh`目录中，以允许通过SSH访问新创建的虚拟机。JSON输出还提供了机器的公共IP地址：
- en: '[PRE43]'
  id: totrans-432
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'The following command lists all virtual machines:'
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: 以下命令列出所有虚拟机：
- en: '[PRE44]'
  id: totrans-434
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'You can also check the Azure portal in your browser to see all your virtual
    machines, including the newly created one:'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以在浏览器中查看Azure门户，查看所有虚拟机，包括新创建的虚拟机：
- en: '![Figure 15.47 – Viewing the virtual machines in the Azure portal](img/B19682_15_47.jpg)'
  id: totrans-436
  prefs: []
  type: TYPE_IMG
  zh: '![图 15.47 – 在Azure门户中查看虚拟机](img/B19682_15_47.jpg)'
- en: Figure 15.47 – Viewing the virtual machines in the Azure portal
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15.47 – 在Azure门户中查看虚拟机
- en: 'To get information about a specific virtual machine (`packt-ubuntu-dev`), run
    the following command:'
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取关于特定虚拟机（`packt-ubuntu-dev`）的信息，请运行以下命令：
- en: '[PRE45]'
  id: totrans-439
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: az vm redeploy \
  id: totrans-440
  prefs: []
  type: TYPE_NORMAL
  zh: az vm redeploy \
- en: --resource-group packt-dev \
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: --resource-group packt-dev \
- en: '--name packt-ubuntu-dev):'
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: '--name packt-ubuntu-dev):'
- en: '[PRE46]'
  id: totrans-443
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '[PRE47]'
  id: totrans-444
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '[PRE48]'
  id: totrans-445
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
