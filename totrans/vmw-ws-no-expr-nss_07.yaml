- en: Chapter 7. Converting Virtual Machines
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Among the major benefits of using virtualization is how easy it is to migrate
    machines. In VMware Workstation, you can use both physical to virtual (P2V) migration,
    as well as virtual to virtual, which allows you to import virtual machines that
    have been created somewhere else. In this chapter you will learn how to use both
    techniques.
  prefs: []
  type: TYPE_NORMAL
- en: Converting physical machines to VMware Workstation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To convert physical machines to a virtual machine, you need vCenter Converter
    Standalone. This product is available for free and you can easily install it from
    VMware Workstation 9 or any later versions. You should be aware of some limitations
    though, such as:'
  prefs: []
  type: TYPE_NORMAL
- en: VMware Converter Standalone runs on Windows only, so you cannot use it to convert
    virtual machines that are running on Linux computers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware Converter Standalone in a VMware Workstation environment does not support
    remote conversions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To convert a virtual machine, you should install VMware Converter Standalone
    on that virtual machine, and apply the procedure described in the following section
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Virtualizing a physical Windows machine with VMware Converter
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To convert a physical machine that runs with Windows using VMware Converter
    Standalone, you first have to download and install the VMware Converter Standalone
    utility. You can download it for free at [www.vmware.com](http://www.vmware.com).
  prefs: []
  type: TYPE_NORMAL
- en: 'Before starting a P2V conversion of a Windows computer, you need to switch
    off **User Account Control**. The following procedure describes how to do this:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the Windows Control center and select **User Account** | **Change User**
    **Account Control Settings** (or select the **User Account Control** settings
    application on Windows 8).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Move the slider to **Never Notify** and click on **OK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now you need to enable the **Run all administrators in administrator approval
    mode** option in the Windows security policy. To do this, open a **Run** window
    using Windows key + *R* and enter `secpol.msc`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Local Policies** | **Security Policies**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select **User Account Control**: **Run all administrators in administrator
    approval mode** and enable this option.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Restart your computer.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After its installation, you can use the **Virtualize a Physical Machine** option
    to convert a physical machine into a virtual machine. The following procedure
    describes how to perform the P2V virtualization from the standalone utility that
    is installed on the physical computer that you want to convert. Notice that the
    **Virtualize a Physical Machine** option that you'll find in the VMware Workstation
    **File** menu doesn't work.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Virtualizing a physical Windows machine with VMware Converter](img/9182EN_07_01.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: The Virtualize a Physical Machine option doesn't work
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: From your computer's desktop, select **VMware vCenter Converter Stand-alone
    client**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: As you can also use this tool to connect to a VMware Server that is running
    on another computer in a vCenter environment, you first have to select which server
    you want to use. Choose between either connecting to a local server or a remote
    server. Select the **Connect to a local server** option:![Virtualizing a physical
    Windows machine with VMware Converter](img/9182EN_07_02.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To convert virtual machines to VMware Workstation, select Connect to Local Server
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: In the window that opens now, click on the **Convert Machine** button. To perform
    a physical-to-virtual conversion, next select **Powered-on machine** and select
    **This local machine**—it is the only option that works in a VMware Workstation
    environment.![Virtualizing a physical Windows machine with VMware Converter](img/9182EN_07_03.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connecting to the target machine
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: After selecting the local machine, you have to select the destination type.
    That is the type to which you want to convert this physical machine. Make sure
    that the destination type VMware Workstation or another VMware virtual machine
    is used, and next select **VMware Workstation 8.0.x** from the drop-down list.
    This works for VMware Workstation 8.0 and higher. Also, select a name for the
    virtual machine and the location where you want to store the virtual machine files.
    Notice that you will store the virtual machine's file on the local machine, that
    is, the machine where VMware vCenter Converter is running.![Virtualizing a physical
    Windows machine with VMware Converter](img/9182EN_07_04.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specifying the target file format
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'In the next window, you''ll see an option window where you can specify how
    the hardware on the physical machine should be represented within the virtual
    machine. You''ll probably see some warnings as well, indicating options for which
    enough resources are not available. To make sure the P2V conversion works, tune
    all hardware options of the physical machine to settings that will work within
    the virtual machine as well. Ensure that you have at least a look at the following
    options:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Memory: by default**: The virtual machine will have the same amount of memory
    as the physical machine. You may need to reduce this.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Post-conversion**: You probably want to install the VMware tools automatically
    on the virtual machine once it has been converted.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Virtualizing a physical Windows machine with VMware Converter](img/9182EN_07_05.jpg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Before starting the actual conversion, make sure that hardware settings match
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: After changing all hardware settings, click on **Next**. This shows a summary
    of all the selected parameters. On this summary window, click on **Finish** to
    start the conversion. Notice that depending on the size of the physical machine,
    it may take a long time to complete this process. You'll see the conversion task
    being added to the vCenter Converter tool, with an indication of the approximate
    time it is going to take before the synchronization process is completed. You
    can monitor the conversion process from the VMware vCenter Converter Standalone
    console window. Make sure that it can complete without any errors.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the conversion process is completed successfully, the VMDK file of the
    virtual machine is copied to the disk on the computer that runs VMware Workstation.
    The next step is to import the virtual machine disk file into your VMware Workstation
    computer. Later in this chapter you can read how this works.
  prefs: []
  type: TYPE_NORMAL
- en: Performing a physical-to-virtual conversion of computers running Linux
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Although the previous versions of VMware supported P2V on Linux virtual machines,
    this is no longer the case in the current versions. Therefore, you''ll have to
    rely on other solutions to do P2V for Linux virtual machines. The easiest way
    is to use a pure Linux solution for updating virtual machines: you''ll boot the
    Linux machine from a Linux boot disk, convert all of the physical disk to a virtual
    disk image, and next you''ll import the disk image in VMware as described in the
    following sections.'
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The following procedure describes how to do Linux P2V on a system that has one
    hard disk only. It is possible to do P2V on a system that has more than one hard
    disk, but this is much more difficult and not explained further. If you understand
    this procedure, you can use it to create several disk files and import these disk
    files in VMware.
  prefs: []
  type: TYPE_NORMAL
- en: To perform the following procedure, you'll need a Linux boot disk. It is recommended
    to use Knoppix; you can download a free ISO image of Knoppix from [www.knoppix.org](http://www.knoppix.org).
    This Linux boot disk is used to take an image of the physical disk. Next you'll
    need an external disk to store the image that you're going to write. Before you
    start, make sure that the external hard disk has lots of free disk space; you
    need to create a file on it that is as big as the entire hard disk of the physical
    machine.
  prefs: []
  type: TYPE_NORMAL
- en: Start the physical machine that you want to convert from the Knoppix DVD.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In Knoppix, you will be logged in automatically. Open a console window and enter
    the `sudo su` command, which gives you administrator (root) permissions in the
    Linux operating system.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Use the `cat /proc/partitions` command. This shows you which disks and partitions
    currently exist on the Linux operating system that is installed on the Linux computer.
    It should show you a device with the name `/dev/sda`, and some partitions that
    you can recognize as `/dev/sda1`, `/dev/sda2`, and maybe more (this depends on
    how the computer has been installed).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Connect the external USB disk to your computer and use the command `cat /proc/partitions`
    again. You'll notice that a disk has been added. This is the external hard disk.
    It is very likely that the name of the disk itself is `/dev/sdb`, and it has a
    partition with the name `/dev/sdb1`. (This is likely if the computer that has
    been converted only has one disk.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Use the command `mount /dev/sdb1 /mnt`. This makes the external hard disk accessible
    on the `/mnt` directory.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Use the following command to start the cloning process: `dd if=/dev/sda of=/mnt/mydisk.img
    bs=1M`. You will need approximately 1 hour for every 50 gigabytes, and depending
    on the speed of your computer and external disk, this can be much more. So better
    not wait for it.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the procedure has been completed, use `umount/mnt` to unmount the external
    disk. You have now stored the disk image file and can import it in VMware.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Performing a V2V conversion and virtual machine import
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the preceding sections, you've learned how to convert a physical computer
    into a virtual machine. Occasionally, you'll also need to import virtual machine
    files in VMware Workstation. This can be because you have copied a VMDK file from
    another computer to your VMware Workstation computer, but you may also need this
    approach to import a virtual machine file that has been created on another virtualization
    platform. In this section you'll learn how to perform both of these tasks.
  prefs: []
  type: TYPE_NORMAL
- en: Importing raw image files into VMware Workstation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The easiest way to convert a raw disk file to VMDK is by using the `vmware-vdiskmanager`
    utility. You can use this tool both on the Linux as well as the Windows versions
    of VMware. The following procedure demonstrates how to convert a raw disk file
    to VMDK:'
  prefs: []
  type: TYPE_NORMAL
- en: Attach the medium that contains the raw disk file that you have created to your
    computer, and make sure it is accessible by either a drive letter (Windows) or
    a filesystem mount (Linux).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Use the following command to start the conversion:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Wait until the conversion has finished before proceeding to the next section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Importing VMDK files into VMware Workstation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Once you have converted the source disk file to the VMDK format, you can create
    a new virtual machine based on the VMDK file. This procedure is more or less the
    same as the procedure of creating a new virtual machine. What it comes down to
    is that you start creating a new virtual machine and tell the installation wizard
    to use an existing VMDK file. The following steps demonstrate how it works:'
  prefs: []
  type: TYPE_NORMAL
- en: Start VMware Workstation and navigate to **File** | **New virtual machine**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Custom** when asked what kind of configuration you want to use.![Importing
    VMDK files into VMware Workstation](img/9182EN_07_06.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When asked for the type of configuration you want to use, select Custom
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Select **I will install the** **operating system later** when the **New Virtual
    Machine Wizard** window opens.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify the guest operating system that is on the VMDK file, and customize all
    hardware you want to use, up to the point where the installer asks what kind of
    disk you want to use.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When asked what disk you want to use, select **Use an existing virtual disk**:![Importing
    VMDK files into VMware Workstation](img/9182EN_07_07.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To import a VMDK in VMware Workstation, you need to use an existing virtual
    disk
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: You'll now see an interface where you can browse to an existing disk file. Click
    on the **Browse** button and navigate to the location where the disk file is stored.
    If the virtual machine consists of multiple VMDK files, make sure to select the
    first VMDK from the list.![Importing VMDK files into VMware Workstation](img/9182EN_07_08.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the VMDK consists of multiple files, select the first of these files
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: You can now finish the VM creation procedure by clicking on **Finish**. This
    creates the virtual disk file for you.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Importing other disk file formats into VMware Workstation using OVF
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'There are many disk file formats that can be used by different virtualization
    products. Among these are the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '**OVF**: This stands for **Open Virtualization Format**; this is a generic
    virtual machine disk file that is supported by many virtualization solutions'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VDI**: This is the Virtual Box native disk format'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VMD**K: This is the VMware native disk format'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VHD**: This is the Virtual Hard Disk format that is mainly used in Microsoft
    environments'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**HDD**: This is the Parallel Hard Disk format'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**QED**: This is the QEMU-enhanced disk'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**QCOW**: This is the QEMU Copy-on-Write format'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Within VMware Workstation, there is not much support for all of these different
    disk file types. Some other virtualization solutions, though, offer reasonable-to-good
    support to export virtual machines into a file format that VMware can read. In
    the procedure described as follows, you can learn how to export a virtual machine
    from Virtual Box so that it can be imported in VMware Workstation.
  prefs: []
  type: TYPE_NORMAL
- en: In Virtual Box, make sure that the VM you want to export is shut down.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: From the **File** menu, select **Export Appliance**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the virtual machine you want to export and click on **Next**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Make sure that the virtual machine is exported to a file with the `.ova` extension.
    This is an archive file that can contain multiple OVF files. Click on **Next**
    after specifying the filename to be exported.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Export** to start exporting the virtual machine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once you have exported the virtual machine to the appropriate target format,
    you need to import it into VMware Workstation. To do this, from VMware Workstation,
    click on the **File** menu and select **Open**. Now, browse to the location where
    you''ve saved the OVA file and open it. The Import Virtual Machine dialog opens
    now. In this dialog, you can enter a name and destination storage path for the
    virtual machine. Provide the name and path and click on **Import**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Importing other disk file formats into VMware Workstation using OVF](img/9182EN_07_09.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Importing an OVF file
  prefs: []
  type: TYPE_NORMAL
- en: At the first attempt to import the virtual machine, it will fail. This is because
    the virtual machine file, by default, does not meet the virtual hardware compliance
    checks. If you now click on **Retry**, the import process will start again and
    you will succeed to import the virtual machine.
  prefs: []
  type: TYPE_NORMAL
- en: Once the virtual machine has been imported, make sure that the Virtual Box tools
    are uninstalled from the virtual machine and install the VMware tools. The VM
    you just imported is now ready to use.
  prefs: []
  type: TYPE_NORMAL
- en: Importing third-party virtual machines using VMware vCenter Converter
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Apart from the methods discussed in preceding sections, VMware vCenter Converter
    can also help to import some virtual machine types from external programs. Different
    file types are supported, such as Microsoft Virtual PC, Microsoft Hyper-V virtual
    machines, and parallel virtualization products. You can select the specific machine
    types in the **Select source type** drop-down list in the first screen of the
    VMware Converter conversion window. After specifying the source of the virtual
    machine file, you'll just browse to the virtual machine file. The **Browse** window
    gives access to all the supported virtual machine files; if your virtual machine
    file isn't listed by default, it's not supported.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before starting the V2V conversion project in VMware vCenter Converter, you
    can also check the contents of the virtual machine file. Click on **View Source
    Details** to see a **Machine Details** window for the selected virtual machine:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Importing third-party virtual machines using VMware vCenter Converter](img/9182EN_07_10.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Verifying virtual machine contents
  prefs: []
  type: TYPE_NORMAL
- en: After verifying the virtual machine's contents, you'll proceed through the conversion
    wizard to select VMware Workstation as the destination type, and provide a name
    and location for the virtual machine file. Before the start of the actual conversion
    process, you'll see the virtual machine's properties. Click on **Edit** to tune
    the virtual machine's contents to your needs and start the conversion process.
  prefs: []
  type: TYPE_NORMAL
- en: '![Importing third-party virtual machines using VMware vCenter Converter](img/9182EN_07_11.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Before starting the conversion, you can change properties of the virtual machine
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are many ways to convert virtual machines, but there is no "one-size-fits-all"
    solution. Before performing either a physical-to-virtual or virtual-to-virtual
    conversion, you'll really need to check if the type of conversion you need is
    supported. If it is not, you can check the logfiles to find out why there have
    been problems. Fortunately, inside and outside VMware, almost all conversions
    are supported. In this chapter, you've read how to perform P2V and V2V from Windows
    and Linux to VMware.
  prefs: []
  type: TYPE_NORMAL
