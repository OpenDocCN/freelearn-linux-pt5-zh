["```\ndonnie@linux-0ro8:~> ssh donnie@192.168.0.8\ndonnie@192.168.0.8's password:\n```", "```\ndonnie@ubuntu2204-packt:~$ ssh-keygen\n```", "```\ndonnie@ubuntu2204-packt:~$ ls -l .ssh\ntotal 16\n-rw------- 1 donnie donnie    0 Oct  6 22:09 authorized_keys\n-rw------- 1 donnie donnie 2655 Nov  1 19:49 id_rsa\n-rw-r--r-- 1 donnie donnie  577 Nov  1 19:49 id_rsa.pub\n-rw------- 1 donnie donnie  978 Oct 26 20:41 known_hosts\n-rw-r--r-- 1 donnie donnie  142 Oct 26 20:41 known_hosts.old\ndonnie@ubuntu2204-packt:~$\n```", "```\ndonnie@ubuntu2204-packt:~$ ssh-keygen -t ecdsa -b 384\n```", "```\ndonnie@ubuntu2204-packt:~$ ls -l .ssh/id*\n-rw------- 1 donnie donnie  667 Nov  1 19:55 .ssh/id_ecdsa\n-rw-r--r-- 1 donnie donnie  229 Nov  1 19:55 .ssh/id_ecdsa.pub\n-rw------- 1 donnie donnie 2655 Nov  1 19:49 .ssh/id_rsa\n-rw-r--r-- 1 donnie donnie  577 Nov  1 19:49 .ssh/id_rsa.pub\ndonnie@ubuntu2204-packt:~$\n```", "```\ndonnie@ubuntu2204-packt:~$ ssh-keygen -t ed25519\n```", "```\ndonnie@ubuntu2204-packt:~$ ls -l .ssh/*25519*\n-rw------- 1 donnie donnie 464 Nov  1 20:35 .ssh/id_ed25519\n-rw-r--r-- 1 donnie donnie 105 Nov  1 20:35 .ssh/id_ed25519.pub\ndonnie@ubuntu2204-packt:~$\n```", "```\ndonnie@ubuntu2204-packt:~$ exec /usr/bin/ssh-agent $SHELL\ndonnie@ubuntu2204-packt:~$ ssh-add\nEnter passphrase for /home/donnie/.ssh/id_rsa: \nIdentity added: /home/donnie/.ssh/id_rsa (donnie@ubuntu2204-packt)\nIdentity added: /home/donnie/.ssh/id_ecdsa (donnie@ubuntu2204-packt)\nIdentity added: /home/donnie/.ssh/id_ed25519 (donnie@ubuntu2204-packt)\ndonnie@ubuntu2204-packt:~$\n```", "```\ndonnie@ubuntu2204-packt:~$ ssh-copy-id donnie@192.168.0.17\nThe authenticity of host '192.168.0.17 (192.168.0.17)' can't be established.\nED25519 key fingerprint is SHA256:GkpFwJdpWRQ5GawgFEz9bgDSny//E1I5aLGkjU9DWWY.\nThis key is not known by any other names\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 3 key(s) remain to be installed -- if you are prompted now it is to install the new keys\ndonnie@192.168.0.17's password: \nNumber of key(s) added: 3\nNow try logging into the machine, with:   \"ssh 'donnie@192.168.0.17'\"\nand check to make sure that only the key(s) you wanted were added.\ndonnie@ubuntu2204-packt:~$\n```", "```\ndonnie@ubuntu2204-packt:~$ ssh donnie@192.168.0.17\nLast login: Tue Nov  1 16:52:27 2022\n[donnie@donnie-ca ~]$ \n```", "```\ndonnie@ubuntu2204-packt:~$ ssh -i ~/.ssh/id_ed25519 donnie@192.168.0.17\nLast login: Tue Nov  1 16:56:43 2022 from 192.168.0.14\n[donnie@donnie-ca ~]$ \n```", "```\ndonnie@ubuntu2204-packt:~$ ssh donnie@192.168.0.17\nEnter passphrase for key '/home/donnie/.ssh/id_rsa': \nLast login: Tue Nov  1 16:58:22 2022 from 192.168.0.14\n[donnie@donnie-ca ~]$\n```", "```\nssh-keygen -t ecdsa -b 384\n```", "```\nls -l ./ssh\n```", "```\nexec /usr/bin/ssh-agent $SHELL\nssh-add\n```", "```\nssh-copy-id donnie@192.168.0.7\n```", "```\nssh donnie@192.168.0.7\n```", "```\nls -l .ssh\ncat .ssh/authorized_keys\n```", "```\nexec /usr/bin/ssh-agent $SHELL\nssh-add\n```", "```\n#PermitRootLogin yes\n```", "```\nPermitRootLogin no\n```", "```\nsudo systemctl reload sshd\n```", "```\nPermitRootLogin prohibit-password\n```", "```\n#PasswordAuthentication yes\n```", "```\nPasswordAuthentication no\n```", "```\n#PermitRootLogin yes\n#PermitRootLogin prohibit-password\n```", "```\nPermitRootLogin no\n```", "```\nsudo systemctl reload ssh\n```", "```\nsudo systemctl reload sshd\n```", "```\nsudo apt install libpam-google-authenticator\n```", "```\ngoogle-authenticator\n```", "```\n#\n# /etc/pam.d/common-auth - authentication settings common to all services\n#\n# This file is included from other service-specific PAM config files,\n. . .\n. . .\nauth required pam_google_authenticator.so\n# here are the per-package modules (the \"Primary\" block)\n. . .\n. . .\n```", "```\ndonnie@ubuntu2204-packt:~$ sudo nft list ruleset\nVerification code: \n[sudo] password for donnie:\n. . .\n. . .\nEnter the verification code at the prompt.\n```", "```\nsudo systemctl reload ssh\n```", "```\nPAM configuration for the Secure Shell service\n      # Standard Un*x authentication.\n     @include common-auth\n     auth required pam_google_authenticator.so\n```", "```\nAuthenticationMethods publickey keyboard-interactive:pam\n```", "```\nAuthenticationMethods publickey,keyboard-interactive:pam\n```", "```\nsudo dnf install epel-release\nsudo dnf install google-authenticator qrencode-libs\n```", "```\ngoogle-authenticator -s ~/.ssh/google_authenticator\n```", "```\nauth required pam_google_authenticator.so secret=/home/${USER}/.ssh/google_authenticator\n```", "```\nsudo systemctl reload sshd\n```", "```\ncd\nsudo restorecon .ssh/google_authenticator\n```", "```\nAuthenticationMethods publickey,password publickey,keyboard-interactive\n```", "```\nman sshd_conf\n```", "```\n3des-cbc\naes128-cbc\naes192-cbc\naes256-cbc\naes128-ctr\naes192-ctr\naes256-ctr\naes128-gcm@openssh.com\naes256-gcm@openssh.com\narcfour\narcfour128\narcfour256\nblowfish-cbc\ncast128-cbc\nchacha20-poly1305@openssh.com\n```", "```\nchacha20-poly1305@openssh.com,\naes128-ctr,aes192-ctr,aes256-ctr,\naes128-gcm@openssh.com,aes256-gcm@openssh.com,\naes128-cbc,aes192-cbc,aes256-cbc,\nblowfish-cbc,cast128-cbc,3des-cbc\n```", "```\necdsa-sha2-nistp256-cert-v01@openssh.com,\necdsa-sha2-nistp384-cert-v01@openssh.com,\necdsa-sha2-nistp521-cert-v01@openssh.com,\nssh-ed25519-cert-v01@openssh.com,\nssh-rsa-cert-v01@openssh.com,\nssh-dss-cert-v01@openssh.com,\necdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,\nssh-ed25519,ssh-rsa,ssh-dss\n```", "```\ncurve25519-sha256\ncurve25519-sha256@libssh.org\ndiffie-hellman-group1-sha1\ndiffie-hellman-group14-sha1\ndiffie-hellman-group-exchange-sha1\ndiffie-hellman-group-exchange-sha256\necdh-sha2-nistp256\necdh-sha2-nistp384\necdh-sha2-nistp521\n```", "```\ncurve25519-sha256\ncurve25519-sha256@libssh.org\ndiffie-hellman-group1-sha1\ndiffie-hellman-group14-sha1\ndiffie-hellman-group14-sha256\ndiffie-hellman-group16-sha512\ndiffie-hellman-group18-sha512\ndiffie-hellman-group-exchange-sha1\ndiffie-hellman-group-exchange-sha256\necdh-sha2-nistp256\necdh-sha2-nistp384\necdh-sha2-nistp521\n```", "```\ncurve25519-sha256,curve25519-sha256@libssh.org,\necdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,\ndiffie-hellman-group-exchange-sha256,\ndiffie-hellman-group14-sha1,\ndiffie-hellman-group1-sha1\n```", "```\numac-64-etm@openssh.com,umac-128-etm@openssh.com,\nhmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,\nhmac-sha1-etm@openssh.com,\numac-64@openssh.com,umac-128@openssh.com,\nhmac-sha2-256,hmac-sha2-512,hmac-sha1,\nhmac-sha1-etm@openssh.com\n```", "```\nssh -Q cipher\nssh -Q key\nssh -Q kex\nssh -Q mac\n```", "```\nsudo apt update\nsudo apt install nmap\n```", "```\nsudo yum install nmap\n```", "```\nsudo dnf install nmap\n```", "```\nnmap --script=ssh2-enum-algos.nse 192.168.0.14\n```", "```\nnmap -Pn --script=ssh2-enum-algos.nse 192.168.0.14\n```", "```\nnmap --script=ssh2-enum-algos.nse 192.168.0.14 -oN ubuntuscan.txt\n```", "```\nnmap -p 2222 --script=ssh2-enum-algos.nse 192.168.0.14\n```", "```\nnmap --script=ssh2-enum-algos.nse 192.168.0.14 -oN ubuntuscan.txt\n```", "```\nwc -l ubuntuscan.txt\n```", "```\n# Ciphers and keying\n#RekeyLimit default none\n```", "```\nCiphers -aes128-ctr,aes192-ctr,aes128-gcm@openssh.com\nKexAlgorithms ecdh-sha2-nistp384\nMACs -hmac-sha1-etm@openssh.com,hmac-sha1,umac-64-etm@openssh.com,umac-64@openssh.com,umac-128-etm@openssh.com,umac-128@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-256\n```", "```\nsudo systemctl restart ssh\nsudo systemctl status ssh\n```", "```\nnmap --script=ssh2-enum-algos.nse 192.168.0.14 -oN ubuntuscan_modified.txt\n```", "```\nwc -l ubuntuscan_modified.txt\n```", "```\ndiff -y ubuntuscan.txt ubuntuscan_modified.txt\n```", "```\nnmap -Pn --script=ssh2-enum-algos.nse 192.168.0.12 -oN centos7scan.txt\n```", "```\nwc -l centos7scan.txt\n```", "```\n# Ciphers and keying\n#RekeyLimit default none\n```", "```\nCiphers aes256-gcm@openssh.com,aes256-ctr,chacha20-poly1305@openssh.com\nKexAlgorithms ecdh-sha2-nistp384\nMACs hmac-sha2-256-etm@openssh.com,hmac-sha2-256\n```", "```\nsudo systemctl reload sshd\nsudo systemctl status sshd\n```", "```\nnmap -Pn --script=ssh2-enum-algos.nse 192.168.0.12 -oN centos7scan_modified.txt\n```", "```\nwc -l centos7scan_modified.txt\n```", "```\ndiff -y centos7scan.txt centos7scan_modified.txt\n```", "```\n[donnie@localhost back-ends]$ ls -l\ntotal 0\n. . .\n. . .\nlrwxrwxrwx. 1 root root 46 Sep 24 18:17 openssh.config -> /usr/share/crypto-policies/DEFAULT/openssh.txt\nlrwxrwxrwx. 1 root root 52 Sep 24 18:17 opensshserver.config -> /usr/share/crypto-policies/DEFAULT/opensshserver.txt\nlrwxrwxrwx. 1 root root 49 Sep 24 18:17 opensslcnf.config -> /usr/share/crypto-policies/DEFAULT/opensslcnf.txt\nlrwxrwxrwx. 1 root root 46 Sep 24 18:17 openssl.config -> /usr/share/crypto-policies/DEFAULT/openssl.txt\n[donnie@localhost back-ends]$\n```", "```\nDEFAULT\n```", "```\nsudo update-crypto-policies --show\n```", "```\nnmap -Pn --script=ssh2-enum-algos.nse 192.168.0.17 -oN alma9_default.txt\n```", "```\nsudo update-crypto-policies --set FUTURE\n```", "```\nsudo rm /etc/ssh/*key*\n```", "```\nsudo shutdown -r now\n```", "```\nnmap -Pn --script=ssh2-enum-algos.nse 192.168.0.17 -oN alma9_future.txt\n```", "```\ndiff -y alma9_default.txt alma9_future.txt\n```", "```\nls -l /etc/crypto-policies/back-ends/\n```", "```\nls -l /etc/ssh/*key*\n```", "```\nOct  1 15:03:23 donnie-ca sshd[1141]: Accepted password for donnie from 192.168.0.225 port 54422 ssh2\nOct  1 15:03:24 donnie-ca sshd[1141]: pam_unix(sshd:session): session opened for user donnie by (uid=0)\n```", "```\nsudo less /var/log/auth.log\n```", "```\nsudo less /var/log/secure\n```", "```\n#LogLevel INFO\n```", "```\nLogLevel DEBUG3\n```", "```\nsudo systemctl reload ssh\n```", "```\nsudo systemctl reload sshd\n```", "```\nLogLevel VERBOSE\n```", "```\nsudo adduser frank\n```", "```\nsudo useradd frank\nsudo passwd frank\n```", "```\nsudo groupadd webadmins\nsudo usermod -a -G webadmins frank\n```", "```\nAllowUsers donnie\n```", "```\nFor Ubuntu:\nsudo systemctl restart ssh\nsudo systemctl status ssh\nFor CentOS:\nsudo systemctl restart sshd\nsudo systemctl status sshd\n```", "```\nAllowGroups webadmins\n```", "```\nSSHD: 192.168.0.225\n```", "```\nSSHD: ALL\n```", "```\nTMOUT=100\nreadonly TMOUT\nexport TMOUT\n```", "```\nsudo chmod +x autologout.sh\n```", "```\n#ClientAliveInterval 0\n#ClientAliveCountMax 3\n```", "```\nClientAliveInterval 100\nClientAliveCountMax 0\n```", "```\nWarning!!  Authorized users only.  All others will be prosecuted.\n```", "```\n#Banner none\n```", "```\nBanner /etc/ssh/sshd-banner\n```", "```\n[donnie@fedora-teaching ~]$ ssh donnie@192.168.0.3\nWarning!!  Authorized users only.  All others will be prosecuted.\ndonnie@192.168.0.3's password: \nWelcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-64-generic x86_64)\n. . .\n. . .\n```", "```\nX11Forwarding yes\n```", "```\nssh -X donnie@192.168.0.12\n```", "```\nssh -Y donnie@192.168.0.12\n```", "```\nX11Forwarding no\n```", "```\nsudo ssh -L 80:localhost:80 donnie@192.168.0.12\n```", "```\nAllowTcpForwarding no\nAllowStreamLocalForwarding no\nGatewayPorts no\nPermitTunnel no\n```", "```\nvicky@ubuntu-nftables:~$ cd .ssh\nvicky@ubuntu-nftables:~/.ssh$ ls -l\ntotal 4\n-rw------- 1 vicky vicky 233 Oct  3 18:24 authorized_keys\nvicky@ubuntu-nftables:~/.ssh$\n```", "```\nsudo mkdir /etc/ssh/authorized-keys\n```", "```\ndonnie@ubuntu-nftables:~$ sudo su -\n[sudo] password for donnie: \nroot@ubuntu-nftables:~# cd /home/vicky/.ssh\nroot@ubuntu-nftables:/home/vicky/.ssh# ls -l\ntotal 4\n-rw------- 1 vicky vicky 233 Oct 3 18:24 authorized_keys\nroot@ubuntu-nftables:/home/vicky/.ssh#\n```", "```\nroot@ubuntu-nftables:/home/vicky/.ssh# mv authorized_keys /etc/ssh/authorized-keys/vicky\nroot@ubuntu-nftables:/home/vicky/.ssh# exit\ndonnie@ubuntu-nftables:~$\n```", "```\ndonnie@ubuntu-nftables:~$ cd /etc/ssh/authorized-keys/\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$ ls -l\ntotal 8\n-rw------- 1 vicky vicky 233 Oct 3 18:24 vicky\n-rw-r-----+ 1 root root 406 Oct 3 16:24 donnie\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$\n```", "```\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$ sudo chown root: vicky\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$ sudo setfacl -m u:vicky:r vicky \ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$\n```", "```\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$ ls -l \ntotal 8\n-rw-r-----+ 1 root root 406 Oct 3 16:24 donnie\n-rw-r-----+ 1 root root 233 Oct 3 18:53 vicky\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$\n```", "```\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$ getfacl vicky\n# file: vicky\n# owner: root\n# group: root\nuser::rw-\nuser:vicky:r--\ngroup::---\nmask::r--\nother::---\ndonnie@ubuntu-nftables:/etc/ssh/authorized-keys$\n```", "```\n#AuthorizedKeysFile     .ssh/authorized_keys .ssh/authorized_keys2\n```", "```\nAuthorizedKeysFile      /etc/ssh/authorized-keys/%u\n```", "```\n# Match User anoncvs\n# X11Forwarding no\n# AllowTcpForwarding no\n# PermitTTY no\n# ForceCommand cvs server\n```", "```\nHost ubuntu-nftables\n IdentityFile ~/.ssh/unft_id_rsa\n IdentitiesOnly yes\n ForwardX11 yes\n Cipher aes256-gcm@openssh.com\n```", "```\nsudo groupadd sftpusers\n```", "```\nsudo useradd -G sftpusers max\nsudo passwd max\n```", "```\nsudo useradd -m -d /home/max -s /bin/bash -G sftpusers max\n```", "```\nSubsystem sftp /usr/lib/openssh/sftp-server\n```", "```\nSubsystem sftp internal-sftp\n```", "```\nMatch Group sftpusers\n        ChrootDirectory /home\n        AllowTCPForwarding no\n        AllowAgentForwarding no\n        X11Forwarding no\n        ForceCommand internal-sftp\n```", "```\ndonnie@linux-0ro8:~> ssh max@192.168.0.8\nmax@192.168.0.8's password:\nThis service allows sftp connections only.\nConnection to 192.168.0.8 closed.\ndonnie@linux-0ro8:~>\n```", "```\ndonnie@linux-0ro8:~> sftp max@192.168.0.8\nmax@192.168.0.8's password:\nConnected to 192.168.0.8.\ndrwx------    7 1000     1000         4096 Nov  4 22:53 donnie\ndrwx------    5 1001     1001         4096 Oct 27 23:34 frank\ndrwx------    3 1003     1004         4096 Nov  4 22:43 katelyn\ndrwx------    2 1002     1003         4096 Nov  4 22:37 max\nsftp>\n```", "```\nsftp> cd /etc\nCouldn't stat remote file: No such file or directory\nsftp>\n```", "```\nsudo groupadd sftpusers\n```", "```\nsudo useradd -G sftpusers max\nsudo passwd max\n```", "```\nsudo useradd -m -d /home/max -s /bin/bash -G sftpusers max\n```", "```\nsudo chmod 700 /home/*\n```", "```\nSubsystem sftp /usr/lib/openssh/sftp-server\n```", "```\nSubsystem sftp internal-sftp\n```", "```\nMatch Group sftpusers\n     ChrootDirectory /home\n     AllowTCPForwarding no\n     AllowAgentForwarding no\n     X11Forwarding no\n     ForceCommand internal-sftp\n```", "```\nsudo systemctl reload sshd\n```", "```\nsudo systemctl reload ssh\n```", "```\nssh max@IP_Address_of_your_vm\n```", "```\nsftp max@IP_Address_of_your_vm\n```", "```\nmkdir remote\n```", "```\nsudo apt install sshfs\n```", "```\nsudo yum install fuse-sshfs\n```", "```\nsudo dnf install fuse-sshfs\n```", "```\nsshfs donnie@192.168.0.10: /home/donnie/remote\n```", "```\ndonnie@ubuntu-nftables:~$ mount\n. . .\n. . .\ndonnie@192.168.0.10: on /home/donnie/remote type fuse.sshfs (rw,nosuid,nodev,relatime,user_id=1000,group_id=1004)\n```", "```\nsshfs donnie@192.168.0.53:/maggie_files /home/donnie/remote3\n```"]