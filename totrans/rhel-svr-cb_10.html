<html><head></head><body>
<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10" class="calibre1"/>Chapter 10. Monitoring and Performance Tuning</h1></div></div></div><p class="calibre7">In this chapter, I'll explore the following topics:</p><div><ul class="itemizedlist"><li class="listitem">Tuning your system's performance</li><li class="listitem">Setting up PCP – Performance Co-Pilot</li><li class="listitem">Monitoring basic system performance</li><li class="listitem">Monitoring CPU performance</li><li class="listitem">Monitoring RAM performance</li><li class="listitem">Monitoring storage performance</li><li class="listitem">Monitoring network performance</li></ul></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_1"><a id="ch10lvl1sec75" class="calibre1"/>Introduction</h1></div></div></div><p class="calibre7">Monitoring your infrastructure is an important aspect of your environment as it teaches you much about its behavior. It will tell you where your bottlenecks are and where room for improvement is. In this chapter, we will monitor performance and not create triggers when certain metrics exceed specific values.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec76" class="calibre1"/>Tuning your system's performance</h1></div></div></div><p class="calibre7">Companies buy the best <a id="id497" class="calibre1"/>hardware their money can get, and they want to use everything optimally. However, it's not just the hardware that makes your applications run faster. Your OS will also behave differently under specific circumstances.</p><p class="calibre7">Tuned is a set of tools and a daemon that tunes your system's settings automatically depending on its usage. It periodically collects data from its components through plugins, which it uses to change system settings according to the current usage.</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec209" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre7">In this recipe, we'll<a id="id498" class="calibre1"/> ask tuned which profile to use and apply it through the following steps:</p><div><ol class="orderedlist"><li class="listitem" value="1">First, run the following command to install the required packages:<div><pre class="programlisting">
<strong class="calibre8">~]# yum install -y tuned</strong>
</pre></div></li><li class="listitem" value="2">Enable and start tuned by executing the following commands:<div><pre class="programlisting">
<strong class="calibre8">~]# systemctl enable tuned</strong>
<strong class="calibre8">~]# systemctl restart tuned</strong>
</pre></div></li><li class="listitem" value="3">Have tuned guess the profile to be used via the following:<div><pre class="programlisting">
<strong class="calibre8">~]# tuned-adm recommend</strong>
<strong class="calibre8">virtual-guest</strong>
</pre></div></li><li class="listitem" value="4">Finally, apply the recommended profile to tuned, as follows:<div><pre class="programlisting">
<strong class="calibre8">~]# tuned-adm profile virtual-guest</strong>
</pre></div></li></ol><div></div></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec210" class="calibre1"/>There's more…</h2></div></div></div><p class="calibre7">You can find the system's tuned profiles used in <code class="email">/lib/tuned/</code>. When you create your own, create them in <code class="email">/etc/tuned</code> in the same way as they are organized in <code class="email">/lib/tuned</code>. I do not recommend creating new profiles in <code class="email">/etc/tuned</code> with the same name as in <code class="email">/lib/tuned</code>, but if you do, the one in the <code class="email">/etc/tuned</code> directory will be used. It is better to create a new one with a different name, including the one you want to modify, and then make the necessary changes in your new profile.</p><p class="calibre7">Every profile has a directory, which contains a set of files controlling the behavior of your system. If you explore the <code class="email">tuned.conf</code> files in these directories, you will see that these files define the exact settings that other tools (such as <strong class="calibre8">cpufreq</strong>) need to be configured on and that some profiles include <a id="id499" class="calibre1"/>other profiles. For instance, if you create a profile for, say, a laptop that is a little better on the battery by applying the <code class="email">powersave</code> CPU governor, you could create a new file located at <code class="email">/etc/tuned/laptop/tuned.conf</code> containing the following:</p><div><pre class="programlisting">#
# laptop tuned configuration
#

[main]
include=desktop

[cpu]
replace=1
governor=powersave</pre></div><p class="calibre7">When you<a id="id500" class="calibre1"/> know the bottlenecks of your systems, you can find out how to mitigate them by configuring your system in a specific way. Tuned can come in handy to create and apply profiles based on the performance monitoring of your components.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec211" class="calibre1"/>See also</h2></div></div></div><p class="calibre7">For more<a id="id501" class="calibre1"/> information about tuning your system, refer to the Red Hat Performance Tuning guide at <a class="calibre1" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Performance_Tuning_Guide/index.html">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Performance_Tuning_Guide/index.html</a>.</p><p class="calibre7">Check out the man pages of <em class="calibre9">tuned (8)</em>, <em class="calibre9">tuned-adm (8)</em>, <em class="calibre9">tuned-main.conf (5)</em>, and <em class="calibre9">tuned.conf (5)</em> for more information.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec77" class="calibre1"/>Setting up PCP – Performance Co-Pilot</h1></div></div></div><p class="calibre7">Over the years, a lot of tools have been created to troubleshoot performance issues on your systems, such as <code class="email">top</code>, <code class="email">sar</code>, <code class="email">iotop</code>, <code class="email">iostat</code>, <code class="email">iftop</code>, <code class="email">vmstat</code>, <code class="email">dstat</code>, and others. However, none<a id="id502" class="calibre1"/> of these integrate with each other, some are extensions to others, and so on.</p><p class="calibre7">PCP seems to have a couple of things right: it monitors just about every aspect of your system, it allows the centralized storage of (important) performance data, and it allows you to use not only live data, but also saved data among others.</p></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec212" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre7">In this recipe, we'll look at both the "default" setup and "collector" configuration, which allows you to pull in all the performance data you want.</p><div><div><div><div><h3 class="title2"><a id="ch10lvl3sec74" class="calibre1"/>The default installation</h3></div></div></div><p class="calibre7">This is the<a id="id503" class="calibre1"/> basic setup of PCP:</p><div><ol class="orderedlist"><li class="listitem" value="1">Let's install the necessary packages; run the following command:<div><pre class="programlisting">
<strong class="calibre8">~]# yum install -y pcp</strong>
</pre></div></li><li class="listitem" value="2">Now, enable and start the necessary daemons, as follows:<div><pre class="programlisting">
<strong class="calibre8">~]# systemctl enable pmcd</strong>
<strong class="calibre8">~]# systemctl enable pmlogger</strong>
<strong class="calibre8">~]# systemctl start pmcd</strong>
<strong class="calibre8">~]# systemctl start pmlogger</strong>
</pre></div></li><li class="listitem" value="3">If you want to<a id="id504" class="calibre1"/> have the system monitored by a central collector, execute the following:<div><pre class="programlisting">
<strong class="calibre8">~]# firewall-cmd --add-service pmcd --permanent</strong>
</pre></div></li></ol><div></div></div><div><div><div><div><h3 class="title2"><a id="ch10lvl3sec75" class="calibre1"/>The central collector</h3></div></div></div><p class="calibre7">Each host that<a id="id505" class="calibre1"/> is to act as a collector requires additional configuration. Here's how you can do this:</p><div><ol class="orderedlist"><li class="listitem" value="1">Add a line per system to collect data from <code class="email">/etc/pcp/pmlogger/control</code>, as follows:<div><pre class="programlisting">&lt;hostname&gt; n n PCP_LOG_DIR/pmlogger/&lt;hostname&gt; -r -T24h10m -c config.&lt;hostname&gt;</pre></div><p class="calibre13">Here, <code class="email">&lt;hostname&gt;</code> is the FDQN to this host. Take a look at the following example:</p><div><pre class="programlisting">guest.example.com n n PCP_LOG_DIR/pmlogger/guest.example.com -r -T24h10m -c config.guest.example.com</pre></div></li><li class="listitem" value="2">After adding a host in this way, you need to restart the <code class="email">pmlogger</code> daemon. Execute the following command line:<div><pre class="programlisting">
<strong class="calibre8">~]# systemctl restart pmlogger</strong>
</pre></div></li></ol><div></div></div></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec213" class="calibre1"/>There's more…</h2></div></div></div><p class="calibre7">By default, PCP logs information every 60 seconds. If you want to increase this and want to gather performance statistics every 30 seconds, you need to change the line starting with <code class="email">LOCALHOSTNAME</code> and add <code class="email">-t 30s</code> at the end.</p><p class="calibre7">Modifying the statistics you gather is a bit more difficult. You can find the configuration for <code class="email">pmlogger</code> in <code class="email">/var/lib/pcp/config/pmlogconf/</code>. Every file in this directory contains information about which pointers to gather. The syntax is not very hard to understand, but it is complex to explain. The <em class="calibre9">pmlogconf (1)</em> man page contains everything you need to know.</p><p class="calibre7">If you want to visualize the data on a host, you need to install <code class="email">pcp-gui</code>, as follows:</p><div><pre class="programlisting">
<strong class="calibre8">~]# yum install -y pcp-gui dejavu-sans-fonts</strong>
</pre></div><p class="calibre7">This package comes with a tool called <code class="email">pmchart</code>, which allows you to create graphics with the data collected by PCP. The fonts are needed to properly display the characters.</p></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch10lvl2sec214" class="calibre1"/>See also</h2></div></div></div><p class="calibre7">For more information about PCP and its components, refer to their online manuals, which you<a id="id506" class="calibre1"/> can find at <a class="calibre1" href="http://www.pcp.io/documentation.html">http://www.pcp.io/documentation.html</a>.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec78" class="calibre1"/>Monitoring basic system performance</h1></div></div></div><p class="calibre7">We need to keep an eye out on global system values. The ones that are particularly of interest are <a id="id507" class="calibre1"/>the following:</p><div><ul class="itemizedlist"><li class="listitem"><code class="email">kernel.all.pswitch</code></li><li class="listitem"><code class="email">kernel.all.nprocs</code></li><li class="listitem"><code class="email">kernel.all.load</code></li></ul></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec215" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre7">I'll show you a way to display both text-based and graphical output. Here are the steps:</p><div><ol class="orderedlist"><li class="listitem" value="1">Display live data for the metrics with a 1-second interval for the <code class="email">guest.example.com</code> host by executing the following command:<div><pre class="programlisting">
<strong class="calibre8">~]# pmdumptext -H -t 1 -i -l kernel.all.pswitch kernel.all.nprocs kernel.all.load -h guest.example.com</strong>
</pre></div><div><img src="img/00070.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li><li class="listitem" value="2">Create a configuration file for <code class="email">pmchart</code> to display live data called <code class="email">system.conf</code> with the following contents:<div><pre class="programlisting">
<strong class="calibre8">#kmchart</strong>
<strong class="calibre8">version 1</strong>

<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        </strong>
<strong class="calibre8">plot color #ffff00 metric kernel.all.pswitch</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #ffff00 metric kernel.all.nprocs</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #ffff00 metric kernel.all.load instance "1 minute"</strong>
<strong class="calibre8">        plot color #ff924a metric kernel.all.load instance "5 minute"</strong>
<strong class="calibre8">        plot color #ff0000 metric kernel.all.load instance "15 minute"</strong>
</pre></div></li><li class="listitem" value="3">Next, use <code class="email">pmchart</code> to plot a live chart for <code class="email">guest.example.com</code> via the following<a id="id508" class="calibre1"/> command:<div><pre class="programlisting">
<strong class="calibre8">~]# pmchart -h guest.example.com -c system.conf</strong>
</pre></div><div><img src="img/00071.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li></ol><div></div></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch10lvl2sec216" class="calibre1"/>There's more…</h2></div></div></div><p class="calibre7">The preceding examples are based on "live" data; however, you're not limited to live data. You could increase the interval of <code class="email">pmlogger</code> in order to get more data about a troublesome system and then take a look at the generated data afterwards. With other tools, you'd have to use additional tools through cronjob and so on, while PCP allows you to do both.</p><p class="calibre7">Here's how <a id="id509" class="calibre1"/>you can do this:</p><div><ol class="orderedlist"><li class="listitem" value="1">Show the the data of <code class="email">guest.example.com</code> for November 1, 2015 between <code class="email">15:30</code> and <code class="email">16:30</code> with a 5-minute interval via the following command:<div><pre class="programlisting">
<strong class="calibre8">~]# pmdumptext -H -t 5m -i -l -S @15:30 -T @16:30 kernel.all.pswitch kernel.all.nprocs kernel.all.load -a /var/log/pcp/pmlogger/guest.example.com/20151101</strong>
</pre></div><div><img src="img/00072.jpeg" alt="There's more…" class="calibre10"/></div><p class="calibre15"> </p></li><li class="listitem" value="2">You can do the same with <code class="email">pmchart</code>, as follows:<div><pre class="programlisting">
<strong class="calibre8">~]# pmchart -a /var/log/pcp/pmlogger/guest.example.com/20151101 -c system.conf -S @15:30 -T @16:30 -W -o output.png</strong>
</pre></div><div><img src="img/00073.jpeg" alt="There's more…" class="calibre10"/></div><p class="calibre15"> </p></li></ol><div></div></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec79" class="calibre1"/>Monitoring CPU performance</h1></div></div></div><p class="calibre7">This recipe <a id="id510" class="calibre1"/>will show you how to visualize using <code class="email">pmchart</code> and command-line tools to monitor your CPU's performance. We will have a look at the following metrics:</p><div><ul class="itemizedlist"><li class="listitem"><code class="email">kernel.all.cpu.wait.total</code></li><li class="listitem"><code class="email">kernel.all.cpu.irq.hard</code></li><li class="listitem"><code class="email">kernel.all.cpu.irq.soft</code></li><li class="listitem"><code class="email">kernel.all.cpu.steal</code></li><li class="listitem"><code class="email">kernel.all.cpu.sys</code></li><li class="listitem"><code class="email">kernel.all.cpu.user</code></li><li class="listitem"><code class="email">kernel.all.cpu.nice</code></li><li class="listitem"><code class="email">kernel.all.cpu.idle</code></li></ul></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec217" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre7">This will show <a id="id511" class="calibre1"/>you how to create the text and graphical representation of performance data. Perform the following steps:</p><div><ol class="orderedlist"><li class="listitem" value="1">Display live data for the preceding metrics with a 1-second interval for the host, <code class="email">localhost</code>. Execute the following command:<div><pre class="programlisting">
<strong class="calibre8">~]# pmdumptext -H -t 1 -i -l kernel.all.cpu.wait.total kernel.all.cpu.irq.hard kernel.all.cpu.irq.soft kernel.all.cpu.steal kernel.all.cpu.sys kernel.all.cpu.user kernel.all.cpu.nice kernel.all.cpu.idle -h localhost</strong>
</pre></div><div><img src="img/00074.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li><li class="listitem" value="2">Create a configuration file for <code class="email">pmchart</code> to display live data called <code class="email">cpu_stack.conf</code> with the following contents:<div><pre class="programlisting">
<strong class="calibre8">#kmchart</strong>
<strong class="calibre8">version 1</strong>

<strong class="calibre8">chart style stacking antialiasing off</strong>
<strong class="calibre8">        plot color #aaaa7f metric kernel.all.cpu.wait.total</strong>
<strong class="calibre8">        </strong>
<strong class="calibre8">plot color #008000 metric kernel.all.cpu.irq.hard</strong>
<strong class="calibre8">        plot color #ee82ee metric kernel.all.cpu.irq.soft</strong>
<strong class="calibre8">        plot color #666666 metric kernel.all.cpu.steal</strong>
<strong class="calibre8">        plot color #aa00ff metric kernel.all.cpu.user</strong>
<strong class="calibre8">        plot color #aaff00 metric kernel.all.cpu.sys</strong>
<strong class="calibre8">        plot color #aa5500 metric kernel.all.cpu.nice</strong>
<strong class="calibre8">        plot color #0000ff metric kernel.all.cpu.idle</strong>
</pre></div><p class="calibre13">You will notice that I don't use all the metrics in the graph as some of the metrics are combined with one another.</p></li><li class="listitem" value="3">Use <code class="email">pmchart</code> to<a id="id512" class="calibre1"/> plot a live chart for <code class="email">guest.example.com</code>, as follows:<div><pre class="programlisting">
<strong class="calibre8">~]# pmchart -h guest.example.com -c cpu_stack.conf</strong>
</pre></div><div><img src="img/00075.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li></ol><div></div></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec80" class="calibre1"/>Monitoring RAM performance</h1></div></div></div><p class="calibre7">To monitor <a id="id513" class="calibre1"/>RAM performance, I am only interested in a couple of metrics, not all the memory-related ones. Take a look at this list:</p><div><ul class="itemizedlist"><li class="listitem"><code class="email">mem.util.used</code></li><li class="listitem"><code class="email">mem.util.free</code></li><li class="listitem"><code class="email">mem.util.bufmem</code></li><li class="listitem"><code class="email">mem.util.cached</code></li><li class="listitem"><code class="email">swap.free</code></li><li class="listitem"><code class="email">swap.used</code></li><li class="listitem"><code class="email">swap.pagesin</code></li><li class="listitem"><code class="email">swap.pagesout</code></li></ul></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec218" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre7">This recipe will explain you how to create text-based and graphical outputs:</p><div><ol class="orderedlist"><li class="listitem" value="1">First, display live data for the preceding metrics through this command:<div><pre class="programlisting">
<strong class="calibre8">~]# pmdumptext -H -t 1 -i -l mem.util.used mem.util.free mem.util.bufmem mem.util.cached swap.free swap.used swap.pagesin swap.pagesout -h guest.example.com</strong>
</pre></div><div><img src="img/00076.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li><li class="listitem" value="2">Create a configuration file for <code class="email">pmchart</code> to display live data called <code class="email">memory.conf</code> with the following contents:<div><pre class="programlisting">
<strong class="calibre8">#kmchart</strong>
<strong class="calibre8">version 1</strong>

<strong class="calibre8">chart style stacking</strong>
<strong class="calibre8">        plot color #ffff00 metric mem.util.used</strong>
<strong class="calibre8">        plot color #ee82ee metric mem.util.free</strong>
<strong class="calibre8">chart style stacking</strong>
<strong class="calibre8">        plot color #ffff00 metric swap.used</strong>
<strong class="calibre8">        plot color #0000ff metric swap.free</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #19ff00 metric swap.pagesin</strong>
<strong class="calibre8">        plot color #ff0004 metric swap.pagesout</strong>
</pre></div></li><li class="listitem" value="3">Now<a id="id514" class="calibre1"/>, use <code class="email">pmchart</code> to plot a live chart for <code class="email">guest.example.com</code> by executing the following command line:<div><pre class="programlisting">
<strong class="calibre8">~]# pmchart -h guest.example.com -c memory.conf</strong>
</pre></div><div><img src="img/00077.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li></ol><div></div><p class="calibre7">I haven't included <a id="id515" class="calibre1"/>the buffer and cached memory in this graph as it's part of the memory-used metric.</p></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec81" class="calibre1"/>Monitoring storage performance</h1></div></div></div><p class="calibre7">In this<a id="id516" class="calibre1"/> recipe, we'll look at the following metrics:</p><div><ul class="itemizedlist"><li class="listitem"><code class="email">disk.all.read</code></li><li class="listitem"><code class="email">disk.all.write</code></li><li class="listitem"><code class="email">disk.all.read_bytes</code></li><li class="listitem"><code class="email">disk.all.write_bytes</code></li></ul></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec219" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre7">Let's create a text and graphical representation of the performance data through the following steps:</p><div><ol class="orderedlist"><li class="listitem" value="1">Display live data for the preceding metrics; you can use the following command for this:<div><pre class="programlisting">
<strong class="calibre8">~]# pmdumptext -H -t 1 -i -l disk.all.read disk.all.write disk.all.read_bytes disk.all.write_bytes -h guest.example.com</strong>
</pre></div><div><img src="img/00078.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li><li class="listitem" value="2">Next, create <a id="id517" class="calibre1"/>a configuration file for <code class="email">pmchart</code> to display live data called <code class="email">disk.conf</code> with the following contents:<div><pre class="programlisting">
<strong class="calibre8">#kmchart</strong>
<strong class="calibre8">version 1</strong>

<strong class="calibre8">chart style stacking</strong>
<strong class="calibre8">        plot color #ffff00 metric mem.util.used</strong>
<strong class="calibre8">        plot color #ee82ee metric mem.util.free</strong>
<strong class="calibre8">chart style stacking</strong>
<strong class="calibre8">        </strong>
<strong class="calibre8">plot color #ffff00 metric swap.used</strong>
<strong class="calibre8">        plot color #0000ff metric swap.free</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #19ff00 metric swap.pagesin</strong>
<strong class="calibre8">        plot color #ff0004 metric swap.pagesout</strong>
</pre></div></li><li class="listitem" value="3">Now, use <code class="email">pmchart</code> to plot a live chart for <code class="email">guest.example.com</code>, as follows:<div><pre class="programlisting">
<strong class="calibre8">~]# pmchart -h guest.example.com -c memory.conf</strong>
</pre></div><div><img src="img/00079.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li></ol><div></div></div></div>

<div><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch10lvl1sec82" class="calibre1"/>Monitoring network performance</h1></div></div></div><p class="calibre7">In this<a id="id518" class="calibre1"/> recipe, we'll look at the following network metrics:</p><div><ul class="itemizedlist"><li class="listitem"><code class="email">network.interface.collisions</code></li><li class="listitem"><code class="email">network.interface.in.bytes</code></li><li class="listitem"><code class="email">network.interface.in.packets</code></li><li class="listitem"><code class="email">network.interface.in.errors</code></li><li class="listitem"><code class="email">network.interface.in.drops</code></li><li class="listitem"><code class="email">network.interface.out.bytes</code></li><li class="listitem"><code class="email">network.interface.out.packets</code></li><li class="listitem"><code class="email">network.interface.out.errors</code></li><li class="listitem"><code class="email">network.interface.out.drops</code></li></ul></div></div>

<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch10lvl2sec220" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre7">Now, one last time, we'll look at how we can create a text and graphical representation of data. Perform <a id="id519" class="calibre1"/>the following steps:</p><div><ol class="orderedlist"><li class="listitem" value="1">Display live data for the preceding metrics; run the following command:<div><pre class="programlisting">
<strong class="calibre8">~]# pmdumptext -H -t 1 -i -l network.interface.collisions network.interface.in.bytes network.interface.in.packets network.interface.in.errors network.interface.in.drops network.interface.out.bytes network.interface.out.packets network.interface.out.errors network.interface.out.drops -h guest.example.com</strong>
</pre></div><div><img src="img/00080.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li><li class="listitem" value="2">Create a configuration file for <code class="email">pmchart</code> to display live data called <code class="email">network.conf</code> with the following contents:<div><pre class="programlisting">
<strong class="calibre8">#kmchart</strong>
<strong class="calibre8">version 1</strong>

<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #ff0000 metric network.interface.collisions instance "eth0"</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #00ff00 metric network.interface.in.bytes instance "eth0"</strong>
<strong class="calibre8">        plot color #ff0000 metric network.interface.out.bytes instance "eth0"</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        </strong>
<strong class="calibre8">plot color #00ff00 metric network.interface.in.packets instance "eth0"</strong>
<strong class="calibre8">        plot color #ff0000 metric network.interface.out.packets instance "eth0"</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #00ff00 metric network.interface.in.errors instance "eth0"</strong>
<strong class="calibre8">        plot color #ff0000 metric network.interface.out.errors instance "eth0"</strong>
<strong class="calibre8">chart style plot antialiasing off</strong>
<strong class="calibre8">        plot color #00ff00 metric network.interface.in.drops instance "eth0"</strong>
<strong class="calibre8">        plot color #ff0000 metric network.interface.out.drops instance "eth0"</strong>
</pre></div></li><li class="listitem" value="3">Next, use <code class="email">pmchart</code> to plot a live chart for <code class="email">guest.example.com</code> via this command<a id="id520" class="calibre1"/> line:<div><pre class="programlisting">
<strong class="calibre8">~]# pmchart -h guest.example.com -c network.conf</strong>
</pre></div><div><img src="img/00081.jpeg" alt="How to do it…" class="calibre10"/></div><p class="calibre15"> </p></li></ol><div></div></div></div></body></html>