["```\n donnie@ubuntu:~$ sudo iptables -L\n [sudo] password for donnie:\n Chain INPUT (policy ACCEPT)\n target prot opt source destination\n Chain FORWARD (policy ACCEPT)\n target prot opt source destination\n Chain OUTPUT (policy ACCEPT)\n target prot opt source destination\n donnie@ubuntu:~$\n```", "```\n donnie@ubuntu:~$ sudo ip6tables -L\n Chain INPUT (policy ACCEPT)\n target prot opt source destination\n Chain FORWARD (policy ACCEPT)\n target prot opt source destination\n Chain OUTPUT (policy ACCEPT)\n target prot opt source destination\n donnie@ubuntu:~$\n```", "```\nsudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT\n```", "```\n donnie@ubuntu:~$ sudo iptables -L\n Chain INPUT (policy ACCEPT)\n target prot opt source destination\n ACCEPT all -- anywhere anywhere ctstate RELATED,ESTABLISHED\n Chain FORWARD (policy ACCEPT)\n target prot opt source destination\n Chain OUTPUT (policy ACCEPT)\n target prot opt source destination\n donnie@ubuntu:~$\n```", "```\nsudo iptables -A INPUT -p tcp --dport ssh -j ACCEPT\n```", "```\nsudo iptables -A INPUT -p tcp --dport 53 -j ACCEPT\nsudo iptables -A INPUT -p udp --dport 53 -j ACCEPT\n```", "```\n donnie@ubuntu:~$ sudo iptables -L\n Chain INPUT (policy ACCEPT)\n target prot opt source destination\n ACCEPT all -- anywhere anywhere ctstate\n RELATED,ESTABLISHED\n ACCEPT tcp -- anywhere anywhere tcp dpt:ssh\n DROP all -- anywhere anywhere\n Chain FORWARD (policy ACCEPT)\n target prot opt source destination\n Chain OUTPUT (policy ACCEPT)\n target prot opt source destination\n donnie@ubuntu:~$\n```", "```\nsudo iptables -I INPUT 1 -i lo -j ACCEPT\n```", "```\ndonnie@ubuntu:~$ sudo iptables -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nACCEPT     all  --  anywhere             anywhere            \nACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED\nACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ssh\nACCEPT     tcp  --  anywhere             anywhere             tcp dpt:domain\nACCEPT     udp  --  anywhere             anywhere             udp dpt:domain\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination         \nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination         \ndonnie@ubuntu:~$\n```", "```\ndonnie@ubuntu3:~$ sudo iptables -L -n\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           \nACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:22\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:53\nACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:53\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination         \nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination         \ndonnie@ubuntu3:~$\n```", "```\nsudo iptables -A INPUT -m conntrack -p icmp --icmp-type 3 --ctstate NEW,ESTABLISHED,RELATED -j ACCEPT\nsudo iptables -A INPUT -m conntrack -p icmp --icmp-type 11 --ctstate NEW,ESTABLISHED,RELATED -j ACCEPT\nsudo iptables -A INPUT -m conntrack -p icmp --icmp-type 12 --ctstate NEW,ESTABLISHED,RELATED -j ACCEPT\n```", "```\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nACCEPT     all  --  anywhere             anywhere            \nACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED\nACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ssh\nACCEPT     tcp  --  anywhere             anywhere             tcp dpt:domain\nACCEPT     udp  --  anywhere             anywhere             udp dpt:domain\nACCEPT     icmp --  anywhere             anywhere             ctstate NEW,RELATED,ESTABLISHED icmp destination-unreachable\nACCEPT     icmp --  anywhere             anywhere             ctstate NEW,RELATED,ESTABLISHED icmp source-quench\nACCEPT     icmp --  anywhere             anywhere             ctstate NEW,RELATED,ESTABLISHED icmp time-exceeded\nACCEPT     icmp --  anywhere             anywhere             ctstate NEW,RELATED,ESTABLISHED icmp parameter-problem\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination         \nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination \n```", "```\ndonnie@ubuntu:~$ sudo iptables -A INPUT -j DROP\ndonnie@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ sudo iptables -P INPUT DROP\ndonnie@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ sudo iptables -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nACCEPT     all  --  anywhere             anywhere            \nACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED\n. . .\n. . .\nACCEPT     icmp --  anywhere             anywhere             ctstate NEW,RELATED,ESTABLISHED icmp parameter-problem\nDROP       all  --  anywhere             anywhere            \nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination         \n. . .\n. . .\n```", "```\ndonnie@ubuntu:~$ sudo iptables -L -v\nChain INPUT (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target prot opt in out source destination \n   67 4828 ACCEPT all -- lo any anywhere anywhere \n  828 52354 ACCEPT all -- any any anywhere anywhere ctstate RELATED,ESTABLISHED\n. . .\n. . .\n    0 0 ACCEPT icmp -- any any anywhere anywhere ctstate NEW,RELATED,ESTABLISHED icmp parameter-problem\n  251 40768 DROP all -- any any anywhere anywhere \nChain FORWARD (policy ACCEPT 0 packets, 0 bytes)\n pkts bytes target prot opt in out source destination \n. . .\n. . .\n```", "```\nsudo apt install iptables-persistent\n```", "```\n donnie@ubuntu:~$ ls -l /etc/iptables*\n total 8\n -rw-r--r-- 1 root root 336 Oct 10 10:29 rules.v4\n -rw-r--r-- 1 root root 183 Oct 10 10:29 rules.v6\n donnie@ubuntu:~$\n```", "```\nsudo iptables -L\n```", "```\nsudo systemctl disable --now ufw\n```", "```\nsudo iptables -A INPUT -m conntrack  --ctstate ESTABLISHED,RELATED  -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport ssh -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 53 -j ACCEPT\nsudo iptables -A INPUT -p udp --dport 53 -j ACCEPT\nsudo iptables -A INPUT -m conntrack -p icmp --icmp-type 3 --ctstate NEW,ESTABLISHED,RELATED -j ACCEPT\nsudo iptables -A INPUT -m conntrack -p icmp --icmp-type 11 --ctstate NEW,ESTABLISHED,RELATED -j ACCEPT\nsudo iptables -A INPUT -m conntrack -p icmp --icmp-type 12 --ctstate NEW,ESTABLISHED,RELATED -j ACCEPT\nsudo iptables -A INPUT -j DROP\n```", "```\nsudo iptables -L\n```", "```\nsudo iptables -I INPUT 1 -i lo -j ACCEPT\n```", "```\n sudo iptables -L\n sudo iptables -L -v\n```", "```\nsudo apt install iptables-persistent\n```", "```\n donnie@ubuntu:~$ sudo iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP\n\n donnie@ubuntu:~$ sudo iptables -t mangle -A PREROUTING -p tcp ! --syn -m conntrack --ctstate NEW -j DROP\n donnie@ubuntu:~$\n```", "```\n donnie@ubuntu:~$ sudo iptables -L\n Chain INPUT (policy ACCEPT)\n target     prot opt source               destination         \n ACCEPT     all  --  anywhere             anywhere            \n ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED\n ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ssh\n DROP       all  --  anywhere             anywhere            \n\n Chain FORWARD (policy ACCEPT)\n target     prot opt source               destination         \n\n Chain OUTPUT (policy ACCEPT)\n target     prot opt source               destination         \n donnie@ubuntu:~$\n```", "```\n donnie@ubuntu:~$ sudo iptables -t mangle -L\n Chain PREROUTING (policy ACCEPT)\n target     prot opt source               destination         \n DROP       all  --  anywhere             anywhere             ctstate INVALID\n DROP       tcp  --  anywhere             anywhere             tcp flags:!FIN,SYN,RST,ACK/SYN ctstate NEW\n\n Chain INPUT (policy ACCEPT)\n target     prot opt source               destination         \n Chain FORWARD (policy ACCEPT)\n target     prot opt source               destination         \n Chain OUTPUT (policy ACCEPT)\n target     prot opt source               destination         \n Chain POSTROUTING (policy ACCEPT)\n target     prot opt source               destination         \n donnie@ubuntu:~$\n```", "```\nDROP     tcp  --  anywhere   anywhere    tcp flags:!FIN,SYN,RST,ACK/SYN ctstate NEW\n```", "```\n donnie@ubuntu:~$ sudo iptables-save > rules.v4\n [sudo] password for donnie:\n donnie@ubuntu:~$ sudo cp rules.v4 /etc/iptables/\n donnie@ubuntu:~$\n```", "```\n[donnie@fedora-teaching ~]$ sudo nmap -sX 192.168.0.15\n [sudo] password for donnie:\n Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-26 21:20 EDT\n Nmap scan report for 192.168.0.15\n Host is up (0.00052s latency).\n All 1000 scanned ports on 192.168.0.15 are open|filtered\n MAC Address: 08:00:27:A4:95:1A (Oracle VirtualBox virtual NIC)\n\n Nmap done: 1 IP address (1 host up) scanned in 21.41 seconds\n [donnie@fedora-teaching ~]$\n```", "```\ndonnie@ubuntu:~$ sudo iptables -t mangle -L -v\n Chain PREROUTING (policy ACCEPT 2898 packets, 434K bytes)\n  pkts bytes target     prot opt in     out     source               destination    \n\n  2000 80000 DROP  all  --  any    any     anywhere             anywhere             ctstate INVALID\n\n  0     0 DROP       tcp  --  any    any     anywhere             anywhere             tcp flags:!FIN,SYN,RST,ACK/SYN ctstate NEW\n\n . . .\n . . .\n donnie@ubuntu:~$\n```", "```\n donnie@ubuntu:~$ sudo iptables -t mangle -Z\n donnie@ubuntu:~$ sudo iptables -t mangle -L -v\n Chain PREROUTING (policy ACCEPT 22 packets, 2296 bytes)\n pkts bytes target prot opt in out source destination\n 0 0 DROP all -- any any anywhere anywhere ctstate INVALID\n 0 0 DROP tcp -- any any anywhere anywhere tcp flags:!FIN,SYN,RST,ACK/SYN ctstate NEW\n\n . . .\n . . .\n donnie@ubuntu:~$\n```", "```\n[donnie@fedora-teaching ~]$ sudo nmap -sW 192.168.0.15\n Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-26 21:39 EDT\n Nmap scan report for 192.168.0.15\n Host is up (0.00049s latency).\n All 1000 scanned ports on 192.168.0.15 are filtered\n MAC Address: 08:00:27:A4:95:1A (Oracle VirtualBox virtual NIC)\n\n Nmap done: 1 IP address (1 host up) scanned in 21.44 seconds\n [donnie@fedora-teaching ~]$\n```", "```\n donnie@ubuntu:~$ sudo iptables -t mangle -L -v\n Chain PREROUTING (policy ACCEPT 45 packets, 6398 bytes)\n  pkts bytes target     prot opt in     out     source               destination         \n\n  0     0 DROP       all  --  any    any     anywhere             anywhere             ctstate INVALID\n\n  2000 80000 DROP       tcp  --  any    any     anywhere             anywhere             tcp flags:!FIN,SYN,RST,ACK/SYN ctstate NEW\n\n . . .\n . . .      \n donnie@ubuntu:~$\n```", "```\n donnie@ubuntu:~$ sudo iptables -t mangle -D PREROUTING 1\n donnie@ubuntu:~$ sudo iptables -t mangle -D PREROUTING 1\n donnie@ubuntu:~$\n```", "```\n donnie@ubuntu:~$ sudo iptables -t mangle -L\n Chain PREROUTING (policy ACCEPT)\n target prot opt source destination\n\n . . .\n . . .\n donnie@ubuntu:~$\n```", "```\n [donnie@fedora-teaching ~]$ sudo nmap -sX 192.168.0.15\n [sudo] password for donnie:\n Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-26 21:48 EDT\n Nmap scan report for 192.168.0.15\n Host is up (0.00043s latency).\n All 1000 scanned ports on 192.168.0.15 are open|filtered\n MAC Address: 08:00:27:A4:95:1A (Oracle VirtualBox virtual NIC)\n\n Nmap done: 1 IP address (1 host up) scanned in 21.41 seconds\n [donnie@fedora-teaching ~]$\n```", "```\ndonnie@ubuntu:~$ sudo iptables -L\n Chain INPUT (policy ACCEPT)\n target     prot opt source               destination         \n ACCEPT     all  --  anywhere             anywhere            \n ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED\n ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ssh\n DROP       all  --  anywhere             anywhere            \n\n Chain FORWARD (policy ACCEPT)\n target     prot opt source               destination         \n\n Chain OUTPUT (policy ACCEPT)\n target     prot opt source               destination         \n donnie@ubuntu:~$\n```", "```\ndonnie@ubuntu:~$ sudo iptables -D INPUT 4\ndonnie@ubuntu:~$donnie@ubuntu:~$ sudo iptables -L\n Chain INPUT (policy ACCEPT)\n target     prot opt source               destination         \n ACCEPT     all  --  anywhere             anywhere            \n ACCEPT     all  --  anywhere             anywhere             ctstate RELATED,ESTABLISHED\n ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:ssh\n\n Chain FORWARD (policy ACCEPT)\n target     prot opt source               destination         \n\n Chain OUTPUT (policy ACCEPT)\n target     prot opt source               destination         \n donnie@ubuntu:~$\n```", "```\n[donnie@fedora-teaching ~]$ sudo nmap -sX 192.168.0.15\n Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-26 21:49 EDT\n Nmap scan report for 192.168.0.15\n Host is up (0.00047s latency).\n Not shown: 999 closed ports\n PORT STATE SERVICE\n 22/tcp open|filtered ssh\n MAC Address: 08:00:27:A4:95:1A (Oracle VirtualBox virtual NIC)\n\n Nmap done: 1 IP address (1 host up) scanned in 98.76 seconds\n [donnie@fedora-teaching ~]$\n```", "```\ndonnie@ubuntu:~$ sudo systemctl restart netfilter-persistent\n[sudo] password for donnie:\ndonnie@ubuntu:~$\n```", "```\nsudo iptables -L -v\nsudo iptables -t mangle -L -v\nsudo iptables -Z\nsudo iptables -t mangle -Z\n```", "```\nsudo nmap -sN ip_address_of_your_VM\nsudo nmap -sW ip_address_of_your_VM\n```", "```\nsudo iptables -L -v\nsudo iptables -t mangle -L -v\n```", "```\nsudo iptables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP\nsudo iptables -t mangle -A PREROUTING -p tcp ! --syn -m conntrack --ctstate NEW -j DROP\n```", "```\nsudo iptables-save > rules.v4\nsudo cp rules.v4 /etc/iptables\nsudo iptables -Z\nsudo iptables -t mangle -Z\n```", "```\nsudo nmap -sN ip_address_of_your_VM\n```", "```\nsudo iptables -L -v\nsudo iptables -t mangle -L -v\n```", "```\nsudo nmap -sW ip_address_of_your_VM\n```", "```\nsudo iptables -L -v\nsudo iptables -t mangle -L -v\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -i lo -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p tcp --dport ssh -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p tcp --dport 53 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p udp --dport 53 -j ACCEPT\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 1 -j ACCEPT\n[sudo] password for donnie: \ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 2 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 3 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 4 -j ACCEPT\ndonnie@ubuntu3:~$\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 128 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 129 -j ACCEPT\ndonnie@ubuntu3:~$\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT --protocol icmpv6 --icmpv6-type 130\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT --protocol icmpv6 --icmpv6-type 131\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT --protocol icmpv6 --icmpv6-type 132\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT --protocol icmpv6 --icmpv6-type 143\ndonnie@ubuntu3:~$\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 134 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 135 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 136 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 141 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 142 -j ACCEPT\ndonnie@ubuntu3:~$\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 148 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 149 -j ACCEPT\ndonnie@ubuntu3:~$\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 151 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 152 -j ACCEPT\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -p icmpv6 --icmpv6-type 153 -j ACCEPT\ndonnie@ubuntu3:~$\n```", "```\ndonnie@ubuntu3:~$ sudo ip6tables -A INPUT -j DROP\ndonnie@ubuntu3:~$\n```", "```\nsudo ip6tables -L\n```", "```\nsudo ip6tables -L\n```", "```\nsudo ip6tables -t mangle -A PREROUTING -m conntrack --ctstate INVALID -j DROP\nsudo ip6tables -t mangle -A PREROUTING -p tcp ! --syn -m conntrack --ctstate NEW -j DROP\n```", "```\nsudo ip6tables-save > rules.v6\nsudo cp rules.v6 /etc/iptables/\n```", "```\nip a\n```", "```\nsudo nmap -6 -sW fe80::a00:27ff:fe9f:d923\n```", "```\nsudo ip6tables -t mangle -L -v\n```", "```\nsudo nmap -6 -sX fe80::a00:27ff:fe9f:d923\n```", "```\nsudo ip6tables -t mangle -L -v\n```", "```\nsudo apt install nftables\n```", "```\nsudo nft list tables\n```", "```\ncd /usr/share/doc/nftables/examples/\nls -l\n```", "```\ndonnie@ubuntu2204-packt:/usr/share/doc/nftables/examples$ ls -l\ntotal 124\n-rw-r--r-- 1 root root  1016 Mar 23  2022 all-in-one.nft\n-rw-r--r-- 1 root root   129 Mar 23  2022 arp-filter.nft\n. . .\n. . .\n-rwxr-xr-x 1 root root   817 Mar 23  2022 workstation.nft\ndonnie@ubuntu2204-packt:/usr/share/doc/nftables/examples$\n```", "```\nsudo cp workstation.nft /etc/nftables.conf\n```", "```\ntcp dport { 22, 53 } ct state new accept\n```", "```\nudp dport 53 ct state new accept\n```", "```\ndonnie@ubuntu2204-packt:/etc$ sudo systemctl reload nftables\ndonnie@ubuntu2204-packt:/etc$ sudo nft list ruleset\ntable inet filter {\n    chain input {\n        type filter hook input priority 0; policy accept;\n        iif \"lo\" accept\n        ct state established,related accept\n        tcp dport { ssh, domain } ct state new accept\n        udp dport domain ct state new accept\n        icmpv6 type { nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert } accept\n        counter packets 1 bytes 32 drop\n    }\n}\ndonnie@ubuntu2204-packt:/etc$\n```", "```\ncounter log drop\n```", "```\ncounter log prefix \"Dropped packet: \" drop\n```", "```\ntcp dport 22 ip saddr { 192.168.0.7, 192.168.0.10 } log prefix \"Blocked SSH packets: \" drop\ntcp dport { 22, 53 } ct state new accept\n```", "```\nct state new,related,established icmp type { destination-unreachable, time-exceeded, parameter-problem } accept\nct state established,related,new icmpv6 type { destination-unreachable, time-exceeded, parameter-problem } accept\n```", "```\nchain prerouting {\n                type filter hook prerouting priority 0;\n                ct state invalid counter log prefix \"Invalid Packets:  \" drop\n                tcp flags & (fin|syn|rst|ack) != syn ct state new counter log drop\n        }\n```", "```\nsudo systemctl reload nftables\n```", "```\nsudo nft delete table inet filter\nsudo nft list tables\nsudo nft add table inet ubuntu_filter\nsudo nft list tables\n```", "```\nsudo nft add chain inet ubuntu_filter input { type filter hook input priority 0\\; policy drop\\; }\n```", "```\ndonnie@ubuntu2004-packt:~$ sudo nft list table inet ubuntu_filter\n [sudo] password for donnie:\n table inet filter {\n       chain input {\n             type filter hook input priority 0; policy drop;\n       }\n }\n donnie@ubuntu2004-packt:~$\n```", "```\nsudo nft add rule inet ubuntu_filter input ct state established accept\nsudo nft add rule inet ubuntu_filter input tcp dport 22 ct state new accept\nsudo nft list table inet ubuntu_filter\n table inet ubuntu_filter {\n     chain input {\n         type filter hook input priority 0; policy drop;\n         ct state established accept\n         tcp dport ssh ct state new accept\n     }\n }\n```", "```\nsudo nft insert rule inet ubuntu_filter input iif lo accept\nsudo nft list table inet ubuntu_filter\n table inet ubuntu_filter {\n       chain input {\n              type filter hook input priority 0; policy drop;\n              iif lo accept\n              ct state established accept\n              tcp dport ssh ct state new accept\n      }\n }\n```", "```\nsudo nft list table inet ubuntu_filter -a\n table inet ubuntu_filter {\n        chain input {\n                 type filter hook input priority 0; policy drop;\n                 iif lo accept # handle 4\n                 ct state established accept # handle 2\n                 tcp dport ssh ct state new accept # handle 3\n       }\n }\n```", "```\nsudo nft insert rule inet ubuntu_filter input position 3 tcp dport 22 ip saddr { 192.168.0.7, 192.168.0.10 } drop\nsudo nft list table inet ubuntu_filter -a\n table inet ubuntu_filter {\n         chain input {\n                  type filter hook input priority 0; policy drop;\n                  iif lo accept # handle 4\n                  ct state established accept # handle 2\n                  tcp dport ssh ip saddr { 192.168.0.10, 192.168.0.7} drop # handle 6\n                  tcp dport ssh ct state new accept # handle 3\n         }\n }\n```", "```\nsudo nft delete rule inet ubuntu_filter input handle 6\nsudo nft list table inet ubuntu_filter -a\n table inet ubuntu_filter {\n       chain input {\n              type filter hook input priority 0; policy drop;\n              iif lo accept # handle 4\n              ct state established accept # handle 2\n              tcp dport ssh ct state new accept # handle 3\n      }\n }\n```", "```\nsudo sh -c \"nft list table inet ubuntu_filter > /etc/nftables.conf\"\n```", "```\ntable inet ubuntu_filter { \n    chain input { \n        type filter hook input priority 0; policy drop; \n        iif lo accept \n        ct state established accept \n        tcp dport ssh ct state new accept \n    } \n}\n```", "```\n#!/usr/sbin/nft -f \nflush ruleset \ntable inet ubuntu_filter { \n    chain input { \n         type filter hook input priority 0; policy drop; \n         iif lo accept \n         ct state established accept \n         tcp dport ssh ct state new accept \n   } \n} \n```", "```\nsudo systemctl reload nftables\nsudo nft list table inet ubuntu_filter\n table inet ubuntu_filter {\n        chain input {\n                 type filter hook input priority 0; policy drop;\n                 iif lo accept\n                 ct state established accept\n                 tcp dport ssh ct state new accept\n       }\n }\n```", "```\nsudo systemctl disable --now ufw\nsudo iptables -L\n```", "```\nsudo cp /usr/share/doc/nftables/examples/syntax/workstation /etc/nftables.conf\n```", "```\n#!/usr/sbin/nft -f flush ruleset\ntable inet filter {\n    chain prerouting {\n        type filter hook prerouting priority 0;\n        ct state invalid counter log prefix \"Invalid Packets:  \" drop\n        tcp flags & (fin|syn|rst|ack) != syn ct state new counter log prefix \"Invalid Packets 2: \" drop\n}\n```", "```\nchain input {\n    type filter hook input priority 0;\n    # accept any localhost traffic\n    iif lo accept\n    # accept traffic originated from us\n    ct state established,related accept\n        # activate the following line to accept common local services\n        tcp dport 22 ip saddr { 192.168.0.7, 192.168.0.10 } log prefix \"Blocked SSH packets: \" drop\n\n        tcp dport { 22, 53 } ct state new accept\n        udp dport 53 ct state new accept\n        ct state new,related,established icmp type { destination-unreachable, time-exceeded, parameter-problem } accept\n```", "```\n ct state new,related,established icmpv6 type { destination-unreachable, time-exceeded, parameter-problem } accept\n        # accept neighbour discovery otherwise IPv6 connectivity breaks.\n        ip6 nexthdr icmpv6 icmpv6 type { nd-neighbor-solicit,  nd-router-advert, nd-neighbor-advert } accept\n# count and drop any other traffic\n    counter log prefix \"Dropped packet: \" drop\n     }\n}\n```", "```\n sudo systemctl reload nftables\n```", "```\nsudo nft list tables\nsudo nft list tables\nsudo nft list table inet filter\nsudo nft list ruleset\n```", "```\nsudo nmap -sW ip_address_of_UbuntuVM\n```", "```\nsudo nft list ruleset\n```", "```\nsudo nmap -sN ip_address_of_UbuntuVM\n```", "```\nsudo nft list ruleset\n```"]