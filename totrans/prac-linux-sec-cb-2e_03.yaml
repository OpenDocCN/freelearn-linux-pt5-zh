- en: Local Filesystem Security
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本地文件系统安全
- en: 'In this chapter, we will discuss the following:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下内容：
- en: Viewing files and directory details using `ls`
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`ls`查看文件和目录详细信息
- en: Using `chmod` to set permissions on files and directories
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`chmod`设置文件和目录的权限
- en: Using `chown` to change ownership of files and directories
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`chown`更改文件和目录的所有权
- en: Using ACLs to access files
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 ACLs 访问文件
- en: Implementing Mandatory Access Control with SELinux
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 SELinux 实现强制访问控制
- en: Using extended file attributes to protect sensitive files
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用扩展文件属性保护敏感文件
- en: File handling using the `mv` command (moving and renaming)
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用`mv`命令处理文件（移动和重命名）
- en: Installing and configuring a basic LDAP server on Ubuntu
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Ubuntu 上安装和配置基本的 LDAP 服务器
- en: Viewing files and directory details using ls
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 `ls` 查看文件和目录详细信息
- en: The `ls` command is used to list files in a directory, and it is similar to
    the `dir` command in DOS. This command can be used with various parameters to
    give different results.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '`ls`命令用于列出目录中的文件，类似于 DOS 中的`dir`命令。可以根据不同的参数使用该命令，以获得不同的结果。'
- en: Getting ready
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Since the `ls` command is a built-in command in Linux, we don't need to install
    anything else to use it.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 由于`ls`命令是 Linux 中的内置命令，我们无需安装其他任何东西即可使用它。
- en: How to do it…
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作…
- en: 'Now, let’s take a look at how we can use `ls` in different ways to get a variety
    of results by just following these steps:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们来看看如何通过这些步骤以不同的方式使用`ls`来获取各种结果：
- en: 'To take a look at the simple listing of files in a current directory, type
    `ls`:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要查看当前目录下的简单文件列表，输入`ls`命令：
- en: '![](img/1eaf670a-653b-45f1-8d70-51fbe6b05096.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1eaf670a-653b-45f1-8d70-51fbe6b05096.png)'
- en: 'To get more information about the files and directories listed using the `ls`
    command, add a type identifier as shown here:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要获取更多关于文件和目录的信息，可以在`ls`命令后添加类型标识符，如下所示：
- en: '![](img/5855e3e6-8059-4cbc-8c07-57d3f0a25fa6.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5855e3e6-8059-4cbc-8c07-57d3f0a25fa6.png)'
- en: 'When the preceding identifier is used, the executable files have an asterisk
    at the end of the name, while the directories have a slash, and so on. To check
    out details of files, such as the creation dates, owners, and permissions, run
    a command with the `l` identifier, as shown here:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当使用前面提到的标识符时，可执行文件的名称末尾会有一个星号，而目录会有一个斜杠，等等。要查看文件的详细信息，如创建日期、所有者和权限，可以运行带有`l`标识符的命令，如下所示：
- en: '![](img/32345510-763f-4056-9dd9-e8b69833c823.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/32345510-763f-4056-9dd9-e8b69833c823.png)'
- en: 'To find a listing of all the hidden files in the current directory, use the
    `a` identifier, as shown here:'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要列出当前目录下的所有隐藏文件，可以使用`a`标识符，如下所示：
- en: '![](img/065e6007-4fb9-4a1e-8427-8d2b5b59fb12.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/065e6007-4fb9-4a1e-8427-8d2b5b59fb12.png)'
- en: Files that begin with a period (also called dot files) are hidden files, they
    are not shown if the `–an` option is not used.
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以点（.）开头的文件（也叫做点文件）是隐藏文件，如果没有使用`–an`选项，它们不会显示。
- en: 'To print the file size in readable form, such as MB, GB, TB, and so on, instead
    of printing in terms of bytes, we can use the `-h` identifier along with the `-l`
    identifier, as shown here:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 要以可读的形式打印文件大小（如 MB、GB、TB 等），而不是以字节为单位显示，可以使用`-h`标识符与`-l`标识符一起使用，如下所示：
- en: '![](img/54f34c79-25a1-4961-a3f9-feedbafbb064.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/54f34c79-25a1-4961-a3f9-feedbafbb064.png)'
- en: 'If you wish to exclude all the files and display only their subdirectories,
    then you can use the `-d` option as follows:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你只想排除所有文件并仅显示子目录，则可以使用`-d`选项，如下所示：
- en: '![](img/0629a12f-7765-4e32-a39e-eddc42988b30.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0629a12f-7765-4e32-a39e-eddc42988b30.png)'
- en: 'The `ls` command, when used with the`-R` option, will display the contents
    of the subdirectories too:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当`ls`命令与`-R`选项一起使用时，它还会显示子目录的内容：
- en: '![](img/89c1aa34-8c3c-4050-87f9-7d35914493f9.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/89c1aa34-8c3c-4050-87f9-7d35914493f9.png)'
- en: How it works…
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的…
- en: When we use different options with the `ls` command, it gives us different results
    in terms of listing a directory. We can use any option, as per our requirements.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们使用不同的选项与`ls`命令时，它会根据不同的目录列出不同的结果。我们可以根据需求使用任何选项。
- en: It is recommended that you get into the habit of using `ls –lah` so that you
    can always find the listing in readable sizes.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 建议你养成使用`ls -lah`的习惯，这样你可以始终以可读的大小查看文件列表。
- en: Using chmod to set permissions on files and directories
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用chmod设置文件和目录的权限
- en: '**chmod**, or **Change Mode**, is a Linux command used to modify the access
    permissions of files and directories. Everybody wants to keep their data secure
    and properly organized. For this reason, Linux has the concept of associating
    an owner and group with every file and directory. These owners and groups have
    different permissions to access a particular file.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '**chmod**，或称 **Change Mode**，是一个用于修改文件和目录访问权限的 Linux 命令。每个人都希望保持数据的安全和正确组织。因此，Linux
    提供了将所有者和组与每个文件和目录关联的概念。这些所有者和组有不同的权限来访问特定文件。'
- en: Getting ready
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 正在准备中
- en: 'Before we see the use of the `chmod` command, we need to know that, for different
    types of users, the symbolic representations that are used are as follows:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们查看 `chmod` 命令的使用之前，我们需要知道，不同类型的用户使用的符号表示如下：
- en: '`u` is used for user/owner'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`u` 用于表示用户/所有者'
- en: '`g` is used for group'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`g` 用于表示组'
- en: '`o` is used for others'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`o` 用于表示其他用户'
- en: Now, let's create a file named `file1.txt` to check out the different commands
    of chmod.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们创建一个名为 `file1.txt` 的文件，以检查 `chmod` 的不同命令。
- en: How to do it...
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Now, we will see how to use chmod in different ways to set different permissions:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将展示如何以不同的方式使用 chmod 来设置不同的权限：
- en: 'We first check the current permission of the file and when it was created:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们首先检查文件的当前权限以及它的创建时间：
- en: '![](img/2ff419a0-d906-4059-ba18-c7e47235094b.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2ff419a0-d906-4059-ba18-c7e47235094b.png)'
- en: As we can see, currently only the user/owner has read and write permission,
    whereas groups and other users have only read permission.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，目前只有用户/所有者具有读写权限，而组和其他用户只有读取权限。
- en: 'Now, let''s change a single permission for the owner by using the `+` symbol,
    which is for adding permission:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使用 `+` 符号来修改所有者的单一权限，这个符号用于添加权限：
- en: '[PRE0]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](img/58ffd21c-9947-4c11-b88d-69709a9158a8.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/58ffd21c-9947-4c11-b88d-69709a9158a8.png)'
- en: This command will add the execute permission for the owner of the file.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令将为文件的所有者添加执行权限。
- en: 'To add multiple permissions, we can do the same in a single command. We just
    need to separate different permissions using a comma, as shown here:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要添加多个权限，我们可以在一个命令中执行相同的操作。只需要使用逗号分隔不同的权限，如下所示：
- en: '[PRE1]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](img/03134130-a54e-44e6-b319-b3436b67cecf.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](img/03134130-a54e-44e6-b319-b3436b67cecf.png)'
- en: This command will add the Execute permission for the group and other users of
    the file.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令将为文件的组和其他用户添加执行权限。
- en: 'If we wish to remove a permission, just use the `-` symbol instead of `+`,
    as shown here:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们希望删除某个权限，只需使用 `-` 符号代替 `+`，如下所示：
- en: '[PRE2]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](img/74c3e6ea-f854-42df-a4a9-b0c9ce35e396.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](img/74c3e6ea-f854-42df-a4a9-b0c9ce35e396.png)'
- en: This will remove the Execute permission for other users of the particular file.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 这将删除特定文件的其他用户的执行权限。
- en: If we wish to add or remove a permission for all users (owner, group, and others),
    this can be done with a single command by using the `a` option, which signifies
    all users.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们希望为所有用户（所有者、组和其他用户）添加或删除某个权限，可以通过使用 `a` 选项（表示所有用户）来使用单个命令完成。
- en: 'To add read permission for all users, use this:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 要为所有用户添加读取权限，可以使用以下命令：
- en: '[PRE3]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'To remove read permission for all users, use this:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 要删除所有用户的读取权限，可以使用以下命令：
- en: '[PRE4]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](img/3ffcb4fc-07d5-4703-8dcc-874e17efd5bd.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3ffcb4fc-07d5-4703-8dcc-874e17efd5bd.png)'
- en: 'Suppose we want to add a particular permission to all the files in a directory.
    One way to do it is what we have seen already, by running the command for all
    the files individually. Instead, we can use the `-R` option, which signifies that
    the given operation is recursive. So, to add execute permission for other users,
    for all files in a directory, the command will be this:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设我们想要为目录中的所有文件添加特定权限。一种方法是之前看到的，为所有文件单独运行命令。相反，我们可以使用 `-R` 选项，它表示给定操作是递归的。因此，要为目录中所有文件添加执行权限，命令将是：
- en: '[PRE5]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](img/142056ae-55c5-4c9d-aaa3-117b6cd4d28b.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](img/142056ae-55c5-4c9d-aaa3-117b6cd4d28b.png)'
- en: 'We can also copy the permissions of a particular file to another file by using
    the `reference` option:'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还可以使用 `reference` 选项将某个文件的权限复制到另一个文件：
- en: '[PRE6]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](img/13611a95-3019-465c-99ce-e78aa10d34ed.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](img/13611a95-3019-465c-99ce-e78aa10d34ed.png)'
- en: Here, we have applied the permissions of `file2` to another file, called `file1`.
    The same command can be used to apply permissions of one directory to another
    directory.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们已将 `file2` 的权限应用到另一个文件 `file1`。相同的命令也可以用于将一个目录的权限应用到另一个目录。
- en: How it works...
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'When chmod is used with symbolic representation, we know the following:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用符号表示法时，`chmod` 的使用规则如下：
- en: '`u` is used for user/owner'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`u` 用于表示用户/所有者'
- en: '`g` is used for group'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`g` 用于表示组'
- en: '`o` is used for others'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`o`用于表示其他用户'
- en: 'Also, different permissions are to referred as follows:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，不同的权限表示如下：
- en: 'r: read'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'r: 读取'
- en: 'w: write'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'w: 写入'
- en: 'x: execute'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'x: 执行'
- en: So, using these commands, we change the permissions for the user, group, or
    others as per our requirements.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，使用这些命令，我们可以根据需要更改用户、组或其他人的权限。
- en: There's more...
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'Permissions can be set with chmod using numbers also, known as Octal representation.
    We can edit permissions for the owner, group, and others, all at the same time
    using this method. The syntax of the command is as follows:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 权限也可以通过数字形式设置，称为八进制表示法。我们可以同时编辑所有者、组和其他用户的权限。命令的语法如下：
- en: '[PRE7]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Here, xxx refers to a three-digit number from 1-7\. The first digit refers to
    the owner's permission, the second represents group, and the third digit refers
    to the permissions of others.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 这里，xxx表示从1到7之间的三位数字。第一位表示所有者的权限，第二位表示组的权限，第三位表示其他用户的权限。
- en: 'When we use octal representation r, w, and x permissions have specific number
    values:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们使用八进制表示法时，r、w和x权限有特定的数值：
- en: r = 4
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: r = 4
- en: w = 2
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: w = 2
- en: x = 1
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: x = 1
- en: 'So, if we want to add permission to read and execute, it will be calculated
    as follows:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，如果我们想添加读取和执行权限，它的计算方式如下：
- en: r-x = 4+0+1 = 5
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: r-x = 4+0+1 = 5
- en: 'Similarly, permission to read, write, and execute is calculated as follows:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 类似地，读取、写入和执行权限的计算方式如下：
- en: rwx = 4+2+1 = 7
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: rwx = 4+2+1 = 7
- en: 'And if we wish to give only read permission, it will be this:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们只想给予读取权限，它将是：
- en: r-- = 4+0+0 = 4
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: r-- = 4+0+0 = 4
- en: 'So, now, if we run the given command, it gives the permission as calculated:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，现在如果我们运行给定的命令，它会按计算方式赋予权限：
- en: '[PRE8]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](img/4ad69d19-527c-48f6-8185-40f7fe3cb1fb.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4ad69d19-527c-48f6-8185-40f7fe3cb1fb.png)'
- en: Using chown to change ownership of files and directories
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用`chown`更改文件和目录的所有权
- en: File ownership is fundamental in Linux. As every file is associated with an
    owner and a group, we can change the owner of a file or directory using the `chown`
    command.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 文件所有权在Linux中是基础性的。因为每个文件都与一个所有者和一个组相关联，我们可以使用`chown`命令来更改文件或目录的所有者。
- en: How to do it...
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'To understand the use of `chown`, let''s follow these steps:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解`chown`的使用方法，我们可以按照以下步骤操作：
- en: 'To understand the use of the `chown` command, let''s create a file named `file1.txt`
    and a user named `user1`:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了理解`chown`命令的使用，我们可以创建一个名为`file1.txt`的文件和一个名为`user1`的用户：
- en: '![](img/814962fe-0a6e-470e-b0b8-ab7b04bcd718.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/814962fe-0a6e-470e-b0b8-ab7b04bcd718.png)'
- en: The previous command for changing password information is optional. You can
    ignore it if you want to.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 更改密码信息的先前命令是可选的。如果你不需要，可以忽略它。
- en: Now, let's check the current owner of `file1.txt`.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们检查`file1.txt`的当前所有者。
- en: We can see that the current owner for both the files is root and it belongs
    to the root group.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，当前两个文件的所有者都是root，并且它们属于root组。
- en: 'Let''s change the ownership of `file1.txt` to `user1`:'
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们将`file1.txt`的所有权更改为`user1`：
- en: '![](img/ef69031f-109a-410f-8f93-45ebd96cecc9.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ef69031f-109a-410f-8f93-45ebd96cecc9.png)'
- en: As seen here, the owner of `file1.txt` has now changed to `user1`.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 如这里所示，`file1.txt`的所有者已更改为`user1`。
- en: 'If we want to change the group of a file, we can do that also using `chown`:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们想要更改文件的组，也可以使用`chown`命令来完成：
- en: '![](img/f3035b26-7ed1-4b31-839d-ef0d53c9c5c8.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f3035b26-7ed1-4b31-839d-ef0d53c9c5c8.png)'
- en: 'We can change both the owner and group of a file in single command as shown
    here:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以在一个命令中同时更改文件的所有者和组，如下所示：
- en: '![](img/5bd5d7b2-8712-4fff-9b0f-80663635a5fa.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5bd5d7b2-8712-4fff-9b0f-80663635a5fa.png)'
- en: We can see that the owner and group of `file2.txt` have changed.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，`file2.txt`的所有者和组已经更改。
- en: 'If we wish to recursively change ownership of a directory and its contents,
    we can do it as shown:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们希望递归地更改目录及其内容的所有权，可以按照以下方式操作：
- en: '![](img/0f141356-75e2-4fdd-a8c7-66b4fabc5ea8.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0f141356-75e2-4fdd-a8c7-66b4fabc5ea8.png)'
- en: 'Chown can also be used to copy the owner/group permissions from one file to
    another:'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`chown`还可以用于将一个文件的所有者/组权限复制到另一个文件：'
- en: '![](img/59a26040-d415-4f1c-99c6-df12c5a1ca72.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![](img/59a26040-d415-4f1c-99c6-df12c5a1ca72.png)'
- en: There's more...
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'If we wish to list the changes made by the `chown` command in a verbose manner,
    we can do so using this command:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们希望以详细的方式列出`chown`命令所做的更改，可以使用以下命令：
- en: '![](img/699840b0-e58f-41dd-888d-27452c1abfcc.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/699840b0-e58f-41dd-888d-27452c1abfcc.png)'
- en: Using ACLs to access files
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ACLs来访问文件
- en: Implementing the basic file permissions using `chmod` is not enough, so we can
    use ACLs, or *Access Control Lists*. In addition to providing permissions for
    the owner and group for a particular file, we can set permissions for any user,
    any user group, or a group of all users who are not in the group of the particular
    user using ACLs.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`chmod`实现基本文件权限是不够的，因此我们可以使用ACL，或称为*访问控制列表*。除了为特定文件的所有者和组提供权限外，我们还可以为任何用户、任何用户组或任何不在特定用户组中的所有用户组设置权限。
- en: Getting ready
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备就绪
- en: 'Before using ACLs, we check whether it is enabled or not:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用ACL之前，我们检查它是否已启用：
- en: 'To do this, we try to view the ACLs for any file, as shown here:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为此，我们尝试查看任何文件的ACL，如下所示：
- en: '![](img/7829684c-7691-4c4d-9041-9be4092d6785.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7829684c-7691-4c4d-9041-9be4092d6785.png)'
- en: This command will show an output like this if ACLs are enabled. In our case,
    they are not enabled for `/dev/sda1`, as it is not listed in the mount options.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 如果启用了ACL，此命令将显示如下输出。在我们的例子中，`/dev/sda1`没有启用ACL，因为它没有列在挂载选项中。
- en: 'To enable an ACL, we will add it to the filesystem, using the following command:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要启用ACL，我们将其添加到文件系统中，使用以下命令：
- en: '![](img/a17a5e94-8078-426b-86d6-d21bfd0c91dc.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a17a5e94-8078-426b-86d6-d21bfd0c91dc.png)'
- en: 'Now, run the `tune2fs` command again to confirm the ACL is enabled:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，再次运行`tune2fs`命令以确认ACL已启用：
- en: '![](img/1a55be24-69f1-4da7-98dc-058ad9063382.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1a55be24-69f1-4da7-98dc-058ad9063382.png)'
- en: Now, we can see the ACLs option in the `/dev/sda1` partition.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以在`/dev/sda1`分区看到ACL选项。
- en: How to do it...
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何执行...
- en: 'To understand the workings of ACLs, let''s follow these steps:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 为了理解ACL的工作原理，让我们按照以下步骤操作：
- en: 'We will first check the default ACL values for any file or directory. To do
    this, we use the `getfacl` command:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将首先检查任何文件或目录的默认ACL值。为此，我们使用`getfacl`命令：
- en: '![](img/7c59a5c8-ba8e-417b-90b6-7b70ab08b0bf.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7c59a5c8-ba8e-417b-90b6-7b70ab08b0bf.png)'
- en: 'Now, to set an ACL on `file1.txt`, we will use the following command:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，要在`file1.txt`上设置ACL，我们将使用以下命令：
- en: '![](img/e8d79916-7432-49b7-8d88-846e6b4b9285.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e8d79916-7432-49b7-8d88-846e6b4b9285.png)'
- en: In the preceding command, we have given `rwx` access to the root user for the
    `file1.txt` file.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述命令中，我们为`file1.txt`文件的root用户授予了`rwx`权限。
- en: When we check again using `getfacl`, we can see the new ACL values.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们再次使用`getfacl`检查时，我们可以看到新的ACL值。
- en: 'Run the given command to confirm ACL setup on `file1.txt`:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行给定的命令以确认`file1.txt`上的ACL设置：
- en: '![](img/7ba86c7e-c85d-40c2-b71a-6180433b9ddb.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7ba86c7e-c85d-40c2-b71a-6180433b9ddb.png)'
- en: The (`+`) sign after the file permissions confirms it has the ACL set up.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 文件权限后的（`+`）符号确认它已设置ACL。
- en: 'We can also set an ACL on a folder recursively, by using the `setfacl` command.
    First, we will check the default ACL for our `dir1` directory, using `getfacl`:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还可以通过使用`setfacl`命令递归地设置文件夹上的ACL。首先，我们将使用`getfacl`检查`dir1`目录的默认ACL：
- en: '![](img/b073351e-c63d-4117-9082-92de4864bcb0.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b073351e-c63d-4117-9082-92de4864bcb0.png)'
- en: 'Now, let''s add `rwx` access to the `dir1` directory using `setfacl`:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使用`setfacl`为`dir1`目录添加`rwx`权限：
- en: '![](img/82f8563b-98a6-4d4c-b921-a1c6a5aaddbd.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/82f8563b-98a6-4d4c-b921-a1c6a5aaddbd.png)'
- en: 'We can now confirm that the ACL is set up on the directory using the given
    command:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们现在可以通过给定的命令确认目录上已设置ACL：
- en: '![](img/739e3c85-4fc0-4cc7-b341-b90795cefb1c.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/739e3c85-4fc0-4cc7-b341-b90795cefb1c.png)'
- en: 'Now, let''s check the ACL for the `user1` group on `file1.txt`:'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们检查`user1`组在`file1.txt`上的ACL：
- en: '![](img/d19453dc-c648-4c44-ad71-40d60c1c31b0.png)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d19453dc-c648-4c44-ad71-40d60c1c31b0.png)'
- en: 'Let''s set `rwx` access to the group `user1` on `file1.txt`:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们为`user1`组设置`rwx`权限在`file1.txt`上：
- en: '![](img/4d91341e-c770-4dab-8981-66ddb303a8b5.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4d91341e-c770-4dab-8981-66ddb303a8b5.png)'
- en: There's more...
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Whenever we deal with file permissions, it is a good idea to take a backup of
    the permissions if your files are important.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 每当我们处理文件权限时，最好对权限进行备份，特别是当文件很重要时。
- en: 'Here, we suppose that we have a `dir1` directory that contains a few important
    files. Then, we first navigate to the `dir1` directory and take a backup of the
    permissions using this command:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们假设我们有一个包含一些重要文件的`dir1`目录。然后，我们首先导航到`dir1`目录，并使用以下命令备份权限：
- en: '[PRE9]'
  id: totrans-159
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](img/e1f95cd0-e827-4252-815a-2f947b7b6ee1.png)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1f95cd0-e827-4252-815a-2f947b7b6ee1.png)'
- en: This command creates a backup of the permissions and stores it in `permissions.acl`.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 该命令会创建权限的备份并将其存储在`permissions.acl`中。
- en: 'Now, if we want to restore the permissions, the command will be as follows:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，如果我们想恢复权限，命令如下：
- en: '[PRE10]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](img/ab45ee42-99e4-423f-8683-83d7c3a08411.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ab45ee42-99e4-423f-8683-83d7c3a08411.png)'
- en: This will restore all the permissions back to where they were while creating
    the backup.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 这将恢复所有权限，回到创建备份时的状态。
- en: File handling using the mv command (moving and renaming)
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用`mv`命令进行文件处理（移动和重命名）
- en: The `mv` or `move` command is used to move files from one directory to another
    without creating any duplicates, unlike the case with the `cp` or copy command.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: '`mv`或`move`命令用于将文件从一个目录移动到另一个目录，而不会创建任何重复文件，这与`cp`或复制命令不同。'
- en: Getting ready
  id: totrans-168
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: Since `mv` is a built-in command on Linux, we don't have to configure anything
    else to understand its workings.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 由于`mv`是Linux的内建命令，我们无需配置任何其他设置即可理解其工作原理。
- en: How it works...
  id: totrans-170
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'Let''s take a look at how to use the `mv` command by taking different examples:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过不同的示例来看看如何使用`mv`命令：
- en: 'To move `testfile1.txt` from the current directory to any other directory,
    such as `- home/practical`/`example`, the command will be as follows:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要将`testfile1.txt`从当前目录移动到其他目录，比如`/home/practical/example`，命令如下：
- en: '[PRE11]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](img/1a1fb844-c8bd-4478-8fb8-91d84ca24b8e.png)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1a1fb844-c8bd-4478-8fb8-91d84ca24b8e.png)'
- en: This command will work only when the location of the source file is different
    from the destination location.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 只有当源文件位置与目标位置不同时，此命令才会生效。
- en: When we move the file using the preceding command, the file will get deleted
    from the original location.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们使用前面的命令移动文件时，文件将从原始位置被删除。
- en: 'To move multiple files using a single command, we can use this command:'
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 要使用单个命令移动多个文件，可以使用以下命令：
- en: '[PRE12]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: When using the preceding command, all the files that we are moving should be
    in the same source location.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用前面的命令时，我们移动的所有文件应位于相同的源位置。
- en: 'To move a directory, the command is the same as that used for moving a file.
    Suppose we have a `directory1` directory in the present working directory and
    we want to move it to the location `/home/practical/example`; the command will
    be as follows:'
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移动目录的命令与移动文件时相同。假设我们在当前工作目录下有一个`directory1`目录，并希望将其移动到`/home/practical/example`位置；命令如下：
- en: '[PRE13]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![](img/d68088f2-b8ac-49c5-8dc2-0c59a52598d9.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d68088f2-b8ac-49c5-8dc2-0c59a52598d9.png)'
- en: 'The `mv` command is also used to rename files and directories. Let''s say we
    have a file, `example_1.txt`, and we wish to rename it to `example_2.txt`. The
    command for doing this will be as follows:'
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`mv`命令还用于重命名文件和目录。假设我们有一个文件，`example_1.txt`，并且希望将其重命名为`example_2.txt`。实现这一操作的命令如下：'
- en: '[PRE14]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'This command will work only when the source and the destination are the same:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 只有当源位置和目标位置相同的时候，此命令才会生效：
- en: '![](img/58d9bbe7-c96a-4bfa-a47c-e93a40c1409c.png)'
  id: totrans-186
  prefs: []
  type: TYPE_IMG
  zh: '![](img/58d9bbe7-c96a-4bfa-a47c-e93a40c1409c.png)'
- en: 'Renaming a directory works the same way as renaming a file. Suppose we have
    a directory, `test­­_directory_1`, and we want to rename it to `test­­_directory_2`
    ; the command will be as follows:'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重命名目录与重命名文件的方式相同。假设我们有一个目录，`test­­_directory_1`，我们想将其重命名为`test­­_directory_2`；命令如下：
- en: '[PRE15]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](img/82ec9116-5d4b-423a-b02d-12f01b645979.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![](img/82ec9116-5d4b-423a-b02d-12f01b645979.png)'
- en: When we use the `mv` command to move or rename a large number of files or directories,
    we can check that the command works successfully by using the `-v` option while
    using the command.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当我们使用`mv`命令移动或重命名大量文件或目录时，可以通过在命令中使用`-v`选项来检查命令是否成功执行。
- en: 'Suppose we want to move all text files from the current directory to `/home/practical/example`,
    and we want to ensure it works correctly; the command will be as follows:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想将当前目录中的所有文本文件移动到`/home/practical/example`目录，并希望确保它能正确工作；命令如下：
- en: '[PRE16]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![](img/59dc98e6-fdc6-4870-b144-0c6b71a93174.png)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![](img/59dc98e6-fdc6-4870-b144-0c6b71a93174.png)'
- en: 'The same works when moving or renaming a directory, as shown here:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 移动或重命名目录时也是如此，如下所示：
- en: '![](img/c918ffce-71c6-4ec1-a8f5-942db34e1305.png)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c918ffce-71c6-4ec1-a8f5-942db34e1305.png)'
- en: 'When we use the `mv` command to move a file to another location and a file
    with the same name already exists, then the existing file gets overwritten when
    using the default command. However, if we wish to show a pop-up notification before
    overwriting the file, then we have to use the `-i` option, as shown here:'
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当我们使用`mv`命令将文件移动到另一个位置，并且该位置已经存在同名文件时，默认命令将覆盖已存在的文件。然而，如果我们希望在覆盖文件之前显示弹出通知，则需要使用`-i`选项，如下所示：
- en: '[PRE17]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![](img/2d2f215f-732a-4af9-ae4c-0df22369c231.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2d2f215f-732a-4af9-ae4c-0df22369c231.png)'
- en: When the preceding command is run, it will notify us that a file with the same
    name already exists in the destination location. Only when we press *Y* will the
    command complete, otherwise it will get cancelled.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 当执行上述命令时，它会通知我们目标位置已经存在同名文件。只有在我们按下 *Y* 时，命令才会完成，否则会被取消。
- en: When using the `mv` command to move a file to another location where a file
    with the same name already exists, if we use the `-u` option, it will update the
    file at the destination location only if the source file is newer than the destination
    file.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当使用 `mv` 命令将文件移动到另一个位置时，如果目标位置已有同名文件，使用 `-u` 选项可以仅在源文件比目标文件更新时才更新目标文件。
- en: 'We have two files, `file_1.txt` and `file_2.txt`, at the source location. First,
    check the details of the files using the `ls` command:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在源位置有两个文件，`file_1.txt` 和 `file_2.txt`，首先使用 `ls` 命令检查文件的详细信息：
- en: '[PRE18]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Now, let''s check the details of the files at the destination location:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们检查目标位置文件的详细信息：
- en: '[PRE19]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Now, move the files using the given command:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，使用给定的命令移动文件：
- en: '[PRE20]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '![](img/f9b21aff-cfe3-4500-9676-f732d1c8570a.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f9b21aff-cfe3-4500-9676-f732d1c8570a.png)'
- en: We see that `file1.txt` and `file2.txt` have been moved to the destination location,
    updating the earlier files because of the newer timestamp of the source files.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到 `file1.txt` 和 `file2.txt` 已经被移动到目标位置，并且因为源文件的时间戳较新，更新了先前的文件。
- en: 'We have two files, `file_1.txt` and `file_2.txt`, at the source location. First,
    check the details about the file using this command:'
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们在源位置有两个文件，`file_1.txt` 和 `file_2.txt`，首先使用以下命令检查文件的详细信息：
- en: '[PRE21]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Now, move the files using this command:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，使用以下命令移动文件：
- en: '[PRE22]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Now, let''s check the details of the files at the destination location:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们检查目标位置文件的详细信息：
- en: '[PRE23]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'We see that the files with the same name have not been moved, which can be
    checked by observing the time stamp:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们看到同名文件没有被移动，可以通过观察时间戳进行检查：
- en: '![](img/c6e7038e-5b33-4aa7-b2c9-5b6ddc445777.png)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c6e7038e-5b33-4aa7-b2c9-5b6ddc445777.png)'
- en: 'When moving files, if the destination location already has a file with the
    same name, then we can also create a backup of the destination file before it
    is overwritten by the new one. To do this, we use the `-b` option:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在移动文件时，如果目标位置已经有同名文件，我们还可以在新文件覆盖目标文件之前，创建目标文件的备份。为此，我们使用 `-b` 选项：
- en: '[PRE24]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Now, let's check the details of the files at the destination location.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们检查目标位置文件的详细信息。
- en: 'We see in the details that we have files named `file1.txt~` and `file2.txt~`.
    These files are the backup files, which can be verified by the timestamp, which
    are older than those of `file1.txt` and `file2.txt`:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在详细信息中看到有名为 `file1.txt~` 和 `file2.txt~` 的文件。这些文件是备份文件，可以通过时间戳验证，它们的时间戳早于 `file1.txt`
    和 `file2.txt`。
- en: '![](img/5ab6454a-a1c1-4845-ae90-4cb65cf7a60e.png)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5ab6454a-a1c1-4845-ae90-4cb65cf7a60e.png)'
- en: Implementing Mandatory Access Control with SELinux
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 SELinux 实现强制访问控制
- en: '**SELinux** (short for **Security-Enhanced Linux**), is a flexible Mandatory
    Access Control (MAC) devised to overcome the limitations of standard ugo/rwx permissions
    and ACLs.'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '**SELinux**（**安全增强型 Linux**的缩写），是一种灵活的强制访问控制（MAC），旨在克服标准的 ugo/rwx 权限和 ACL 的限制。'
- en: Getting ready
  id: totrans-224
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 正在准备中
- en: 'In most Linux distributions, such as CentOS and Redhat, SELinux is by default
    incorporated in the kernel. However, if we are working on any other distribution,
    such as Debian, we may have to install and configure SELinux on the system:'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数 Linux 发行版中，如 CentOS 和 Redhat，SELinux 默认包含在内核中。然而，如果我们使用的是其他发行版，如 Debian，可能需要在系统上安装和配置
    SELinux：
- en: 'First, we have to get the basic set of SELinux utilities and default policies
    by running the following command:'
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们必须通过运行以下命令来获取 SELinux 的基本工具集和默认策略：
- en: '![](img/0c1ab45b-2d7c-4582-816b-dcda933fc4e6.png)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0c1ab45b-2d7c-4582-816b-dcda933fc4e6.png)'
- en: 'Once the installation has completed, run the following command to configure
    GRUB and PAM, and to create `/autorelabel`:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装完成后，运行以下命令配置 GRUB 和 PAM，并创建 `/autorelabel`：
- en: '![](img/d4e98939-f819-4207-9f1c-790d5039209b.png)'
  id: totrans-229
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d4e98939-f819-4207-9f1c-790d5039209b.png)'
- en: After this, you have to reboot the system to label the filesystems on boot.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，您需要重启系统，以便在启动时标记文件系统。
- en: 'After reboot, when the system starts, you may get the following warning:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重启后，当系统启动时，您可能会收到以下警告：
- en: '![](img/986440c4-666a-402e-b7fb-c4f217985eb1.png)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![](img/986440c4-666a-402e-b7fb-c4f217985eb1.png)'
- en: Now, we have a working SELinux system.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们有一个正常工作的 SELinux 系统。
- en: How to do it...
  id: totrans-234
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Once we have a working SELinux system, we can choose how to use it:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们有了一个正常工作的SELinux系统，我们可以选择如何使用它：
- en: 'SELinux can operate in two different ways: Enforcing and Permissive.'
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: SELinux可以以两种不同的方式运行：Enforcing模式和Permissive模式。
- en: 'Let''s check the current mode by using the `getenforce` command:'
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们通过使用`getenforce`命令来检查当前的模式：
- en: '![](img/7a0dd6ac-ad1f-4ad8-ae10-76bd5f46ce09.png)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7a0dd6ac-ad1f-4ad8-ae10-76bd5f46ce09.png)'
- en: As we can see, SELinux is currently working in Permissive mode.
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所见，SELinux当前处于Permissive模式。
- en: 'Now, if we wish to toggle the mode, we can use the `setenforce` command:'
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，如果我们希望切换模式，可以使用`setenforce`命令：
- en: '![](img/3d5b6919-defa-436f-9680-30a8fa681ebf.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3d5b6919-defa-436f-9680-30a8fa681ebf.png)'
- en: When we run the preceding command with option 1, the mode changes to Enforcing.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们运行带有选项1的上述命令时，模式将切换为Enforcing模式。
- en: 'If we want to toggle back to Permissive mode, we can again use the `setenforce`
    command with option 0:'
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们想要切换回Permissive模式，可以再次使用带有选项0的`setenforce`命令：
- en: '![](img/a9a61390-a532-482c-8e1b-cef70e98f2c8.png)'
  id: totrans-244
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a9a61390-a532-482c-8e1b-cef70e98f2c8.png)'
- en: Now, the mode has changed back to Permissive.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，模式已恢复为Permissive模式。
- en: 'This change will not survive system reboot. If we want to change the mode permanently,
    we have to edit the `/etc/selinux/config` file and change the SELinux variable
    to what we want: enforcing, permissive or disabled.'
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此更改不会在系统重启后保留。如果我们想要永久更改模式，必须编辑`/etc/selinux/config`文件，并将SELinux变量更改为我们想要的模式：enforcing、permissive或disabled。
- en: Whenever an application is misbehaving or not working as expected, as part of
    the troubleshooting, we should try toggling between SELinux modes (from Enforcing
    to Permissive, or vice versa). This will help us understand if the application
    works after changing to Permissive mode or not. If it does, then we know that
    it's an SElinux permission issue.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 每当应用程序出现故障或无法正常工作时，作为故障排除的一部分，我们应该尝试在SELinux模式之间切换（从Enforcing到Permissive，或反之）。这将帮助我们了解在切换到Permissive模式后，应用程序是否能正常工作。如果可以正常工作，那么我们就知道这是一个SELinux权限问题。
- en: How it works...
  id: totrans-248
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: SELinux operates in two modes, Enforcing and permissive. When working in Enforcing
    mode, SELinux denies access based on how SELinux policy rules have been defined.
    These rules are a part of the guidelines that control the security engine.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: SELinux在两种模式下运行：Enforcing和Permissive模式。在Enforcing模式下，SELinux根据SELinux策略规则拒绝访问。这些规则是控制安全引擎的准则的一部分。
- en: When SELinux is working in Permissive mode, it does not deny access, but any
    actions that would have been denied in enforcing mode get logged.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 当SELinux在Permissive模式下工作时，它不会拒绝访问，但任何在Enforcing模式下会被拒绝的操作都会被记录下来。
- en: SELinux rules can be modified to allow any application or service that would
    otherwise be denied in Enforcing mode.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 可以修改SELinux规则，以允许在Enforcing模式下会被拒绝的任何应用程序或服务。
- en: There's more...
  id: totrans-252
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 还有更多...
- en: You can learn more about the `mv` command by typing `man mv` or `mv --help`.
    This will display its manual page, where we can explore more details about the
    command.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过输入`man mv`或`mv --help`来了解更多关于`mv`命令的信息。这将显示它的手册页面，我们可以在其中探索更多有关该命令的详细信息。
- en: Using extended file attributes to protect sensitive files
  id: totrans-254
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用扩展文件属性保护敏感文件
- en: Extended attributes are an extensible way to store metadata in files. These
    are name-value pairs associated with files and directories. Several filesystems
    support extended file attributes that enable further customization of allowable
    file operations.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展属性是一种可扩展的方式，用于在文件中存储元数据。这些是与文件和目录相关联的名称-值对。多个文件系统支持扩展文件属性，使得文件操作的自定义变得更加灵活。
- en: Getting ready
  id: totrans-256
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备中
- en: 'At present, in Linux there are four different namespaces for extended file
    attributes:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，在Linux中有四种不同的命名空间用于扩展文件属性：
- en: '`user`'
  id: totrans-258
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`user`'
- en: '`trusted`'
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`trusted`'
- en: '`security`'
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`security`'
- en: '`system`'
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`system`'
- en: Many tools are available for manipulating extended attributes, and these are
    normally included in the `attr` package, which comes with most Linux distributions.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多工具可以操作扩展属性，这些工具通常包含在`attr`软件包中，后者大多数Linux发行版都包含该软件包。
- en: 'If `attr` is not installed in your system, simply execute the following command
    to install it:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 如果系统中没有安装`attr`，只需执行以下命令来安装它：
- en: '[PRE25]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'To check if this package is installed on our system, just run `attr` in the
    Terminal. If an output appears as shown here, it will confirm that the package
    is installed:'
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 要检查该软件包是否已安装在我们的系统中，只需在终端运行`attr`。如果出现如下输出，则表示该软件包已安装：
- en: '![](img/f8d07d86-6ec1-4938-a97a-84d5bff2f236.png)'
  id: totrans-266
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f8d07d86-6ec1-4938-a97a-84d5bff2f236.png)'
- en: 'The next step is to check if the kernel has support for the attribute. It can
    be checked using the following command:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是检查内核是否支持该属性。可以使用以下命令进行检查：
- en: '![](img/9dbf665e-68de-4b5c-a0b5-7247b50b807c.png)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9dbf665e-68de-4b5c-a0b5-7247b50b807c.png)'
- en: The output confirms that the kernel has attribute support.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 输出确认内核已支持该属性。
- en: 'We also need to confirm that the filesystem is mounted with the `user_xattr`
    option. To confirm this, we run this command:'
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要确认文件系统是以`user_xattr`选项挂载的。为此，运行以下命令：
- en: '![](img/8266c8ab-4daa-4be0-8fd0-7c3911471488.png)'
  id: totrans-271
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8266c8ab-4daa-4be0-8fd0-7c3911471488.png)'
- en: How to do it...
  id: totrans-272
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Once we have confirmed all the requirements mentioned in the previous section,
    we can move on to see how to use extended attributes:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦我们确认了前面一节中提到的所有要求，就可以继续了解如何使用扩展属性：
- en: 'First, we will create a test file with some dummy data in it:'
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们将创建一个包含一些虚拟数据的测试文件：
- en: '![](img/c742473c-b857-47ea-acfb-041c98cf0f0b.png)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c742473c-b857-47ea-acfb-041c98cf0f0b.png)'
- en: 'Now, we will add an extended attribute to this file using the `setfattr` command:'
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将使用`setfattr`命令向该文件添加一个扩展属性：
- en: '![](img/06ea09dd-fa24-4d49-b418-b86ebafd1f8a.png)'
  id: totrans-277
  prefs: []
  type: TYPE_IMG
  zh: '![](img/06ea09dd-fa24-4d49-b418-b86ebafd1f8a.png)'
- en: 'Now, let''s determine the attributes on the file, using the `getfattr` command:'
  id: totrans-278
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们使用`getfattr`命令确定文件上的属性：
- en: '![](img/7bf1b227-c31a-4ecf-bbf2-d26ef0e842bb.png)'
  id: totrans-279
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7bf1b227-c31a-4ecf-bbf2-d26ef0e842bb.png)'
- en: 'If we want to check the values of the attributes, we can do that by using the
    following command:'
  id: totrans-280
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果我们想要检查属性的值，可以使用以下命令：
- en: '![](img/4f8782dd-d136-4810-a670-496ecef33ff8.png)'
  id: totrans-281
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4f8782dd-d136-4810-a670-496ecef33ff8.png)'
- en: At any time, if we want to remove any attribute, we can do the same using the
    `setfattr` command, but with the `-x` option.
  id: totrans-282
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 随时，如果我们想要删除任何属性，可以使用`setfattr`命令，添加`-x`选项来实现。
- en: Installing and configuring a basic LDAP server on Ubuntu
  id: totrans-283
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Ubuntu上安装和配置基本的LDAP服务器
- en: '**Lightweight Directory Access Protocol** (**LDAP**) is a protocol for managing
    access to a file and directory hierarchy from some centralized location. LDAP
    is mainly used for centralized authentication.'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: '**轻量级目录访问协议**（**LDAP**）是一种用于管理从某个集中位置访问文件和目录层次结构的协议。LDAP主要用于集中认证。'
- en: An LDAP server helps in controlling who has access to read and update information
    in the directory.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: LDAP服务器有助于控制谁可以访问和更新目录中的信息。
- en: Getting ready
  id: totrans-286
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'To install and configure LDAP, we need to first create an Ubuntu server. The
    current version for Ubuntu server installation media can be found here: [http://www.ubuntu.com/download/server](http://www.ubuntu.com/download/server).'
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装和配置LDAP，我们首先需要创建一个Ubuntu服务器。当前的Ubuntu服务器安装媒体版本可以在此找到：[http://www.ubuntu.com/download/server](http://www.ubuntu.com/download/server)。
- en: After downloading, follow the steps provided to install an Ubuntu server.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 下载后，按照提供的步骤安装Ubuntu服务器。
- en: We need a second system with a desktop version of Ubuntu installed. This will
    be used to access your LDAP server through a web interface.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要第二台安装了Ubuntu桌面版本的系统。将用来通过Web界面访问LDAP服务器。
- en: Once this is done, we can proceed with the installation of LDAP.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 完成后，我们可以继续安装LDAP。
- en: How to do it...
  id: totrans-291
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'We shall now start to install and configure LDAP on the Ubuntu server:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们开始在Ubuntu服务器上安装和配置LDAP：
- en: 'We will first update the package list on the server from Ubuntu''s repositories
    to get information about the latest versions of all the packages and their dependencies:'
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将首先从Ubuntu的仓库更新服务器上的软件包列表，以获取所有软件包及其依赖项的最新版本信息：
- en: '[PRE26]'
  id: totrans-294
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Now, run the command to install the `slapd` package and some associated utilities,
    and `ldap-utils` to install the LDAP server:'
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，运行命令来安装`slapd`包及其相关工具，并安装`ldap-utils`来安装LDAP服务器：
- en: '![](img/c7947761-3708-4b04-bc8c-65cfab4ba829.png)'
  id: totrans-296
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c7947761-3708-4b04-bc8c-65cfab4ba829.png)'
- en: During the installation process, when prompted, enter and confirm an administrator
    password, which will be used for the administrator account of LDAP. Configure
    a password of your choice and proceed with the installation process.
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在安装过程中，当系统提示时，输入并确认一个管理员密码，该密码将用于LDAP的管理员账户。配置一个您选择的密码并继续安装过程。
- en: 'Once the package is installed, we will reconfigure the LDAP package as per
    our requirements. To do so, type this command:'
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装完软件包后，我们将根据我们的需求重新配置LDAP包。为此，输入以下命令：
- en: '[PRE27]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This will start a series of questions regarding configuring the software. We
    need to choose the options one by one as per our requirements.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 这将启动一系列关于配置软件的问题。我们需要根据需求逐一选择选项。
- en: 'The first question asked is Omit OpenLDAP server configuration? Select No and
    continue:'
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第一个问题是是否忽略OpenLDAP服务器配置？选择否并继续：
- en: '![](img/f5c3a78d-5865-45d9-ba5f-3a96845741da.png)'
  id: totrans-302
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f5c3a78d-5865-45d9-ba5f-3a96845741da.png)'
- en: 'Next, enter the domain name. An already existing domain name on the server
    can be used, or a new one can be created. We will use `example.com` here:'
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，输入域名。可以使用服务器上已存在的域名，也可以创建一个新的域名。我们在这里使用`example.com`：
- en: '![](img/e6fff28c-2373-4748-a587-f157b719c7bf.png)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e6fff28c-2373-4748-a587-f157b719c7bf.png)'
- en: 'Next, enter the `Organization name`:'
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，输入`组织名称`：
- en: '![](img/2e09a4df-f3d5-4d4a-9ae0-c5ec7f328f28.png)-'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: '![](img/2e09a4df-f3d5-4d4a-9ae0-c5ec7f328f28.png)-'
- en: Next, configure the administrator password for LDAP. Use the same as configured
    during the installation process, or change it to something else in this step.
  id: totrans-307
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，配置LDAP的管理员密码。可以使用安装过程中配置的相同密码，或者在此步骤中更改为其他密码。
- en: 'Next, set Database backend to use. Select `MDB` and continue:'
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，设置要使用的数据库后端。选择`MDB`并继续：
- en: '![](img/e612be60-1c9d-468c-a5c8-6e8411b92197.png)'
  id: totrans-309
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e612be60-1c9d-468c-a5c8-6e8411b92197.png)'
- en: Now, you will be asked if you wish to remove the database when slapd is purged.
    Select **No** here.
  id: totrans-310
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，系统会询问是否希望在`slapd`被删除时移除数据库。请选择**否**。
- en: 'Next, select Yes to move the old database and allow the configuration process
    to create a new database:'
  id: totrans-311
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择是以移动旧数据库，并允许配置过程创建一个新数据库：
- en: '![](img/c2e74dfc-97cf-4d11-a0cd-eba83e31d1ad.png)'
  id: totrans-312
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c2e74dfc-97cf-4d11-a0cd-eba83e31d1ad.png)'
- en: 'When asked `Allow LDAPv2 protocol?` choose `No`, as the latest version is LDAPv3,
    and LDAPv2 is obsolete now:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当询问`是否允许使用LDAPv2协议？`时，选择`否`，因为最新版本是LDAPv3，LDAPv2现在已经过时：
- en: '![](img/8b37381d-0e75-42cf-bf7d-79a542a97c39.png)'
  id: totrans-314
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8b37381d-0e75-42cf-bf7d-79a542a97c39.png)'
- en: 'At this point, the configuration process is done and LDAP is running:'
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此时，配置过程完成，LDAP正在运行：
- en: '![](img/15b5c75f-7edb-4ff5-9d70-72c0ba66c778.png)'
  id: totrans-316
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15b5c75f-7edb-4ff5-9d70-72c0ba66c778.png)'
- en: 'Let''s now open the firewall port for LDAP so that external users can use it:'
  id: totrans-317
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在让我们为LDAP打开防火墙端口，以便外部用户可以使用它：
- en: '![](img/5e5ffd54-7219-4012-89cf-a55d40157f2e.png)'
  id: totrans-318
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5e5ffd54-7219-4012-89cf-a55d40157f2e.png)'
- en: 'We will now install the PHPldapadmin package, which will help in administering
    LDAP through the web interface:'
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们将安装PHPldapadmin包，它将帮助通过Web界面管理LDAP：
- en: '[PRE28]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![](img/fe6225ff-64d3-47fd-b102-7eaa8b2518dc.png)'
  id: totrans-321
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fe6225ff-64d3-47fd-b102-7eaa8b2518dc.png)'
- en: 'Once the installation completes, edit the configuration file of PHPldapadmin
    to configure a few values:'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，编辑PHPldapadmin的配置文件，以配置一些值：
- en: '[PRE29]'
  id: totrans-323
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'Now, search for the given section and modify it to reflect the domain name
    or the IP address of the Ubuntu server:'
  id: totrans-324
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，搜索给定部分并修改它，以反映Ubuntu服务器的域名或IP地址：
- en: '[PRE30]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'Next, edit the following entry and insert the domain name that we gave when
    we reconfigured `slapd`:'
  id: totrans-326
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，编辑以下条目并插入我们在重新配置`slapd`时给定的域名：
- en: '[PRE31]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Give the domain name as values to the `dc` attribute in the previous line. Since
    our domain name was `example.com`, the value in the previous line will be entered
    as `dc=example, dc=com`.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 将域名作为值输入到前一行中的`dc`属性。由于我们的域名是`example.com`，因此前一行中的值将输入为`dc=example, dc=com`。
- en: 'Next, find the following line and again enter the domain name as the `dc` attribute.
    For the `cn` attribute, the value will be `admin` only:'
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，找到以下行，并再次将域名作为`dc`属性输入。对于`cn`属性，值将仅为`admin`：
- en: '[PRE32]'
  id: totrans-330
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'Now, search for the section that reads as follows, and first uncomment the
    line, then set the value to `true`:'
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，搜索如下所示的部分，首先取消注释该行，然后将值设置为`true`：
- en: '[PRE33]'
  id: totrans-332
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: After making all these changes, save and close the file.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 完成所有这些更改后，保存并关闭文件。
- en: 'When the configuration of PHPldapadmin is complete, open a browser in the other
    system, which has the desktop version of Ubuntu. In the address bar of the browser,
    type the domain name or the IP address of the server, followed by `/phpldapadmin`:'
  id: totrans-334
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当PHPldapadmin的配置完成后，在另一个系统中打开浏览器，该系统具有Ubuntu桌面版本。在浏览器的地址栏中，输入域名或服务器的IP地址，后跟`/phpldapadmin`：
- en: '[PRE34]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Once the PHPldapadmin page opens, on the left-hand side we find the login link.
    Click on it and you will get a login prompt:'
  id: totrans-336
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦PHPldapadmin页面打开，在左侧找到登录链接。点击它，你将看到一个登录提示：
- en: '![](img/1010e3d9-a24a-4e50-8a3e-34521a27068d.png)'
  id: totrans-337
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1010e3d9-a24a-4e50-8a3e-34521a27068d.png)'
- en: 'The login screen will have the correct Login DN details if PHPldapadmin was
    configured correctly:'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 如果PHPldapadmin配置正确，登录界面将显示正确的登录DN详细信息：
- en: '![](img/995949ad-6294-4c58-800c-0250856c5d7b.png)'
  id: totrans-339
  prefs: []
  type: TYPE_IMG
  zh: '![](img/995949ad-6294-4c58-800c-0250856c5d7b.png)'
- en: This is `cn=admin,dc=example,dc=com` in our case.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，这是`cn=admin,dc=example,dc=com`。
- en: 'Once you enter the administrator password correctly, the admin interface will
    be shown:'
  id: totrans-341
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦正确输入管理员密码，管理界面将会显示：
- en: '![](img/d51ceec9-28dd-4085-80f8-aa0c8baa0d1e.png)'
  id: totrans-342
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d51ceec9-28dd-4085-80f8-aa0c8baa0d1e.png)'
- en: 'On the admin interface, on the left-hand side where you see the domain components
    (`dc=example,dc=co`), click on the plus sign next to it. It will show the admin
    login being used:'
  id: totrans-343
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在管理界面中，在左侧看到域组件（`dc=example,dc=co`）的位置，点击旁边的加号。它将显示正在使用的管理员登录：
- en: '![](img/e4220f48-1d92-4616-9fc7-60e0f0956757.png)'
  id: totrans-344
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e4220f48-1d92-4616-9fc7-60e0f0956757.png)'
- en: Our basic LDAP server is now set up and running.
  id: totrans-345
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们的基础LDAP服务器现在已设置并正常运行。
- en: How it works...
  id: totrans-346
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 它是如何工作的……
- en: We first create an Ubuntu server, and then on top of it, we install the `slapd`
    package for installing LDAP. Once it is completely installed, we install the additional
    package required. Then, we reconfigure LDAP as per our requirements.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先创建一个Ubuntu服务器，然后在其上安装`slapd`包来安装LDAP。安装完成后，我们安装所需的附加包。然后，我们根据需求重新配置LDAP。
- en: Once reconfiguration is complete, we install the PHPldapadmin package, which
    will help us in managing the LDPA server through the web interface using a browser.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完成后，我们安装PHPldapadmin包，它将帮助我们通过浏览器的Web界面管理LDAP服务器。
