- en: Chapter 11. Backing Up the VMware View Infrastructure
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While a single point of failure should not exist in the VMware View environment,
    it is still important to ensure regular backups are taken for quick recovery in
    times of failure. Also, if a setting becomes corrupted or is changed, a backup
    could be used to restore to a previous point in time. The backup of the VMware
    View environment should be performed on a regular basis in line with an organization’s
    existing backup methodology. A VMware View environment contains both files and
    database.
  prefs: []
  type: TYPE_NORMAL
- en: 'The main backup points of a VMware View environment are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: VMware View ADAM database
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware View Composer database
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware vCenter database
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware View Connection Server settings
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: With a backup of all of the preceding components, the VMware View Server infrastructure
    can be recovered during a time of failure.
  prefs: []
  type: TYPE_NORMAL
- en: To maximize the chance of success in a recovery environment, it is advised to
    take backups of the View ADAM, View Composer, and vCenter database at the same
    time to avoid discrepancies. Backups can be scheduled and automated or can be
    manually executed; ideally, scheduled backups will be used to ensure that they
    are performed and completed regularly.
  prefs: []
  type: TYPE_NORMAL
- en: Proper design dictates that there should always be two or more View Connection
    Servers. As all View Connection Servers in the same replica pool contain the same
    configuration data, it is only necessary to back up one View Connection Server.
    This backup is typically configured for the first View Connection Server installed
    in standard mode in an environment.
  prefs: []
  type: TYPE_NORMAL
- en: Backing up the VMware View Connection Server environment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'View Connection Server backups can be configured from the VMware View Admin
    console. These backups dump the configuration files and database information to
    a location on the VMware View Connection Server, and must then be backed up through
    normal mechanisms, such as a backup agent and scheduled job. The workflow for
    a VMware View Connection Server backup is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Schedule VMware View Backup runs and exports to `C:\View_Backup\`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Third-party backup solution runs on the View Connection Server and backs up
    the `System State, Program Files`, and `C:\View_Backup\` folders.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'From within the VMware View Admin console, there are three primary options
    that must be configured to back up VMware View Connection Server settings:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Automatic backup frequency:** This is the frequency at which backups are
    automatically taken'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Recommendation every day:** As most server backups are performed daily, if
    the automatic View Connection Server backup is taken before the full backup of
    the Windows server, it will be included in the nightly backup; adjust as necessary'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Max number of backups:** This is the maximum number of backups that can be
    stored on the View Connection Server; once the maximum number has been reached,
    backups will be rotated out based on age, with the oldest backup being replaced
    by the newest backup'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Recommendation 30 days:** This will ensure that approximately one month of
    backups is retained on the server; adjust as necessary'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Folder location:** This is the location on the View Connection Server, where
    the backups will be stored'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure that the third-party backup solution is backing up this location
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Once a backup has been either automatically run or manually executed, there
    will be two types of files saved in the backup location as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'LDF files: These are the LDIF exports from the VMware View Connection Server
    ADAM database and store the configuration settings of the VMware View environment'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'SVI files: These are the backups of the VMware View Composer database'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The backup process of the View Connection Server is fairly straightforward.
    While the process is easy, it should not be overlooked.
  prefs: []
  type: TYPE_NORMAL
- en: Security server considerations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Surprisingly, there is no option to backup the VMware View Security Server via
    the VMware View Admin console. For View Connection Servers, backup is configured
    by selecting the server, selecting **Edit**, and then **Backup**. Highlighting
    the View Security Server provides no such functionality.
  prefs: []
  type: TYPE_NORMAL
- en: Instead, the security server should be backed up via normal third-party mechanisms.
    Of primary concern, is the installation directory, which is `C:\Program Files\VMware\VMware
    View\Server` by default.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the `...\sslgateway\conf` directory is the `.config` file, which includes
    the following settings:'
  prefs: []
  type: TYPE_NORMAL
- en: '`pcoipClientIPAddress:` This is the public address used by the security server'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`pcoipClientUDPPort:` This is the port used for UDP traffic (default: 4172)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In addition, the `settings` file is located in this directory, which includes
    settings such as:'
  prefs: []
  type: TYPE_NORMAL
- en: '`maxConnections:` This is the maximum number of concurrent connections the
    View Security Server can have at one time (default: 2000)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`serverID:` This is the hostname used by the security server'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In addition, custom certificates and log files are stored within the installation
    directory of the VMware View Security Server. Therefore, it is important to back
    up the data regularly if the log file data is to be maintained (and is not being
    ingested into a larger enterprise log file solution).
  prefs: []
  type: TYPE_NORMAL
- en: Transfer server and ThinApp repository considerations
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There are two components to backing up the VMware View Transfer Servers in an
    environment. The first component is that of the transfer server’s VMware installation
    directory and the server’s registry. The second component, which is significantly
    more important, is the actual repository storing the published vDesktops.
  prefs: []
  type: TYPE_NORMAL
- en: If the View Transfer Server itself fails but the repository is online, the checkout
    and check-in tasks will be unavailable, but the main data, the published vDesktops,
    will still be preserved. Once the View Transfer Server is rebuilt and restored,
    it should function as normal. In most production scenarios, there should be two
    transfer servers that are likely pointed to the same redundant file share.
  prefs: []
  type: TYPE_NORMAL
- en: If the View Transfer Server is online but the repository fails, any transfer-related
    activity, such as checkout, update, or check-in, will fail.
  prefs: []
  type: TYPE_NORMAL
- en: The ThinApp repository is similar in nature to the transfer server repository
    in that it should reside on a redundant file share that is backed up regularly.
    If the ThinApp packages are configured to preserve each user’s sandbox, the ThinApp
    repository should likely be backed up nightly.
  prefs: []
  type: TYPE_NORMAL
- en: Restoring the VMware View environment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The steps to perform a View Connection Server restore can primarily be found
    in the VMware KB article, *Performing an end-to-end backup and restore for View
    Manager 3.x or 4.x*.
  prefs: []
  type: TYPE_NORMAL
- en: Backing up the gold templates
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: For environments using full cloning as the provisioning technique for the vDesktops,
    the gold template should be backed up regularly. The gold template is the mastered
    vDesktop that all other vDesktops are cloned from. The VMware KB article *Backing
    up and restoring virtual machine templates using VMware APIs* covers the steps
    to both back up and restore a template. In short, most backup solutions will require
    that the gold template is converted from a template to a regular virtual machine
    at which time it can then be backed up.
  prefs: []
  type: TYPE_NORMAL
- en: Backing up the Parent VM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Backing up the Parent VM can be tricky as it is a virtual machine, often with
    many different point-in-time snapshots. The most common technique is to collapse
    the virtual machine snapshot tree at a given point-in-time snapshot, and then
    back up or copy the newly created virtual machine to a second datastore. By storing
    the parent VM on a redundant storage solution, it is quite unlikely that the Parent
    VM will be lost. What’s more likely is that a point-in-time snapshot may be created
    of the Parent VM while it’s in a non-functional or less-than-ideal state.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As expected, it is important to back up the fundamental components of a VMware
    View solution. While a resilient design should mitigate most types of failure,
    there are still occasions when a backup may be needed to bring an environment
    back up to an operational level. Some of the additional tools that could prove
    useful to a VDI architect designing a VMware View solution are discussed in [Appendix](apa.html
    "Appendix A. Additional Tools"), *Additional Tools*.
  prefs: []
  type: TYPE_NORMAL
