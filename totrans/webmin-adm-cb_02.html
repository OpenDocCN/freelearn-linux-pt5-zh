<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;User Management"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. User Management</h1></div></div></div><p>In this chapter, we will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating a Webmin user</li><li class="listitem" style="list-style-type: disc">Creating a Webmin group with access to specific modules and options</li><li class="listitem" style="list-style-type: disc">Allowing users to log in to Webmin with the system credentials</li><li class="listitem" style="list-style-type: disc">Creating Webmin users based on system accounts</li><li class="listitem" style="list-style-type: disc">Controlling who is currently using Webmin</li><li class="listitem" style="list-style-type: disc">Creating a system user account</li><li class="listitem" style="list-style-type: disc">Modifying a user's UID and other information</li><li class="listitem" style="list-style-type: disc">Temporarily disabling a user account</li><li class="listitem" style="list-style-type: disc">Creating and editing a system group</li><li class="listitem" style="list-style-type: disc">Changing a user's password</li><li class="listitem" style="list-style-type: disc">Exporting users and importing them into another system</li><li class="listitem" style="list-style-type: disc">Installing Usermin</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec22"/>Introduction</h1></div></div></div><p>Webmin's user management features are quite sophisticated. You can use Webmin to manage users and groups on your system, decide which of them have access to Webmin, and which modules they will be allowed to see. You can also create special Webmin-only users, who will not have regular accounts on your system, but will still be able to access selected Webmin modules.</p><p>If you're the main administrator of a system, you can set up Webmin to allow other administrators to modify only selected parts of your system's configuration. For instance, you can allow sub-administrators to configure the Apache web server but not to change other settings. This particular workflow is so common, in fact, that a sibling product to Webmin called Usermin<a id="id84" class="indexterm"/> was developed to allow non-administrators access to a Webmin-like environment through which they can access databases, configure web hosts, set up <code class="literal">cron</code> jobs, and read local mail.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note08"/>Note</h3><p>Webmin distinguishes between two types of users:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Unix users</strong></span> (<span class="strong"><strong>system users</strong></span>) <a id="id85" class="indexterm"/>are standard users of your system. They are usually able to log in to your system through the console or over SSH.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Webmin users</strong></span><a id="id86" class="indexterm"/> are accounts specific to Webmin itself. These type of users can log in to Webmin but may have no ability to log in to your system otherwise.</li></ul></div></div></div><p>Any system user can be given the status of Webmin user. You can also configure Webmin to add and delete Webmin accounts whenever a system user is added or removed. It's up to you to decide what will suit your situation best—keeping Webmin user accounts separate from system accounts or keeping them synchronized.</p><p>Another important concept to keep in mind is a <a id="id87" class="indexterm"/>
<span class="strong"><strong>Webmin group</strong></span>. Similar to system groups, these are groups of users with specific privileges. You can decide which modules are available to all members of a Webmin group. In general, if you have more then one user with the same privileges, you should assign them to a group and then assign module permissions to the group instead of assigning them individually to each user. This will make future management easier to handle.</p></div></div>
<div class="section" title="Creating a Webmin user"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec23"/>Creating a Webmin user</h1></div></div></div><p>The simplest way to <a id="id88" class="indexterm"/>grant someone access to Webmin is to create a Webmin user account for him/her. You can regulate which IPs the user will be allowed to log in from and even at what times during the week the access will be open. During account creation, you can specify what modules the user will have access to or which group he/she will belong to.</p><p>In this recipe, we will create a new user with access to only one module.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec56"/>Getting ready</h2></div></div></div><p>We will create a new user account with a single-use password, which the user will have to change after the first login. In order to use this one-time password, we need to enable a feature in Webmin. Perform the following steps to set the password expiry policy:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Configuration</strong></span> | <span class="strong"><strong>Authentication</strong></span>.</li><li class="listitem">Set the <span class="strong"><strong>Password expiry policy</strong></span> option to <span class="strong"><strong>Prompt users with expired passwords to enter a new one</strong></span>.</li><li class="listitem">Webmin's server process will restart; wait for a few seconds before continuing.</li></ol></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec57"/>How to do it...</h2></div></div></div><p>Perform the following steps to<a id="id89" class="indexterm"/> create a new Webmin user:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to the <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span> screen, and click <span class="strong"><strong>Create a new Webmin user</strong></span>.</li><li class="listitem">On the user creation screen, specify a username, a password, and the real name of the user. You can set any random long string for the password, as we expect the user to change it. Note the password somewhere, so that we can use it later.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip16"/>Tip</h3><p>
<span class="strong"><strong>Strong passwords</strong></span>
<a id="id90" class="indexterm"/> are long strings of characters randomly selected from a large alphabet. If you use all alphanumeric characters (a-z, A-Z, and 0–9) then each character adds approximately 6 bits of entropy to the strength of the password. This means that for a 128-bit password you'd need a 22-character string, for a 256-bit strength you'd need 43 characters, and so on. You can generate a pseudo-random password using a simple Perl one-liner such as:</p><div class="informalexample"><pre class="programlisting">$ perl -le'@chars=(a..z,A..Z,0..9,_);$p.=$chars[rand(@chars)] while($i++&lt;22);print $p'</pre></div><p>If you wish to use a truly random password generated by a quantum mechanical white noise generator, visit GRC's Ultra High Security Passwords page:</p><p>
<a class="ulink" href="https://www.grc.com/passwords.htm">https://www.grc.com/passwords.htm</a>
</p></div></div></li><li class="listitem">Check the <span class="strong"><strong>Force change at next login</strong></span> option:<div class="mediaobject"><img src="graphics/5849OS_02_01.jpg" alt="How to do it..."/></div></li><li class="listitem">In the <span class="strong"><strong>Security and limits options</strong></span> section, set <span class="strong"><strong>Inactivity logout time</strong></span> to <code class="literal">30</code> minutes and <span class="strong"><strong>Minimum password length</strong></span> to <code class="literal">10</code> letters.</li><li class="listitem">In the <span class="strong"><strong>Available Webmin modules</strong></span> section, check the box next to <span class="strong"><strong>Read User Mail</strong></span> module in the <span class="strong"><strong>Servers</strong></span> section.</li><li class="listitem">Click the <span class="strong"><strong>Create</strong></span> button to create the account.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec58"/>How it works...</h2></div></div></div><p>Webmin <a id="id91" class="indexterm"/>keeps its own database of user accounts, separate from the system user list. The list of accounts is kept by default in the <code class="literal">miniserv.users</code> file at <code class="literal">/etc/webmin/</code>. Information about which modules each account has access to is<a id="id92" class="indexterm"/> stored in the <code class="literal">webmin.acl</code> file at <code class="literal">/etc/webmin/</code> (<span class="strong"><strong>acl</strong></span> stands for <span class="strong"><strong>access control list</strong></span>).</p><p>When a user tries to log into Webmin, it checks those files to determine whether the login information provided is correct, if the account is active, and which modules the user has access to. Based <a id="id93" class="indexterm"/>on this information, Webmin logs the user in and creates an interface for him/her.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec59"/>There's more...</h2></div></div></div><p>Webmin provides additional features, which make account administration easier. For instance, if you find that you need to create a few similar accounts, you can create one and clone it. If you want to preview what Webmin looks like to a particular user, you can switch to that user's account without the need to know their password.</p><div class="section" title="Clone a Webmin user"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec10"/>Clone a Webmin user</h3></div></div></div><p>In order to <a id="id94" class="indexterm"/>clone an already existing user account, go to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span>, and click the username of the user you would like to clone. At the bottom of the <span class="strong"><strong>Edit Webmin User</strong></span> screen, you will find a button marked <span class="strong"><strong>Clone</strong></span>. If you click on it, you will be brought to an account creation page with options prefilled based on settings of the user you cloned.</p></div><div class="section" title="Switch to user"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec11"/>Switch to user</h3></div></div></div><p>If you want to check what options <a id="id95" class="indexterm"/>Webmin makes available to a particular user, you can go to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span>, click on the username, and then click the <span class="strong"><strong>Switch to User</strong></span> button at the bottom of the screen. After you are finished testing, you will need to log out and log in again as yourself if this user does not have access to the <span class="strong"><strong>Webmin Users</strong></span> module.</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec60"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In the next recipe, <span class="emphasis"><em>Creating a Webmin group with access to specific modules and options</em></span>, we will go into more detail about granting users access to specific module options.</li></ul></div></div></div>
<div class="section" title="Creating a Webmin group with access to specific modules and options"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec24"/>Creating a Webmin group with access to specific modules and options</h1></div></div></div><p>Webmin users <a id="id96" class="indexterm"/>should be organized into groups. If you have more then one user whom you would like to equip with the same privileges, creating a group is the way to go. Webmin provides very granular permissions, which you can grant to each group. You can set the following three types of permissions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Specify which Webmin modules are available to a group</li><li class="listitem" style="list-style-type: disc">Set global permissions, which apply to all modules</li><li class="listitem" style="list-style-type: disc">Set module-level access control settings, specifying which options of each module will be available<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip18"/>Tip</h3><p>Permissions for an individual account can be configured with the same level of granularity.</p></div></div></li></ul></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec61"/>How to do it...</h2></div></div></div><p>In this recipe, we will create a <a id="id97" class="indexterm"/>Webmin group with access limited to viewing log files from the <code class="literal">/var/log</code> directory:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To create a new Webmin group, navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span>, and click <span class="strong"><strong>Create a new Webmin group</strong></span>.</li><li class="listitem">Name the new group <code class="literal">log_viewers</code>, and supply a group description.</li><li class="listitem">In the <span class="strong"><strong>Available Webmin modules</strong></span> section, select only <span class="strong"><strong>System Logs</strong></span>, and click <span class="strong"><strong>Create</strong></span>.</li><li class="listitem">After the group is created, we can specify more detailed permissions. Go back to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span>, and click the name of the new group in the <span class="strong"><strong>Webmin Groups</strong></span> section.</li><li class="listitem">You will notice that the names of modules in the <span class="strong"><strong>Available Webmin modules</strong></span> section are now links. Click the <span class="strong"><strong>System Logs</strong></span> link to bring up the access control configuration for this module.</li><li class="listitem">Set permissions, as shown in the following screenshot, to grant read-only access to the logs from <code class="literal">/var/log</code> and no other module permission:<div class="mediaobject"><img src="graphics/5849OS_02_02.jpg" alt="How to do it..."/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note09"/>Note</h3><p>Note that full access to this module allows users to view any file as a log. This could give users unauthorized access to other files on your system.</p></div></div><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip19"/>Tip</h3><p>You can reset module permissions to full access by clicking on the <span class="strong"><strong>Reset To Full Access</strong></span> button.</p></div></div></li></ol></div><p>Let's verify that the <a id="id98" class="indexterm"/>new group permissions work as expected:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a new user for testing according to the <span class="emphasis"><em>Creating a Webmin user</em></span>recipe.</li><li class="listitem">Assign him/her to the group by selecting <code class="literal">log_viewers</code> in the <span class="strong"><strong>Member of group</strong></span> list.</li><li class="listitem">Go to the<span class="strong"><strong> Edit Webmin User</strong></span> screen for this new user, and click the <span class="strong"><strong>Switch to User</strong></span> button.</li></ol></div><p>You will see Webmin as the new user would see it, and you should have access limited to the <span class="strong"><strong>System Logs</strong></span> module, within which you should only be able to view logs from <code class="literal">/var/log</code>.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec62"/>How it works...</h2></div></div></div><p>By default, Webmin<a id="id99" class="indexterm"/> keeps information about existing groups in the <code class="literal">webmin.groups</code> file at <code class="literal">/etc/webmin/</code>. Information about module-specific permissions is stored in <a id="id100" class="indexterm"/>
<span class="strong"><strong>access control list</strong></span> (<span class="strong"><strong>ACL</strong></span>) files. Each module has its own directory in <code class="literal">/etc/webmin</code>, containing a separate ACL file for each group and user. For instance, a group of ACL files for a module named <code class="literal">module_name</code> and a group named <code class="literal">group_name</code> would be stored at: <code class="literal">/etc/webmin/module_name/group_name.gacl</code>. A similar file for a user named <code class="literal">user_name</code> would be stored in the <code class="literal">user_name.acl</code> file at <code class="literal">/etc/webmin/module_name/</code>. Webmin inspects these files whenever a user accesses a module and determines which options to make available to them.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note10"/>Note</h3><p>The exact structure of each ACL file is specific to its individual module; it may also change when upgrading Webmin to a new version. Editing these files manually requires familiarity with the module's internal code, so it's probably best to edit permissions through Webmin's interface.</p></div></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec63"/>There's more...</h2></div></div></div><p>In addition to module-specific access permissions, Webmin also allows you to specify global permissions, which modify the behavior of all modules.</p><div class="section" title="Permissions for all modules"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec12"/>Permissions for all modules</h3></div></div></div><p>In order to set <a id="id101" class="indexterm"/>Webmin-wide permissions for a group, go to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span>, click the name of the group, and open the <span class="strong"><strong>Permissions for all modules</strong></span> section.</p><p>Here, you can set which files will be visible in Webmin's file chooser when a module requires the user to select a file, which users and groups will be visible in their chooser widgets, and other global options:</p><div class="mediaobject"><img src="graphics/5849OS_02_03.jpg" alt="Permissions for all modules"/></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec64"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You can create a Webmin account for each user you wish to assign to a group, but you can also set up Webmin to create accounts automatically for all members of a system group and assign them to a Webmin group. See the recipe, <span class="emphasis"><em>Creating Webmin users based on existing system user</em></span> <span class="emphasis"><em>accounts</em></span>, for more information.</li></ul></div></div></div>
<div class="section" title="Allowing users to log in to Webmin with the system credentials"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec25"/>Allowing users to log in to Webmin with the system credentials</h1></div></div></div><p>Webmin's default settings don't allow regular system users to log in to Webmin, but at least one user is allowed to log in after installation. Depending on the settings included in your Webmin package, that may be any of the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The root user</li><li class="listitem" style="list-style-type: disc">Users with unrestricted root access via <code class="literal">sudo</code> (specifically those with an <code class="literal">ALL=(ALL) ALL</code> rule)</li><li class="listitem" style="list-style-type: disc">The user created during manual Webmin installation</li></ul></div><p>In this recipe, we will allow all users of a Unix group to log in to Webmin with limited permissions.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec65"/>Getting ready</h2></div></div></div><p>We need to begin by creating a standard Webmin account, which will be shared by all system users we grant access to. Refer to the recipe, <span class="emphasis"><em>Creating a Webmin user,</em></span> for instructions, and create a Webmin account, named <code class="literal">webmin_user</code>, for instance, with specific permissions.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec66"/>How to do it...</h2></div></div></div><p>Follow these steps to allow members of a system group to <a id="id102" class="indexterm"/>log in to Webmin:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to the <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span> | <span class="strong"><strong>Configure Unix User Authentication</strong></span> screen.</li><li class="listitem">Select the <span class="strong"><strong>Allow Unix users listed below to login</strong></span> radio button.</li><li class="listitem">Select the options to allow <span class="strong"><strong>Members of group</strong></span> users to log in as the Webmin user you created for this purpose.</li><li class="listitem">If your standard user were named <code class="literal">webmin_user</code>, your screen would resemble the following screenshot:<div class="mediaobject"><img src="graphics/5849OS_02_04.jpg" alt="How to do it..."/></div></li><li class="listitem">Click on the <span class="strong"><strong>Save</strong></span> button to save your settings.</li></ol></div><p>From now on, all <a id="id103" class="indexterm"/>Unix users belonging to the <code class="literal">users</code> group will be able to log in to Webmin and have the same privileges as the Webmin user you selected.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec67"/>How it works...</h2></div></div></div><p>If we use the preceding configuration, Webmin will verify login credentials against the <span class="strong"><strong>pluggable authentication module</strong></span> (<span class="strong"><strong>PAM</strong></span>)<a id="id104" class="indexterm"/> service configured on your system. In its basic setup, PAM will verify credentials against those stored in the standard system files (<code class="literal">/etc/passwd</code> and <code class="literal">/etc/shadow</code>).</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note11"/>Note</h3><p>If PAM is set up differently on your system, the login information may be validated by an external service such as LDAP, NIS, Kerberos, Active Directory, or looked up in a SQL database. By default, Webmin uses your system's common configuration (<code class="literal">system-auth</code> or <code class="literal">common-auth</code>), but it can use its own separate settings.</p></div></div><p>Webmin also checks which system groups the authenticating user belongs to. If any of those groups are listed in Webmin's configuration or the user account is individually listed as allowed, the user will be logged in as if using the associated Webmin account.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec68"/>There's more...</h2></div></div></div><p>In order to allow the users with unrestricted access via <code class="literal">sudo</code> to log in to Webmin as <code class="literal">root</code>, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span> | <span class="strong"><strong>Configure Unix User Authentication</strong></span>.</li><li class="listitem">Check the box <span class="strong"><strong>Allow users who can run all commands via sudo to login as root</strong></span>.</li><li class="listitem">Click <span class="strong"><strong>Save</strong></span>.</li></ol></div></div></div>
<div class="section" title="Creating Webmin users based on system accounts"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec26"/>Creating Webmin users based on system accounts</h1></div></div></div><p>In previous recipes, we <a id="id105" class="indexterm"/>talked about creating Webmin users and allowing system users to log in as a chosen Webmin account. You may choose to have a more direct, one-to-one correspondence between Webmin and system accounts. You can achieve this by creating Webmin accounts for selected existing users and setting up account synchronization for users added in the future.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec69"/>Getting ready</h2></div></div></div><p>In this recipe, we will create a Webmin account for each system user. All new Webmin accounts will be assigned to a Webmin group. Before we begin, set up a Webmin group following the recipe,
<span class="emphasis"><em>Creating a Webmin group with access to specific modules and options</em></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec70"/>How to do it...</h2></div></div></div><p>Our first step will be to create Webmin accounts for existing system users:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span> | <span class="strong"><strong>Convert Unix To Webmin Users</strong></span>.</li><li class="listitem">Select the users you would like to add to Webmin.</li><li class="listitem">Select the Webmin group to assign them to.</li><li class="listitem">Click <span class="strong"><strong>Convert Now</strong></span>.</li></ol></div><p>Webmin accounts for all selected users should now be created. You can inspect them on the <span class="strong"><strong>Webmin Users</strong></span> screen.</p><p>The second step is to instruct Webmin to create accounts automatically for all newly created system users:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span> | <span class="strong"><strong>Configure Unix User Synchronization</strong></span>.</li><li class="listitem">Check the boxes to create and delete Webmin accounts when system accounts are created and deleted.</li><li class="listitem">Also, select the <span class="strong"><strong>Set password for new users to Unix authentication</strong></span> option:<div class="mediaobject"><img src="graphics/5849OS_02_05.jpg" alt="How to do it..."/></div></li><li class="listitem">Select the <a id="id106" class="indexterm"/>Webmin group you would like new users to be added to, and click <span class="strong"><strong>Save</strong></span>.</li></ol></div><p>From now on, every new system account will be associated with an automatically created Webmin account.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note12"/>Note</h3><p>Please note that Webmin will not synchronize accounts created at the command line or by editing system configuration files directly. Only system accounts created through Webmin will receive associated Webmin accounts.</p></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec71"/>How it works...</h2></div></div></div><p>Webmin inspects your system configuration files (<code class="literal">/etc/passwd</code> and <code class="literal">/etc/group</code>) to find a list of system users and creates corresponding Webmin accounts based on your selection.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note13"/>Note</h3><p>In reality, Webmin doesn't read the <code class="literal">passwd</code> file directly, but instead uses a system call such as <code class="literal">getpwent</code> to inspect your system's password database. This means that account information may also be read from a database or external services such as NIS or LDAP.</p></div></div><p>If you set up <a id="id107" class="indexterm"/>user synchronization, Webmin adds an additional step to its user creation functionality, which automatically sets up a new Webmin account for each new system user.</p></div></div>
<div class="section" title="Controlling who is currently using Webmin"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec27"/>Controlling who is currently using Webmin</h1></div></div></div><p>Webmin keeps a log<a id="id108" class="indexterm"/> of all the actions performed by users. You can inspect a list of currently open user sessions, check what actions were performed during a session, or close a session, forcing the user to be logged out.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec72"/>How to do it...</h2></div></div></div><p>Perform these steps to check which users are currently logged into Webmin:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Users</strong></span>.</li><li class="listitem">Click the <span class="strong"><strong>View Login Sessions</strong></span> icon.</li><li class="listitem">To view the actions performed by the user in this session, click the <span class="strong"><strong>View logs</strong></span> link next to any session.</li></ol></div><p>You can close any session, except your own, and force the user to log in again. To do this, click the link in the <span class="strong"><strong>Session ID</strong></span> column. The next time this user clicks a link or submits a form, he/she will be asked to log in again.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec73"/>How it works...</h2></div></div></div><p>Whenever a user logs in, Webmin creates a session for him/her. A session consists of a specific ID and associated information about who the owner of the session is and whether the session is active.</p><p>The session ID is passed to the user's browser in a secure cookie, thanks to which Webmin can identify subsequent requests coming in from the same user. This identifier is stored in Webmin's log files to group together actions performed by the user during the time between logging in and logging out. You can search Webmin's log for actions associated with any session.</p><p>If you choose to end a <a id="id109" class="indexterm"/>session, Webmin deletes its identifier from the list of active sessions. When the user makes another request to Webmin, the session identifier passed by the cookie will no longer be recognized, and the user will have to log in again, creating a new session.</p></div></div>
<div class="section" title="Creating a system user account"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec28"/>Creating a system user account</h1></div></div></div><p>Creating user <a id="id110" class="indexterm"/>accounts in Unix is a multistep process: you need to add user data to system configuration files, create a home directory, copy template files to that directory, and set ownership of those files to the new user. Webmin automates this process for you.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip20"/>Tip</h3><p>In addition, if you set up synchronization, a Webmin account will also be created for the new user. Refer to the recipe, <span class="emphasis"><em>Creating Webmin users based on existing system accounts</em></span>, for more information about account synchronization.</p></div></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec74"/>Getting ready</h2></div></div></div><p>We will create a new user account with a single-use password, which the user will have to change to after the first login. In order to allow the user to change the password through Webmin, go to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Configuration</strong></span> | <span class="strong"><strong>Authentication</strong></span>, and set the <span class="strong"><strong>Password expiry policy</strong></span> option to <span class="strong"><strong>Prompt users with expired passwords to enter a new one</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec75"/>How to do it...</h2></div></div></div><p>Perform the following steps to create a system user account:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click <span class="strong"><strong>Create a new user</strong></span>.</li><li class="listitem">Provide basic account information: <span class="strong"><strong>Username</strong></span><span class="emphasis"><em> </em></span>and<span class="emphasis"><em> </em></span><span class="strong"><strong>Real name</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>User ID</strong></span> and <span class="strong"><strong>Home directory</strong></span> to <span class="strong"><strong>Automatic</strong></span>.</li><li class="listitem">Set the user's default shell to <code class="literal">/bin/bash</code>.</li><li class="listitem">For <span class="strong"><strong>Password</strong></span>, select <span class="strong"><strong>Normal Password</strong></span>, and type in a long, random string into the textbox. Save this string. In <span class="strong"><strong>Password Options</strong></span>, answer <span class="strong"><strong>Yes</strong></span> to the <span class="strong"><strong>Force change at next login?</strong></span> question.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip21"/>Tip</h3><p>Take a look at the recipe, <span class="emphasis"><em>Creating a Webmin user</em></span>, for a note about generating strong passwords.</p></div></div></li><li class="listitem">Leave the primary group in <span class="strong"><strong>Group Membership</strong></span> with system default settings.</li><li class="listitem">Answer <span class="strong"><strong>Yes</strong></span> to the questions about creating a home directory and copying template files in the <span class="strong"><strong>Upon Creation</strong></span> section.</li><li class="listitem">Also answer <span class="strong"><strong>Yes</strong></span> to the <span class="strong"><strong>Create user in other modules?</strong></span> question.</li><li class="listitem">Click <span class="strong"><strong>Create</strong></span>.</li><li class="listitem">Send the user his/her new username and password. The user will be asked to change the password after the first login.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec76"/>How it works...</h2></div></div></div><p>Quite a bit is <a id="id111" class="indexterm"/>happening here; let's go through it step by step.</p><p>We are asking Webmin to create an account for the user whose real name we specified. The user will be able to log in using the username we provided. We told Webmin to generate <span class="strong"><strong>User ID</strong></span> and <span class="strong"><strong>Home directory</strong></span> automatically. The UID will be the first available integer higher than 500 or 1,000, depending on the system. The home directory will be placed in <code class="literal">/home/</code> and named as the username.</p><p>We set the user's shell to <code class="literal">/bin/bash</code>, which is the default user shell on most modern Linux distributions. If your users prefer to use a different shell, such as <code class="literal">ksh</code>, <code class="literal">zsh</code>, or <code class="literal">fish</code>, you can set it here after its package is installed.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip22"/>Tip</h3><p>If you wish to prevent the user from logging into the system console (or over SSH and FTP), you can set the shell to <code class="literal">/bin/false</code>. This will prevent shell access but will allow the user to use other system services that don't require Unix user authentication, such as e-mail or Webmin.</p></div></div><p>Next, we created a one-time password for the user. The user will be forced to change it after the first login regardless of whether he/she logs in through the console or Webmin.</p><p>During account creation, we need to assign the user to a primary group. On some systems, the default group will be named <code class="literal">users</code>; other systems will create a private group for the new user, named the same as the user. It's up to you as the system's administrator to decide how you wish to use these groups.</p><p>Because we answered <span class="strong"><strong>Yes</strong></span> to questions about setting up the home directory, Webmin took care of it for us and created the new user's directory with all the required files.</p><p>Finally, by answering <span class="strong"><strong>Yes</strong></span> to the question about creating the user account in other modules, we told Webmin to make information about the new account available to other parts of Webmin. Thanks<a id="id112" class="indexterm"/> to this, the new user will be available in configuration settings of other modules (for instance, file sharing).</p></div></div>
<div class="section" title="Modifying a user's UID and other information"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec29"/>Modifying a user's UID and other information</h1></div></div></div><p>Modifying basic<a id="id113" class="indexterm"/> information about an existing user is usually quite simple. The exception to this rule is the change of a user's UID. This is sometimes necessary if a user has accounts on two different Unix systems and both systems have to identify him/her as the same person. A typical example of this situation is sharing files over NFS as we will discuss in <a class="link" href="ch06.html" title="Chapter 6. Managing Files on Your System">Chapter 6</a>, <span class="emphasis"><em>Managing Files on Your System</em></span>.</p><p>Changing a UID requires an update of file ownership of all files belonging to that user. This can be quite tedious, but Webmin does the job for us.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec77"/>How to do it...</h2></div></div></div><p>Follow these steps for modifying a user's UID:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click the username link of the account you want to edit.</li><li class="listitem">On the next page, you will be able to edit all the basic user information, including the username, ID, home directory location, chosen default shell program, primary and secondary system groups, and so on.</li><li class="listitem">Change <span class="strong"><strong>User ID</strong></span> to a different value.</li><li class="listitem">In the <span class="strong"><strong>Upon Save</strong></span> section, answer <span class="strong"><strong>All files</strong></span> to the <span class="strong"><strong>Change user ID on files?</strong></span> question.</li><li class="listitem">You can limit the update to <span class="strong"><strong>Home directory</strong></span> if you are sure that the user owns files only in his/her home directory.<div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note14"/>Note</h3><p>Limiting file updates to the user's home directory will speed things up, but any files belonging to the user but located in other directories will become orphaned. If a new user is later created with the leftover UID, these files may unexpectedly change hands and belong to the new user. Choose this option only if you're sure that the user doesn't own any files outside of the home directory.</p></div></div></li><li class="listitem">Click <span class="strong"><strong>Save</strong></span>.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip30000"/>Tip</h3><p>You can use the same method to change the GID of the user's primary group.</p></div></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec78"/>How it works...</h2></div></div></div><p>Webmin updates<a id="id114" class="indexterm"/> the user's system data with the information you provide. It then scans the disk in search of files that belong to the user and updates the file owner's UID.</p></div></div>
<div class="section" title="Temporarily disabling a user account"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec30"/>Temporarily disabling a user account</h1></div></div></div><p>If a person stops using<a id="id115" class="indexterm"/> your system, it's often a good idea not to delete their account, but rather to disable it. Perhaps you need to preserve data for forensic purposes, the user would need access to your system again in the future or is the owner of files on your system, which you don't want to delete or leave orphaned.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec79"/>How to do it...</h2></div></div></div><p>Disabling a user account through Webmin is very easy. Perform the following steps to do so:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click the username link of the account you want to edit.</li><li class="listitem">On the next page, check the box labeled <span class="strong"><strong>Login temporarily disabled</strong></span>.</li><li class="listitem">Click <span class="strong"><strong>Save</strong></span>.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip23"/>Tip</h3><p>You can re-enable the account by following the same procedure. Just uncheck the <span class="strong"><strong>Login temporarily disabled</strong></span> box, and hit <span class="strong"><strong>Save</strong></span>.</p></div></div></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec80"/>How it works...</h2></div></div></div><p>To disable a user account, Webmin updates the <code class="literal">/etc/shadow</code> file, which stores hashed user passwords. The password hash for the selected user is prepended with an exclamation point (<code class="literal">!</code>). This invalidates the hash and makes the password unusable, so the user can no longer log in. Removing the exclamation point re-enables the account.</p></div></div>
<div class="section" title="Creating and editing a system group"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec31"/>Creating and editing a system group</h1></div></div></div><p>Creating and editing <a id="id116" class="indexterm"/>system groups <a id="id117" class="indexterm"/>through Webmin is very simple; just follow the steps outlined.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec81"/>How to do it...</h2></div></div></div><p>Let's start by creating a group as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click through to the <span class="strong"><strong>Local Groups</strong></span> tab.</li><li class="listitem">Click <span class="strong"><strong>Create a new group</strong></span>.</li><li class="listitem">On the next page, you will be asked to specify basic group information. Set <span class="strong"><strong>Group name</strong></span> to a chosen name, and leave <span class="strong"><strong>Group ID</strong></span> set to <span class="strong"><strong>Automatic</strong></span>. Ignore the password fields.</li><li class="listitem">You can now add any user you choose to the group by moving them from the left to the right column of the <span class="strong"><strong>Users</strong></span> widget.</li><li class="listitem">Click <span class="strong"><strong>Create</strong></span> to finish and create the group.</li></ol></div><p>You can now edit the group by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Go back to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click the <span class="strong"><strong>Local Groups</strong></span> tab.</li><li class="listitem">Click the group's link in the <span class="strong"><strong>Group name</strong></span> column.</li><li class="listitem">You will be brought to a screen with a form similar to the one used to create a group, with one difference. If you now change a group's ID, you can tell Webmin to update files on the system with the new ID of the group.</li><li class="listitem">Click the <span class="strong"><strong>Save</strong></span> button to save changes.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec82"/>How it works...</h2></div></div></div><p>Depending on which operating system you're using, Webmin will either directly modify system files that store information about groups (<code class="literal">/etc/group</code>, <code class="literal">/etc/gshadow</code>), or use a dedicated utility to update group information (such as the <code class="literal">dscl</code>—Directory Service command-line utility on OS X).</p><p>When you change a group's GID, Webmin will also scan your filesystem and update all the files owned by the group with its new GID.</p></div></div>
<div class="section" title="Changing a user's password"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec32"/>Changing a user's password</h1></div></div></div><p>When a user forgets <a id="id118" class="indexterm"/>his/her password, he/she will contact you as the system's administrator and request a password reminder. For security reasons, passwords are stored on your system only in the form of cryptographic hashes, not plain text. Because of this, you cannot send passwords to users, but you can reset a password and send the new one to the user. The best practice in such a case is to make the new password usable only once, allowing the user to log in, but requesting that he/she immediately change it to a password of his/her own choice.</p><p>In this recipe, we will describe how to reset a user's password to a one-time value.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec83"/>Getting ready</h2></div></div></div><p>In order to use single-use passwords in Webmin, we need to enable this feature. Go to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Webmin Configuration</strong></span> | <span class="strong"><strong>Authentication</strong></span>, and set the <span class="strong"><strong>Password expiry policy</strong></span> option to <span class="strong"><strong>Prompt users with expired passwords to enter a new one</strong></span>.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec84"/>How to do it...</h2></div></div></div><p>Perform the following steps to change the user's password:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click the username link of the account you want to change the password for.</li><li class="listitem">In the <span class="strong"><strong>Password</strong></span> section, choose <span class="strong"><strong>Normal password</strong></span>, and enter a long, random string of characters. Make a note of this string, as we will send it to the user as a one-time login password afterward.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip24"/>Tip</h3><p>Take a look at the recipe, <span class="emphasis"><em>Creating a Webmin user</em></span>, for a note about generating strong passwords.</p></div></div></li><li class="listitem">In the <span class="strong"><strong>Password Options</strong></span> section, answer <span class="strong"><strong>Yes</strong></span> to the <span class="strong"><strong>Force change at next login?</strong></span> question.</li><li class="listitem">Click <span class="strong"><strong>Save</strong></span> to commit changes.</li><li class="listitem">Send the new single-use password to the user.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec85"/>How it works...</h2></div></div></div><p>Webmin modifies your system's passwords file (<code class="literal">/etc/shadow</code>), updating the user's stored password hash with the new string we provided.</p><p>Your system also stores the information about when the password was last changed. Webmin changes this setting to 0 (equivalent to January 1, 1970). This causes your system to request a<a id="id119" class="indexterm"/> password change next time the user logs in. Webmin also respects this setting and will ask the user to change the password when he/she logs into Webmin. Note the steps described in the <span class="emphasis"><em>Getting ready</em></span> section.</p></div></div>
<div class="section" title="Exporting users and importing them into another system"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec33"/>Exporting users and importing them into another system</h1></div></div></div><p>When you're setting up another server for your organization, you may need to recreate accounts of multiple users on the new system. Webmin's user management module has the ability to export data about existing user accounts to a special<a id="id120" class="indexterm"/> <span class="strong"><strong>batch file</strong></span>, which you can then import into any other system that also runs Webmin. This allows you to recreate multiple accounts quickly and easily.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec86"/>How to do it...</h2></div></div></div><p>In this recipe, we <a id="id121" class="indexterm"/>will <a id="id122" class="indexterm"/>export selected users from one system (source) and import them into a second system (destination).</p><p>Let's start by exporting users as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">On your source system, navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click the link marked <span class="strong"><strong>Export to batch file</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Batch file format</strong></span> to <span class="strong"><strong>Standard passwd and shadow files</strong></span>.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip25"/>Tip</h3><p>Note that you should use an export format compatible with the destination operating system. Use the <span class="strong"><strong>Standard</strong></span> format if you're exporting to Linux, but use the BSD, Mac OS, or AIX specific formats if you're exporting to those systems. Always test on a small number of users' accounts before importing a large batch.</p></div></div></li><li class="listitem">Set <span class="strong"><strong>Batch file destination</strong></span> to <span class="strong"><strong>Display in browser</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Users to export</strong></span> to <span class="strong"><strong>Only users</strong></span>, and click the ellipsis (<span class="strong"><strong>...</strong></span>) at the end of the line.</li><li class="listitem">A new user-chooser window will pop up, in which you can select the names of accounts you want to export.</li><li class="listitem">Select accounts by clicking their usernames on the left-hand side of the screen. If you make a mistake, you can remove an account by clicking its name listed among <span class="strong"><strong>Selected Users</strong></span> on the right-hand side of the screen. After you make your selection, click <span class="strong"><strong>OK</strong></span>.</li><li class="listitem">Back in the <span class="strong"><strong>Export Batch File</strong></span> screen, click <span class="strong"><strong>Export Now</strong></span>.</li><li class="listitem">The resultant batch file will be displayed as text in your browser; copy this to your clipboard or save it to a local file.</li></ol></div><p>You can now import the accounts on another machine.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">On your destination system, navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, and click on the link marked <span class="strong"><strong>Run batch file</strong></span>.</li><li class="listitem">Set <span class="strong"><strong>Batch data source</strong></span> to <span class="strong"><strong>Text in box</strong></span>, and <a id="id123" class="indexterm"/>paste the exported batch file content into the provided text area.</li><li class="listitem">Answer <a id="id124" class="indexterm"/><span class="strong"><strong>Yes</strong></span> to the following questions:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Create, modify or delete users in other modules?</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Create home directories for created users?</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Copy files to home directories of created users?</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Passwords are already encrypted?</strong></span></li></ul></div></li><li class="listitem">Your screen should resemble the following screenshot:<div class="mediaobject"><img src="graphics/5849OS_02_06.jpg" alt="How to do it..."/></div></li><li class="listitem">Click <span class="strong"><strong>Execute batch</strong></span> to import the accounts.</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec87"/>How it works...</h2></div></div></div><p>Webmin<a id="id125" class="indexterm"/> uses a <a id="id126" class="indexterm"/>simple but powerful file format to describe its operations on users and groups. Each line in this file describes a single operation, which may be either <code class="literal">create</code>, <code class="literal">modify</code>, or <code class="literal">delete</code>. Fields in each line are separated by colon characters (<code class="literal">:</code>), similar to the format of the Unix user file (<code class="literal">/etc/passwd</code>). The first field is the name of the operation, the second field contains the name of the user or group we want to perform the operation on, and the following fields contain additional data.</p><p>The following is a brief explanation of the format for Webmin's batch files:</p><div class="section" title="Webmin's batch file format for operations on users"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec13"/>Webmin's batch file format for operations on users</h3></div></div></div><p>Webmin's batch instructions are written as text with one operation described in each line. The following standard format is used in operations on system users in Linux:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>create</strong></span>:username:passwd:uid:gid:realname:homedir:shell:min:max:warn:inactive:expire
<span class="strong"><strong>modify</strong></span>:oldusername:newusername:passwd:uid:gid:realname:homedir:shell:min:max:warn:inactive:expire
<span class="strong"><strong>delete</strong></span>:username</pre></div><p>The fields used in <a id="id127" class="indexterm"/>Webmin's batch instructions are similar to fields stored in standard Unix system files. Following are various fields used in Webmin's batch instruction:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">username</code>: This is the <a id="id128" class="indexterm"/>username of the account we want to perform our operation on (for example, <code class="literal">archer</code>).</li><li class="listitem" style="list-style-type: disc"><code class="literal">oldusername</code> and <code class="literal">newusername</code>: These <a id="id129" class="indexterm"/>fields are used in<a id="id130" class="indexterm"/> a <span class="strong"><strong>modify</strong></span> operation. The username field is used twice in case we want to change its value. The first instance is the current username, and the second is the value we want to change it to. You can leave <code class="literal">newusername</code> blank if you don't want to make a change.</li><li class="listitem" style="list-style-type: disc"><code class="literal">passwd</code>: This is the <a id="id131" class="indexterm"/>password that may already be encrypted into a hash or provided in plain text (for example, <code class="literal">myVeryLongPassword123456789</code>). If this field contains just an <code class="literal">x</code> character, the account will be locked.</li><li class="listitem" style="list-style-type: disc"><code class="literal">uid</code>: This is<a id="id132" class="indexterm"/> the user ID represented as a number (for example, <code class="literal">500</code>). If this field is left empty, Webmin will assign an ID automatically.</li><li class="listitem" style="list-style-type: disc"><code class="literal">gid</code>: This is the ID of <a id="id133" class="indexterm"/>the user's primary group (for example, <code class="literal">500</code>). If this field is left empty in a <code class="literal">create</code> operation, Webmin will automatically create a new group named the same as the user.</li><li class="listitem" style="list-style-type: disc"><code class="literal">realname</code>: This is the <a id="id134" class="indexterm"/>real name of the user (for example, <code class="literal">Sterling Archer</code>).</li><li class="listitem" style="list-style-type: disc"><code class="literal">homedir</code>: This is the<a id="id135" class="indexterm"/> home directory of the user (for example, <code class="literal">/home/archer</code>).</li><li class="listitem" style="list-style-type: disc"><code class="literal">shell</code>: This is the <a id="id136" class="indexterm"/>user's default shell program (for example, <code class="literal">/bin/bash</code>).</li><li class="listitem" style="list-style-type: disc"><code class="literal">min</code>: This is the <a id="id137" class="indexterm"/>minimum number of days until the system allows the user to change his/her password. You can set this to <code class="literal">0</code> to remove this limitation.</li><li class="listitem" style="list-style-type: disc"><code class="literal">max</code>: This is the <a id="id138" class="indexterm"/>maximum number of days after which the system will force the user to change his/her password. Set this to <code class="literal">0</code> to remove this feature.</li><li class="listitem" style="list-style-type: disc"><code class="literal">warn</code>: This is the number of days before the password expires, during which the user will be<a id="id139" class="indexterm"/> warned about the upcoming password change.</li><li class="listitem" style="list-style-type: disc"><code class="literal">inactive</code>: This is the<a id="id140" class="indexterm"/> number of days after the password expires, during which the user will still be able to log in and change the password. After this time passes, the user will not be able to log in.</li><li class="listitem" style="list-style-type: disc"><code class="literal">expire</code>: This is<a id="id141" class="indexterm"/> the date when the password will expire, expressed as the number of days since January 1, 1970.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip26"/>Tip</h3><p>If you're performing the <code class="literal">modify</code> operation, you can leave all fields empty, except for the ones you want to change.</p></div></div></li></ul></div></div><div class="section" title="Webmin's batch file format for operations on groups"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec14"/>Webmin's batch file format for operations on groups</h3></div></div></div><p>The following format is used in <a id="id142" class="indexterm"/>operations on system groups:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>create</strong></span>:groupname:passwd:gid:member,member,...
<span class="strong"><strong>modify</strong></span>:oldgroupname:newgroupname:passwd:gid:member,member,...
<span class="strong"><strong>delete</strong></span>:groupname</pre></div><p>The following fields are used:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">groupname</code>: This is the name of the group we want to perform an operation on (for example, <code class="literal">users</code>).</li><li class="listitem" style="list-style-type: disc"><code class="literal">oldgroupname</code> and <code class="literal">newgroupname</code>: These fields are used in a <span class="strong"><strong>modify</strong></span> operation. The group name field is used twice in case we want to change its value. The first instance is the current name of the group, and the second is the value we want to set it to.</li><li class="listitem" style="list-style-type: disc"><code class="literal">passwd</code>: Group passwords are not in common use. They may be used to password-restrict a user's ability to add himself or herself to a group. Set this field to an asterisk or exclamation point (<code class="literal">*</code> or <code class="literal">!</code>) to disable this functionality.</li><li class="listitem" style="list-style-type: disc"><code class="literal">gid</code>: This is the group's ID (for example, <code class="literal">100</code>). If this field is left empty, Webmin will set it automatically to the next available value.</li><li class="listitem" style="list-style-type: disc"><code class="literal">member</code>: This is the username of a user account that should be a member of this group (for example, <code class="literal">archer</code>).</li></ul></div></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec88"/>There's more...</h2></div></div></div><p>Webmin's batch file format can be used to perform operations on both system users and groups. This functionality is not limited to exporting and importing data between systems. Batch files can also be used to quickly modify or delete multiple accounts.</p><div class="section" title="Export and import system groups"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec15"/>Export and import system groups</h3></div></div></div><p>In order to export a list<a id="id143" class="indexterm"/> of system<a id="id144" class="indexterm"/> groups from one system to another, you can follow this recipe, but when you navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>, switch to the <span class="strong"><strong>Local Groups</strong></span> tab before performing the import and export.</p></div><div class="section" title="Batch update user accounts"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec16"/>Batch update user accounts</h3></div></div></div><p>Let's say you find <a id="id145" class="indexterm"/>yourself in a situation that calls for a change in all system user accounts. Let's also say, for example, that we decide to switch the default shell program of all accounts to <code class="literal">zsh</code>. In order to do that, you should prepare a batch file with the following line for each user, where <code class="literal">username</code> is substituted by the username of each account:</p><div class="informalexample"><pre class="programlisting">modify:username:::::::/bin/zsh:::::</pre></div><p>Next, navigate to <span class="strong"><strong>System</strong></span> | <span class="strong"><strong>Users and Groups</strong></span>; click on the link marked <span class="strong"><strong>Run batch file</strong></span>, provide your batch file, and execute it. This will update all user accounts with the new default shell program.</p><p>The same method can be used to update the values of any standard account field.</p></div><div class="section" title="Batch delete user accounts"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec17"/>Batch delete user accounts</h3></div></div></div><p>If you need to delete a<a id="id146" class="indexterm"/> large number of users, you can create a batch file with the following line for each user, where <code class="literal">username</code> is substituted by the name of each user:</p><div class="informalexample"><pre class="programlisting">delete:username</pre></div><p>We run the file in the same way as described previously.</p><div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip27"/>Tip</h3><p>You can use the same method to delete multiple groups; just use group names instead of a username, and switch to the <span class="strong"><strong>Local Groups</strong></span> tab before executing the batch file.</p></div></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec89"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">You can find more information about using Webmin's batch formats on its wiki: <a class="ulink" href="http://doxfer.webmin.com/Usermin/Introduction">http://doxfer.webmin.com/Usermin/Introduction</a>.</li></ul></div></div></div>
<div class="section" title="Installing Usermin"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec34"/>Installing Usermin</h1></div></div></div><p>If you would like to <a id="id147" class="indexterm"/>make the basic functionality of your system available to its users<a id="id148" class="indexterm"/> through an interface similar to Webmin, you can use Webmin's companion product called Usermin. This environment is just as easy to use as Webmin and provides a number of features that do not require administrative privileges:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Reading e-mails</li><li class="listitem" style="list-style-type: disc">Setting up mail forwarding and auto-replies</li><li class="listitem" style="list-style-type: disc">Setting up scheduled e-mails</li><li class="listitem" style="list-style-type: disc">Changing passwords</li><li class="listitem" style="list-style-type: disc">Executing system commands</li><li class="listitem" style="list-style-type: disc">Opening an SSH session in the browser</li><li class="listitem" style="list-style-type: disc">Configuring Apache virtual hosts</li><li class="listitem" style="list-style-type: disc">Configuring MySQL or PostgreSQL databases</li><li class="listitem" style="list-style-type: disc">Setting up CRON jobs or scheduled command execution</li></ul></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec90"/>How to do it...</h2></div></div></div><p>Installation of Usermin is very simple and using it is analogous to using Webmin. The main difference is that you connect over a different port; the default port for Usermin is 20000.</p><p>Let's start by installing Usermin:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">If you've installed Webmin from its repository, follow the recipe, <span class="emphasis"><em>Installing software packages</em></span> from <a class="link" href="ch01.html" title="Chapter 1. Setting Up Your System">Chapter 1</a>, <span class="emphasis"><em>Setting Up Your System</em></span>, and install the package called <code class="literal">usermin</code>.<div class="tip" title="Tip" style=""><div class="inner"><h3 class="title"><a id="tip28"/>Tip</h3><p>If you've installed Webmin from a package file instead of a repository, navigate to <span class="strong"><strong>Un-used Modules</strong></span> | <span class="strong"><strong>Usermin Configuration</strong></span>, and click on the button marked <span class="strong"><strong>Install Usermin</strong></span> package.</p></div></div></li><li class="listitem">After installing the package, click <span class="strong"><strong>Refresh Modules</strong></span> in Webmin's sidebar menu and reload Webmin.</li></ol></div><p>After installation, Usermin will be automatically activated. The usage of Usermin is analogous to the way you use Webmin. Usermin's default port is 20000, so you can connect to it using your web browser and the following address; just substitute the words <code class="literal">webmin.host</code> with the IP address or domain name of your server:</p><div class="informalexample"><pre class="programlisting">https://webmin.host:20000</pre></div><p>You can now log in as any user of your system and explore Usermin's features.</p><p>Usermin's configuration is done through Webmin and is available in the <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Usermin Configuration</strong></span> module. Notice that this screen is similar to Webmin's main settings screen. Configuration options are analogous but limited to the features of Usermin.</p><p>First of all, let's decide which of our users will have access to Usermin:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Usermin Configuration</strong></span> | <span class="strong"><strong>Allowed Users and Groups</strong></span>.</li><li class="listitem">In the <span class="strong"><strong>Usermin login access control</strong></span> section, select <span class="strong"><strong>Only allow listed users</strong></span>.</li><li class="listitem">You can now provide a list of usernames of users whom you wish to grant access to Usermin. If you want to add all members of a group, add the group name to the list preceded by an <code class="literal">@</code> sign, that is, <code class="literal">@groupname</code>.</li></ol></div><p>Second, let's decide which Usermin modules to make available:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Usermin Configuration</strong></span> | <span class="strong"><strong>Available Modules</strong></span>.</li><li class="listitem">Check the boxes next to each module that you wish to make available to users. If you're not sure what a module does, it's probably best to leave it unavailable until you decide you need it.</li><li class="listitem">In order to configure options specific to each module, navigate to <span class="strong"><strong>Webmin</strong></span> | <span class="strong"><strong>Usermin Configuration</strong></span> | <span class="strong"><strong>Usermin Module Configuration</strong></span>.</li><li class="listitem">Click the name of the module and set its options.</li><li class="listitem">You will be able to set modules' global options (<span class="strong"><strong>Global module configuration</strong></span> tab) and default values, which the user will be able to override (<span class="strong"><strong>Default user preferences</strong></span> tab).</li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec91"/>How it works...</h2></div></div></div><p>Usermin is a <a id="id149" class="indexterm"/>companion <a id="id150" class="indexterm"/>package to Webmin, which is installed by default in the directory, <code class="literal">/usr/share/usermin</code>. It functions in much the same way as Webmin, but is focused on providing access to basic functions that don't require root privileges.</p></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec92"/>See also</h2></div></div></div><p>Because Usermin's functionality is similar to Webmin's, you can refer to other recipes in this book to get an idea about its usage and configuration. In particular, take a look at the following chapters:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="link" href="ch01.html" title="Chapter 1. Setting Up Your System">Chapter 1</a>, <span class="emphasis"><em>Setting Up Your System</em></span></li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch08.html" title="Chapter 8. Running an Apache Web Server">Chapter 8</a>, <span class="emphasis"><em>Running an Apache Web Server</em></span></li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch09.html" title="Chapter 9. Running a MySQL Database Server">Chapter 9, </a><span class="emphasis"><em>Running a MySQL Database Server</em></span></li><li class="listitem" style="list-style-type: disc"><a class="link" href="ch10.html" title="Chapter 10. Running a PostgreSQL Database Server">Chapter 10</a>, <span class="emphasis"><em>Running a PostgreSQL Database Server</em></span></li></ul></div><p>You can find more information about Usermin online at the following URL: <a class="ulink" href="http://doxfer.webmin.com/Usermin/Introduction">http://doxfer.webmin.com/Usermin/Introduction</a>
</p></div></div></body></html>