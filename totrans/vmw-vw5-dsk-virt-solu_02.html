<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Solution Methodology"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Solution Methodology</h1></div></div></div><p>This chapter will focus on the solution approach required to design the successful VMware View environments, including the gathering of inputs, their digestion, and the production of a VMware View design, or project output.</p><p>A<span class="strong"><strong> Virtual Desktop Infrastructure (VDI)</strong></span> implementation can have various project drivers, including cost reduction, increased security, or end device flexibility. When participating in a VDI endeavor, it is important to define the project success criteria. For example, if an organization is looking to decrease the login time for roaming physicians, it is important to incorporate a streamlined login process (for example, Single Sign-On) into the overall solution.<a id="id72" class="indexterm"/>
</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note10"/>Note</h3><p>A robust VDI solution that doesn't address the organization's key criteria may still be judged as a mediocre success, instead of embraced a significant improvement to the end user work environment.</p></div><p>Also, for solution providers and architects that are designing VMware View solutions for multiple organizations, it is important to take a scientific and organized approach for designing View solutions. Designing the solutions for separate organizations in tandem can be very confusing. By taking the same approach to each project, the VDI architect can minimize errors and, more importantly, streamline the amount of effort required to produce a design.</p><p>The key phases of designing a VMware View solution are:<a id="id73" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Assessment</li><li class="listitem" style="list-style-type: disc">Use case definition</li><li class="listitem" style="list-style-type: disc">Design</li><li class="listitem" style="list-style-type: disc">Validation</li><li class="listitem" style="list-style-type: disc">Handoff/manage<div class="mediaobject"><img src="graphics/1124EN_02_01.jpg" alt="Solution Methodology"/></div></li></ul></div><p>As noted in<a class="link" href="ch01.html" title="Chapter 1. Components of VMware View"> Chapter 1</a>,<span class="emphasis"><em> Components of VMware View</em></span>, this book focuses on designing the solutions based on VMware View 5. In a full solution, there would be an implementation phase, which would follow the validation phase. These phases, which would include subtopics such as defining the project timeline, key milestones, handoff, and operational readiness would also be incorporated. Nevertheless, these topics are outside the scope of this book.</p><p>This book is a guide for architects to design the solution with the highest probability of success.</p><div class="section" title="Assessment"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec01"/>Assessment</h1></div></div></div><p>A VMware View solution may replace existing physical desktops and require a migration phase or it may be a completely new solution to an organization. In either case, a proper assessment is required to understand how to scope hardware requirements, storage needs, and additional solutions that may be required (for example, a profile management solution).</p><p>An assessment is used to collect the necessary information in order to design the solution properly. An assessment is the process of collecting both technical information as well as organizational information. Typically, there are three components of an assessment:<a id="id74" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Questionnaire</li><li class="listitem" style="list-style-type: disc">Metric collection</li><li class="listitem" style="list-style-type: disc">Discussion</li></ul></div><div class="section" title="Questionnaire"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec01"/>Questionnaire</h2></div></div></div><p>A<span class="strong"><strong> questionnaire</strong></span>, whether filled out manually or electronically, is a valuable tool to start collecting the necessary data to put together a solid VMware View design. A questionnaire is also a useful tool to help an organization feel involved in the design, which helps increase the chance of success.<a id="id75" class="indexterm"/>
</p><p>An organization that participates actively in the VDI design will feel more invested in its success. An organization that was handed a VDI solution with little input will likely enter into their solution with scepticism.<a id="id76" class="indexterm"/>
</p><p>The VDI Fox™ tool, produced by the authors of this book, has a questionnaire available from an iPhone or iPad, which can be used in the field in real time. The questionnaire is also available in the next section. It can be printed out and filled in on site, or the VDI Fox tool can be used. For more information about the VDI Fox application, please visit<a class="ulink" href="http://www.redfoxllc.com/"> http://www.redfoxllc.com/</a>.</p><div class="section" title="Assessment worksheet from VMware View 5 Desktop Virtualization Solutions"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec01"/>Assessment worksheet from VMware View 5 Desktop Virtualization Solutions</h3></div></div></div><p>The following table shows the assessment worksheet from VMware View 5 Desktop Virtualization Solutions:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Question</p>
</th><th style="text-align: left" valign="bottom">
<p>Value</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr><tr><th style="text-align: left" valign="bottom">
<p>Desktop pool inputs</p>
</th><td class="auto-generated"> </td><td class="auto-generated"> </td></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>How many kiosks (explained after this table) will be supported by this solution?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It provides the total number of vDesktops that will be configured as kiosks with (likely) automatic login.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is the maximum number of vDesktop users in the environment?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It provides the total number of vDesktops for a persistent vDesktop solution.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is the maximum number of concurrent users that will connect at any given time?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It provides the total number of vDesktops for a non-persistent vDesktop solution.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What are the desired desktop operating systems for the VDI?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines a baseline of memory and vCPU required for the vDesktops.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is the full size of the existing desktop images?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines how much disk space is required.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>How often do you want the vDesktops refreshed?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the desktop pool settings (refresh immediately, refresh after<span class="emphasis"><em> n</em></span> minutes, refresh at<span class="emphasis"><em> n</em></span> percent disk bloat, and so on).</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Number of point-in-time snapshots to maintain the base image?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines how much disk space is required.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Full highly available solution?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether redundant View Connection Servers, vCenter Servers, and so on, will be used.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will remote workers be supported?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether View Security servers are required.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will users be classified based on where they are connecting from?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether View Connection Server tags are required.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Should external users connect to a different VDI than internal users?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether View Connection Server tags should be used.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will smart cards, CAC cards, proximity badges, and so on be used for authentication?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the settings of View Client, View Agent, and the necessary certificates.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Do you adhere to FIPS 140-2 compliance?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the advanced settings of the View environment.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Do you use two-factor RSA authentication?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to configure advanced authentication options.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Are your remote users primarily in a connected state?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether the solution requires VMware View Local Mode.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Are USB drives allowed?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the advanced View configuration settings.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Does the environment have shift workers?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the desktop pool settings.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is the average work day of an employee in hours?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the desktop pool settings.</p>
</td></tr><tr><td style="text-align: left" valign="bottom">
<p>Storage inputs</p>
</td><td class="auto-generated"> </td><td class="auto-generated"> </td></tr><tr><td style="text-align: left" valign="top">
<p>What is the amount of available space in the desktop images?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the thin size of the image (full - space free = thin size).</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>How many desktop base images exist in the environment today?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used as an input for the number of desktop pools in the solution.</p>
</td></tr><tr><td style="text-align: left" valign="bottom">
<p>Landscape inputs</p>
</td><td class="auto-generated"> </td><td class="auto-generated"> </td></tr><tr><td style="text-align: left" valign="top">
<p>How are desktops patched today?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the patching solution for vDesktops.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is your existing server infrastructure?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the technical landscape.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is your existing storage infrastructure?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the technical landscape.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is your switching infrastructure?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the technical landscape.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Which group manages your virtual server environment?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the political landscape.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Which group manages your physical desktop environment?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the political landscape.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Who do you foresee managing your VDI?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the political landscape.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>How technical are the people that will manage the solution once implemented?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the level of operational readiness that should be performed.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Current Microsoft desktop licensing agreement?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether the necessary Microsoft licensing exists.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Current asset tracking solution for physical desktops?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the existing technology landscape.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will new end devices be purchased for this solution?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether new devices (for example, zero clients) can be used or the existing hardware will be repurposed.</p>
</td></tr><tr><td style="text-align: left" valign="bottom">
<p>Network inputs</p>
</td><td class="auto-generated"> </td><td class="auto-generated"> </td></tr><tr><td style="text-align: left" valign="top">
<p>Will CD or DVD burners be used?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the PCoIP bandwidth considerations.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will microphone jack headsets be used?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the PCoIP bandwidth considerations.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will Dragon Naturally Speaking or Dragon Medical be used?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the PCoIP bandwidth and storage IOPS considerations.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will USB handsets, Dictaphones, and so on be used?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the PCoIP bandwidth considerations.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will videos be streamed on a regular basis?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the PCoIP bandwidth considerations.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will a VOIP solution be required?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the PCoIP bandwidth and end device considerations.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>How far from the VDI will the majority of the users reside?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the network requirements and topology.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will the solution reside on a sensitive or classified network?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the advanced configurations of the overall solution.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>How many VLANs are currently used by your physical desktop networking environment?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It is used to understand the the existing network layout.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Will you be supporting the remote offices?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether a remote office solution needs to be incorporated.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is the current number of<span class="strong"><strong> Dynamic Host Configuration Protocol (DHCP)</strong></span> scopes (and size) available for desktops?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the existing network topology.</p>
</td></tr><tr><td style="text-align: left" valign="bottom">
<p>Profile management inputs</p>
</td><td class="auto-generated"> </td><td class="auto-generated"> </td></tr><tr><td style="text-align: left" valign="top">
<p>What are you using today for profile management?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines whether profile management is required, and/or if there is a solution already in place.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>Where do the users' home directories live?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It determines the existing profile management solution.</p>
</td></tr><tr><td style="text-align: left" valign="bottom">
<p>Success criteria</p>
</td><td class="auto-generated"> </td><td class="auto-generated"> </td></tr><tr><td style="text-align: left" valign="top">
<p>Three months after the solution is live, how will you know you've chosen the proper solution?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It elicits the success criteria for the VDI project.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>What is your primary motivation for implementing a VDI solution?</p>
</td><td style="text-align: left" valign="top"> </td><td style="text-align: left" valign="top">
<p>It elicits the success criteria for the VDI project.</p>
</td></tr></tbody></table></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"/>Note</h3><p>A<span class="strong"><strong> kiosk</strong></span> is used to identify an end device that will be configured to automatically connect to a vDesktop in the VMware View environment.</p></div></div></div><div class="section" title="Metric collection"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec02"/>Metric collection</h2></div></div></div><p>Once the questionnaire has been completed, it is time to begin collecting real-world data from the organization's existing physical landscape. By completing the questionnaire before collecting usage data, the metric collection phase can focus on the areas of concern.<a id="id77" class="indexterm"/>
</p><p>For example, if during the questionnaire it was revealed that the VMware View solution would be supporting surgeons who work 10 hour days and use bidirectional audio (for example, Dragon Medical) often throughout the day, it would be beneficial to collect the data such as CPU, memory, and network usage of these surgeons, even if they are a very small subset of the overall end user population.</p><p>Assessments can be performed on an existing physical desktop infrastructure and on an existing VDI solution (for an organization looking to migrate from Citrix XenDesktop to VMware View, for example).</p><p>There are various ways of collecting the assessment data, including the use of Liquidware Labs Stratusphere Fit™. Fit uses the software running on the desktop that reports back to a central location (Stratusphere Hub). Some of the key metrics collected are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">CPU and memory usage (total and per application)</li><li class="listitem" style="list-style-type: disc">Average login delay</li><li class="listitem" style="list-style-type: disc">Average<span class="strong"><strong> Input/Output Operations Per Second (IOPS)</strong></span><a id="id78" class="indexterm"/></li><li class="listitem" style="list-style-type: disc">Network latency</li><li class="listitem" style="list-style-type: disc">Peripherals</li></ul></div><p>In addition to metric and inventory collection, Fit can be used to rate users on their suitability for a vDesktop solution.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note12"/>Note</h3><p>There are plenty of successful VDI solutions implemented that have never undergone a metric collection phase; however, these are likely implemented by very seasoned VDI professionals. If available, it is encouraged to execute the metric collection phase as it will drastically increase the project's chance of success, as well as give the data to support both the good and bad results as the project progresses.</p></div><p>The goals of the metric collection phase are as follows:<a id="id79" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Establishing a baseline average user</li><li class="listitem" style="list-style-type: disc">Establishing the top ten applications used in the environment</li><li class="listitem" style="list-style-type: disc">Identifying the current points</li><li class="listitem" style="list-style-type: disc">Identifying the potential pitfalls for VDI</li><li class="listitem" style="list-style-type: disc">Classifying the users into use cases</li></ul></div><p>Fit can also be used to organize the future vDesktop users into use types, which translate into desktop pools within the View infrastructure.</p><p>For example, if Stratusphere Fit determines that the vast majority of users are allocated 2 GB of RAM on their physical desktop (and use 80 percent of the allocated memory), but a small contingent of users have 4 GB of memory (and use 80 percent of their allocated memory), then two different linked clone desktop pools (at a minimum) are likely needed. The first pool would have a base desktop image with 2 GB of memory, whereas the second pool would have a base desktop image with 4 GB of memory:<a id="id80" class="indexterm"/>
</p><div class="mediaobject"><img src="graphics/1124EN_02_02.jpg" alt="Metric collection"/></div><p>The preceding diagram demonstrates that the data must first be collected and then analyzed. After analysis the design can begin.</p><p>To properly determine how much physical hardware to procure as well as how to logistically divide the user population into the desktop pools, it is important to collect the information based on the real-world end user activities. Some of the key metrics to collect include the average and peak numbers as follows:<a id="id81" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Memory usage</li><li class="listitem" style="list-style-type: disc">CPU usage</li><li class="listitem" style="list-style-type: disc">CPU ready/wait time</li><li class="listitem" style="list-style-type: disc">Network throughput</li><li class="listitem" style="list-style-type: disc">Network latency</li><li class="listitem" style="list-style-type: disc">Disk throughput (MBps)</li><li class="listitem" style="list-style-type: disc">Disk activity (IOPS)</li><li class="listitem" style="list-style-type: disc">Disk read/write percentage</li><li class="listitem" style="list-style-type: disc">Most frequently used applications</li><li class="listitem" style="list-style-type: disc">Number of monitors</li><li class="listitem" style="list-style-type: disc">Unique peripheral requirements</li><li class="listitem" style="list-style-type: disc">Unused applications</li><li class="listitem" style="list-style-type: disc">Graphics intensity</li></ul></div><p>With most collection utilities, an agent must be installed on the desktops to be surveyed. The most efficient way to install such an agent is typically through an existing mechanism such as group policy objects, Microsoft System Center Configuration Manager, logon scripts, or a variety of other methods.<a id="id82" class="indexterm"/>
</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note13"/>Note</h3><p>While data collecting tools are often forbidden on the sensitive or classified networks, Liquidware Labs has taken the necessary steps and certifications to be able to run them on many sensitive networks.</p></div><p>Fit from Liquidware Labs generates unique reports that help a VDI architect properly understand the existing physical desktop environment so that a robust VMware View solution can be designed and implemented:</p><div class="mediaobject"><img src="graphics/1124EN_02_03.jpg" alt="Metric collection"/></div><p>You can find the preceding screenshot at<a class="ulink" href="http://www.liquidwarelabs.com/images/Bubble_Graphs.png"> http://www.liquidwarelabs.com/images/Bubble_Graphs.png</a>.</p><p>It is recommended to collect data between two and four weeks to ensure that enough time has passed to capture the most typical business cycles. If the organization that is being assessed has known peak work periods (for example, end of quarter closeouts), it may be helpful to collect the data during this time. However, it is advised not to let the collection of outlier data slow down the overall project's process. The careful analysis is important, but just as prolonged capacity planning assessments can bring a server virtualization project to its knees, so can an overly prolonged VDI assessment.<a id="id83" class="indexterm"/>
</p><div class="section" title="Processing the data"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec02"/>Processing the data</h3></div></div></div><p>Once the end user data has been collected, it is important to properly comprehend and analyze the information that has been gleaned from the customer's environment, as shown in the following list:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Memory usage (in MB)<a id="id84" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is the total memory consumed (both active and peak) by the end users. The summation of this metric does not yield the total memory required for the VDI solution.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> It helps determine how much total memory is required by the physical environment. The formula is as follows:<p>MB required for vDesktops + MB required for supporting infrastructure + MB overhead of hypervisor + MB for swap space = Total MB required.
<a id="id85" class="indexterm"/>
</p></li></ul></div></li><li class="listitem" style="list-style-type: disc">CPU usage (in GHz)<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is the total CPU usage consumed (both active and peak) by the end users. In a VDI environment, total CPU usage is likely less important than the users per core.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> This helps determine the total CPU usage required by the physical environment and is used to determine which users may require multiple vCPUs.<a id="id86" class="indexterm"/><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note14"/>Note</h3><p>
<span class="strong"><strong>Why users per core?</strong></span>
</p><p>Calculating users per core is more important than trying to determine the total number of MHz needed by a given user. Two key CPU-related metrics are CPU Ready and CPU Wait.<span class="strong"><strong> CPU Ready</strong></span> is the time in milliseconds that a machine spends waiting for a CPU to become available. If the design implements too many vDesktops per core, the end users will experience a high CPU Ready time and their vDesktops will be sluggish as the vDesktops wait for one another to free up the CPU time for their own processing needs.<span class="strong"><strong> CPU Wait</strong></span> is the time in milliseconds that a CPU spends waiting for an I/O to complete. A high CPU Wait is usually indicative of either a disk or a network bottleneck. For example, a particular vDesktop may be running a process that reads and writes the large amount of data to the local filesystem. If the underlying storage is unable to meet the performance needs of the vDesktop's process, a high CPU Wait time may be realized.</p></div></li></ul></div></li><li class="listitem" style="list-style-type: disc">Network throughput (in KBps)<a id="id87" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine potential bottlenecks in both an on-site and/or a remote solution. As the VDI solutions are often implemented in a central location, the network throughput can be used to determine the required bandwidth between a remote office and the location of the VDI.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> For example, an environment with minimal network throughput between the end users at a remote site and the centrally located VDI may choose to implement VDI at the remote office and manage it from a central location (one solution to limited network throughput). It is also important to understand any unusual network bandwidth requirements of the VDI users.<a id="id88" class="indexterm"/></li></ul></div></li><li class="listitem" style="list-style-type: disc">Network latency (in milliseconds)<a id="id89" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine the potential bottlenecks in both an on-site and/or a remote solution. As both the<span class="strong"><strong> Microsoft Remote Desktop Protocol (RDP)</strong></span> and VMware's PCoIP protocol are latency sensitive, it's important to understand the round trip time for data transmissions between the end users and the location of VDI.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> For example, an environment with high network latency may choose to implement policies optimizing the PCoIP protocol at both the end devices and within the vDesktop. The policies may limit advanced graphics capabilities and use compression to maximize an end user's experience.</li></ul></div></li><li class="listitem" style="list-style-type: disc">Disk throughput (in MBps)<a id="id90" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine potential bottlenecks in the underlying storage environment supporting VDI from a bandwidth perspective.<a id="id91" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> For example, an environment with a class of users requiring large amounts of disk throughput (for example, recording audio) may need to have their vDesktops reside on a separate data store from other vDesktops users. This not only suggests and promotes the tiering of the storage platform but also prevents low disk throughput users from being impacted by high throughput users.</li></ul></div></li><li class="listitem" style="list-style-type: disc">Disk activity (in IOPS)<a id="id92" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine potential bottlenecks in the underlying storage environment supporting VDI from a performance perspective.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> Disk IOPS is one of the most important metrics of a VDI design and, as such, a chapter later in this book is dedicated to the fundamental concepts of storage in a VDI solution. Collecting disk IOPS consumed by end users before a migration to a VMware View solution will provide an idea about the overall number of disk IOPS that need to be supported in the solution. However, as discussed later in this book, storage design plays a paramount role in the overall success of a VMware View solution.<a id="id93" class="indexterm"/></li></ul></div></li><li class="listitem" style="list-style-type: disc">Disk read/write percentage<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to help determine a suitable storage environment for the VDI.<a id="id94" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> More on designing a suitable storage environment for the VDI can be found later in this book.</li></ul></div></li><li class="listitem" style="list-style-type: disc">Most frequently used applications<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> A list of common applications used on a daily basis by the majority of users in a given user class.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> Understanding the most frequently used applications can help determine a candidate list for a given application virtualization (AppVirt) solution, for example, VMware ThinApp. The most frequently used application list may also be helpful in determining what applications will be included in a desktop pool's parent image.</li></ul></div></li><li class="listitem" style="list-style-type: disc">Number of monitors<a id="id95" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine how many monitors a given user is using.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> As supporting additional monitors will change the memory settings of the vDesktop (and if using linked clones, all vDesktops in a given pool), it may be useful to separate multi-monitor users from single-monitor users. With a growing number of environments, two monitors is the standard and four monitors is abnormal. In this case, separating the four monitor users may prove beneficial:</li></ul></div></li><li class="listitem" style="list-style-type: disc">Unique peripheral requirements<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine potential compatibility issues with a VMware View solution.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> For example, a class of users may require the use of webcams for collaboration. At the time of writing, the webcams were not supported by VMware View 5.</li></ul></div></li><li class="listitem" style="list-style-type: disc">Unused applications<a id="id96" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine applications that are never or seldom used in a desktop environment.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> For example, an environment may have several applications that are included in the current gold image. However, it may likely make sense not to include such applications in the base image for the VMware View vDesktop deployments.</li></ul></div></li><li class="listitem" style="list-style-type: disc">Graphics intensity<a id="id97" class="indexterm"/><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Input:</strong></span> It is used to determine potential bottlenecks in the underlying storage environment supporting the VDI from a bandwidth perspective.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Output:</strong></span> For example, it is used to determine which users may need additional hardware (for example, blade PC) to provide the level of graphics required by an end user. In some environments, the capabilities of a vDesktop will not be able to provide the level of graphics capabilities required by a class of users. In these environments, a solution that integrates a blade PC solution into a VDI (for example, a solution from ClearCube) would be ideal.</li></ul></div></li></ul></div></div></div></div></div>
<div class="section" title="Use case definition"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec02"/>Use case definition</h1></div></div></div><p>Once sufficient data has been collected during the assessment phase, the data can then be analyzed to determine the specific use cases.</p><p>A<span class="strong"><strong> use case</strong></span> is a collection of connection, performance, peripheral, and other characteristics for a group of vDesktop users. It is important to use the data collected in the assessment phase as well as observations (if possible) of the users in action to determine the primary use cases for a given environment.<a id="id98" class="indexterm"/>
</p><p>For example, through a diligent assessment phase, the following may be determined:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Total of 300 vDesktop users</li><li class="listitem" style="list-style-type: disc">50 of which require 2 monitors</li><li class="listitem" style="list-style-type: disc">25 of which have high performance needs that are fulfilled with 2 vCPUs and 6 GB of RAM</li><li class="listitem" style="list-style-type: disc">200 of which have average needs that are fulfilled with 2 vCPUs and 1.5 GB of RAM</li><li class="listitem" style="list-style-type: disc">25 of which require 4 monitors</li></ul></div><p>If the design attempts to support all of the preceding requirements in a single desktop pool, the desktop pool would have support for 4 monitors and vDesktops with 6 GB of RAM. This type of design would waste a lot of physical resources (for example, 4 GB of additional memory for 175 vDesktops, totaling 700 GB of waste).<a id="id99" class="indexterm"/>
</p><p>Therefore, a proper design would be as follows:<a id="id100" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A desktop pool of 25 desktops based on a gold image of 2 vCPUs and 6 GB of RAM</li><li class="listitem" style="list-style-type: disc">A desktop pool of 50 desktops supporting up to 2 monitors</li><li class="listitem" style="list-style-type: disc">A desktop pool of 25 desktops supporting up to 4 monitors</li><li class="listitem" style="list-style-type: disc">A desktop pool of 200 desktops supporting the bulk of the user environment; based on a gold image of 2 vCPUs and 1.5 GB of RAM</li></ul></div><p>Some key questions that can help determine use cases are as follows:<a id="id101" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">What are the minimum performance requirements needed to provide a favorable vDesktop experience?</li><li class="listitem" style="list-style-type: disc">Are there bidirectional audio requirements?</li><li class="listitem" style="list-style-type: disc">How many monitors must be supported?</li><li class="listitem" style="list-style-type: disc">Will the desktops be disposable (non-persistent)?</li><li class="listitem" style="list-style-type: disc">How will the user profiles be managed (if applicable)?</li><li class="listitem" style="list-style-type: disc">Are there any unique security or compliance needs?</li></ul></div><p>By determining the various use cases supported by the VDI solution, the ultimate design can not only support the required use cases but also ensure that the underlying physical infrastructure is optimized.</p><p>At the end of the use case definition phase, the required inputs to design a solution have been collected, discussed with the organization, and agreed upon.</p></div>
<div class="section" title="Design overview"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec03"/>Design overview</h1></div></div></div><p>A VDI solution builds on the complexity of a typical server virtualization solution by adding requirements for connection infrastructure, persona management (if applicable), desktop pool infrastructure, end devices, and so on, as shown in the following diagram, which shows the VMware View solution stack:<a id="id102" class="indexterm"/>
</p><div class="mediaobject"><img src="graphics/1124EN_02_04.jpg" alt="Design overview"/></div><p>In addition, for experienced server virtualization architects, the requirements of a VDI solution are often significantly different (for example, the way a vSphere cluster may be designed), so it is important to respect the importance of sound VMware vSphere design while recognizing the new implications of a VMware View solution. For example, a VDI solution will likely have greater virtual machine to physical density than a classic server virtualization solution. In addition, the compute and storage demands can be more burst of nature, with higher peaks and shorter duration than a classic server virtualization solution.</p><p>While many of the following subsections (for example, storage, user persona management) will be covered in much greater detail later in this book, an overview of the methodology used for each design is provided in brief for each component in the following section.<a id="id103" class="indexterm"/>
</p><div class="section" title="Storage"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec03"/>Storage</h2></div></div></div><p>
<span class="strong"><strong>Storage</strong></span> is an area of high impact in regards to the overall VMware View solution. Without a properly designed storage infrastructure, the entire solution may ultimately fail.<a id="id104" class="indexterm"/>
</p><p>This book focuses primarily on VMware View solutions that leverage the linked clone technology afforded by VMware View Composer. In designs using linked clones, a single replica disk is used for all vDesktops in a given pool. Therefore, storage considerations, for example, read IOPS are extremely important when designing the storage subsystem for a VDI solution:</p><div class="mediaobject"><img src="graphics/1124EN_02_05.jpg" alt="Storage"/></div><p>In the preceding diagram, the heavy read load is illustrated as every user in a given desktop pool is reading from the same replica disk. However, each user will write to his/her own OS Disk (and persistent User Data Disk and/or non-persistent temporary data disk, if applicable).<a id="id105" class="indexterm"/>
</p><p>In addition, understanding the application environment of the end users is important as applications such as Nuance's Dragon Medical could place a heavy load on the disk when performing transcription tasks. For users that require heavy storage I/O, it is advised to place them in their own desktop pool:</p><div class="mediaobject"><img src="graphics/1124EN_02_06.jpg" alt="Storage"/></div><p>As shown in the preceding diagram, linked clones allow the use of storage tiering. In the preceding example, the replica disk (a high read I/O load) is placed on<span class="strong"><strong> Enterprise Flash Drives (EFDs)</strong></span> protected with RAID 10. The User Data virtual disks are placed on SCSI 10K drives protected with RAID 5. Linked clones allow for the storage subsystem to be tailored economically, technically, and functionally to match the needs of the VDI.<a id="id106" class="indexterm"/>
</p><div class="section" title="Isolation at the data store level"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec03"/>Isolation at the data store level</h3></div></div></div><p>When designing a VMware View solution, especially one leveraging linked clones, it is important to understand the inherent advantage of being able to separate desktop pools, user classes, and performance requirements on separate data stores.<a id="id107" class="indexterm"/>
</p><p>In the following diagram, Pool 1 supports heavy users requiring an I/O intensive application, Pool 2 supports the general user population, and Pool 3 supports kiosks for walk-in customers:</p><div class="mediaobject"><img src="graphics/1124EN_02_07.jpg" alt="Isolation at the data store level"/></div><p>In Pool 1, for example, the replica disk can reside on performance optimized EFDs (extremely high IOPS supported), with the user's write activity (for example, OS Disk) occurring on SCSI 15K disks in a RAID 10 set (high IOPS supported) and the user's non-persistent data residing on SATA RAID 5 (low IOPS supported) disks.<a id="id108" class="indexterm"/>
</p><p>Furthermore, for Pool 2, the replica disks can reside on a separate EFD-based data store with the user's write activity occurring on a separate SCSI 10K RAID 5 data store. Pool 2 can also use the same data store for non-persistent temporary data, if so desired.</p><p>Finally, Pool 3 can also use separate data stores, from Pool 1 and Pool 2, for its replica disks and user OS Disks.</p><div class="section" title="Why is this beneficial?"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl4sec01"/>Why is this beneficial?</h4></div></div></div><p>This is beneficial for the following reasons:<a id="id109" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Cost savings:</strong></span> In this solution, an entire storage array doesn't need to be populated with expensive EFDs; instead only enough EFDs need to be purchased to support the desired replica disks. On the contrary, for non-persistent and performance-insensitive data, cheap SATA disks can be used.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Performance tuning:</strong></span> In this solution, the appropriate technology (for example, EFD) is used to deliver an optimized end user experience. By using tiered storage the disk optimized for heavy I/O can be used when necessary, but it doesn't have to be used for all disk activities.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Performance segregation:</strong></span> In this example, extremely heavy use (for example, login storm, application batch processing, and so on) in Pool 1 should not impact end users in Pool 2 (assuming that the storage array network is not a bottleneck). Therefore, high I/O users (for example, bidirectional audio physicians) can be separated and segregated from moderate I/O users (for example, administrative staff).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Service-level agreements:</strong></span> In this example, each pool uses its own data store for replica disks. However, if each pool uses the same data store for its replica disks, it would be possible for the actions and activities in one desktop pool to impact another, making adhering and enforcing<span class="strong"><strong> service-level agreements (SLAs)</strong></span> extremely difficult.</li></ul></div></div></div></div><div class="section" title="Networking"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec04"/>Networking</h2></div></div></div><p>There are several core networking components that must be considered when designing a VDI,<span class="strong"><strong> Dynamic Host Configuration Protocol (DHCP)</strong></span> leases,<span class="strong"><strong> Domain Name System (DNS)</strong></span> resolution, load balancing, and virtual switch technology. This is addressed in detail later in this book, but it is worth noting that engaging the organization's network team early in the conversation is highly recommended.<a id="id110" class="indexterm"/>
</p></div><div class="section" title="Compute"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec05"/>Compute</h2></div></div></div><p>As addressed in<a class="link" href="ch01.html" title="Chapter 1. Components of VMware View"> Chapter 1</a>,<span class="emphasis"><em> Components of VMware View</em></span>, users per core is the primary measurement of consideration in the compute layer of a VMware View solution. With ever-increasing processing power and processing density becoming available, compute is becoming a layer that requires less attention, especially when using processors with six or more cores.<a id="id111" class="indexterm"/>
</p></div><div class="section" title="VMware vSphere and View desktop pool infrastructure"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec06"/>VMware vSphere and View desktop pool infrastructure</h2></div></div></div><p>As discussed in more detail later in this book, a sound VMware vSphere infrastructure is extremely important to a robust VMware View solution. For seasoned vSphere architects, many of the concepts of a sound vSphere infrastructure will be familiar and practiced. However, VMware View solutions will likely exceed some of the maximums allowed, as defined by VMware. For example, in the current version of VMware vCenter, the maximum number of powered-on virtual machines is 10,000. In some large-scale VDI implementations, this number will easily be surpassed. Regardless, it is important to understand that 10,000 vDesktops may not be an acceptable notion from the management's perspective. This book will cover how to properly design a VMware vSphere infrastructure for large-scale VMware View solutions.<a id="id112" class="indexterm"/>
</p><div class="section" title="Pod architecture"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec04"/>Pod architecture</h3></div></div></div><p>As mentioned earlier, VMware View solutions may exceed the maximums allowed by VMware vSphere, the underlying virtual infrastructure platform. As such, collections of VMware vSphere environments, called pods, are used to provide modular building blocks for the VDI. A<span class="strong"><strong> pod</strong></span> is a collection of physical servers running VMware ESX, one or more VMware vCenter Servers, and the supporting storage and networking infrastructure to provide<span class="emphasis"><em> n</em></span> number of vDesktops. This number will vary with design, unique customer requirements, and the data gathered during the assessment phase:<a id="id113" class="indexterm"/>
</p><div class="mediaobject"><img src="graphics/1124EN_02_08.jpg" alt="Pod architecture"/></div><p>In the preceding diagram, the pod consists of a VMware vCenter environment managing two clusters of eight hosts per cluster. The eight hosts per cluster configuration is the VMware View maximum configuration that is supported. Therefore, in most VMware View pods, a cluster will consist of between six and eight hosts per cluster (typically eight).<a id="id114" class="indexterm"/>
</p></div></div><div class="section" title="Application distribution infrastructure"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec07"/>Application distribution infrastructure</h2></div></div></div><p>Whether VMware ThinApp, Citrix XenApp, Microsoft App-V, or another solution is used to deliver applications to the desktops in an environment, understanding where the environment lives, how it is used, and its impact on the overall solution (for example, network implications) is important. This book will cover the key concepts of application virtualization as it relates to a VMware View solution. However, this book does not dive deep into the technical components of application virtualization.<a id="id115" class="indexterm"/>
</p></div><div class="section" title="User persona management"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec08"/>User persona management</h2></div></div></div><p>There are many options when it comes to managing the user persona in a VDI solution such as Microsoft Folder Redirection and the User State Migration Tool, Liquidware Labs ProfileUnity, and AppSense.<a id="id116" class="indexterm"/>
</p><p>VMware's acquisition of<span class="strong"><strong> RTO</strong></span> now provides an integrated persona management solution with VMware View 5. However, at the time of writing, the community of VMware View architects was not leveraging the built-in capability in large-scale solutions. Regardless, user persona management will be addressed later in this book as it is important to understand how they integrate (especially) in a non-persistent desktop pool, as well as potential network implications that user profiles may add.</p><div class="section" title="What is a user persona?"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec05"/>What is a user persona?</h3></div></div></div><p>A<span class="strong"><strong> user persona</strong></span> is a collection of settings, favorites, shortcuts, wallpapers, customizations, desktop icons, printers, and other settings unique to a given user.</p><p>As illustrated previously, a vDesktop is composed of three abstract layers. These layers are OS, Apps, and Persona.</p><p>The OS layer is the execution environment for the vDesktops. This is primarily either Microsoft Windows XP or Microsoft Windows 7 (or planned to be Microsoft Windows 7).</p><p>The Apps (applications) layer can either be a separate layer by using an application virtualization solution (for example, VMware ThinApp) or can be included inside the OS layer:</p><div class="mediaobject"><img src="graphics/1124EN_02_09.jpg" alt="What is a user persona?"/></div><p>In the preceding diagram, the Apps layer is not separate and is instead nested within the OS layer. This means that to update a single application for a desktop pool, the entire parent image must be updated:</p><div class="mediaobject"><img src="graphics/1124EN_02_10.jpg" alt="What is a user persona?"/></div><p>In the preceding diagram, the Apps layer is independent of the OS layer, and thus can be updated independently. This allows administrators to update a single application without requiring massive changes to the composition of a VMware View desktop pool. In most instances, there are strong advantages to using an AppVirt solution for some or all of the applications for the VDI. The user base and performance characteristics of the applications may play a part in your overall decision on how you decide to deliver your applications.</p></div></div><div class="section" title="Connection infrastructure"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec09"/>Connection infrastructure</h2></div></div></div><p>The connection infrastructure includes the brokers or VMware View Connection Servers, an optional load balancer, an optimal WAN optimizer, a DNS solution, and any advanced routing capabilities (for example, Cisco Global Site Selector).<a id="id117" class="indexterm"/>
</p><p>As ultimately all incoming connections will initially route to a VMware View Connection Server, it is imperative to keep at least one VMware View Connection Server available to end users at all times.</p><p>Once a connection has been successfully authenticated, the VMware View Client directly connects to the VMware View Agent within the vDesktop; this is referred to as a<span class="strong"><strong> direct connection</strong></span>. For direct connections, a failure of the VMware View Connection Server once a user has already connected to their desktop does not impact existing connections. However, it does impact future connection requests.</p><p>It is possible to use the Microsoft protocol with VMware View. Microsoft RDP uses a tunnelled connection. This tunnelled connection opens a second HTTPS connection with the View Connnection Server or View Security Server. In this scenario, the failure of the View Connection Server or View Security Server providing the secondary HTTPS connection will cause disconnection of the end user.</p></div><div class="section" title="End devices"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec10"/>End devices</h2></div></div></div><p>As detailed later in this book, there are various end devices that offer various benefits (and trade-offs). It's important to understand the multitude of devices available in the market to understand how they are incorporated into a VMware View solution. This book will cover the major categories of end devices, including thick clients, thin clients, zero clients, Apple iPads, and forward-looking end devices.<a id="id118" class="indexterm"/>
</p></div><div class="section" title="People"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec11"/>People</h2></div></div></div><p>People are the most important layer of any VDI solution. It is important for the VDI architect to always understand that a project's success will very likely be measured by the people using the solution, their experience, their perception, and their transition to a vDesktop environment.<a id="id119" class="indexterm"/>
</p><p>Not keeping people at the forefront of the solution can have catastrophic consequences. Everything from end devices to desktop pool configuration should be chosen with the happiness of the end user in mind.</p></div></div>
<div class="section" title="Validation"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec04"/>Validation</h1></div></div></div><p>Once a design has been formulated, vetted, and approved, then comes the time to validate the solution. Validation is normally performed on a representative subset of the full-scale solution. For example, in a solution that leverages two fully populated HP c7000 Blade chassis, a single half-populated chassis may be used to test the provisioning, basic functionality, and underlying storage performance. In some scenarios, disposable hardware is used simply to test the software components.<a id="id120" class="indexterm"/>
</p><p>Leveraging an economically scalable hardware platform, such as the Nutanix converged virtualization appliance (<a class="ulink" href="http://www.nutanix.com/">http://www.nutanix.com/</a>) or Pivot3 vSTAC (<a class="ulink" href="http://pivot3.com/">http://pivot3.com/</a>) can help both prove out the design with a low cost of entry, as well as support a production solution in the future.</p><p>One of the best ways of validating a solution is to build a pilot environment according to the specifications detailed in the design document. Once the pilot environment is built, a pilot group of users can be enrolled to test user experience, functionality, and to apply a load on the underlying hardware.<a id="id121" class="indexterm"/>
</p><div class="section" title="VMware View Planner tool (formerly VMware RAWC)"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec12"/>VMware View Planner tool (formerly VMware RAWC)</h2></div></div></div><p>The VMware View Planner tool, formerly known as the<span class="strong"><strong> Reference Architecture Workload Simulator (RAWC)</strong></span>) tool, is the best way to simulate end user connections and activity in a VMware View environment. For organizations looking to stress test VMware and competing solutions side by side, the Login VSI tool (<a class="ulink" href="http://www.loginvsi.com/">http://www.loginvsi.com/</a>) will support comparison testing. The VMware View Planner tool is for VMware View environments only.<a id="id122" class="indexterm"/>
</p><p>The VMware View Planner tool is comprised of the following things:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Session launcher virtual machine:</strong></span> This virtual machine launches the actual vDesktop sessions. Each session launcher virtual machine can support up to 20 concurrent sessions.<a id="id123" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Controller virtual machine:</strong></span> This virtual machine hosts the View Planner interface and the network share for the configuration and log files.<a id="id124" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Target vDesktops:</strong></span> The vDesktops used for stress testing have the View Planner code residing on each of the vDesktops (or as part of the parent image).<a id="id125" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>E-mail server virtual machine (optional):</strong></span> This virtual machine is only necessary if Microsoft Outlook will be used as part of the View Planner testing and if there is no Microsoft Exchange Server available for testing purposes.<a id="id126" class="indexterm"/></li></ul></div><p>View Planner can be tailored to perform the following end user tasks:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Microsoft Word:</strong></span> Insert text, save modifications, resize window, close application<a id="id127" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Microsoft Excel:</strong></span> Insert numbers, insert and delete columns and rows, copy and paste formulae, save modifications, resize window, close application<a id="id128" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Microsoft PowerPoint:</strong></span> Open a presentation, conduct a slideshow presentation, resize window, close application<a id="id129" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Microsoft Outlook:</strong></span> Set up a mailbox, send e-mail, execute send/receive, resize window, close application<a id="id130" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Internet Explorer:</strong></span> Browse a web page, resize window, close application<a id="id131" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Windows Media Player:</strong></span> View a video, close application<a id="id132" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Adobe Acrobat Reader:</strong></span> Open a PDF document, scroll through the document, resize window, close application<a id="id133" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Java Runtime:</strong></span> Run a Java application, close application<a id="id134" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>McAfee AntiVirus:</strong></span> Execute a real-time virus scan, close application<a id="id135" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>7-Zip:</strong></span> Compress files, close application<a id="id136" class="indexterm"/></li></ul></div><p>With this extensive list of capabilities, a variety of tests can be executed to test overall VDI performance, login storms, boot storms, storage performance, and so on.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note15"/>Note</h3><p>
<span class="strong"><strong>Boot storm versus login storm</strong></span>
</p><p>In researching, designing, discussing, and planning the VDI solutions, the boot storm and login storm terms will appear often; however, the two terms cannot be used interchangeably.</p><p>A<span class="strong"><strong> boot storm</strong></span> is a significant enough number of vDesktops booting (or resuming from a suspension) to cause a decrease in the overall VDI performance. This can be caused due to one or more data stores that are unable to handle the I/O load, a file lock conflict with too many vDesktops/data stores, a DHCP lease request flood, and so on.</p><p>A<span class="strong"><strong> login storm</strong></span> is a significant enough number of end users logging into the vDesktops to cause a decrease in the overall VDI performance. This can be caused due to creating initial profiles, streaming a user's persona, slow Active Directory performance, misaligned disks (for example, Windows XP without the proper offset), and so on.</p></div><p>Using RAWC in conjunction with a monitoring solution such as Liquidware Labs Stratusphere UX (User Experience) or RTO PinPoint can allow a VMware View architect to identify bottlenecks during the validation phase instead of during the implementation phase.<a id="id137" class="indexterm"/>
</p><div class="section" title="Comparing storage platforms"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl3sec06"/>Comparing storage platforms</h3></div></div></div><p>As RAWC View Planner provides a scientific approach to testing a canned (or random) series of tailored tests, the tests can become the control in an experiment where the storage platform is the variable.<a id="id138" class="indexterm"/>
</p><p>For example, if the true advantages of EFD in a RAID 10 (over SCSI 15K RAID 10) are needed to be quantified, a saved RAWC test could be run against a desktop pool using EFD in the first iteration and SCSI 15K in the second iteration.</p><p>This technique can be used not only to test, quantify, and optimize a storage array and its configuration, but it can also be used to compare the storage arrays from multiple vendors.</p><p>Many thanks to Fred Schmischeimer for all of his help with the RAWC tool and for his information guide,<span class="emphasis"><em> Workload Considerations for Virtual Desktop Reference Architectures</em></span> information guide.</p></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec05"/>Summary</h1></div></div></div><p>VDI solution design is complex; by taking a measured approach that involves both hard data (metric collection) as well as organizational input (questionnaire), the chances of a suitable design increase drastically. This chapter discussed the layers involved in a VMware View solution, some of the pitfalls to watch out for, as well as some of the industry tools to use to help support the overall design and validation process.</p><p>The next chapter discusses one of the most important design considerations a VDI architect can make,<span class="emphasis"><em> persistent or non-persistent?</em></span> The answer to this question is the cornerstone of the VMware View design, and, as such, needs to be fully understood to ensure the best possible design outcome.</p></div></body></html>