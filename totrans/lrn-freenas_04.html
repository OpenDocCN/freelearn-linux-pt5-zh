<html><head></head><body><div class="chapter" title="Chapter&#xA0;5.&#xA0;User and System Administration"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter 5. User and System Administration</h1></div></div></div><p>In this chapter, we will look at the different system administration tasks for the FreeNAS server as well as user administration. Areas covered include:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Adding new users</p></li><li class="listitem"><p>Using local user authentication with CIFS, FTP, AFP, and SSH</p></li><li class="listitem"><p>Rebooting and shutting down the server</p></li><li class="listitem"><p>Simple network management including configuring FreeNAS to use DNS and setting the default gateway</p></li><li class="listitem"><p>Getting status information about the server</p></li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec01"/>Introduction</h1></div></div></div><p>In general, once the FreeNAS server is configured and running, it doesn't really need much attention, it should just work. However, there are lots of different features which can be configured. This chapter will look at some of the common administration tasks for setting up your FreeNAS server.</p></div></div>
<div class="section" title="Local User Management"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec02"/>Local User Management</h1></div></div></div><p>Until now, we have only used the FreeNAS server in an "anonymous" mode, meaning that anyone can connect to the server and read, create, and delete files. This isn't always what you want, so FreeNAS has some user management features that change the way CIFS, FTP, and AFP allow users to connect to the server.<a id="id155" class="indexterm"/>
</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note17"/>Note</h3><p>The 0.6 series of FreeNAS releases has rather blunt user management. The defined users have access or they don't have access, period. There is no granularity; for example being able to give some users read access while others have read/write access.</p><p>The roadmap for the 0.7 releases promises the ability to create a share (meaning a folder on a selected disk), with user/group/quota property on this share. This implies a greater level of control.</p></div><p>The first step to creating a user is in fact to create a group. Each user must belong to a group. Groups are sets of users who are associated with one another. So in your business, you might have a <span class="emphasis"><em>sales</em></span> group and a <span class="emphasis"><em>engineering</em></span> group. At home, you probably only want one group, for example <span class="emphasis"><em>home</em></span>.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>1. To create a group, go to<span class="strong"><strong> Access: Users and Groups</strong></span> and click on the<span class="strong"><strong> Group</strong></span> tab.</p></li><li class="listitem"><p>2. Now click on the add circle.<a id="id156" class="indexterm"/>
</p></li><li class="listitem"><p>3. The form is very simple; you need to add a name and a description. For example sales and "The sales people".</p></li><li class="listitem"><p>4. Now click<span class="strong"><strong> Add</strong></span> and then apply the changes.</p></li></ol></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip50"/>Note</h3><p>Only a-z, A-Z, and 0-9 are supported in the group name. _ (underscores) and spaces are not supported, neither are punctuation characters like $%&amp;* etc.</p></div><p>Now that you have a group created, you can create a user.<a id="id157" class="indexterm"/>
</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>1. Click on the<span class="strong"><strong> Users</strong></span> tab.</p></li><li class="listitem"><p>2. And then on the add circle.</p><p>There are four mandatory fields:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
<span class="strong"><strong>Login:</strong></span> This is the unique login name of user. If the user already has a login name on other servers or workstations, like a Windows user name or a Linux user name, it is best to keep it the same here. This way the user doesn't need to try an remember an extra username and also some programs (particularly Windows) try and log in with the Windows user name before asking which name it should use. Keeping them the same will ease integration.</p></li><li class="listitem"><p>
<span class="strong"><strong>Full Name:</strong></span> The user's full name. Often, the login name is an abbreviation or short name for the user like john, gary. Here you need to enter the full name so that it is easy to tell which login name belongs to which person.</p></li><li class="listitem"><p>
<span class="strong"><strong>Password:</strong></span> Their password (with confirmation). The colon ':' character isn't allowed in the password.</p></li><li class="listitem"><p>
<span class="strong"><strong>Primary Group:</strong></span> The group to which they belong, for example sales.</p></li></ul></div><div class="mediaobject"><img src="graphics/4688_05_01a.jpg" alt="Local User Management"/></div></li><li class="listitem"><p>3. To finish, you need to click<span class="strong"><strong> Add</strong></span> and apply the changes.</p></li></ol></div><p>You now have a user added to your FreeNAS server.</p><p>There are three more optional fields when adding a user: Home Directory, Full Shell, and Administrator, and we shall look at these in a moment, but first let's look at what effect adding a user has on the rest of the FreeNAS server.</p><div class="section" title="Using CIFS with Local Users"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec01"/>Using CIFS with Local Users</h2></div></div></div><p>To use the users you have defined with Windows networking, you need to go to the<span class="strong"><strong> Services: CIFS/SMB</strong></span> page and change the<span class="strong"><strong> Authentication</strong></span> field to<span class="strong"><strong> Local User</strong></span>. Then click<span class="strong"><strong> Save and Restart</strong></span> to apply your changes.<a id="id158" class="indexterm"/>
</p><p>What this means is that only authenticated users can now access the FreeNAS shares via CIFS.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note18"/>Note</h3><p>In version 0.6, this user authentication is for all the shares, the user has access to everything or nothing. This should change with 0.7.</p></div><p>When trying to connect now from a Windows Vista machine, a window pops up asking for a user name and password.</p><div class="mediaobject"><img src="graphics/4688_05_04.jpg" alt="Using CIFS with Local Users"/></div><p>Once authenticated, the user has access to all the user shares on the FreeNAS server.</p></div><div class="section" title="FTP and User Login"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec02"/>FTP and User Login</h2></div></div></div><p>On the<span class="strong"><strong> Services: FTP</strong></span>, there are two fields that control how users log in to the FreeNAS server:<a id="id159" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
<span class="strong"><strong>Anonymous login:</strong></span> This allows you to enable anonymous login. This means the user connects with the user name<span class="strong"><strong> anonymous</strong></span> and any password.</p></li><li class="listitem"><p>
<span class="strong"><strong>Local User:</strong></span> This enables a local user login. Users log in using the user name and passwords defined in the Access: Users and Groups page.</p></li></ul></div><p>The two can be used together; however, they do negate one another in terms of security. It is best to run the FTP with either anonymous logins enabled and local user logins disabled or vice versa. If you run with both enabled, then people can still log in using the anonymous method even if they don't have a user account and so, it diminishes the benefits of having the user accounts enabled.</p><p>Other than the security benefits, another advantage of local user login with FTP is that you can define a home directory for the user and when the user logs in, they will be taken to that directory and only they have access to that directory and those below it. This effectively offers each user their own space on the server and other users cannot interfere with their files.</p><p>To get this working, you need to create a directory on your shared disk. You can do this with any of the access protocols CIFS, NFS, FTP, and AFS. You need to connect to the shared disk and create a new folder.</p><p>Then, in<span class="strong"><strong> Access: Users</strong></span>, either create a new user or edit an existing one (by clicking on the 'e' in a circle). In the<span class="strong"><strong> Home directory</strong></span>, you need to enter the directory for that user. For example for the user john, you might create a directory cunningly named <span class="emphasis"><em>john</em></span>. Assuming the disk is named <span class="emphasis"><em>store</em></span> (as per the quick start guide) then the path for the home directory would be: /mnt/store/john.<a id="id160" class="indexterm"/>
</p><p>Click<span class="strong"><strong> Save</strong></span> and apply the changes. Now when John logs in using the user name <span class="emphasis"><em>john</em></span> he will be taken directly to the <span class="emphasis"><em>john</em></span> directory. He doesn't have access to other files or folders on the store disk, only those in <span class="emphasis"><em>john</em></span> and any sub folder.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip51"/>Note</h3><p><span class="strong"><strong>chroot() Everyone, but Root</strong></span></p><p>In the advanced settings section of the Services: FTP page, there is a field called<span class="strong"><strong> chroot() everyone, but root</strong></span>. What this means is that when a user logs in via FTP, the root directory (top or start directory) for them will be the directory set in the<span class="strong"><strong> Home directory</strong></span> field. Without this set, the user will log in to the server at the physical / and will see the server in its entirety including the FreeNAS and FreeBSD system files. It is much safer to have this box checked. The exception to this is the user root (which in FreeBSD terms is the system administer account). If<span class="strong"><strong> Permit root login</strong></span> is enabled, then the user root can log in and they will be taken to the root of the actual server. This can be useful if you ever need to alter any of the system files on the FreeNAS, but this isn't recommend unless you absolutely know what you are doing!</p></div></div><div class="section" title="Authenticating AFP Users"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec03"/>Authenticating AFP Users</h2></div></div></div><p>Like CIFS and FTP, the Apple Filing Protocol (AFP) can also use the local user authentication features of FreeNAS.<a id="id161" class="indexterm"/>
</p><p>In the<span class="strong"><strong> Services: AFP</strong></span> page, there are two options for controlling access to the server via AFP:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
<span class="strong"><strong>Enable guest access</strong></span>, meaning that anyone can connect without giving a username or password. The users have full read and write access.</p></li><li class="listitem"><p>
<span class="strong"><strong>Enable local user authentication</strong></span>, meaning that only users defined on the FreeNAS server (on the<span class="strong"><strong> Access: Users</strong></span> page) can access the server. The user name and password set in the FreeNAS server need to be given to authenticate.</p></li></ul></div><p>Like FTP, the two can be used together, however, they do negate one another in terms of security. It is best to run the AFP service with either guest logins enabled and local user logins disabled or vice versa. If you run with both enabled then people can still log in using the guest account even if they don't have a user account and so it reduces the benefits of having the user accounts enabled.<a id="id162" class="indexterm"/>
</p><p>With just local user authentication enabled, initial connections from an Apple Macintosh will fail. In the top right-hand corner of the Finder window, there is a button labeled<span class="strong"><strong> Connect As..</strong></span>. Use that to enter a user name and password.</p><div class="mediaobject"><img src="graphics/4688_05_05.jpg" alt="Authenticating AFP Users"/></div></div><div class="section" title="Connect to the FreeNAS Server via SSH"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec04"/>Connect to the FreeNAS Server via SSH</h2></div></div></div><p>One of the services that hasn't been mentioned much in this book so far is Secure Shell access or SSH for short. It is really for advanced users and it will be used to connect to the server in Chapter 10, when we look at FreeBSD and command line tools available.<a id="id163" class="indexterm"/>
</p><p>However, SSH depends heavily on the local users defined on the server and as such it is worth looking at now.</p><p>SSH is a network protocol that allows data to be exchanged over an encrypted (secure) channel between two computers. It is commonly used as a secure command line interface to a remote computer. This means that you can access the command line interface of the FreeNAS server from a remote computer without having to access the keyboard the and monitor of the FreeNAS server. On the FreeNAS server, it is also used in conjunction with the Unison suite of programs. Unison uses SSH to log in to the server and start the synchronization process.<a id="id164" class="indexterm"/>
</p><p>On the<span class="strong"><strong> Access: Users: Add</strong></span> page, there is a field called<span class="strong"><strong> Full Shell</strong></span>, which when enabled, gives that user access to the FreeNAS server via SSH.</p><p>To test SSH connectivity:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>1. Create a user and make sure that<span class="strong"><strong> Full Shell</strong></span> is enabled.</p></li><li class="listitem"><p>2. Go to the<span class="strong"><strong> Services: SSHD</strong></span> and enable the service.</p></li><li class="listitem"><p>3. Make sure that Password authentication is ticked.</p></li><li class="listitem"><p>4. Click<span class="strong"><strong> Save and Restart</strong></span>.</p></li><li class="listitem"><p>5. Connect to the FreeNAS server using a SSH client (see below).</p></li></ol></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note19"/>Note</h3><p><span class="strong"><strong>Password Authentication</strong></span></p><p>It is possible to connect to the FreeNAS server without giving a user name and password but by relying on an exchange of encryption keys that verify that you are who you claim to be. With Password Authentication enabled, you are able to log in just using a username and password.</p></div><p>You can connect to the FreeNAS server via the command line program ssh using Linux and Mac OS X. For Windows, you will need a SSH client, the best one is called Putty ( <a class="ulink" href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">http://www.chiark.greenend.org.uk/~sgtatham/putty/</a>). We will look in more detail at Putty in Chapter 10.</p><p>From a Linux or OS X command line type:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>ssh -l john 192.168.1.250
</strong></span>
</pre></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note20"/>Note</h3><p>Don't forget to change the address to that of your FreeNAS if you aren't using the default.</p></div><p>The<code class="literal"> -l</code> tells the SSH program which user you want to use as the login name, in this case, I have chosen<code class="literal"> john</code>.</p><p>The first time you log in, you may be asked if you trust the remote machine as you are about to enter into encrypted communications with it. It should read some thing like this:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>The authenticity of host '192.168.1.250 (192.168.1.250)' can't be established.
DSA key fingerprint is b2:d0:99:cb:6e:b2:53:95:4d:f6:b3:02:1d:bc:36:db.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.1.250' (DSA) to the list of known hosts
</strong></span>
</pre></div><p>Answer yes and then type in the password for the user. You are now connected to the FreeNAS server via SSH. From here, you can access the command line tools of the FreeNAS server. See chapter 10 for more details.</p></div><div class="section" title="Services that Don't Use Local User Accounts"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec05"/>Services that Don't Use Local User Accounts</h2></div></div></div><p>Not all services provided by FreeNAS use local accounts for authentication, most notably NFS. This requires a note of caution. If you have NFS enabled, and are using local user authentication for CIFS, FTP, and AFP be aware that users can still connect to the FreeNAS server using NFS without any username and password. This is an easy way for people to circumvent the local user authentication process.</p></div></div>
<div class="section" title="Using FreeNAS with the Microsoft Active Directory"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec03"/>Using FreeNAS with the Microsoft Active Directory</h1></div></div></div><p>Until now, we have defined all the user information locally on the FreeNAS server. This is fine for small networks but if you have a large business network, you may already have Microsoft's Active Directory deployed. FreeNAS can use the user database of a Microsoft Active Directory (Windows 2000/2003) to authenticate user names and passwords and therefore, remove the need to define users locally.<a id="id165" class="indexterm"/>
</p><p>When Active Directory is being used, the FreeNAS server will authenticate users using the directory for the following services: CIFS, FTP, SSH, and Unison.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip54"/>Note</h3><p><span class="strong"><strong>Pre-Windows 2000</strong></span></p><p>FreeNAS is considered as a pre-Windows 2000 client and as such the Active Directory must be configured with pre-Windows 2000 compatibility.</p></div><p>Assuming the Active Directory is installed and running:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>1. Go to<span class="strong"><strong> Access: Active Directory</strong></span>.</p></li><li class="listitem"><p>2. Tick the Enable check box in the title bar of the table.</p></li><li class="listitem"><p>3. Enter the Active Directory server name in the<span class="strong"><strong> AD server name</strong></span> field. For example the Windows Server 2003 server on my test network is called WS2003, so I entered WS2003.</p></li><li class="listitem"><p>4. Enter the IP address of the Active Directory server in the<span class="strong"><strong> AD server IP</strong></span> field.</p></li><li class="listitem"><p>5. Enter the domain name for Active Directory. This is in pre-Windows 2000 format.</p></li><li class="listitem"><p>6. Enter the domain administrator account user name (probably Administrator) and the password.</p></li><li class="listitem"><p>7. Finally, click<span class="strong"><strong> Save</strong></span>.</p></li></ol></div><p>To check if the FreeNAS is able to communicate with the Active Directory correctly:<a id="id166" class="indexterm"/>
</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>1. Go to<span class="strong"><strong> Diagnostics: Information</strong></span>
</p></li><li class="listitem"><p>2. Click the<span class="strong"><strong> MS Domain</strong></span> tab.</p></li></ol></div><p>This will test the connecting to the Active Directory.</p><p>A successful test will look like this:</p><p>
<code class="literal">Accessibility test to MS domain:</code>
</p><p>
<code class="literal">Results for net rpc testjoin:</code>
</p><p>
<code class="literal">Join to 'FREENAS' is OK</code>
</p><p>
<code class="literal">Ping winbindd to see if it is alive:</code>
</p><p>
<code class="literal">Ping to winbindd succeeded on fd 4</code>
</p><p>
<code class="literal">Check shared secret:</code>
</p><p>
<code class="literal">Checking the trust secret via RPC calls succeeded</code>
</p><p>After the Active Directory is configured, CIFS, FTP, SSH, and Unison authentication will rely <span class="strong"><strong>only</strong></span> on account information in the Active Directory.</p><p>The authentication method for CIFS/SMB is automatically changed to <span class="emphasis"><em>Domain</em></span> when the Active Directory is configured for use.</p><p>To check this, go to<span class="strong"><strong> Services: CIFS/SMB</strong></span> and notice that<span class="strong"><strong> Authentication</strong></span> is now set to<span class="strong"><strong> Domain</strong></span>.</p><p>To test the use of Active Directory, try connecting to the FreeNAS server via CIFS, FTP or SSH and use account information from the Active Directory.</p></div>
<div class="section" title="System Admin"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec04"/>System Admin</h1></div></div></div><p>Some of the common administration tasks for the system admin:<a id="id167" class="indexterm"/>
</p><div class="section" title="How to Change the Web GUI User Name and Password"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec06"/>How to Change the Web GUI User Name and Password</h2></div></div></div><p>When you first install or boot-up the FreeNAS server it has a default username and password for accessing the web GUI. These are <span class="emphasis"><em>admin</em></span> and <span class="emphasis"><em>freenas</em></span> respectively. If your FreeNAS is in an environment where others could potentially access the FreeNAS server and change settings, either maliciously or by accident/curiosity, it is advisable that you change the password and possibly even the username for access to the web GUI.<a id="id168" class="indexterm"/>
</p><p>To change the password, go to<span class="strong"><strong> System: General</strong></span> and click on the<span class="strong"><strong> Password</strong></span> tab. Enter the current web GUI password (which is probably <span class="emphasis"><em>freenas</em></span>) and then enter the new desired password twice, the second time for confirmation to make sure you entered the right characters. Now click on<span class="strong"><strong> Save</strong></span>.</p><p>Once saved, you will automatically asked to log in again. So enter the username (probably <span class="emphasis"><em>admin</em></span>) and then the new password you entered.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip56"/>Note</h3><p>Choosing a Good Password</p></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip57"/>Note</h3><p>You need to choose a strong password, which means one that is difficult to guess.</p><p>It is best to choose a password that you will remember, that way you don't have to write it down or leave it in the open.</p><p>But avoid using a complete word from a dictionary or a name.</p><p>The more characters your password contains, the harder it is for someone to guess it. Often a longer but simple password can be safer than a short, complex one; it also has the benefit that it is easier to remember.</p><p>Use a combination of capital and lowercase letters, numbers, and standard symbols (! @ # $ % ^ &amp; *). The FreeNAS web GUI password is case-sensitive, which means that a capital letter Z is different from a lowercase z.</p><p>Don't use your birthday, your child or pet's name, your phone number etc. Personal information can be easy for someone to figure out.</p><p>Avoid the obvious password like "123456", "test" or "password."</p></div><p>It is also possible to change the default username from <span class="emphasis"><em>admin</em></span> to another name of your choosing. To change it, go to<span class="strong"><strong> System: General</strong></span> and enter a new username in<span class="strong"><strong> username</strong></span> field. Click Save to apply the changes. You will be asked to log in again, this time you will need to enter the new username.</p></div><div class="section" title="Rebooting and Shutting Down"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec07"/>Rebooting and Shutting Down</h2></div></div></div><p>It is possible to shutdown and reboot the FreeNAS server from the web interface. In the web interface, rebooting and shutting down work in very similar fashions. To reboot, you need to go to<span class="strong"><strong> System: Reboot</strong></span> and to shutdown go to<span class="strong"><strong> System: Shutdown</strong></span>.<a id="id169" class="indexterm"/>
</p><p>There are two types of reboot/shutdown, immediate (now) or scheduled. To reboot or shutdown immediately, go to the respective page and click on<span class="strong"><strong> Yes</strong></span> in answer to the question<span class="strong"><strong> Are you sure?</strong></span> Once you have clicked on<span class="strong"><strong> Yes</strong></span>, the system will start to shutdown/reboot.</p><p>For scheduled reboots or shutdowns, click on the<span class="strong"><strong> Scheduled</strong></span> tab.</p><div class="mediaobject"><img src="graphics/4688_05_01.jpg" alt="Rebooting and Shutting Down"/></div><p>Reboots and shutdowns are scheduled by selecting which minute, hour, day, and month you want the reboot or shutdown or occur. This is a re-occurring event and as such you can also choose a day of the week rather than day of the month for the reboot.</p><p>To enable the scheduled reboot or shutdown, tick the enable tick box and then select the time you want for the reboot or shutdown. For example, to reboot the server every Sunday at 4:35PM you would select:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>35 from the minutes section</p></li><li class="listitem"><p>16 from the hours (remember it is a 24 hour clock)</p></li><li class="listitem"><p>Sunday from the week days</p></li><li class="listitem"><p>Days and months would remain empty</p></li></ul></div></div><div class="section" title="How to Set the Hostname of the Server"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec08"/>How to Set the Hostname of the Server</h2></div></div></div><p>Your FreeNAS server has a name, known as the hostname. This name uniquely identifies the server. If you have more than one FreeNAS server on your network, you need to change the hostnames so that each one is unique.<a id="id170" class="indexterm"/>
</p><p>To change the hostname, go to<span class="strong"><strong> System: General</strong></span> and enter a new hostname in the<span class="strong"><strong> Hostname</strong></span> field. If you are deploying your FreeNAS in a network environment, which also uses Internet domains names for identification, then you can also enter a domain name (e.g. yourcompany.com) in the<span class="strong"><strong> Domain</strong></span> field.</p></div><div class="section" title="Configuring the Web Interface to use HTTPS"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec09"/>Configuring the Web Interface to use HTTPS</h2></div></div></div><p>HTTPS (Hypertext Transfer Protocol over Secure Socket Layer) is a way for your web browser to connect to the FreeNAS server over a secure encrypted connection. If your FreeNAS server is in an environment where people can "snoop" on the network to discover the passwords being used, it is best to use HTTPS. This is also true if you have configured your network in such a way that your FreeNAS can be administered from the Internet (probably through a firewall). This can be useful when the FreeNAS server is in a different location than the person responsible for administering it.<a id="id171" class="indexterm"/>
</p><p>To enable HTTPS, go to<span class="strong"><strong> System: General</strong></span> and check the HTTPS checkbox in the<span class="strong"><strong> WebGUI protocol</strong></span> field. After you have clicked<span class="strong"><strong> Save</strong></span>, you will need to reboot the server for the changes to be applied.</p><p>Once rebooted, you now connect to the web GUI with:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>https://192.168.1.250
</strong></span>
</pre></div><p>Notice that the URL starts with<code class="literal"> https</code> and not<code class="literal"> http</code> as before. Once you connect to the server, your browser will almost certainly tell you that the certificate for this secure connection is signed by an unknown authority. It will question if you can trust server or not. Don't be alarmed, this isn't a problem. Accept the certificate and proceed. Depending on your browser, you may be able to accept this certificate permanently so as to not receive the warning in future. You can now log in as usual.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note21"/>Note</h3><p>When a web browser makes a connection to a secure site using HTTPS, the web server presents the browser with a certificate identifying itself. This certificate contains unique, authenticated information about the certificate owner. To be sure that this information is correct, a 3<sup>rd</sup> party needs to vouch for the certificate and say it is trustworthy. This 3<sup>rd</sup> party is called a Certificate Authority (CA) and they verify the identity of the certificate owner. They establish a level of trust. If <span class="emphasis"><em>they</em></span> say this certificate is valid then I <span class="emphasis"><em>trust</em></span> them.</p><p>Web browsers are preprogrammed with an accepted list of Certificate Authorities and when they see a CA that isn't on that list, the web browser will question if this is a trustworthy certificate.</p><p>FreeNAS uses a self-signed certificate, which means it vouches for itself. This would be a problem for a major website that accepts online payments but for FreeNAS it is acceptable as it isn't the trust of the server that is required but rather the ability to talk securely. Once you accept the certificate, the secure communications will begin with the FreeNAS server based on some of the information in the certificate.</p></div></div><div class="section" title="Changing the Web Interface Port"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec10"/>Changing the Web Interface Port</h2></div></div></div><p>Sometimes, it can be useful to change the web server port from the default value of 80 (443 for HTTPS) to something else. For example if you want to administer your FreeNAS server from the Internet and you need to configure your firewall with a forwarding rule, then it can be helpful to put the web server on a different port.<a id="id172" class="indexterm"/>
</p><p>To change the port number, go to<span class="strong"><strong> System: General</strong></span> and enter the new port number in<span class="strong"><strong> WebGUI port</strong></span> field. When you change the port number, you need to reboot the server for the settings to take effect. Once rebooted, you need to use a new URL:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>http ://192.168.1.250:8080</strong></span>
</pre></div><p>Where 8080 is the new port number you choose and of course 192.168.1.250 is the IP address of your FreeNAS server, you will need to change this accordingly.</p></div><div class="section" title="How to Set a DNS Server"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec11"/>How to Set a DNS Server</h2></div></div></div><p>Several of the services on the FreeNAS server like the Network Time Protocol service and the sending of email status reports require the FreeNAS to use DNS. DNS is an Internet service that translates domain names into IP addresses. Each time you use a domain name (in your web browser for example), DNS is used to translate the name into the corresponding IP address. To find different servers on the Internet, like an email server, FreeNAS also needs to use DNS.<a id="id173" class="indexterm"/>
</p><p>Your can ascertain the DNS servers you need to use from one of several sources:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>If you are using the FreeNAS on your company network, you may well have DNS servers on your LAN. You need to speak to your network administrator to get the correct information.</p></li><li class="listitem"><p>If you are using the FreeNAS server at home, then your DNS could be the address of your ADSL/DSL modem.</p></li><li class="listitem"><p>Alternatively, for the home user, the DNS servers could be those of your ISP. You need to contact your ISP (or search their website) to find out what DNS servers you should use.</p></li></ul></div><p>If you can't find which DNS servers to use, then copy the settings from an existing machine on your network. For example, to find out what your DNS settings are in Windows XP, Windows Server 2003, and Vista, click on<span class="strong"><strong> Start</strong></span> then<span class="strong"><strong> Run..</strong></span>. and type<span class="strong"><strong> cmd</strong></span> and press <span class="emphasis"><em>ENTER</em></span>. A command prompt will appear. Now type:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>C:\&gt;ipconfig /all
</strong></span>
</pre></div><p>The result will list various bits of information about your network connection. In the<span class="strong"><strong> Ethernet adapter Local Area Connection:</strong></span> section, there will be information about the DNS servers.</p><div class="mediaobject"><img src="graphics/4688_05_02.jpg" alt="How to Set a DNS Server"/></div></div><div class="section" title="How to Set the Language for the Web Interface"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec12"/>How to Set the Language for the Web Interface</h2></div></div></div><p>Along with English, the FreeNAS web interface comes in several different languages including: Bulgarian, Chinese, Dutch, French, German, Greek, Hungarian, Italian. Japanese, Norwegian, Polish, Portuguese, Romanian, Russian, Slovenian, Spanish, and Swedish.<a id="id174" class="indexterm"/>
</p><p>To change the language of the web interface, go to<span class="strong"><strong> System: General Setup</strong></span> and select the desired language from the<span class="strong"><strong> Language</strong></span> drop down box. Once you click<span class="strong"><strong> Save</strong></span>, the language should change straight away, however, sometimes because of browser caching you might need to click to another section of the web interface before you see the language change.<a id="id175" class="indexterm"/>
</p></div><div class="section" title="Date and Time Configuration"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec13"/>Date and Time Configuration</h2></div></div></div><p>All PCs have a clock and can keep a track of the date and time. Keeping the date and time correct is important for several reasons including:<a id="id176" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Files will be marked with the correct creation and modification time stamps.</p></li><li class="listitem"><p>The scheduled reboots and shutdowns will occur at the right time.</p></li><li class="listitem"><p>The FreeNAS server can act as a time server to Windows machines.</p></li><li class="listitem"><p>Scheduled status reports sent by email will be sent at the right time and will have the correct time and date on them.</p></li><li class="listitem"><p>Log files will have the right time stamps, which aids any diagnostics.</p></li></ul></div><p>The date and time can be set in one of three ways:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Set it in the computers BIOS</p></li><li class="listitem"><p>Set it via the web GUI</p></li><li class="listitem"><p>Configure automatic time adjustment via NTP</p></li></ul></div><p>The time and date configurations are made on the<span class="strong"><strong> System: General</strong></span> page.</p><p>The first thing to set is your time zone, this is done by selecting it from the<span class="strong"><strong> time zone</strong></span> drop down box. You need to select the nearest location to you (normally, the capital city of the country you are in or a state capital), for example<span class="strong"><strong> America/New York</strong></span>. You can also select the time zone in a more manual fashion, for example<span class="strong"><strong> Etc/GMT-1</strong></span>. Use the<span class="strong"><strong> Save</strong></span> button to apply the changes.</p><p>If you need to set the date and time, you can choose to set the date and time by entering them into the<span class="strong"><strong> System time</strong></span> field. The format is mm/dd/yyyy hh:mm. You can also use the icon to select the date and time from a simple calendar widget. It is worth noting that the seconds cannot be set using this method. Use the<span class="strong"><strong> Save</strong></span> button to apply the changes.</p><p>You can choose to configure the date and time automatically using the Network Time Protocol (NTP). NTP is a way of synchronizing computer clocks over the Internet. The time server normally has a very accurate atomic clock attached to it, and other computers ask it the time and set their clocks accordingly. The protocol has special algorithms to allow for the delays in sending and receiving requests over the Internet. With this, protocol clocks can be accurate within a fraction of a second.</p><p>To enable NTP, tick the<span class="strong"><strong> Enable NTP</strong></span> field. Next, you need to enter which time server you want to use,<code class="literal"> pool.ntp.org</code> is the default and should be just fine for your usage. If your FreeNAS doesn't have access to the Internet, then you will need to find an NTP server on your local network. Although using one NTP server is sufficient, the recommendation from the NTP people is to specify 3 servers:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
<code class="literal">0.pool.ntp.org</code>
</p></li><li class="listitem"><p>
<code class="literal">1.pool.ntp.org</code>
</p></li><li class="listitem"><p>
<code class="literal">2.pool.ntp.org</code>
</p></li></ul></div><p>Use a space to separate the hosts.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note22"/>Note</h3><p>The<code class="literal"> pool.ntp.org</code> project is a big virtual cluster of timeservers striving to provide reliably easy to use NTP service for millions of clients without putting a strain on the big popular timeservers.</p><p>To spread the load and handle the occasional down server, the NTP project have created random sets of servers using the 0, 1, and 2.pool.ntp.org names. The servers in each set randomly change every hour.</p></div><p>The last thing to set is the interval, in minutes, between network time syncs. The default is 300, which is every 5 hours. This should be sufficient for most needs.<a id="id177" class="indexterm"/>
</p><p>For the NTP protocol to work correctly, you need to make sure you have defined at least one DNS server for name resolution. See the <span class="emphasis"><em>How to set a DNS server</em></span> section for more details.</p></div><div class="section" title="How to Disable Console Menu"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec14"/>How to Disable Console Menu</h2></div></div></div><p>Beyond initial network settings, the FreeNAS server uses the web interface for the majority of its configuration. However, the console menu remains active even when you don't need it anymore. This can be a security risk as anyone with access to the keyboard and monitor attached to the server can change settings either deliberately or by accident.<a id="id178" class="indexterm"/>
</p><p>To disable the console menu, go to<span class="strong"><strong> System: Advanced</strong></span> and check the<span class="strong"><strong> Disable console menu</strong></span> checkbox. Once you click<span class="strong"><strong> Save</strong></span>, you will need to reboot for the console to be disabled.</p></div><div class="section" title="How to Stop the Startup and Shutdown Beeps"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec15"/>How to Stop the Startup and Shutdown Beeps</h2></div></div></div><p>When FreeNAS starts up and shuts down, it plays a few melodious beeps to indicate that it has started. If you want to disable them, then go to the<span class="strong"><strong> System: Advanced Setup</strong></span> page and tick<span class="strong"><strong> the System Beep</strong></span> box, this will disable the speaker beep on startup and shutdown.<a id="id179" class="indexterm"/>
</p></div><div class="section" title="Adding Predefined Network Hosts"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec16"/>Adding Predefined Network Hosts</h2></div></div></div><p>In the rare case that you don't have access to a DNS server but yet you still want to use the NTP protocol or email status reports, you will need to define the NTP server or the email (SMTP) server manually. You can do that on the System: Hosts page.<a id="id180" class="indexterm"/>
</p><p>To add, say an NTP server, with the address 86.125.34.112, click the add circle and then enter the host name of the server and its IP address. You can also add a description.</p><div class="mediaobject"><img src="graphics/4688_05_06.jpg" alt="Adding Predefined Network Hosts"/></div></div><div class="section" title="Reset the Server to the Factory Defaults"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec17"/>Reset the Server to the Factory Defaults</h2></div></div></div><p>If you want to reset the FreeNAS server back to its original installation state (or Live CD boot state), which is often known as the factory settings (metaphorically: the settings it had when it left the factory) then you can do this on the<span class="strong"><strong> System: Factory</strong></span> defaults.<a id="id181" class="indexterm"/>
</p><p>If you click<span class="strong"><strong> Yes,</strong></span>, the FreeNAS server will be reset to factory defaults and will reboot immediately. The entire system configuration will be overwritten. The LAN IP address will be reset to 192.168.1.250 and the password will be set to 'freenas'.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip58"/>Note</h3><p>It is worth noting that when you reset the server to the factory defaults, the data on the disks won't be touched. This means that you can reset the server and then reconfigure it to find your data. But be VERY CAREFUL, if during the re-configuration phase you reformat a disk or apply a different configuration than before, you are likely to lose data.</p></div></div><div class="section" title="Simple Network Administration"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec18"/>Simple Network Administration</h2></div></div></div><p>On the<span class="strong"><strong> Interfaces: LAN</strong></span> page, you can perform some limited network administration tasks such as defining a new IP address for the FreeNAS server and defining a default gateway for the server.<a id="id182" class="indexterm"/>
</p><p>The default gateway is the IP address of another device on the network that will accept network traffic for forwarding on to another network. The most common default type of default gateway in the home situation is the ADSL/DSL modem/router that is provided by your Internet Service Provider (ISP). The modem's job is to route traffic from your home network on to the Internet and the reverse.</p><p>In a business environment, the setup may be same or if you have a comprehensive network infrastructure, the default gateway will be a network device that connects your segment of the network to the rest of the corporate network.</p><p>You will almost certainly need to set your default gateway to give the FreeNAS server access to the Internet ,which you will especially need if you are using an Internet NTP service.</p><p>You need to ask your network administer or ISP for the details of the default gateway. Another way to ascertain the default gateway settings is to see what they are on another machine on your network.</p><p>For example, to find out what your default gateway is in Windows XP, Windows Server 2003, and Vista, click on<span class="strong"><strong> Start</strong></span> then<span class="strong"><strong> Run..</strong></span>. and type<span class="strong"><strong> cmd</strong></span> and press ENTER. A command prompt will appear. Now type:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>C:\&gt;ipconfig /all
</strong></span>
</pre></div><p>The result will list various bits of information about your network connection. In the<span class="strong"><strong> Ethernet adapter Local Area Connection:</strong></span> section, there will be information about the Default Gateway.</p><div class="mediaobject"><img src="graphics/4688_05_07.jpg" alt="Simple Network Administration"/></div></div><div class="section" title="Disabling Bonjour/ZeroConf"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec19"/>Disabling Bonjour/ZeroConf</h2></div></div></div><p>By default, FreeNAS will announce which services it provides (CIFS, AFP etc) with the Zeroconf protocol. This will permit other computers on the LAN to detect that there is a server that provides network services. Zeroconf/Bonjour is used by Apple OS X operating system and recent Linux distributions.<a id="id183" class="indexterm"/>
</p><p>If you wish to disable this feature, then remove the tick from the<span class="strong"><strong> Zeroconf</strong></span> field on the<span class="strong"><strong> System: Advanced Setup</strong></span> page.</p></div><div class="section" title="Getting Status Information About the Server"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec20"/>Getting Status Information About the Server</h2></div></div></div><p>FreeNAS comes with some excellent tools to monitor the status of your server. These are all grouped together under the heading<span class="strong"><strong> Status</strong></span> in the left-hand menu column.<a id="id184" class="indexterm"/>
</p><p>The different status categories are:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
<span class="strong"><strong>System:</strong></span> This is the summary page that is displayed when you first connect to the web interface. It will tell you, among other things, which version of FreeNAS you are running, how long the server has been up and running, the amount of the memory being used, and the disk space usage.<a id="id185" class="indexterm"/>
</p></li><li class="listitem"><p>
<span class="strong"><strong>Process:</strong></span> This will show you some summary information about the processes running on your FreeNAS server and a list of the top processes.</p></li><li class="listitem"><p>
<span class="strong"><strong>Interfaces:</strong></span> This displays a summary of the network interfaces in the server and some simple statics about their traffic loads.</p></li><li class="listitem"><p>
<span class="strong"><strong>Disks:</strong></span> Here you can see a list of disks currently configured on your system including each disks size, description, and status.</p></li><li class="listitem"><p>
<span class="strong"><strong>Wireless:</strong></span> This displays a summary of the wireless network interfaces in the server and some simple statics about their traffic loads.<a id="id186" class="indexterm"/>
</p></li><li class="listitem"><p>
<span class="strong"><strong>Graph:</strong></span> This page is divided into 2 sections, Traffic graph and CPU load. The first is a real time graph showing the amount of traffic on the network card and the second the amount of CPU usage. Both work in a 2 minute window.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note23"/>Note</h3><p>FreeBSD is able to run many programs at the same time and FreeNAS uses this multitasking ability of FreeBSD to run the web server, the CIFS server, the FTP etc simultaneously.</p><p>Each of these programs or services runs as a separate <span class="strong"><strong>process</strong></span>. Each process uses time on a system's CPU, as well as other system resources such as memory and disk space.</p><p>The various status pages help you keep a eye on those process and the resources being used by the FreeNAS server.</p></div><div class="mediaobject"><img src="graphics/4688_05_08.jpg" alt="Getting Status Information About the Server"/></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note24"/>Note</h3><p>The output from the processes status page can seem a bit strange if you are not used to UNIX-type systems, here is a quick guide:</p><p>
<span class="strong"><strong>PID:</strong></span> Each process has a unique process ID called the PID.</p><p>
<span class="strong"><strong>SIZE:</strong></span> SIZE is the total amount of memory used, in kilobytes, by the process.</p><p>
<span class="strong"><strong>RES:</strong></span> Is the actual amount of physical memory being used by the process. This can different from SIZE as FreeBSD shares regions of memory (called pages) between processes that have the same values and have not been changed.</p><p>
<span class="strong"><strong>STATE:</strong></span> This is the current state of the process (one of sleep, wait, run, idl, zomb or stop).</p><p>
<span class="strong"><strong>TIME:</strong></span> This is the number of system and user CPU seconds that the process has used.</p><p>
<span class="strong"><strong>WCPU:</strong></span> This is percentage of the CPU being used at that moment.</p><p>
<span class="strong"><strong>COMMAND:</strong></span> Is the command line which started the process.</p></div></div><div class="section" title="Sending Status Report by Email"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec21"/>Sending Status Report by Email</h2></div></div></div><p>FreeNAS has the ability to send status reports by email at pre-programmed times. To configure these reports, go to<span class="strong"><strong> Status: Email Report</strong></span>. FreeNAS doesn't include an email server (SMTP server), so you need to tell it which server to use. If you are a home user then this will be the SMTP server provided by your ISP. For business environments, you will need to ask your network administrator where is the address of the SMTP server on your network. If you are addressing the SMTP server by its domain name (e.g. mail.myisp.com) then you need to be sure that DNS is configured so FreeNAS can look up the IP address of the mail server. You could also predefine the server in System: Hosts.<a id="id187" class="indexterm"/>
</p><p>If your SMTP server requites authentication (which is almost certainly found to be true if you are using the SMTP server provided by your ISP) then tick the<span class="strong"><strong> Authentication</strong></span> box and enter the appropriate user name and password.</p><p>Next, you need to set who the email is from and where you want it to go. The<span class="strong"><strong> To email</strong></span> needs to be the address where you want to receive the email and the<span class="strong"><strong> From email</strong></span> the sender of the email. For the<span class="strong"><strong> From email</strong></span>, you need to enter a valid address as any notifications of failure to deliver the email will be sent there. Also, you want the<span class="strong"><strong> From email</strong></span> address to be valid so as not to antagonize any spam filtering that your email system may have.</p><p>You can fill in the desired subject line of the email and also fine tune what is included in the email report.</p><p>Finally, you need to define the time when these status messages will be sent. The table is exactly the same as the one used for scheduled reboots/shutdowns. Messages scheduled by selecting which minute, hour, day, and month you want the messages to be sent. This is a re-occurring event and as such you can also choose a day of the week rather than day of the month for the messages. For example, to send a status message on the 1st of every month at 9:00AM you would select:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>0 from the minutes section.</p></li><li class="listitem"><p>9 from the hours.</p></li><li class="listitem"><p>1 from the days.</p></li><li class="listitem"><p>Select <span class="emphasis"><em>All</em></span> for the months.</p></li><li class="listitem"><p>The week days would remain unused.</p></li></ul></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec05"/>Summary</h1></div></div></div><p>In this chapter, we have looked at the different administration tasks for setting up your FreeNAS server including user management and its effects on the access protocols like CIFS and FTP. We have also looked at some of the system administration options as well as simple administration tasks like shutting down and rebooting.</p><p>In the next chapter, we shall take a more in depth look at configuring disks on the FreeNAS server including setting up software RAID.</p></div></body></html>