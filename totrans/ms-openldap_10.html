<html><head></head><body><div class="appendix" title="Appendix&#xA0;B.&#xA0;LDAP URLs"><div class="titlepage"><div><div><h1 class="title"><a id="appB"/>Appendix B. LDAP URLs</h1></div></div></div><p>To query a directory a client must send the server several different pieces of information. To make it possible to group all of this information together into one standards-based string format, LDAP developers proposed a standard LDAP URL syntax, which follows the URL standard (RFC 3986). In this appendix we will take a look at the format of LDAP URLs.<a class="indexterm" id="id883"/>
<a class="indexterm" id="id884"/>
</p><div class="section" title="The LDAP URL"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec54"/>The LDAP URL</h1></div></div></div><p>The LDAP URL is composed of eight different parts:<a class="indexterm" id="id885"/>
</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The <span class="strong"><strong>protocol</strong></span>, which is usually LDAP (<code class="literal">ldap://</code>), though the non-standard LDAPS protocol (<code class="literal">ldaps://</code>) is used.<a class="indexterm" id="id886"/></li><li class="listitem"><a class="indexterm" id="id887"/>The <span class="strong"><strong>domain name</strong></span> (or IP address) of the server. The default is <code class="literal">localhost</code>.</li><li class="listitem"><a class="indexterm" id="id888"/>The <span class="strong"><strong>port number</strong></span> of the server. The default is the standard LDAP port, <code class="literal">389</code>.</li><li class="listitem"><a class="indexterm" id="id889"/>The <span class="strong"><strong>base DN</strong></span> for the search.</li><li class="listitem"><a class="indexterm" id="id890"/>The list of <span class="strong"><strong>attributes</strong></span> to be returned. The default is to return all the attributes.</li><li class="listitem"><a class="indexterm" id="id891"/>The <span class="strong"><strong>scope</strong></span> specifier. The default is to use the <code class="literal">base</code> scope.</li><li class="listitem"><a class="indexterm" id="id892"/>The <span class="strong"><strong>search filter</strong></span>. The default is <code class="literal">(objectclass=*)</code>.</li><li class="listitem"><a class="indexterm" id="id893"/>The <span class="strong"><strong>extension</strong></span> field. If the server supports extensions, parameters for those extensions can be passed in the last field.</li></ol></div><p>Combining seven of the eight parts (we will skip the extension field) we can create a URL that looks something like this:</p><div class="informalexample"><pre class="programlisting">ldap://example.com:389/ou=Users,dc=example,dc=com?mail?sub?(uid=matt)</pre></div><p>This URL is composed of the seven parts in this way:</p><div class="informalexample"><pre class="programlisting">&lt;protocol&gt;://&lt;domain&gt;:&lt;port&gt;/&lt;basedn&gt;?&lt;attrs&gt;?&lt;scope&gt;?&lt;filter&gt;</pre></div><p>Where we have to use an extension we would simply append a question mark <code class="literal">(?</code>) and the extension information to the end of the given URL.</p><p>Using this URL to perform an LDAP search, the result would be as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The client would connect to Example.Com on port 389 using the LDAP protocol.</li><li class="listitem" style="list-style-type: disc">The based DN would be set to <code class="literal">ou=Users,dc=example,dc=com</code>.</li><li class="listitem" style="list-style-type: disc">The client would request the <span class="strong"><strong>mail</strong></span> attributes for all the entries in the subtree of <code class="literal">ou=Users,dc=example,dc=com</code> where the UID was <code class="literal">matt</code>.</li></ul></div><p>To use LDAPS (the non-standard practice of using LDAP over a dedicated SSL/TLS port), use <code class="literal">ldaps://</code> instead of <code class="literal">ldap://</code>.</p><p>In many cases it is convenient to shorten the URL and accept the default options. For example, the default domain is <code class="literal">localhost</code> (or the IP address <code class="literal">127.0.0.1</code>), the address of the server on which the URL is executed. And the default port is 389 (unless the protocol is <code class="literal">ldaps://</code> instead of <code class="literal">ldap://</code>, in which case the default port is the LDAP port 636).</p><p>The port can be left off in most cases. But the domain portion of the URL can be omitted too:</p><div class="informalexample"><pre class="programlisting">ldap:///ou=Users,dc=example,dc=com?mail?sub?(uid=matt)</pre></div><p>Note that there are now three slashes at the beginning, <code class="literal">ldap:///</code>. The domain name, which normally appears between the second and third slash, is not specified. If this URL were used, the LDAP application would connect to the localhost (the default host) at port 389 (the default LDAP port), and then proceed to run the search.</p><p>Now let's say that instead of wanting the LDAP server to return just the <code class="literal">mail</code> attribute, we want it to return all of the standard (non-operational) attributes. To do this, we simply leave the attribute specification empty:</p><div class="informalexample"><pre class="programlisting">ldap:///ou=Users,dc=example,dc=com??sub?(uid=matt)</pre></div><p>Now, the attribute position has no value, though the two adjacent question marks (<code class="literal">??</code>) indicate where the empty attribute position is.</p><p>In the previous two examples, when we have omitted specific field values, we have had to leave the designators in the URL, so we have <code class="literal">ldap:///</code> for the domain portion of the URL, and <code class="literal">?</code> without a value for the attribute specification (which looks like <code class="literal">??</code> in the given example).</p><p>But when we drop values from the <span class="emphasis"><em>end</em></span> of the URL we do not need to leave the empty position designators. For example, if we were to drop the filter from the end, we do not need to leave trailing <code class="literal">?</code> at the end of the URL. Here's an example:</p><div class="informalexample"><pre class="programlisting">ldap:///ou=Users,dc=example,dc=com?mail?sub</pre></div><p>In this example the <code class="literal">mail</code> attributes for every entry under <code class="literal">ou=Users,dc=example,dc=com</code> are returned.</p></div></div>
<div class="section" title="Common Uses of LDAP URLs"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec55"/>Common Uses of LDAP URLs</h1></div></div></div><a class="indexterm" id="id894"/><p>Throughout this book LDAP URLs have been used for various purposes.</p><p>In Chapter 4 we used LDAP URLs to perform searches in the <code class="literal">authz-regexp</code> directive in <code class="literal">slapd.conf</code>.</p><p>While a full LDAP URL, as we examined, can be a useful way to formulate a search, this is probably not the primary use of LDAP URLs. More commonly the LDAP URL syntax is simplified and used to capture only basic information.</p><div class="section" title="Not all LDAP URLs are for Searching"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec109"/>Not all LDAP URLs are for Searching</h2></div></div></div><p>In Chapter 3 we used LDAP URLs to connect to SLAPD from the <code class="literal">ldapsearch</code> utility, but we were not using the LDAP URL as a way to specify a search string. In many cases in fact, an LDAP URL may be used simply to provide protocol, host, and port information in one convenient string:</p><div class="informalexample"><pre class="programlisting">ldap://example.com:646</pre></div><p>In this example the LDAP URL provides sufficient information for a client to use the plain LDAP protocol when connecting to the server <code class="literal">Example.Com</code> on the non-standard port 646.</p><p>Directory referrals, handled in the <code class="literal">slapd.conf</code> file by the referral directive, also use LDAP URL syntax, but only use the protocol, domain, and port settings.</p><p>LDAP URLs then, are used for two main purposes, and the purpose of each determines the form:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">LDAP search URLs follow the sophisticated eight-field format, and can convey all the information needed for an LDAP agent to perform a search</li><li class="listitem" style="list-style-type: disc">LDAP connection URLs utilize only protocol, host, and port information, and are used mainly to convey information about how to connect to a directory</li></ul></div><p>There are currently no LDAP URL forms for modifying or deleting LDAP records.</p></div></div>
<div class="section" title="For More Information on LDAP URLs..."><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec56"/>For More Information on LDAP URLs...</h1></div></div></div><p>The LDAP URL format is described in the standards-track RFC 4516. The RFC is loaded with examples, and covers the use of extensions and encoding of special characters. The RFC is available online at <a class="ulink" href="http://rfc-editor.org/rfc/rfc4516.txt">http://rfc-editor.org/rfc/rfc4516.txt</a>.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec57"/>Summary</h1></div></div></div><p>This brief primer provides an overview of the LDAP URL syntax. LDAP URLs are used in a variety of contexts, to provide connection information, and sometimes (in their more sophisticated form) to provide information necessary for performing an LDAP search.</p></div></body></html>