["```\nroot@solaris11-1:~# useradd -d /export/home/aborges -m -s /bin/bash aborges\n80 blocks\nroot@solaris11-1:~# passwd aborges\nNew Password: hacker123!\nRe-enter new Password: hacker123!\npasswd: password successfully changed for aborges\nroot@solaris11-1:~# su - aborges\nOracle Corporation  SunOS 5.11  11.1  September 2012\naborges@solaris11-1:~$ reboot\nreboot: permission denied\naborges@solaris11-1:~$\n```", "```\n    root@solaris11-1:~# getent prof_attr | more\n    Software Installation:RO::Add application software to the system:auths=solaris.smf.manage.servicetags;profiles=ZFS File System Management;help=RtSoftwareInst\n    all.html\n    NTP Management:RO::Manage the NTP service:auths=solaris.smf.manage.ntp,solaris.smf.value.ntp\n    Desktop Configuration:RO::Configure graphical desktop software:auths=solaris.smf.manage.dt.login,solaris.smf.manage.x11,solaris.smf.manage.font,solaris.smf.m\n    anage.opengl\n    Device Security:RO::Manage devices and Volume Manager:auths=solaris.smf.manage.dt.login,solaris.device.*,solaris.smf.manage.vt,solaris.smf.manage.allocate;he\n    lp=RtDeviceSecurity.html\n    Desktop Removable Media User:RO::Access removable media for desktop user:\n    (truncated output)\n\n    ```", "```\n    root@solaris11-1:~# getent auth_attr | more\n    solaris.smf.read.ocm:::Read permissions for protected Oracle Configuration Manager Service Properties::\n    solaris.smf.value.ocm:::Change Oracle Configuration Manager System Repository Service values::\n    solaris.smf.manage.ocm:::Manage Oracle Configuration Manager System Repository Service states::\n    solaris.smf.manage.cups:::Manage CUPS service states::help=ManageCUPS.html\n    solaris.smf.manage.zfs-auto-snapshot:::Manage the ZFS Automatic Snapshot Service::\n    solaris.smf.value.tcsd:::Change TPM Administation value properties::\n    (truncated output)\n\n    ```", "```\n    root@solaris11-1:~# getent exec_attr | more\n    DTrace Toolkit:solaris:cmd:::/usr/dtrace/DTT/*/*:privs=dtrace_kernel,dtrace_proc,dtrace_user\n    Desktop Configuration:solaris:cmd:RO::/usr/bin/scanpci:euid=0;privs=sys_config\n    Desktop Configuration:solaris:cmd:RO::/usr/X11/bin/scanpci:euid=0;privs=sys_config\n    OpenLDAP Server Administration:suser:cmd:RO::/usr/sbin/slapd:uid=openldap;gid=openldap;privs=basic,net_privaddr\n    OpenLDAP Server Administration:suser:cmd:RO::/usr/sbin/slapacl:uid=openldap;gid=openldap\n    (truncated output)\n\n    ```", "```\n    root@solaris11-1:~# more /etc/security/policy.conf\n\n    ```", "```\nroot@solaris11-1:~# useradd -d /export/home/aborges -m -s /bin/bash aborges\n80 blocks\nroot@solaris11-1:~# passwd aborges\nNew Password: hacker123!\nRe-enter new Password: hacker123!\npasswd: password successfully changed for aborges\n```", "```\nroot@solaris11-1:~# cat /etc/security/exec_attr.d/core-os | grep reboot\nMaintenance and Repair:solaris:cmd:RO::/usr/sbin/reboot:uid=0\n```", "```\nroot@solaris11-1:~# usermod -P \"Maintenance and Repair\" aborges\nroot@solaris11-1:/# more /etc/user_attr.d/local-entries | grep aborges\naborges::::profiles=Maintenance and Repair\n```", "```\nroot@solaris11-1:/# su – aborges\nOracle Corporation  SunOS 5.11  11.1  September 2012\naborges@solaris11-1:~$ reboot\nreboot: permission denied\n```", "```\naborges@solaris11-1:~$ pfexec reboot\n\n```", "```\n    root@solaris11-1:~# cat /etc/security/exec_attr.d/core-os | grep -i \"Maintenance and Repair\"\n    Maintenance and Repair:solaris:cmd:RO::/usr/bin/mdb:privs=all\n    Maintenance and Repair:solaris:cmd:RO::/usr/bin/coreadm:euid=0;privs=proc_owner\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/croinfo:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/bin/date:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/bin/ldd:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/bin/vmstat:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/eeprom:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/halt:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/init:uid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/pcitool:privs=all\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/poweroff:uid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/prtconf:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/reboot:uid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/syslogd:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/bootadm:euid=0\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/ucodeadm:privs=all\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/cpustat:privs=basic,cpc_cpu\n    Maintenance and Repair:solaris:cmd:RO::/usr/bin/pgstat:privs=basic,cpc_cpu\n    Maintenance and Repair:solaris:cmd:RO::/usr/bin/kstat:privs=basic,cpc_cpu\n    Maintenance and Repair:solaris:cmd:RO::/usr/sbin/ilomconfig:privs=sys_config,sys_ip_config,sys_dl_config\n    Maintenance and Repair:solaris:cmd:RO::/usr/lib/ilomconfig.builtin:privs=sys_config,sys_ip_config,sys_dl_config\n    ```", "```\nroot@solaris11-1:~# useradd -d /export/home/rbactest -m -s /bin/bash rbactest\n80 blocks\nroot@solaris11-1:~# passwd rbactest\nNew Password: oracle123!\nRe-enter new Password: oracle123!\npasswd: password successfully changed for rbactest\n```", "```\nroot@solaris11-1:~# su - rbactest\nOracle Corporation\tSunOS 5.11  11.1  September 2012\n\nrbactest@solaris11-1:~$ reboot\nreboot: permission denied\n```", "```\nroot@solaris11-1:~# roleadd -m -d /export/home/r_reboot -s /bin/pfbash r_reboot\n80 blocks\nroot@solaris11-1:~# grep r_reboot /etc/passwd\nr_reboot:x:103:10::/export/home/r_reboot:/bin/bash\nroot@solaris11-1:~# grep r_reboot /etc/shadow\nr_reboot:UP:::::::\n```", "```\nroot@solaris11-1:~# more /etc/security/prof_attr.d/core-os \n(truncated output)\nAll:RO::\\\nExecute any command as the user or role:\\\nhelp=RtAll.html\n\nAdministrator Message Edit:RO::\\\nUpdate administrator message files:\\\nauths=solaris.admin.edit/etc/issue,\\\nsolaris.admin.edit/etc/motd;\\\nhelp=RtAdminMsg.html\n\nAudit Configuration:RO::\\\nConfigure Solaris Audit:\\\nauths=solaris.smf.value.audit;\\\nhelp=RtAuditCfg.html\n\nAudit Control:RO::\\\nControl Solaris Audit:\\\nauths=solaris.smf.manage.audit;\\\nhelp=RtAuditCtrl.html\n(truncated output)\n\n```", "```\nroot@solaris11-1:~# vi /etc/security/prof_attr\n#\n# The system provided entries are stored in different files\n# under \"/etc/security/prof_attr.d\".  They should not be\n# copied to this file.\n#\n# Only local changes should be stored in this file.\n# This line should be kept in this file or it will be overwritten.\n#\nReboot:RO::\\\nFor authorized users to reboot the system:\\\nhelp=RebootByRegularUser.html\n\n```", "```\nroot@solaris11-1:~# vi /etc/security/exec_attr\n#\n# The system provided entries are stored in different files\n# under \"/etc/security/exec_attr.d\".  They should not be\n# copied to this file.\n#\n# Only local changes should be stored in this file.\n# This line should be kept in this file or it will be overwritten.\n#\nReboot:solaris:cmd:RO::/usr/sbin/reboot:uid=0\n\n```", "```\n explained as follows:\n```", "```\nroot@solaris11-1:~# more /etc/security/exec_attr.d/core-os \n(truncated output)\nAll:solaris:cmd:RO::*:\nAudit Control:solaris:cmd:RO::/usr/sbin/audit:privs=proc_owner,sys_audit\nAudit Configuration:solaris:cmd:RO::/usr/sbin/auditconfig:privs=sys_audit\nAudit Review:solaris:cmd:RO::/usr/sbin/auditreduce:euid=0\nAudit Review:solaris:cmd:RO::/usr/sbin/auditstat:privs=proc_audit\nAudit Review:solaris:cmd:RO::/usr/sbin/praudit:privs=file_dac_read\nContract Observer:solaris:cmd:RO::/usr/bin/ctwatch:\\\n  privs=contract_event,contract_observer\nCron Management:solaris:cmd:RO::/usr/bin/crontab:euid=0\nCrypto Management:solaris:cmd:RO::/usr/sbin/cryptoadm:euid=0\nCrypto Management:solaris:cmd:RO::/usr/bin/kmfcfg:euid=0\nCrypto Management:solaris:cmd:RO::/usr/sfw/bin/openssl:euid=0\nCrypto Management:solaris:cmd:RO::/usr/sfw/bin/CA.pl:euid=0\nDHCP Management:solaris:cmd:RO::/usr/lib/inet/dhcp/svcadm/dhcpconfig:uid=0\nDHCP Management:solaris:cmd:RO::/usr/lib/inet/dhcp/svcadm/dhtadm:uid=0\nDHCP Management:solaris:cmd:RO::/usr/lib/inet/dhcp/svcadm/pntadm:uid=0\n(truncated output)\n\n```", "```\nroot@solaris11-1:~# rolemod -P Reboot r_reboot\nroot@solaris11-1:~# more /etc/user_attr\n#\n# The system provided entries are stored in different files\n# under \"/etc/user_attr.d\".  They should not be copied to this file.\n#\n# Only local changes should be stored in this file.\n# This line should be kept in this file or it will be overwritten.\n#\nale::::lock_after_retries=no;profiles=System Administrator;roles=root\nr_reboot::::type=role;profiles=Reboot;roleauth=role\n\n```", "```\nroot@solaris11-1:~# passwd r_reboot\nNew Password: hacker321!\nRe-enter new Password: hacker321!\npasswd: password successfully changed for r_reboot\nroot@solaris11-1:~# grep r_reboot /etc/shadow\nr_reboot:$5$q75Eiy5/$u9mgnYsvlszbNXkSuH4kZwVVnFOhemnCTMF//cvBWD9:16178::::::19216\n```", "```\nroot@solaris11-1:~# usermod -R r_reboot rbactest\nroot@solaris11-1:~# more /etc/user_attr\n#\n# The system provided entries are stored in different files\n# under \"/etc/user_attr.d\".  They should not be copied to this file.\n#\n# Only local changes should be stored in this file.\n# This line should be kept in this file or it will be overwritten.\n#\nale::::lock_after_retries=no;profiles=System Administrator;roles=root\nr_reboot::::type=role;profiles=Reboot;roleauth=role\nrbactest::::roles=r_reboot\n\n```", "```\nroot@solaris11-1:~# roles rbactest\nr_reboot\nroot@solaris11-1:~# profiles rbactest\nrbactest:\n          Basic Solaris User\n          All\nroot@solaris11-1:~# profiles r_reboot\nr_reboot:\n          Reboot\n Basic Solaris User\n All\n\n```", "```\nroot@solaris11-1:~# auths r_reboot\nsolaris.admin.wusb.read,solaris.mail.mailq,solaris.network.autoconf.read\nroot@solaris11-1:~# auths rbactest\nsolaris.admin.wusb.read,solaris.mail.mailq,solaris.network.autoconf.read\nroot@solaris11-1:~# profiles -l r_reboot\nr_reboot:\n      Reboot\n          /usr/sbin/reboot           uid=0\n\n      Basic Solaris User\n      auths=solaris.mail.mailq,solaris.network.autoconf.read,solaris.admin.wusb.read\n      profiles=All\n              /usr/bin/cdrecord.bin      privs=file_dac_read,sys_devices,proc_lock_memory,proc_priocntl,net_privaddr\n          /usr/bin/readcd.bin        privs=file_dac_read,sys_devices,net_privaddr\n          /usr/bin/cdda2wav.bin      privs=file_dac_read,sys_devices,proc_priocntl,net_privaddr\n\n      All\n          *\n```", "```\nroot@solaris11-1:~# id\nuid=0(root) gid=0(root)\nroot@solaris11-1:~# su - rbactest\nOracle Corporation\tSunOS 5.11\t11.1\tSeptember 2012\nrbactest@solaris11-1:~$ id\nuid=102(rbactest) gid=10(staff)\nrbactest@solaris11-1:~$ profiles\n          Basic Solaris User\n          All\nrbactest@solaris11-1:~$ su - r_reboot\nPassword: hacker321!\nOracle Corporation\tSunOS 5.11\t11.1\tSeptember 2012\nr_reboot@solaris11-1:~$ id\nuid=103(r_reboot) gid=10(staff)\nr_reboot@solaris11-1:~$ profiles\n          Reboot\n          Basic Solaris User\n          All\nr_reboot@solaris11-1:~$ reboot\n\n```", "```\nroot@solaris11-1:~# svcprop -p general/action_authorization dns/client\nsolaris.smf.manage.name-service.dns.client\nroot@solaris11-1:~# svcprop -p general/action_authorization dhcp/server:ipv4\nsolaris.smf.manage.dhcp\n```", "```\nroot@solaris11-1:~# id\nuid=0(root) gid=0(root)\nroot@solaris11-1:~# su - rbactest\nOracle Corporation\tSunOS 5.11  11.1  September 2012\nrbactest@solaris11-1:~$ id\nuid=102(rbactest) gid=10(staff)\nrbactest@solaris11-1:~$ svcadm restart dns/client\nsvcadm: svc:/network/dns/client:default: Permission denied.\nrbactest@solaris11-1:~$ svcadm restart dhcp/server:ipv4\nsvcadm: svc:/network/dhcp/server:ipv4: Permission denied.\n```", "```\nroot@solaris11-1:~# rolemod -A solaris.smf.manage.name-service.dns.client,solaris.smf.manage.dhcp r_reboot\n\n```", "```\nroot@solaris11-1:~# more /etc/user_attr\n#\n# The system provided entries are stored in different files\n# under \"/etc/user_attr.d\".  They should not be copied to this file.\n#\n# Only local changes should be stored in this file.\n# This line should be kept in this file or it will be overwritten.\n#\nale::::lock_after_retries=no;profiles=System Administrator;roles=root\nr_reboot::::type=role;auths=solaris.smf.manage.name-service.dns.client,solaris.smf.manage.dhcp;profiles=Reboot;defaultpriv=basic,file_dac_read;roleauth=role\nrbactest::::defaultpriv=basic,file_dac_read;roles=r_reboot\n```", "```\nroot@solaris11-1:~# su - rbactest\nOracle Corporation  SunOS 5.11  11.1  September 2012\nrbactest@solaris11-1:~$ su - r_reboot\nPassword: hacker321!\nOracle Corporation  SunOS 5.11  11.1  September 2012\nr_reboot@solaris11-1:~$ svcadm -v restart dns/client\nAction restart set for svc:/network/dns/client:default.\nr_reboot@solaris11-1:~$ svcadm -v restart dhcp/server:ipv4\nAction restart set for svc:/network/dhcp/server:ipv4.\n```", "```\nroot@solaris11-1:~# roles rbactest\nr_reboot\nroot@solaris11-1:~# usermod -R \"\" rbactest\nroot@solaris11-1:~# roles rbactest\nroot@solaris11-1:~#\n```", "```\nroot@solaris11-1:~# more /etc/security/policy.conf \n(truncated output)\nAUTHS_GRANTED=\nPROFS_GRANTED=Basic Solaris User\nCONSOLE_USER=Console User\n(truncated output)\n#\n#PRIV_DEFAULT=basic\n#PRIV_LIMIT=all\n#\n(truncated output)\n\n```", "```\nroot@solaris11-1:~# ppriv -vl | more\ncontract_event\n  Allows a process to request critical events without limitation.\n  Allows a process to request reliable delivery of all events on\n  any event queue.\ncontract_identity\n  Allows a process to set the service FMRI value of a process\n  contract template.\n (truncated output)\n\n```", "```\nroot@solaris11-1:~# ppriv -vl basic\nfile_link_any\n  Allows a process to create hardlinks to files owned by a uid\n  different from the process' effective uid.\nfile_read\n  Allows a process to read objects in the filesystem.\nfile_write\n  Allows a process to modify objects in the filesystem.\nnet_access\n  Allows a process to open a TCP, UDP, SDP or SCTP network endpoint.\nproc_exec\n  Allows a process to call execve().\nproc_fork\n  Allows a process to call fork1()/forkall()/vfork()\nproc_info\n  Allows a process to examine the status of processes other\n  than those it can send signals to.  Processes which cannot\n  be examined cannot be seen in /proc and appear not to exist.\nproc_session\n  Allows a process to send signals or trace processes outside its\n  session.\n```", "```\nroot@solaris11-1:~# ppriv $$\n2590:  bash\nflags = <none>\n  E: all\n  I: basic\n  P: all\n  L: all\n```", "```\nroot@solaris11-1:~# id\nuid=0(root) gid=0(root)\nroot@solaris11-1:~# ls -l /etc/shadow\n-r--------   1 root     sys          949 Apr 18 22:57 /etc/shadow\nroot@solaris11-1:~# su – rbactest\nOracle Corporation\tSunOS 5.11  11.1  September 2012\nrbactest@solaris11-1:~$ more /etc/shadow\n/etc/shadow: Permission denied\n```", "```\nrbactest@solaris11-1:~$ ppriv -De more /etc/shadow\nmore[2615]: missing privilege \"file_dac_read\" (euid = 102, syscall = 69) for \"/etc/shadow\" needed at zfs_zaccess+0x245\n/etc/shadow: Permission denied\n```", "```\nrbactest@solaris11-1:~$ ppriv -vl file_dac_read\nfile_dac_read\n  Allows a process to read a file or directory whose permission\n  bits or ACL do not allow the process read permission.\n```", "```\nroot@solaris11-1:~# grep 69 /etc/name_to_sysnum\nopenat64    69\n```", "```\nrbactest@solaris11-1:~$ man openat\nSystem Calls                                              open(2)\nNAME\n     open, openat - open a file\n\nSYNOPSIS\n     #include <sys/types.h>\n     #include <sys/stat.h>\n     #include <fcntl.h>\n\n     int open(const char *path, int oflag, /* mode_t mode */);\n\n     int openat(int fildes, const char *path, int oflag,\n          /* mode_t mode */);\n\nDESCRIPTION\n     The open() function establishes  the  connection  between  a\n     file and a file descriptor. It creates an open file descrip-\n     tion that refers to a file and a file descriptor that refers \n(truncated output)\n\n```", "```\nroot@solaris11-1:~# id\nuid=0(root) gid=0(root)\nroot@solaris11-1:~# usermod -R r_reboot rbactest\nroot@solaris11-1:~# rolemod -K defaultpriv=basic,file_dac_read r_reboot\nroot@solaris11-1:~# cat /etc/user_attr\n#\n# The system provided entries are stored in different files\n# under \"/etc/user_attr.d\".  They should not be copied to this file.\n#\n# Only local changes should be stored in this file.\n# This line should be kept in this file or it will be overwritten.\n#\nale::::lock_after_retries=no;profiles=System Administrator;roles=root\nr_reboot::::type=role;defaultpriv=basic,file_dac_read;profiles=Reboot;roleauth=role\nrbactest::::roles=r_reboot \n```", "```\nroot@solaris11-1:~# su - rbactest\nOracle Corporation  SunOS 5.11  11.1  September 2012\n\nrbactest@solaris11-1:~$ su - r_reboot\nPassword: hacker321!\nOracle Corporation  SunOS 5.11  11.1  September 2012\nr_reboot@solaris11-1:~$ profiles\n          Reboot\n          Basic Solaris User\n          All\nr_reboot@solaris11-1:~$ more /etc/shadow\nroot:$5$7X5pLA3o$ZTJJeO.MfVLlBGzJI.yzh3vqhvW.xUWBknCCMHRvP79:16179::::::18384\ndaemon:NP:6445::::::\nbin:NP:6445::::::\nsys:NP:6445::::::\nadm:NP:6445::::::\n(truncated output)\n\n```", "```\nroot@solaris11-1:~# id\nuid=0(root) gid=0(root)\nroot@solaris11-1:~# usermod -K defaultpriv=basic,file_dac_read rbactest\nroot@solaris11-1:~# more /etc/user_attr\n# The system provided entries are stored in different files\n# under \"/etc/user_attr.d\".  They should not be copied to this file.\n#\n# Only local changes should be stored in this file.\n# This line should be kept in this file or it will be overwritten.\n#\nale::::lock_after_retries=no;profiles=System Administrator;roles=root\nr_reboot::::type=role;defaultpriv=basic,file_dac_read;profiles=Reboot;roleauth=role\nrbactest::::defaultpriv=basic,file_dac_read;roles=r_reboot\n\nroot@solaris11-1:~# su – rbactest\nOracle Corporation\tSunOS 5.11  11.1  September 2012\nrbactest@solaris11-1:~$ more /etc/shadow\nroot:$5$oXapLA3o$UTJJeO.MfVlTBGzJI.yzhHvqhvW.xUWBknCCKHRvP79:16179::::::18384\ndaemon:NP:6445::::::\nbin:NP:6445::::::\nsys:NP:6445::::::\nadm:NP:6445::::::\n(truncated output)\n\n```"]