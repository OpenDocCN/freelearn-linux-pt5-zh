<html><head></head><body>
<div id="_idContainer129">
<h1 class="chapter-number" id="_idParaDest-75"><a id="_idTextAnchor090"/><span class="koboSpan" id="kobo.1.1">4</span></h1>
<h1 id="_idParaDest-76"><a id="_idTextAnchor091"/><span class="koboSpan" id="kobo.2.1">Managing Users and Groups</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Linux is a multiuser, multitasking operating system, which means multiple users can access the operating system at the same time while sharing platform resources, with the kernel performing tasks for each user concurrently and independently. </span><span class="koboSpan" id="kobo.3.2">Linux provides the required isolation and security mechanisms to avoid multiple users accessing or deleting each </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">other’s files.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">When multiple users are accessing the system, permissions come into play. </span><span class="koboSpan" id="kobo.5.2">We’ll learn how </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">permissions</span></strong><span class="koboSpan" id="kobo.7.1"> work in Linux, with their essential read, write, and execution tenets. </span><span class="koboSpan" id="kobo.7.2">We’ll introduce you to the concept of a </span><em class="italic"><span class="koboSpan" id="kobo.8.1">superuser</span></em><span class="koboSpan" id="kobo.9.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.10.1">root</span></strong><span class="koboSpan" id="kobo.11.1">) account, with complete access to the operating </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">system resources.</span></span></p>
<p><span class="koboSpan" id="kobo.13.1">Along the way, we’ll take a hands-on approach to the topics learned, further deepening the assimilation of key concepts through practical examples. </span><span class="koboSpan" id="kobo.13.2">This chapter covers the </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">following topics:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.15.1">Managing users</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.16.1">Managing groups</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.17.1">Managing permissions</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.18.1">We hope that by the end of the chapter, you will be comfortable with the command-line utilities for creating, modifying, and deleting users and groups, while proficiently handling file and </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">directory permissions.</span></span></p>
<p><span class="koboSpan" id="kobo.20.1">Let’s take a quick look at the technical requirements for </span><span class="No-Break"><span class="koboSpan" id="kobo.21.1">this chapter.</span></span></p>
<h1 id="_idParaDest-77"><a id="_idTextAnchor092"/><span class="koboSpan" id="kobo.22.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.23.1">You need a working Linux distribution installed on either a </span><strong class="bold"><span class="koboSpan" id="kobo.24.1">virtual machine</span></strong><span class="koboSpan" id="kobo.25.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.26.1">VM</span></strong><span class="koboSpan" id="kobo.27.1">) or a desktop platform. </span><span class="koboSpan" id="kobo.27.2">In case you don’t have one already, </span><a href="B19682_01.xhtml#_idTextAnchor030"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.28.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.29.1">, </span><em class="italic"><span class="koboSpan" id="kobo.30.1">Installing Linux</span></em><span class="koboSpan" id="kobo.31.1">, will drive you through the related process. </span><span class="koboSpan" id="kobo.31.2">In this chapter, we’ll be using Ubuntu or Fedora, but most of the commands and examples used would pertain to any other </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">Linux platform.</span></span></p>
<h1 id="_idParaDest-78"><a id="_idTextAnchor093"/><span class="koboSpan" id="kobo.33.1">Managing users</span></h1>
<p><span class="koboSpan" id="kobo.34.1">In this context, a </span><strong class="bold"><span class="koboSpan" id="kobo.35.1">user</span></strong><span class="koboSpan" id="kobo.36.1"> is anyone</span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.37.1"> using a computer or a system resource. </span><span class="koboSpan" id="kobo.37.2">In its simplest form, a Linux </span><em class="italic"><span class="koboSpan" id="kobo.38.1">user</span></em><span class="koboSpan" id="kobo.39.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.40.1">user account</span></em><span class="koboSpan" id="kobo.41.1"> is identified by a name and a </span><strong class="bold"><span class="koboSpan" id="kobo.42.1">unique identifier</span></strong><span class="koboSpan" id="kobo.43.1">, known</span><a id="_idIndexMarker453"/><span class="koboSpan" id="kobo.44.1"> as </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">a </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.46.1">UID</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">From a purely technical point of view, in Linux, we have the following types </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">of users:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.50.1">Normal (or regular) users</span></strong><span class="koboSpan" id="kobo.51.1">: General-purpose, everyday user accounts, mostly suited for personal use</span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.52.1"> and for common application and file management tasks, with limited access</span><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.53.1"> to system-wide resources. </span><span class="koboSpan" id="kobo.53.2">A regular user account usually has a </span><em class="italic"><span class="koboSpan" id="kobo.54.1">login</span></em><span class="koboSpan" id="kobo.55.1"> shell and a </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.56.1">home</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.57.1"> directory.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.58.1">System users</span></strong><span class="koboSpan" id="kobo.59.1">: These are similar to regular user accounts, except they may lack a login shell or a home </span><a id="_idIndexMarker456"/><span class="koboSpan" id="kobo.60.1">directory. </span><span class="koboSpan" id="kobo.60.2">System accounts are usually assigned to background application services, mostly for security reasons and to limit the </span><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.61.1">attack surface associated with the related resources—for example, a web server daemon handling public requests should run as a system account, ideally without login or </span><strong class="source-inline"><span class="koboSpan" id="kobo.62.1">root</span></strong><span class="koboSpan" id="kobo.63.1"> privileges. </span><span class="koboSpan" id="kobo.63.2">Consequently, possible vulnerabilities exposed through the web server would remain strictly isolated to the limited action realm of the associated </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">system account.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.65.1">Superusers</span></strong><span class="koboSpan" id="kobo.66.1">: These are</span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.67.1"> privileged user accounts, with full access to system</span><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.68.1"> resources, including the permission to create, modify, and delete user accounts. </span><span class="koboSpan" id="kobo.68.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.69.1">root</span></strong><span class="koboSpan" id="kobo.70.1"> user is an example of </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">a superuser.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.72.1">In Linux, only the </span><strong class="source-inline"><span class="koboSpan" id="kobo.73.1">root</span></strong><span class="koboSpan" id="kobo.74.1"> user or</span><a id="_idIndexMarker460"/><span class="koboSpan" id="kobo.75.1"> users with </span><strong class="source-inline"><span class="koboSpan" id="kobo.76.1">sudo</span></strong><span class="koboSpan" id="kobo.77.1"> privileges (</span><strong class="bold"><span class="koboSpan" id="kobo.78.1">sudoers</span></strong><span class="koboSpan" id="kobo.79.1">) can create, modify, or delete </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">user accounts.</span></span></p>
<h2 id="_idParaDest-79"><a id="_idTextAnchor094"/><span class="koboSpan" id="kobo.81.1">Understanding sudo</span></h2>
<p><span class="koboSpan" id="kobo.82.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">root</span></strong><span class="koboSpan" id="kobo.84.1"> user is the default </span><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.85.1">superuser account in Linux, and it has the ability to do anything on a system. </span><span class="koboSpan" id="kobo.85.2">Ideally, acting</span><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.86.1"> as </span><strong class="source-inline"><span class="koboSpan" id="kobo.87.1">root</span></strong><span class="koboSpan" id="kobo.88.1"> on a system should generally be avoided due to safety and security reasons. </span><span class="koboSpan" id="kobo.88.2">With </span><strong class="source-inline"><span class="koboSpan" id="kobo.89.1">sudo</span></strong><span class="koboSpan" id="kobo.90.1">, Linux provides a mechanism for </span><em class="italic"><span class="koboSpan" id="kobo.91.1">promoting</span></em><span class="koboSpan" id="kobo.92.1"> a regular user account to superuser privileges, using an additional layer of security. </span><span class="koboSpan" id="kobo.92.2">This way, a </span><strong class="source-inline"><span class="koboSpan" id="kobo.93.1">sudo</span></strong><span class="koboSpan" id="kobo.94.1"> user is generally used instead </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">root</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.98.1">sudo</span></strong><span class="koboSpan" id="kobo.99.1"> is a command-line utility that </span><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.100.1">allows a permitted user to execute commands with the security privileges of a superuser or another user (depending on the local system’s security policy). </span><strong class="source-inline"><span class="koboSpan" id="kobo.101.1">sudo</span></strong><span class="koboSpan" id="kobo.102.1"> originall</span><a id="_idTextAnchor095"/><span class="koboSpan" id="kobo.103.1">y stood for </span><em class="italic"><span class="koboSpan" id="kobo.104.1">superuser do</span></em><span class="koboSpan" id="kobo.105.1"> due to its initial implementation of acting exclusively as the superuser, but has since been expanded to support not only the superuser but also other (restricted) user impersonations. </span><span class="koboSpan" id="kobo.105.2">Thus, it is also referred to as </span><em class="italic"><span class="koboSpan" id="kobo.106.1">substitute user do</span></em><span class="koboSpan" id="kobo.107.1">. </span><span class="koboSpan" id="kobo.107.2">Yet, more </span><a id="_idIndexMarker464"/><span class="koboSpan" id="kobo.108.1">often than not, it is perceived as </span><em class="italic"><span class="koboSpan" id="kobo.109.1">superuser do</span></em><span class="koboSpan" id="kobo.110.1"> due to its frequent </span><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.111.1">use in Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">administrative tasks.</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">Most of the </span><a id="_idIndexMarker466"/><span class="koboSpan" id="kobo.114.1">command-line tools for</span><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.115.1"> managing users in Linux require </span><strong class="source-inline"><span class="koboSpan" id="kobo.116.1">sudo</span></strong><span class="koboSpan" id="kobo.117.1"> privileges unless the related tasks are carried out by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.118.1">root</span></strong><span class="koboSpan" id="kobo.119.1"> user. </span><span class="koboSpan" id="kobo.119.2">If we want to avoid using the root context, we can’t genuinely proceed with the rest of this chapter—and create a user in particular—before we have a user account with superuser privileges. </span><span class="koboSpan" id="kobo.119.3">So, let’s take this chicken-and-egg scenario out of the </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">way first.</span></span></p>
<p><span class="koboSpan" id="kobo.121.1">Most Linux distributions create an additional user account with superuser privileges, besides </span><strong class="source-inline"><span class="koboSpan" id="kobo.122.1">root</span></strong><span class="koboSpan" id="kobo.123.1">, during installation. </span><span class="koboSpan" id="kobo.123.2">The reason, as noted before, is to provide an extra layer of security and safety for elevated operations. </span><span class="koboSpan" id="kobo.123.3">The simplest way to check whether a user account has </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">sudo</span></strong><span class="koboSpan" id="kobo.125.1"> privileges is to run the following command in a terminal, while logged in with the related </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">user account:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.127.1">
sudo -v</span></pre> <p><span class="koboSpan" id="kobo.128.1">According to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.129.1">sudo</span></strong><span class="koboSpan" id="kobo.130.1"> manual (</span><strong class="source-inline"><span class="koboSpan" id="kobo.131.1">man sudo</span></strong><span class="koboSpan" id="kobo.132.1">), the </span><strong class="source-inline"><span class="koboSpan" id="kobo.133.1">-v</span></strong><span class="koboSpan" id="kobo.134.1"> option causes </span><strong class="source-inline"><span class="koboSpan" id="kobo.135.1">sudo</span></strong><span class="koboSpan" id="kobo.136.1"> to update the user’s cached credentials and authenticate the user if the cached </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">credentials expired.</span></span></p>
<p><span class="koboSpan" id="kobo.138.1">If the user (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.139.1">julian</span></strong><span class="koboSpan" id="kobo.140.1">) doesn’t have superuser privileges on the local machine (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.141.1">neptune</span></strong><span class="koboSpan" id="kobo.142.1">), the preceding command yields the following (or a </span><span class="No-Break"><span class="koboSpan" id="kobo.143.1">similar) error:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.144.1">
Sorry, user </span><strong class="bold"><span class="koboSpan" id="kobo.145.1">julian</span></strong><span class="koboSpan" id="kobo.146.1"> may not run sudo on </span><strong class="bold"><span class="koboSpan" id="kobo.147.1">neptune</span></strong><span class="koboSpan" id="kobo.148.1">.</span></pre> <p><span class="koboSpan" id="kobo.149.1">In recent Linux distributions, the execution of a </span><strong class="source-inline"><span class="koboSpan" id="kobo.150.1">sudo</span></strong><span class="koboSpan" id="kobo.151.1"> command usually grants elevated permissions for a limited time. </span><span class="koboSpan" id="kobo.151.2">Ubuntu, for example, has a 15-minute </span><strong class="source-inline"><span class="koboSpan" id="kobo.152.1">sudo</span></strong><span class="koboSpan" id="kobo.153.1"> elevation span, after which time a </span><strong class="source-inline"><span class="koboSpan" id="kobo.154.1">sudo</span></strong><span class="koboSpan" id="kobo.155.1"> user would need to authenticate again. </span><span class="koboSpan" id="kobo.155.2">Subsequent invocations of </span><strong class="source-inline"><span class="koboSpan" id="kobo.156.1">sudo</span></strong><span class="koboSpan" id="kobo.157.1"> may not prompt for a password if done within the </span><strong class="source-inline"><span class="koboSpan" id="kobo.158.1">sudo</span></strong><span class="koboSpan" id="kobo.159.1"> cache </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">credential timeout.</span></span></p>
<p><span class="koboSpan" id="kobo.161.1">If we don’t have a default superuser account, we can always use the root context to create new users (see the</span><a id="_idIndexMarker468"/><span class="koboSpan" id="kobo.162.1"> next chapter) and elevate them to </span><strong class="bold"><span class="koboSpan" id="kobo.163.1">sudoer</span></strong><span class="koboSpan" id="kobo.164.1"> privileges. </span><span class="koboSpan" id="kobo.164.2">We’ll learn </span><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.165.1">more about this in the </span><em class="italic"><span class="koboSpan" id="kobo.166.1">Creating a superuser</span></em><span class="koboSpan" id="kobo.167.1"> section, later in </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.169.1">Now, let’s have a look at how to create, modify, and </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">delete users.</span></span></p>
<h2 id="_idParaDest-80"><a id="_idTextAnchor096"/><span class="koboSpan" id="kobo.171.1">Creating, modifying, and deleting users</span></h2>
<p><span class="koboSpan" id="kobo.172.1">In this section, we explore a few </span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.173.1">command-line tools and some common tasks for managing users. </span><span class="koboSpan" id="kobo.173.2">The</span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.174.1"> example commands and procedures are shown for Ubuntu and Fedora, but the same principles apply to any other Linux distribution. </span><span class="koboSpan" id="kobo.174.2">Some user </span><a id="_idIndexMarker472"/><span class="koboSpan" id="kobo.175.1">management </span><strong class="bold"><span class="koboSpan" id="kobo.176.1">command-line interface</span></strong><span class="koboSpan" id="kobo.177.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.178.1">CLI</span></strong><span class="koboSpan" id="kobo.179.1">) tools may differ or may not be available on specific Linux platforms (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.180.1">useradd</span></strong><span class="koboSpan" id="kobo.181.1"> is not available on Alpine Linux, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">adduser</span></strong><span class="koboSpan" id="kobo.183.1"> should be used instead). </span><span class="koboSpan" id="kobo.183.2">Please</span><a id="_idIndexMarker473"/><span class="koboSpan" id="kobo.184.1"> check the documentation of the Linux distribution of your choice for the </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">equivalent commands.</span></span></p>
<h3><span class="koboSpan" id="kobo.186.1">Creating users</span></h3>
<p><span class="koboSpan" id="kobo.187.1">To create users, we can use</span><a id="_idIndexMarker474"/><span class="koboSpan" id="kobo.188.1"> either the </span><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">useradd</span></strong><span class="koboSpan" id="kobo.190.1"> or the </span><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">adduser</span></strong><span class="koboSpan" id="kobo.192.1"> command, although on some Linux distributions (for example, Debian or Ubuntu), the recommended way is to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.193.1">adduser</span></strong><span class="koboSpan" id="kobo.194.1"> command in favor of the low-level </span><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">useradd</span></strong><span class="koboSpan" id="kobo.196.1"> utility. </span><span class="koboSpan" id="kobo.196.2">We’ll cover both in </span><span class="No-Break"><span class="koboSpan" id="kobo.197.1">this section.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">adduser</span></strong><span class="koboSpan" id="kobo.199.1"> is a Perl script using </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">useradd</span></strong><span class="koboSpan" id="kobo.201.1">—basically, a shim of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.202.1">useradd</span></strong><span class="koboSpan" id="kobo.203.1"> command—with a user-friendly guided configuration. </span><span class="koboSpan" id="kobo.203.2">Both command-line tools are installed by default in Ubuntu and Fedora. </span><span class="koboSpan" id="kobo.203.3">Let’s take a brief look at each of </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">these commands.</span></span></p>
<h4><span class="koboSpan" id="kobo.205.1">Creating users with useradd</span></h4>
<p><span class="koboSpan" id="kobo.206.1">The syntax for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">useradd</span></strong><span class="koboSpan" id="kobo.208.1"> command is </span><a id="_idIndexMarker475"/><span class="No-Break"><span class="koboSpan" id="kobo.209.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.210.1">
useradd [OPTIONS] USER</span></pre> <p><span class="koboSpan" id="kobo.211.1">In its simplest</span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.212.1"> invocation, the following command creates a user </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">account (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.215.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.216.1">
sudo useradd julian</span></pre> <p><span class="koboSpan" id="kobo.217.1">The user information is stored in a </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.219.1"> file. </span><span class="koboSpan" id="kobo.219.2">Here’s the related user data </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">for </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.221.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.223.1">
sudo cat /etc/passwd | grep julian</span></pre> <p><span class="koboSpan" id="kobo.224.1">In our case, this is </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer087">
<span class="koboSpan" id="kobo.226.1"><img alt="Figure 4.1 – The user record created with useradd" src="image/Figure_04_01_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.227.1">Figure 4.1 – The user record created with useradd</span></p>
<p><span class="koboSpan" id="kobo.228.1">Let’s analyze the related</span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.229.1"> user record. </span><span class="koboSpan" id="kobo.229.2">Each entry is delimited by</span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.230.1"> a colon (</span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">:</span></strong><span class="koboSpan" id="kobo.232.1">) and is </span><span class="No-Break"><span class="koboSpan" id="kobo.233.1">listed here:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">: Username</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.236.1">x</span></strong><span class="koboSpan" id="kobo.237.1">: Encrypted password (password hash is stored </span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.239.1">/etc/shadow</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">1001</span></strong><span class="koboSpan" id="kobo.242.1">: </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">The </span></span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">UID</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">1001</span></strong><span class="koboSpan" id="kobo.246.1">: The user </span><strong class="bold"><span class="koboSpan" id="kobo.247.1">group </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.248.1">ID</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.249.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.250.1">GID</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.252.1">::</span></strong><span class="koboSpan" id="kobo.253.1"> The </span><strong class="bold"><span class="koboSpan" id="kobo.254.1">General Electric Comprehensive Operating Supervisor</span></strong><span class="koboSpan" id="kobo.255.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.256.1">GECOS</span></strong><span class="koboSpan" id="kobo.257.1">) field—for example, display</span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.258.1"> name (in our case, empty), explained later in </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">this section</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">/home/julian</span></strong><span class="koboSpan" id="kobo.261.1">: User </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">home folder</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">/bin/sh</span></strong><span class="koboSpan" id="kobo.264.1">: Default login shell for </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">the user</span></span></li>
</ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.266.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.267.1">The GECOS field is a string of comma-delimited attributes, reflecting general information about the user account (for example, real name, company, and phone number). </span><span class="koboSpan" id="kobo.267.2">In Linux, the GECOS </span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.268.1">field is the fifth field in a user record. </span><span class="koboSpan" id="kobo.268.2">See more information </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">at </span></span><a href="https://en.wikipedia.org/wiki/Gecos_field"><span class="No-Break"><span class="koboSpan" id="kobo.270.1">https://en.wikipedia.org/wiki/Gecos_field</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.271.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.272.1">We can also use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">getent</span></strong><span class="koboSpan" id="kobo.274.1"> command to retrieve the preceding user information, </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.276.1">
getent passwd julian</span></pre> <p><span class="koboSpan" id="kobo.277.1">To view the UID (</span><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">uid</span></strong><span class="koboSpan" id="kobo.279.1">), GID (</span><strong class="source-inline"><span class="koboSpan" id="kobo.280.1">gid</span></strong><span class="koboSpan" id="kobo.281.1">), and group membership associated with a user, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.282.1">id</span></strong><span class="koboSpan" id="kobo.283.1"> command, </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.285.1">
id julian</span></pre> <p><span class="koboSpan" id="kobo.286.1">This command gives us the </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer088">
<span class="koboSpan" id="kobo.288.1"><img alt="Figure 4.2 – The UID information" src="image/Figure_04_02_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.289.1">Figure 4.2 – The UID information</span></p>
<p><span class="koboSpan" id="kobo.290.1">With the simple invocation of </span><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">useradd</span></strong><span class="koboSpan" id="kobo.292.1">, the command creates the user (</span><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">julian</span></strong><span class="koboSpan" id="kobo.294.1">) with some immediate default values (as enumerated), while other user-related data is empty—for example, we have no full name or password specified for the user yet. </span><span class="koboSpan" id="kobo.294.2">Also, while the home directory</span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.295.1"> has a default value (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">/home/julian</span></strong><span class="koboSpan" id="kobo.297.1">), the actual filesystem folder will not be created unless the </span><strong class="source-inline"><span class="koboSpan" id="kobo.298.1">useradd</span></strong><span class="koboSpan" id="kobo.299.1"> command is invoked with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">-m</span></strong><span class="koboSpan" id="kobo.301.1"> or the </span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">--create-home</span></strong><span class="koboSpan" id="kobo.303.1"> option, </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.305.1">
sudo useradd -m julian</span></pre> <p><span class="koboSpan" id="kobo.306.1">Without a home directory, regular </span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.307.1">users would not have the ability to save their files in a private location on the system. </span><span class="koboSpan" id="kobo.307.2">On the other hand, some system accounts may not need a home directory since they don’t have a login shell. </span><span class="koboSpan" id="kobo.307.3">For example, a database server (for example, PostgreSQL) may run with a non-root system account (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">postgres</span></strong><span class="koboSpan" id="kobo.309.1">) that only needs access to database resources in specific locations (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">/var/lib/pgsql</span></strong><span class="koboSpan" id="kobo.311.1">), controlled via other permission</span><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.312.1"> mechanisms (for example, </span><strong class="bold"><span class="koboSpan" id="kobo.313.1">Security-Enhanced </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.314.1">Linux</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.315.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.316.1">SELinux</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">)).</span></span></p>
<p><span class="koboSpan" id="kobo.318.1">For our regular user, if we also wanted to specify a full name (display name), the command would change </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">to this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.320.1">
sudo useradd -m -c "Julian" julian</span></pre> <p><span class="koboSpan" id="kobo.321.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">-c, --comment</span></strong><span class="koboSpan" id="kobo.323.1"> option parameter of </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">useradd</span></strong><span class="koboSpan" id="kobo.325.1"> expects a </span><em class="italic"><span class="koboSpan" id="kobo.326.1">comment</span></em><span class="koboSpan" id="kobo.327.1">, also known as the GECOS field (the fifth field in</span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.328.1"> our user record), with multiple comma-separated values. </span><span class="koboSpan" id="kobo.328.2">In our case, we specify the full name (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">Julian</span></strong><span class="koboSpan" id="kobo.330.1">). </span><span class="koboSpan" id="kobo.330.2">For more information, check out the </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">useradd</span></strong><span class="koboSpan" id="kobo.332.1"> manual (</span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">man useradd</span></strong><span class="koboSpan" id="kobo.334.1">) or </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">useradd --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.336.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.337.1">The user still won’t have a </span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.338.1">password yet, and consequently, there would be no way for them to log in (for example, via a </span><strong class="bold"><span class="koboSpan" id="kobo.339.1">graphical user interface</span></strong><span class="koboSpan" id="kobo.340.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.341.1">GUI</span></strong><span class="koboSpan" id="kobo.342.1">) or </span><strong class="bold"><span class="koboSpan" id="kobo.343.1">Secure Shell</span></strong><span class="koboSpan" id="kobo.344.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.345.1">SSH</span></strong><span class="koboSpan" id="kobo.346.1">)). </span><span class="koboSpan" id="kobo.346.2">To </span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.347.1">create a password for </span><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">julian</span></strong><span class="koboSpan" id="kobo.349.1">, we invoke</span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.350.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">passwd</span></strong><span class="koboSpan" id="kobo.352.1"> command, </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.354.1">
sudo passwd julian</span></pre> <p><span class="koboSpan" id="kobo.355.1">You can see the </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer089">
<span class="koboSpan" id="kobo.357.1"><img alt="Figure 4.3 – Creating or changing the user password" src="image/Figure_04_03_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.358.1">Figure 4.3 – Creating or changing the user password</span></p>
<p><span class="koboSpan" id="kobo.359.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">passwd</span></strong><span class="koboSpan" id="kobo.361.1"> command will </span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.362.1">prompt for the new user’s password. </span><span class="koboSpan" id="kobo.362.2">With the password set, there will be a new entry added to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.363.1">/etc/shadow</span></strong><span class="koboSpan" id="kobo.364.1"> file. </span><span class="koboSpan" id="kobo.364.2">This file stores the secure password hashes (not the passwords!) for each user. </span><span class="koboSpan" id="kobo.364.3">Only superusers can access the content of this file. </span><span class="koboSpan" id="kobo.364.4">Here’s the command to retrieve the related information for the </span><span class="No-Break"><span class="koboSpan" id="kobo.365.1">user </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.367.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.368.1">
sudo getent shadow julian</span></pre> <p><span class="koboSpan" id="kobo.369.1">You can also use the </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.371.1">
sudo cat /etc/shadow | grep julian</span></pre> <p><span class="koboSpan" id="kobo.372.1">The output of both commands is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer090">
<span class="koboSpan" id="kobo.374.1"><img alt="Figure 4.4 – Information about the user from the shadow file" src="image/Figure_04_04_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.375.1">Figure 4.4 – Information about the user from the shadow file</span></p>
<p><span class="koboSpan" id="kobo.376.1">Once the password has been set, in normal circumstances, the user can log in to the system (via SSH or GUI). </span><span class="koboSpan" id="kobo.376.2">If the</span><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.377.1"> Linux distribution has a GUI, the new user will show up on the </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">login screen.</span></span></p>
<p><span class="koboSpan" id="kobo.379.1">As noted, with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">useradd</span></strong><span class="koboSpan" id="kobo.381.1"> command, </span><a id="_idIndexMarker490"/><span class="koboSpan" id="kobo.382.1">we have low-level granular control over how we create user accounts, but sometimes we may prefer a more user-friendly approach. </span><span class="koboSpan" id="kobo.382.2">Enter the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">adduser</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.384.1"> command.</span></span></p>
<h4><span class="koboSpan" id="kobo.385.1">Creating users with adduser</span></h4>
<p><span class="koboSpan" id="kobo.386.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.387.1">adduser</span></strong><span class="koboSpan" id="kobo.388.1"> command is a</span><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.389.1"> Perl wrapper for </span><strong class="source-inline"><span class="koboSpan" id="kobo.390.1">useradd</span></strong><span class="koboSpan" id="kobo.391.1">. </span><span class="koboSpan" id="kobo.391.2">The syntax</span><a id="_idIndexMarker492"/><span class="koboSpan" id="kobo.392.1"> for this command is </span><span class="No-Break"><span class="koboSpan" id="kobo.393.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.394.1">
adduser [OPTIONS] USER</span></pre> <p><strong class="source-inline"><span class="koboSpan" id="kobo.395.1">sudo</span></strong><span class="koboSpan" id="kobo.396.1"> may prompt for the superuser password. </span><strong class="source-inline"><span class="koboSpan" id="kobo.397.1">adduser</span></strong><span class="koboSpan" id="kobo.398.1"> will prompt for the new user’s password and other user-related information (as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.399.1">Figure 4</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.400.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.401.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.402.1">Let’s create a new user account (</span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">alex</span></strong><span class="koboSpan" id="kobo.404.1">) with </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">adduser</span></strong><span class="koboSpan" id="kobo.406.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.407.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.408.1">
sudo adduser alex</span></pre> <p><span class="koboSpan" id="kobo.409.1">The preceding command yields the </span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer091">
<span class="koboSpan" id="kobo.411.1"><img alt="Figure 4.5 – The adduser command" src="image/Figure_04_05_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.412.1">Figure 4.5 – The adduser command</span></p>
<p><span class="koboSpan" id="kobo.413.1">In Fedora, the preceding invocation of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">adduser</span></strong><span class="koboSpan" id="kobo.415.1"> command will simply run without prompting the </span><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.416.1">user for a password or any </span><span class="No-Break"><span class="koboSpan" id="kobo.417.1">other</span></span><span class="No-Break"><a id="_idIndexMarker494"/></span><span class="No-Break"><span class="koboSpan" id="kobo.418.1"> information.</span></span></p>
<p><span class="koboSpan" id="kobo.419.1">We can see the related user entry in </span><strong class="source-inline"><span class="koboSpan" id="kobo.420.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.421.1"> with </span><strong class="source-inline"><span class="koboSpan" id="kobo.422.1">getent</span></strong><span class="koboSpan" id="kobo.423.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.425.1">
getent passwd alex</span></pre> <p><span class="koboSpan" id="kobo.426.1">The following is </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer092">
<span class="koboSpan" id="kobo.428.1"><img alt="Figure 4.6 – Viewing user information with getent" src="image/Figure_04_06_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.429.1">Figure 4.6 – Viewing user information with getent</span></p>
<p><span class="koboSpan" id="kobo.430.1">In the preceding examples, we created a regular user account. </span><span class="koboSpan" id="kobo.430.2">Administrators or superusers can also elevate the privileges of a regular user to a superuser. </span><span class="koboSpan" id="kobo.430.3">Let’s see how in the </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">following section.</span></span></p>
<h3><span class="koboSpan" id="kobo.432.1">Creating a superuser</span></h3>
<p><span class="koboSpan" id="kobo.433.1">When a regular user is given the </span><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.434.1">power to run </span><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">sudo</span></strong><span class="koboSpan" id="kobo.436.1">, they become a superuser. </span><span class="koboSpan" id="kobo.436.2">Let’s assume we have a regular user created via any of the examples shown in the </span><em class="italic"><span class="koboSpan" id="kobo.437.1">Creating </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.438.1">users</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.439.1"> section.</span></span></p>
<p><span class="koboSpan" id="kobo.440.1">Promoting the user to a </span><a id="_idIndexMarker496"/><span class="koboSpan" id="kobo.441.1">superuser (or </span><em class="italic"><span class="koboSpan" id="kobo.442.1">sudoer</span></em><span class="koboSpan" id="kobo.443.1">) requires a </span><strong class="source-inline"><span class="koboSpan" id="kobo.444.1">sudo</span></strong><span class="koboSpan" id="kobo.445.1"> group membership. </span><span class="koboSpan" id="kobo.445.2">In Linux, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.446.1">sudo</span></strong><span class="koboSpan" id="kobo.447.1"> group is a reserved system group for users with elevated or </span><strong class="source-inline"><span class="koboSpan" id="kobo.448.1">root</span></strong><span class="koboSpan" id="kobo.449.1"> privileges. </span><span class="koboSpan" id="kobo.449.2">To make the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.450.1">julian</span></strong><span class="koboSpan" id="kobo.451.1"> a sudoer, we simply need to add the user to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.452.1">sudo</span></strong><span class="koboSpan" id="kobo.453.1"> group, like this (</span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">in Ubuntu):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.455.1">
sudo usermod -aG sudo julian</span></pre> <p><span class="koboSpan" id="kobo.456.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.457.1">-aG</span></strong><span class="koboSpan" id="kobo.458.1"> options of </span><strong class="source-inline"><span class="koboSpan" id="kobo.459.1">usermod</span></strong><span class="koboSpan" id="kobo.460.1"> instruct the command to append (</span><strong class="source-inline"><span class="koboSpan" id="kobo.461.1">-a, --append</span></strong><span class="koboSpan" id="kobo.462.1">) the user to the specified group (</span><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">-G, --group</span></strong><span class="koboSpan" id="kobo.464.1">)—in our </span><span class="No-Break"><span class="koboSpan" id="kobo.465.1">case, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.466.1">sudo</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.467.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.468.1">To verify our user is now a sudoer, first make sure the related user information reflects the </span><strong class="source-inline"><span class="koboSpan" id="kobo.469.1">sudo</span></strong><span class="koboSpan" id="kobo.470.1"> membership by running the </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.472.1">
id julian</span></pre> <p><span class="koboSpan" id="kobo.473.1">This gives us the </span><span class="No-Break"><span class="koboSpan" id="kobo.474.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer093">
<span class="koboSpan" id="kobo.475.1"><img alt="Figure 4.7 – Looking for the sudo membership of a user" src="image/Figure_04_07_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.476.1">Figure 4.7 – Looking for the sudo membership of a user</span></p>
<p><span class="koboSpan" id="kobo.477.1">The output shows that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">sudo</span></strong><span class="koboSpan" id="kobo.479.1"> group membership (GID) in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.480.1">groups</span></strong><span class="koboSpan" id="kobo.481.1"> tag </span><span class="No-Break"><span class="koboSpan" id="kobo.482.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">27(sudo)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.484.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.485.1">To verify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">sudo</span></strong><span class="koboSpan" id="kobo.487.1"> access for the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.488.1">julian</span></strong><span class="koboSpan" id="kobo.489.1">, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.490.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.491.1">
su - julian</span></pre> <p><span class="koboSpan" id="kobo.492.1">The preceding command prompts for the password of the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">julian</span></strong><span class="koboSpan" id="kobo.494.1">. </span><span class="koboSpan" id="kobo.494.2">A successful login would usually validate the superuser context. </span><span class="koboSpan" id="kobo.494.3">Alternatively, the user (</span><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">julian</span></strong><span class="koboSpan" id="kobo.496.1">) can run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">sudo -v</span></strong><span class="koboSpan" id="kobo.498.1"> command in their terminal session to validate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">sudo</span></strong><span class="koboSpan" id="kobo.500.1"> privileges. </span><span class="koboSpan" id="kobo.500.2">For more information on superuser privileges, see the </span><em class="italic"><span class="koboSpan" id="kobo.501.1">Understanding sudo</span></em><span class="koboSpan" id="kobo.502.1"> section earlier in </span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">the chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.504.1">With multiple users created, a system administrator may want to view or list all the users in the system. </span><span class="koboSpan" id="kobo.504.2">In the next section, we provide a few ways to accomplish </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">this task.</span></span></p>
<h4><span class="koboSpan" id="kobo.506.1">Viewing users</span></h4>
<p><span class="koboSpan" id="kobo.507.1">There are a few ways for a </span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.508.1">superuser to view all users configured in the system. </span><span class="koboSpan" id="kobo.508.2">As previously noted, the user information is stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.509.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.510.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.511.1">/etc/shadow</span></strong><span class="koboSpan" id="kobo.512.1"> files. </span><span class="koboSpan" id="kobo.512.2">Besides simply viewing these files, we can parse them and extract only the usernames with the </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.514.1">
cat /etc/passwd | cut -d: -f1 | less</span></pre> <p><span class="koboSpan" id="kobo.515.1">Alternatively, we can parse the </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">/etc/shadow</span></strong><span class="koboSpan" id="kobo.517.1"> file, </span><span class="No-Break"><span class="koboSpan" id="kobo.518.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.519.1">
sudo cat /etc/shadow | cut -d: -f1 | less</span></pre> <p><span class="koboSpan" id="kobo.520.1">In the preceding commands, we read the content from the related files (with </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">cat</span></strong><span class="koboSpan" id="kobo.522.1">). </span><span class="koboSpan" id="kobo.522.2">Next, we piped the result to a delimiter-based parsing (with </span><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">cut</span></strong><span class="koboSpan" id="kobo.524.1">, on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">:</span></strong><span class="koboSpan" id="kobo.526.1"> delimiter) and picked the first field </span><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">(-f1</span></strong><span class="koboSpan" id="kobo.528.1">). </span><span class="koboSpan" id="kobo.528.2">Finally, we chose a paginated display of the results, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.529.1">less</span></strong><span class="koboSpan" id="kobo.530.1"> command (to exit the command’s output, </span><span class="No-Break"><span class="koboSpan" id="kobo.531.1">press </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.532.1">Q</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.533.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.534.1">Note the use of </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">sudo</span></strong><span class="koboSpan" id="kobo.536.1"> for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.537.1">shadow</span></strong><span class="koboSpan" id="kobo.538.1"> file since access is limited to superusers only, due to the sensitive nature </span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.539.1">of the password hash data. </span><span class="koboSpan" id="kobo.539.2">Alternatively, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.540.1">getent</span></strong><span class="koboSpan" id="kobo.541.1"> command to retrieve the </span><span class="No-Break"><span class="koboSpan" id="kobo.542.1">user information.</span></span></p>
<p><span class="koboSpan" id="kobo.543.1">The following command lists all the users configured in </span><span class="No-Break"><span class="koboSpan" id="kobo.544.1">the system:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.545.1">
getent passwd</span></pre> <p><span class="koboSpan" id="kobo.546.1">The preceding command reads the </span><strong class="source-inline"><span class="koboSpan" id="kobo.547.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.548.1"> file. </span><span class="koboSpan" id="kobo.548.2">Alternatively, we can retrieve the same information from </span><strong class="source-inline"><span class="koboSpan" id="kobo.549.1">/etc/shadow</span></strong><span class="koboSpan" id="kobo.550.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.551.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.552.1">
sudo getent shadow</span></pre> <p><span class="koboSpan" id="kobo.553.1">For both commands, we can further pipe the </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">getent</span></strong><span class="koboSpan" id="kobo.555.1"> output to </span><strong class="source-inline"><span class="koboSpan" id="kobo.556.1">| cut -d: -f1</span></strong><span class="koboSpan" id="kobo.557.1"> to list only the usernames, </span><span class="No-Break"><span class="koboSpan" id="kobo.558.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.559.1">
sudo getent shadow | cut -d: -f1 | less | column</span></pre> <p><span class="koboSpan" id="kobo.560.1">The output will be similar </span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">to this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer094">
<span class="koboSpan" id="kobo.562.1"><img alt="Figure 4.8 – Viewing usernames" src="image/Figure_04_08_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.563.1">Figure 4.8 – Viewing usernames</span></p>
<p><span class="koboSpan" id="kobo.564.1">With new users created, administrators </span><a id="_idIndexMarker499"/><span class="koboSpan" id="kobo.565.1">or superusers may want to change certain user-related information, such as password, password expiration, full name, or login shell. </span><span class="koboSpan" id="kobo.565.2">Next, we take a look at some of the most common ways to accomplish </span><span class="No-Break"><span class="koboSpan" id="kobo.566.1">this task.</span></span></p>
<h3><span class="koboSpan" id="kobo.567.1">Modifying users</span></h3>
<p><span class="koboSpan" id="kobo.568.1">A superuser can run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.569.1">usermod</span></strong><span class="koboSpan" id="kobo.570.1"> command to</span><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.571.1"> modify user settings, with the </span><span class="No-Break"><span class="koboSpan" id="kobo.572.1">following syntax:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.573.1">
usermod [OPTIONS] USER</span></pre> <p><span class="koboSpan" id="kobo.574.1">The examples in this section apply to a user we previously created (</span><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">julian</span></strong><span class="koboSpan" id="kobo.576.1">) with the simplest invocation of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.577.1">useradd</span></strong><span class="koboSpan" id="kobo.578.1"> command. </span><span class="koboSpan" id="kobo.578.2">As noted in the previous section, the related user record in </span><strong class="source-inline"><span class="koboSpan" id="kobo.579.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.580.1"> has no full name for the user, and the user has no </span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">password either.</span></span></p>
<p><span class="koboSpan" id="kobo.582.1">Let’s change the following settings for our </span><span class="No-Break"><span class="koboSpan" id="kobo.583.1">user (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.585.1">):</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.586.1">Full name</span></strong><span class="koboSpan" id="kobo.587.1">: To </span><strong class="source-inline"><span class="koboSpan" id="kobo.588.1">Julian</span></strong><span class="koboSpan" id="kobo.589.1"> (</span><span class="No-Break"><span class="koboSpan" id="kobo.590.1">initially empty)</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.591.1">Home folder</span></strong><span class="koboSpan" id="kobo.592.1">: Move to </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">/local/julian</span></strong><span class="koboSpan" id="kobo.594.1"> (from </span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">default </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">/home/julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">)</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.598.1">Login shell</span></strong><span class="koboSpan" id="kobo.599.1">: </span><strong class="source-inline"><span class="koboSpan" id="kobo.600.1">/bin/bash</span></strong><span class="koboSpan" id="kobo.601.1"> (from </span><span class="No-Break"><span class="koboSpan" id="kobo.602.1">default </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.603.1">/bin/sh</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.604.1">)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.605.1">The command-line utility for changing all the preceding information is </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.607.1">
sudo usermod -c "Julian" -d /local/julian -m -s /bin/bash julian</span></pre> <p><span class="koboSpan" id="kobo.608.1">Here are the command options, </span><span class="No-Break"><span class="koboSpan" id="kobo.609.1">briefly explained:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">-c, --comment "Julian"</span></strong><span class="koboSpan" id="kobo.611.1">: The </span><span class="No-Break"><span class="koboSpan" id="kobo.612.1">full username</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">-d, --home local/julian</span></strong><span class="koboSpan" id="kobo.614.1">: The user’s new </span><span class="No-Break"><span class="koboSpan" id="kobo.615.1">home directory</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">-m, --move</span></strong><span class="koboSpan" id="kobo.617.1">: Move the content of the current home directory to the </span><span class="No-Break"><span class="koboSpan" id="kobo.618.1">new location</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.619.1">-s, --shell /bin/sh</span></strong><span class="koboSpan" id="kobo.620.1">: The user </span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">login shell</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.622.1">The related change, retrieved</span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.623.1"> with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.624.1">getent</span></strong><span class="koboSpan" id="kobo.625.1"> command, is </span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.627.1">
getent passwd julian</span></pre> <p><span class="koboSpan" id="kobo.628.1">We get the </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer095">
<span class="koboSpan" id="kobo.630.1"><img alt="Figure 4.9 – The user changes reflected with getent" src="image/Figure_04_09_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.631.1">Figure 4.9 – The user changes reflected with getent</span></p>
<p><span class="koboSpan" id="kobo.632.1">Here are a few more examples of changing user settings with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.633.1">usermod</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.634.1">command-line utility.</span></span></p>
<h4><span class="koboSpan" id="kobo.635.1">Changing the username</span></h4>
<p><span class="koboSpan" id="kobo.636.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.637.1">-l, --login</span></strong><span class="koboSpan" id="kobo.638.1"> option</span><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.639.1"> parameter of </span><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">usermod</span></strong><span class="koboSpan" id="kobo.641.1"> specifies a new login username. </span><span class="koboSpan" id="kobo.641.2">The following command changes the username from </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">julian</span></strong><span class="koboSpan" id="kobo.643.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.644.1">balog</span></strong><span class="koboSpan" id="kobo.645.1"> (that is, first name to last name), as </span><span class="No-Break"><span class="koboSpan" id="kobo.646.1">illustrated here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.647.1">
sudo usermod -l "balog" julian</span></pre> <p><span class="koboSpan" id="kobo.648.1">In a production environment, we may have to add to the preceding command, as we may also want to change the display name and the home directory of the user (for consistency reasons). </span><span class="koboSpan" id="kobo.648.2">In a previous example in the </span><em class="italic"><span class="koboSpan" id="kobo.649.1">Creating users with useradd</span></em><span class="koboSpan" id="kobo.650.1"> section, we showcased the </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">-d, --home</span></strong><span class="koboSpan" id="kobo.652.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.653.1">-m, --move</span></strong><span class="koboSpan" id="kobo.654.1"> option parameters, which would accommodate </span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">such changes.</span></span></p>
<h4><span class="koboSpan" id="kobo.656.1">Locking or unlocking a user</span></h4>
<p><span class="koboSpan" id="kobo.657.1">A superuser or administrator may choose to</span><a id="_idIndexMarker503"/><span class="koboSpan" id="kobo.658.1"> temporarily or permanently lock a specific user with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.659.1">-L, --lock</span></strong><span class="koboSpan" id="kobo.660.1"> option parameter of </span><strong class="source-inline"><span class="koboSpan" id="kobo.661.1">usermod</span></strong><span class="koboSpan" id="kobo.662.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.663.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.664.1">
sudo usermod -L julian</span></pre> <p><span class="koboSpan" id="kobo.665.1">As a result of the preceding command, the</span><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.666.1"> login attempt for the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.667.1">julian</span></strong><span class="koboSpan" id="kobo.668.1"> would be denied. </span><span class="koboSpan" id="kobo.668.2">Should the user try to SSH into the Linux machine, they would get a </span><strong class="bold"><span class="koboSpan" id="kobo.669.1">Permission denied, please try again</span></strong><span class="koboSpan" id="kobo.670.1"> error message. </span><span class="koboSpan" id="kobo.670.2">Also, the related username will be removed from the login screen if the Linux platform has </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">a GUI.</span></span></p>
<p><span class="koboSpan" id="kobo.672.1">To unlock the user, we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.673.1">-U, --unlock</span></strong><span class="koboSpan" id="kobo.674.1"> option parameter, </span><span class="No-Break"><span class="koboSpan" id="kobo.675.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.676.1">
sudo usermod -U julian</span></pre> <p><span class="koboSpan" id="kobo.677.1">The preceding command restores system access for </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">the user.</span></span></p>
<p><span class="koboSpan" id="kobo.679.1">For more information on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.680.1">usermod</span></strong><span class="koboSpan" id="kobo.681.1"> utility, please check out the related documentation (</span><strong class="source-inline"><span class="koboSpan" id="kobo.682.1">man usermod</span></strong><span class="koboSpan" id="kobo.683.1">) or the command-line help (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.684.1">usermod --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.685.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.686.1">Although the recommended way of modifying user settings is via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.687.1">usermod</span></strong><span class="koboSpan" id="kobo.688.1"> command-line utility, some users may find it easier to manually edit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.689.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.690.1"> file. </span><span class="koboSpan" id="kobo.690.2">The following section shows </span><span class="No-Break"><span class="koboSpan" id="kobo.691.1">you how.</span></span></p>
<h4><span class="koboSpan" id="kobo.692.1">Modifying users via /etc/passwd</span></h4>
<p><span class="koboSpan" id="kobo.693.1">A superuser can also</span><a id="_idIndexMarker505"/><span class="koboSpan" id="kobo.694.1"> manually edit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.695.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.696.1"> file to modify user data by updating the relevant line. </span><span class="koboSpan" id="kobo.696.2">Although the editing can be done with a text editor of your choice (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.697.1">nano</span></strong><span class="koboSpan" id="kobo.698.1">), we recommend the use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.699.1">vipw</span></strong><span class="koboSpan" id="kobo.700.1"> command-line utility for a safer approach. </span><strong class="source-inline"><span class="koboSpan" id="kobo.701.1">vipw</span></strong><span class="koboSpan" id="kobo.702.1"> enables the required locks to prevent possible data corruption—for example, in case a superuser performs a change at the same time regular users change </span><span class="No-Break"><span class="koboSpan" id="kobo.703.1">their password.</span></span></p>
<p><span class="koboSpan" id="kobo.704.1">The following command initiates the editing of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.705.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.706.1"> file by also prompting for the preferred text editor (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.707.1">nano</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.708.1">or </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">vim</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.710.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.711.1">
sudo vipw</span></pre> <p><span class="koboSpan" id="kobo.712.1">For example, we can change the settings for user </span><strong class="source-inline"><span class="koboSpan" id="kobo.713.1">julian</span></strong><span class="koboSpan" id="kobo.714.1"> by editing the </span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">following line:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.716.1">
julian:x:1001:1001:Julian,,,:/home/julian:/bin/bash</span></pre> <p><span class="koboSpan" id="kobo.717.1">The meaning of the colon (</span><strong class="source-inline"><span class="koboSpan" id="kobo.718.1">:</span></strong><span class="koboSpan" id="kobo.719.1">)-separated fields was previously described in the </span><em class="italic"><span class="koboSpan" id="kobo.720.1">Creating users with useradd</span></em><span class="koboSpan" id="kobo.721.1"> section. </span><span class="koboSpan" id="kobo.721.2">Each of these fields can be manually altered in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.722.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.723.1"> file, resulting in changes equivalent to the corresponding </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.724.1">usermod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.725.1"> invocation.</span></span></p>
<p><span class="koboSpan" id="kobo.726.1">For more information on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.727.1">vipw</span></strong><span class="koboSpan" id="kobo.728.1"> command-line utility, you can refer to the related system manual (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.729.1">man vipw</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.730.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.731.1">Another relatively common</span><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.732.1"> administrative task for a user account is to change a password or set up a password expiration. </span><span class="koboSpan" id="kobo.732.2">Although </span><strong class="source-inline"><span class="koboSpan" id="kobo.733.1">usermod</span></strong><span class="koboSpan" id="kobo.734.1"> can change a user password via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.735.1">-p</span></strong><span class="koboSpan" id="kobo.736.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.737.1">--password</span></strong><span class="koboSpan" id="kobo.738.1"> option, it requires an encrypted hash string (and not a cleartext password). </span><span class="koboSpan" id="kobo.738.2">Generating an encrypted password hash would be an extra step. </span><span class="koboSpan" id="kobo.738.3">An easier way is to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">passwd</span></strong><span class="koboSpan" id="kobo.740.1"> utility to change </span><span class="No-Break"><span class="koboSpan" id="kobo.741.1">the password.</span></span></p>
<p><span class="koboSpan" id="kobo.742.1">A superuser (administrator) can change the password of a user (for example, the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.743.1">julian</span></strong><span class="koboSpan" id="kobo.744.1">) with the </span><span class="No-Break"><span class="koboSpan" id="kobo.745.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.746.1">
sudo passwd julian</span></pre> <p><span class="koboSpan" id="kobo.747.1">The output will ask for the new password for the respective user. </span><span class="koboSpan" id="kobo.747.2">To change the expiration time of a password (the password age), the </span><strong class="source-inline"><span class="koboSpan" id="kobo.748.1">chage</span></strong><span class="koboSpan" id="kobo.749.1"> command is used. </span><span class="koboSpan" id="kobo.749.2">For example, to set a 30-day password age for the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.750.1">julian</span></strong><span class="koboSpan" id="kobo.751.1">, we will use the </span><span class="No-Break"><span class="koboSpan" id="kobo.752.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.753.1">
sudo chage -M 30 julian</span></pre> <p><span class="koboSpan" id="kobo.754.1">This will force the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.755.1">julian</span></strong><span class="koboSpan" id="kobo.756.1"> to change their password every month. </span><span class="koboSpan" id="kobo.756.2">The password time availability is defined system-wide by the password policy. </span><span class="koboSpan" id="kobo.756.3">It is found inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.757.1">/etc/login.defs</span></strong><span class="koboSpan" id="kobo.758.1"> file, inside the </span><strong class="bold"><span class="koboSpan" id="kobo.759.1">Password aging controls</span></strong><span class="koboSpan" id="kobo.760.1"> section. </span><span class="koboSpan" id="kobo.760.2">If you change these entries, the password policy will be set for every user. </span><span class="koboSpan" id="kobo.760.3">Another common practice is to force the user to change the password at the first login. </span><span class="koboSpan" id="kobo.760.4">You can enforce this by using the following command (we will use </span><strong class="source-inline"><span class="koboSpan" id="kobo.761.1">julian</span></strong><span class="koboSpan" id="kobo.762.1"> as our </span><span class="No-Break"><span class="koboSpan" id="kobo.763.1">example again):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.764.1">
sudo chage -d 0 julian</span></pre> <p><span class="koboSpan" id="kobo.765.1">This command will force the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.766.1">julian</span></strong><span class="koboSpan" id="kobo.767.1"> to enter their own password the first time they log in to </span><span class="No-Break"><span class="koboSpan" id="kobo.768.1">the system.</span></span></p>
<p><span class="koboSpan" id="kobo.769.1">Sometimes, administrators are required to remove specific users from the system. </span><span class="koboSpan" id="kobo.769.2">The next section shows a couple of ways of accomplishing </span><span class="No-Break"><span class="koboSpan" id="kobo.770.1">this task.</span></span></p>
<h3><span class="koboSpan" id="kobo.771.1">Deleting users</span></h3>
<p><span class="koboSpan" id="kobo.772.1">The most common way to</span><a id="_idIndexMarker507"/><span class="koboSpan" id="kobo.773.1"> remove users from the system is to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.774.1">userdel</span></strong><span class="koboSpan" id="kobo.775.1"> command-line tool. </span><span class="koboSpan" id="kobo.775.2">The general syntax of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.776.1">userdel</span></strong><span class="koboSpan" id="kobo.777.1"> command is </span><span class="No-Break"><span class="koboSpan" id="kobo.778.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.779.1">
userdel [OPTIONS] USER</span></pre> <p><span class="koboSpan" id="kobo.780.1">For example, to remove the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.781.1">julian</span></strong><span class="koboSpan" id="kobo.782.1">, a superuser would run the </span><span class="No-Break"><span class="koboSpan" id="kobo.783.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.784.1">
sudo userdel -f -r julian</span></pre> <p><span class="koboSpan" id="kobo.785.1">Here are the command </span><span class="No-Break"><span class="koboSpan" id="kobo.786.1">options used:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.787.1">-f, --force</span></strong><span class="koboSpan" id="kobo.788.1">: Removes all files in the user’s home directory, even if not owned by </span><span class="No-Break"><span class="koboSpan" id="kobo.789.1">the user</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.790.1">-r, --remove</span></strong><span class="koboSpan" id="kobo.791.1">: Removes the user’s home directory and </span><span class="No-Break"><span class="koboSpan" id="kobo.792.1">mail spool</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.793.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.794.1">userdel</span></strong><span class="koboSpan" id="kobo.795.1"> command removes the related user data from the system, including the user’s home directory (when invoked with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.796.1">-f</span></strong><span class="koboSpan" id="kobo.797.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.798.1">--force</span></strong><span class="koboSpan" id="kobo.799.1"> option) and the related entries in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.800.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.801.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.802.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.803.1">etc/shadow</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.804.1"> files.</span></span></p>
<p><span class="koboSpan" id="kobo.805.1">There is also an alternative way, which could be handy in some odd cleanup scenarios. </span><span class="koboSpan" id="kobo.805.2">The next section </span><span class="No-Break"><span class="koboSpan" id="kobo.806.1">shows how.</span></span></p>
<h4><span class="koboSpan" id="kobo.807.1">Deleting users via /etc/passwd and /etc/shadow</span></h4>
<p><span class="koboSpan" id="kobo.808.1">A superuser can edit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.809.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.810.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.811.1">/etc/shadow</span></strong><span class="koboSpan" id="kobo.812.1"> files and manually remove the corresponding</span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.813.1"> lines for the user (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.814.1">julian</span></strong><span class="koboSpan" id="kobo.815.1">). </span><span class="koboSpan" id="kobo.815.2">Please note that both files have to be edited for consistency and complete removal of the related </span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">user account.</span></span></p>
<p><span class="koboSpan" id="kobo.817.1">Edit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.818.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.819.1"> file using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.820.1">vipw</span></strong><span class="koboSpan" id="kobo.821.1"> command-line utility, </span><span class="No-Break"><span class="koboSpan" id="kobo.822.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.823.1">
sudo vipw</span></pre> <p><span class="koboSpan" id="kobo.824.1">Remove the following line (for the </span><span class="No-Break"><span class="koboSpan" id="kobo.825.1">user </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.826.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.827.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.828.1">
julian:x:1001:1001:Julian,,,:/home/julian:/bin/bash</span></pre> <p><span class="koboSpan" id="kobo.829.1">Next, edit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.830.1">/etc/shadow</span></strong><span class="koboSpan" id="kobo.831.1"> file using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.832.1">-s</span></strong><span class="koboSpan" id="kobo.833.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.834.1">--shadow</span></strong><span class="koboSpan" id="kobo.835.1"> option with </span><strong class="source-inline"><span class="koboSpan" id="kobo.836.1">vipw</span></strong><span class="koboSpan" id="kobo.837.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.838.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.839.1">
sudo vipw -s</span></pre> <p><span class="koboSpan" id="kobo.840.1">Remove the following line (for the </span><span class="No-Break"><span class="koboSpan" id="kobo.841.1">user </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.842.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.843.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.844.1">
julian:$6$xDdd7Eay/RKYjeTm$Sf.../:18519:0:99999:7:::</span></pre> <p><span class="koboSpan" id="kobo.845.1">After editing the preceding files, a superuser may also need to remove the deleted user’s home directory, </span><span class="No-Break"><span class="koboSpan" id="kobo.846.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.847.1">
sudo rm -rf /home/julian</span></pre> <p><span class="koboSpan" id="kobo.848.1">For more information on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.849.1">userdel</span></strong><span class="koboSpan" id="kobo.850.1"> utility, please check out the related documentation (</span><strong class="source-inline"><span class="koboSpan" id="kobo.851.1">man userdel</span></strong><span class="koboSpan" id="kobo.852.1">) or the command-line help (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.853.1">userdel --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.854.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.855.1">The user management concepts and commands learned so far apply exclusively to individual users in the system. </span><span class="koboSpan" id="kobo.855.2">When multiple users in the system have a common access level or permission attribute, they</span><a id="_idIndexMarker509"/><span class="koboSpan" id="kobo.856.1"> are collectively referred to as a group. </span><span class="koboSpan" id="kobo.856.2">Groups can be regarded as standalone organizational units we can create, modify, or delete. </span><span class="koboSpan" id="kobo.856.3">We can also define and alter user memberships associated with groups. </span><span class="koboSpan" id="kobo.856.4">The next section focuses on group </span><span class="No-Break"><span class="koboSpan" id="kobo.857.1">management internals.</span></span></p>
<h1 id="_idParaDest-81"><a id="_idTextAnchor097"/><span class="koboSpan" id="kobo.858.1">Managing groups</span></h1>
<p><span class="koboSpan" id="kobo.859.1">Linux uses groups to </span><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.860.1">organize users. </span><span class="koboSpan" id="kobo.860.2">Simply put, a group is a collection of users sharing a common attribute. </span><span class="koboSpan" id="kobo.860.3">Examples of such groups could be </span><em class="italic"><span class="koboSpan" id="kobo.861.1">employees</span></em><span class="koboSpan" id="kobo.862.1">, </span><em class="italic"><span class="koboSpan" id="kobo.863.1">developers</span></em><span class="koboSpan" id="kobo.864.1">, </span><em class="italic"><span class="koboSpan" id="kobo.865.1">managers</span></em><span class="koboSpan" id="kobo.866.1">, and so on. </span><span class="koboSpan" id="kobo.866.2">In Linux, a group is uniquely identified by a GID. </span><span class="koboSpan" id="kobo.866.3">Users within the same group share the </span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">same GID.</span></span></p>
<p><span class="koboSpan" id="kobo.868.1">From a user’s perspective, there are two types of groups, </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">outlined here:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.870.1">Primary group</span></strong><span class="koboSpan" id="kobo.871.1">: The user’s</span><a id="_idIndexMarker511"/><span class="koboSpan" id="kobo.872.1"> initial (default) </span><span class="No-Break"><span class="koboSpan" id="kobo.873.1">login group</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.874.1">Supplementary groups</span></strong><span class="koboSpan" id="kobo.875.1">: A list of groups the </span><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.876.1">user is also a </span><a id="_idIndexMarker513"/><span class="koboSpan" id="kobo.877.1">member of; also known as </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.878.1">secondary groups</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.879.1">Every Linux user is a member of a primary group. </span><span class="koboSpan" id="kobo.879.2">A user can belong to multiple supplementary groups or no supplementary groups at all. </span><span class="koboSpan" id="kobo.879.3">In other words, there is one mandatory primary group associated with each Linux user, and a user can have multiple or no supplementary </span><span class="No-Break"><span class="koboSpan" id="kobo.880.1">group memberships.</span></span></p>
<p><span class="koboSpan" id="kobo.881.1">From a practical point of view, we can look at groups as a permissive context of collaboration for a select number of users. </span><span class="koboSpan" id="kobo.881.2">Imagine a </span><em class="italic"><span class="koboSpan" id="kobo.882.1">developers</span></em><span class="koboSpan" id="kobo.883.1"> group having access to developer-specific resources. </span><span class="koboSpan" id="kobo.883.2">Each</span><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.884.1"> user in this group has access to these resources. </span><span class="koboSpan" id="kobo.884.2">Users outside the </span><em class="italic"><span class="koboSpan" id="kobo.885.1">developers</span></em><span class="koboSpan" id="kobo.886.1"> group may not have access unless they authenticate with a group password if the group </span><span class="No-Break"><span class="koboSpan" id="kobo.887.1">has one.</span></span></p>
<p><span class="koboSpan" id="kobo.888.1">In the following section, we provide detailed examples of how to manage groups and set up group memberships for users. </span><span class="koboSpan" id="kobo.888.2">Most related commands require </span><em class="italic"><span class="koboSpan" id="kobo.889.1">superuser</span></em><span class="koboSpan" id="kobo.890.1"> or </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.891.1">sudo</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.892.1"> privileges.</span></span></p>
<h2 id="_idParaDest-82"><a id="_idTextAnchor098"/><span class="koboSpan" id="kobo.893.1">Creating, modifying, and deleting groups</span></h2>
<p><span class="koboSpan" id="kobo.894.1">While our primary focus remains on</span><a id="_idIndexMarker515"/><span class="koboSpan" id="kobo.895.1"> group administrative tasks, some related operations </span><a id="_idIndexMarker516"/><span class="koboSpan" id="kobo.896.1">still involve user-related commands. </span><span class="koboSpan" id="kobo.896.2">Command-line utilities such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.897.1">groupadd</span></strong><span class="koboSpan" id="kobo.898.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.899.1">groupmod</span></strong><span class="koboSpan" id="kobo.900.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.901.1">groupdel</span></strong><span class="koboSpan" id="kobo.902.1"> are targeted strictly at creating, modifying, and </span><a id="_idIndexMarker517"/><span class="koboSpan" id="kobo.903.1">deleting groups, respectively. </span><span class="koboSpan" id="kobo.903.2">On the other hand, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.904.1">useradd</span></strong><span class="koboSpan" id="kobo.905.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.906.1">usermod</span></strong><span class="koboSpan" id="kobo.907.1"> commands carry group-specific options when associating users with groups. </span><span class="koboSpan" id="kobo.907.2">We’ll also introduce you to </span><strong class="source-inline"><span class="koboSpan" id="kobo.908.1">gpasswd</span></strong><span class="koboSpan" id="kobo.909.1">, a command-line tool specializing in group administration, combining user- and </span><span class="No-Break"><span class="koboSpan" id="kobo.910.1">group-related operations.</span></span></p>
<p><span class="koboSpan" id="kobo.911.1">With this aspect in mind, let’s take a look at how to create, modify, and delete groups and how to manipulate group memberships </span><span class="No-Break"><span class="koboSpan" id="kobo.912.1">for users.</span></span></p>
<h3><span class="koboSpan" id="kobo.913.1">Creating groups</span></h3>
<p><span class="koboSpan" id="kobo.914.1">To create a new group, a</span><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.915.1"> superuser invokes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.916.1">groupadd</span></strong><span class="koboSpan" id="kobo.917.1"> command-line utility. </span><span class="koboSpan" id="kobo.917.2">Here’s the basic syntax of the </span><span class="No-Break"><span class="koboSpan" id="kobo.918.1">related command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.919.1">
groupadd [OPTIONS] GROUP</span></pre> <p><span class="koboSpan" id="kobo.920.1">Let’s create a new group (</span><strong class="source-inline"><span class="koboSpan" id="kobo.921.1">developers</span></strong><span class="koboSpan" id="kobo.922.1">), with default settings, </span><span class="No-Break"><span class="koboSpan" id="kobo.923.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.924.1">
sudo groupadd developers</span></pre> <p><span class="koboSpan" id="kobo.925.1">The group information is stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.926.1">/etc/group</span></strong><span class="koboSpan" id="kobo.927.1"> file. </span><span class="koboSpan" id="kobo.927.2">Here’s the related data for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.928.1">developers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.929.1"> group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.930.1">
cat /etc/group | grep developers</span></pre> <p><span class="koboSpan" id="kobo.931.1">The command yields the </span><span class="No-Break"><span class="koboSpan" id="kobo.932.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer096">
<span class="koboSpan" id="kobo.933.1"><img alt="Figure 4.10 – The group with default attributes" src="image/Figure_04_10_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.934.1">Figure 4.10 – The group with default attributes</span></p>
<p><span class="koboSpan" id="kobo.935.1">Let’s analyze the related group record. </span><span class="koboSpan" id="kobo.935.2">Each entry is delimited by a colon (</span><strong class="source-inline"><span class="koboSpan" id="kobo.936.1">:</span></strong><span class="koboSpan" id="kobo.937.1">) and is </span><span class="No-Break"><span class="koboSpan" id="kobo.938.1">listed here:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.939.1">developers</span></strong><span class="koboSpan" id="kobo.940.1">: </span><span class="No-Break"><span class="koboSpan" id="kobo.941.1">Group name</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.942.1">x</span></strong><span class="koboSpan" id="kobo.943.1">: Encrypted password (password hash is stored </span><span class="No-Break"><span class="koboSpan" id="kobo.944.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.945.1">/etc/gshadow</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.946.1">)</span></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.947.1">1003</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.948.1">: GID</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.949.1">We can also use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.950.1">getent</span></strong><span class="koboSpan" id="kobo.951.1"> command to retrieve the preceding group information, </span><span class="No-Break"><span class="koboSpan" id="kobo.952.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.953.1">
getent group developers</span></pre> <p><span class="koboSpan" id="kobo.954.1">A superuser may choose to create a group with a specific GID, using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.955.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.956.1"> option parameter with </span><strong class="source-inline"><span class="koboSpan" id="kobo.957.1">groupadd</span></strong><span class="koboSpan" id="kobo.958.1">. </span><span class="koboSpan" id="kobo.958.2">For example, the following command creates the </span><strong class="source-inline"><span class="koboSpan" id="kobo.959.1">developers</span></strong><span class="koboSpan" id="kobo.960.1"> group (if it doesn’t exist) with a GID </span><span class="No-Break"><span class="koboSpan" id="kobo.961.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.962.1">1200</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.963.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.964.1">
sudo groupadd -g 1200 developers</span></pre> <p><span class="koboSpan" id="kobo.965.1">For more information on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.966.1">groupadd</span></strong><span class="koboSpan" id="kobo.967.1"> command-line utility, please refer to the related documentation (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.968.1">man groupadd</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.969.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.970.1">Group-related data is stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.971.1">/etc/group</span></strong><span class="koboSpan" id="kobo.972.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">/etc/gshadow</span></strong><span class="koboSpan" id="kobo.974.1"> files. </span><span class="koboSpan" id="kobo.974.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.975.1">/etc/group</span></strong><span class="koboSpan" id="kobo.976.1"> file contains</span><a id="_idIndexMarker519"/><span class="koboSpan" id="kobo.977.1"> generic group membership information, while the </span><strong class="source-inline"><span class="koboSpan" id="kobo.978.1">/etc/gshadow</span></strong><span class="koboSpan" id="kobo.979.1"> file stores the encrypted password hashes for each group. </span><span class="koboSpan" id="kobo.979.2">Let’s take a brief look at </span><span class="No-Break"><span class="koboSpan" id="kobo.980.1">group passwords.</span></span></p>
<h4><span class="koboSpan" id="kobo.981.1">Understanding group passwords</span></h4>
<p><span class="koboSpan" id="kobo.982.1">By default, a group doesn’t have a password when created with the simplest invocation</span><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.983.1"> of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.984.1">groupadd</span></strong><span class="koboSpan" id="kobo.985.1"> command (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.986.1">groupadd developers</span></strong><span class="koboSpan" id="kobo.987.1">). </span><span class="koboSpan" id="kobo.987.2">Although </span><strong class="source-inline"><span class="koboSpan" id="kobo.988.1">groupadd</span></strong><span class="koboSpan" id="kobo.989.1"> supports an encrypted password (via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.990.1">-p, --password</span></strong><span class="koboSpan" id="kobo.991.1"> option parameter), this would require an extra step to generate a secure password hash. </span><span class="koboSpan" id="kobo.991.2">There’s a better and simpler way to create a group password: by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.992.1">gpasswd</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.993.1">command-line utility.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.994.1">Important note</span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.995.1">gpasswd</span></strong><span class="koboSpan" id="kobo.996.1"> is a command-line tool that helps with everyday group </span><span class="No-Break"><span class="koboSpan" id="kobo.997.1">administration tasks.</span></span></p>
<p><span class="koboSpan" id="kobo.998.1">The following command creates a password for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.999.1">developers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1000.1"> group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1001.1">
sudo gpasswd developers</span></pre> <p><span class="koboSpan" id="kobo.1002.1">We get prompted to enter and re-enter a password, as </span><span class="No-Break"><span class="koboSpan" id="kobo.1003.1">illustrated here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer097">
<span class="koboSpan" id="kobo.1004.1"><img alt="Figure 4.11 – Creating a password for the developers group" src="image/Figure_04_11_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1005.1">Figure 4.11 – Creating a password for the developers group</span></p>
<p><span class="koboSpan" id="kobo.1006.1">The purpose of a group password is to protect access to group resources. </span><span class="koboSpan" id="kobo.1006.2">A group password is inherently insecure when shared among group members, yet a Linux administrator may choose to keep the group password private while group members collaborate unhindered within the group’s </span><span class="No-Break"><span class="koboSpan" id="kobo.1007.1">security context.</span></span></p>
<p><span class="koboSpan" id="kobo.1008.1">Here’s a quick explanation of how it works. </span><span class="koboSpan" id="kobo.1008.2">When a member of a specific group (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1009.1">developers</span></strong><span class="koboSpan" id="kobo.1010.1">) logs in to that group (using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1011.1">newgrp</span></strong><span class="koboSpan" id="kobo.1012.1"> command), the user is not prompted for the group password. </span><span class="koboSpan" id="kobo.1012.2">When users who don’t belong to the group attempt to log in, they will be prompted for the </span><span class="No-Break"><span class="koboSpan" id="kobo.1013.1">group password.</span></span></p>
<p><span class="koboSpan" id="kobo.1014.1">In general, a group can have </span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.1015.1">administrators, members, and a password. </span><span class="koboSpan" id="kobo.1015.2">Members of a group who are the group’s administrators may use </span><strong class="source-inline"><span class="koboSpan" id="kobo.1016.1">gpasswd</span></strong><span class="koboSpan" id="kobo.1017.1"> without being prompted for a password, as long as they’re logged in to the group. </span><span class="koboSpan" id="kobo.1017.2">Also, group administrators don’t need superuser privileges to perform group administrative tasks for a group they are the </span><span class="No-Break"><span class="koboSpan" id="kobo.1018.1">administrator of.</span></span></p>
<p><span class="koboSpan" id="kobo.1019.1">We’ll take a closer look at </span><strong class="source-inline"><span class="koboSpan" id="kobo.1020.1">gpasswd</span></strong><span class="koboSpan" id="kobo.1021.1"> in the next sections, where we further focus on group management tasks, as well as adding users to</span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.1022.1"> a group and removing users from a group. </span><span class="koboSpan" id="kobo.1022.2">But for now, let’s keep our attention strictly at the group level and see how we can modify a </span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">user group.</span></span></p>
<h3><span class="koboSpan" id="kobo.1024.1">Modifying groups</span></h3>
<p><span class="koboSpan" id="kobo.1025.1">The most common way to modify the</span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.1026.1"> definition of a group is via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1027.1">groupmod</span></strong><span class="koboSpan" id="kobo.1028.1"> command-line utility. </span><span class="koboSpan" id="kobo.1028.2">Here’s the basic syntax for </span><span class="No-Break"><span class="koboSpan" id="kobo.1029.1">the command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1030.1">
groupmod [OPTIONS] GROUP</span></pre> <p><span class="koboSpan" id="kobo.1031.1">The most common operations when changing a group’s definition are related to the GID, group name, and group password. </span><span class="koboSpan" id="kobo.1031.2">Let’s take a look at each of these changes. </span><span class="koboSpan" id="kobo.1031.3">We assume our previously created group is named </span><strong class="source-inline"><span class="koboSpan" id="kobo.1032.1">developers</span></strong><span class="koboSpan" id="kobo.1033.1">, with a GID </span><span class="No-Break"><span class="koboSpan" id="kobo.1034.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1035.1">1003</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1036.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1037.1">To change the GID to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1038.1">1200</span></strong><span class="koboSpan" id="kobo.1039.1">, a superuser invokes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1040.1">groupmod</span></strong><span class="koboSpan" id="kobo.1041.1"> command with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1042.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.1043.1"> option parameter, </span><span class="No-Break"><span class="koboSpan" id="kobo.1044.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1045.1">
sudo groupmod -g </span><strong class="bold"><span class="koboSpan" id="kobo.1046.1">1200</span></strong><span class="koboSpan" id="kobo.1047.1"> developers</span></pre> <p><span class="koboSpan" id="kobo.1048.1">To change the group name from </span><strong class="source-inline"><span class="koboSpan" id="kobo.1049.1">developers</span></strong><span class="koboSpan" id="kobo.1050.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1051.1">devops</span></strong><span class="koboSpan" id="kobo.1052.1">, we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1053.1">-n, --new-name</span></strong><span class="koboSpan" id="kobo.1054.1"> option, </span><span class="No-Break"><span class="koboSpan" id="kobo.1055.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1056.1">
sudo groupmod -n </span><strong class="bold"><span class="koboSpan" id="kobo.1057.1">devops</span></strong><span class="koboSpan" id="kobo.1058.1"> developers</span></pre> <p><span class="koboSpan" id="kobo.1059.1">We can verify the preceding changes for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1060.1">devops</span></strong><span class="koboSpan" id="kobo.1061.1"> group with the </span><span class="No-Break"><span class="koboSpan" id="kobo.1062.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1063.1">
getent group </span><strong class="bold"><span class="koboSpan" id="kobo.1064.1">devops</span></strong></pre> <p><span class="koboSpan" id="kobo.1065.1">The command yields the </span><span class="No-Break"><span class="koboSpan" id="kobo.1066.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer098">
<span class="koboSpan" id="kobo.1067.1"><img alt="Figure 4.12 – Verifying the group changes" src="image/Figure_04_12_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1068.1">Figure 4.12 – Verifying the group changes</span></p>
<p><span class="koboSpan" id="kobo.1069.1">To change the group password for </span><strong class="source-inline"><span class="koboSpan" id="kobo.1070.1">devops</span></strong><span class="koboSpan" id="kobo.1071.1">, the simplest way is to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.1072.1">gpasswd</span></strong><span class="koboSpan" id="kobo.1073.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.1074.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1075.1">
sudo gpasswd devops</span></pre> <p><span class="koboSpan" id="kobo.1076.1">We are prompted to enter and</span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.1077.1"> re-enter </span><span class="No-Break"><span class="koboSpan" id="kobo.1078.1">a password.</span></span></p>
<p><span class="koboSpan" id="kobo.1079.1">To remove the group password for </span><strong class="source-inline"><span class="koboSpan" id="kobo.1080.1">devops</span></strong><span class="koboSpan" id="kobo.1081.1">, we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1082.1">gpasswd</span></strong><span class="koboSpan" id="kobo.1083.1"> command with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1084.1">-r, --remove-password</span></strong><span class="koboSpan" id="kobo.1085.1"> option, </span><span class="No-Break"><span class="koboSpan" id="kobo.1086.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1087.1">
sudo gpasswd -r devops</span></pre> <p><span class="koboSpan" id="kobo.1088.1">As the command has no visible outcome or message, we will be prompted back to </span><span class="No-Break"><span class="koboSpan" id="kobo.1089.1">the shell:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer099">
<span class="koboSpan" id="kobo.1090.1"><img alt="Figure 4.13 – Setting a new group password and removing a group password" src="image/Figure_04_13_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1091.1">Figure 4.13 – Setting a new group password and removing a group password</span></p>
<p><span class="koboSpan" id="kobo.1092.1">For more information on </span><strong class="source-inline"><span class="koboSpan" id="kobo.1093.1">groupmod</span></strong><span class="koboSpan" id="kobo.1094.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1095.1">gpasswd</span></strong><span class="koboSpan" id="kobo.1096.1">, refer to the system manuals of these utilities (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1097.1">man groupmod</span></strong><span class="koboSpan" id="kobo.1098.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1099.1">man gpasswd</span></strong><span class="koboSpan" id="kobo.1100.1">), or simply invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1101.1">-h, --help</span></strong><span class="koboSpan" id="kobo.1102.1"> option </span><span class="No-Break"><span class="koboSpan" id="kobo.1103.1">for each.</span></span></p>
<p><span class="koboSpan" id="kobo.1104.1">Next, we look at how to </span><span class="No-Break"><span class="koboSpan" id="kobo.1105.1">delete groups.</span></span></p>
<h3><span class="koboSpan" id="kobo.1106.1">Deleting groups</span></h3>
<p><span class="koboSpan" id="kobo.1107.1">To delete </span><a id="_idIndexMarker525"/><span class="koboSpan" id="kobo.1108.1">groups, we use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1109.1">groupdel</span></strong><span class="koboSpan" id="kobo.1110.1"> command-line utility. </span><span class="koboSpan" id="kobo.1110.2">The related syntax is </span><span class="No-Break"><span class="koboSpan" id="kobo.1111.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1112.1">
groupdel [OPTIONS] GROUP</span></pre> <p><span class="koboSpan" id="kobo.1113.1">By default, Linux enforces referential integrity between a primary group and the users associated with that primary group. </span><span class="koboSpan" id="kobo.1113.2">We cannot delete a group that has been assigned as a primary group for some users before deleting the users of that primary group. </span><span class="koboSpan" id="kobo.1113.3">In other words, by default, Linux doesn’t want to leave the users with dangling </span><span class="No-Break"><span class="koboSpan" id="kobo.1114.1">primary GIDs.</span></span></p>
<p><span class="koboSpan" id="kobo.1115.1">For example, when we first added the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1116.1">julian</span></strong><span class="koboSpan" id="kobo.1117.1">, they were assigned automatically to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1118.1">julian</span></strong><span class="koboSpan" id="kobo.1119.1"> primary group. </span><span class="koboSpan" id="kobo.1119.2">We then added the user to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1120.1">sudoers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1121.1"> group.</span></span></p>
<p><span class="koboSpan" id="kobo.1122.1">Let’s attempt to add the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1123.1">julian</span></strong><span class="koboSpan" id="kobo.1124.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1125.1">devops</span></strong><span class="koboSpan" id="kobo.1126.1"> group. </span><span class="koboSpan" id="kobo.1126.2">A superuser may run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1127.1">usermod</span></strong><span class="koboSpan" id="kobo.1128.1"> command with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1129.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.1130.1"> option parameter to </span><em class="italic"><span class="koboSpan" id="kobo.1131.1">change</span></em><span class="koboSpan" id="kobo.1132.1"> the primary group of a user. </span><span class="koboSpan" id="kobo.1132.2">The command should be invoked for each user. </span><span class="koboSpan" id="kobo.1132.3">Here’s an example of removing the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1133.1">julian</span></strong><span class="koboSpan" id="kobo.1134.1"> from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1135.1">julian</span></strong><span class="koboSpan" id="kobo.1136.1"> primary group. </span><span class="koboSpan" id="kobo.1136.2">First, let’s get the current data for the user, </span><span class="No-Break"><span class="koboSpan" id="kobo.1137.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1138.1">
id julian</span></pre> <p><span class="koboSpan" id="kobo.1139.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1140.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer100">
<span class="koboSpan" id="kobo.1141.1"><img alt="Figure 4.14 – Retrieving the current primary group for the user" src="image/Figure_04_14_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1142.1">Figure 4.14 – Retrieving the current primary group for the user</span></p>
<p><span class="koboSpan" id="kobo.1143.1">Now, let us add the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1144.1">julian</span></strong><span class="koboSpan" id="kobo.1145.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1146.1">devops</span></strong><span class="koboSpan" id="kobo.1147.1"> group. </span><span class="koboSpan" id="kobo.1147.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1148.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.1149.1"> option parameter of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1150.1">usermod</span></strong><span class="koboSpan" id="kobo.1151.1"> command accepts both a </span><em class="italic"><span class="koboSpan" id="kobo.1152.1">GID</span></em><span class="koboSpan" id="kobo.1153.1"> and a group </span><em class="italic"><span class="koboSpan" id="kobo.1154.1">name</span></em><span class="koboSpan" id="kobo.1155.1">. </span><span class="koboSpan" id="kobo.1155.2">The specified group name must already be present </span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.1156.1">in the system; otherwise, the command will fail. </span><span class="koboSpan" id="kobo.1156.2">If we want to change the primary group (for example, to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1157.1">devops</span></strong><span class="koboSpan" id="kobo.1158.1">), we simply specify the group name in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1159.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.1160.1"> option parameter, </span><span class="No-Break"><span class="koboSpan" id="kobo.1161.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1162.1">
sudo usermod -g devops julian</span></pre> <p><span class="koboSpan" id="kobo.1163.1">The output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1164.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer101">
<span class="koboSpan" id="kobo.1165.1"><img alt="Figure 4.15 – Changing the primary group of the user" src="image/Figure_04_15_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1166.1">Figure 4.15 – Changing the primary group of the user</span></p>
<p><span class="koboSpan" id="kobo.1167.1">The result is that the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1168.1">julian</span></strong><span class="koboSpan" id="kobo.1169.1"> is now part of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1170.1">devops</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1171.1"> group.</span></span></p>
<p><span class="koboSpan" id="kobo.1172.1">Now, let us attempt to delete the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1173.1">devops</span></strong><span class="koboSpan" id="kobo.1174.1"> group, which is the primary group for the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1175.1">julian</span></strong><span class="koboSpan" id="kobo.1176.1">. </span><span class="koboSpan" id="kobo.1176.2">Attempting to delete the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1177.1">devops</span></strong><span class="koboSpan" id="kobo.1178.1"> group results in an error, as can be seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1179.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1180.1">.16</span></em><span class="koboSpan" id="kobo.1181.1"> (the first command used). </span><span class="koboSpan" id="kobo.1181.2">Therefore, we cannot delete a group that is </span><span class="No-Break"><span class="koboSpan" id="kobo.1182.1">not empty.</span></span></p>
<p><span class="koboSpan" id="kobo.1183.1">A superuser may choose to </span><em class="italic"><span class="koboSpan" id="kobo.1184.1">force</span></em><span class="koboSpan" id="kobo.1185.1"> the deletion of a primary group, invoking </span><strong class="source-inline"><span class="koboSpan" id="kobo.1186.1">groupdel</span></strong><span class="koboSpan" id="kobo.1187.1"> with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1188.1">-f, --force</span></strong><span class="koboSpan" id="kobo.1189.1"> option, but this would be ill advised. </span><span class="koboSpan" id="kobo.1189.2">This is because the command would result in users with orphaned primary GIDs and a possible security hole in the system. </span><span class="koboSpan" id="kobo.1189.3">The maintenance and</span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.1190.1"> removal of such users would also </span><span class="No-Break"><span class="koboSpan" id="kobo.1191.1">become problematic.</span></span></p>
<p><span class="koboSpan" id="kobo.1192.1">In order to be able to delete the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1193.1">devops</span></strong><span class="koboSpan" id="kobo.1194.1"> group, we need to assign another group to the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1195.1">julian</span></strong><span class="koboSpan" id="kobo.1196.1">. </span><span class="koboSpan" id="kobo.1196.2">What we can do is assign it to the initial primary group called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1197.1">julian</span></strong><span class="koboSpan" id="kobo.1198.1">, and then attempt to delete the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1199.1">devops</span></strong><span class="koboSpan" id="kobo.1200.1"> group, now that it is empty. </span><span class="koboSpan" id="kobo.1200.2">First, let us assign the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1201.1">julian</span></strong><span class="koboSpan" id="kobo.1202.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1203.1">julian</span></strong><span class="koboSpan" id="kobo.1204.1"> group with the </span><span class="No-Break"><span class="koboSpan" id="kobo.1205.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1206.1">
sudo usermod -g julian julian</span></pre> <p><span class="koboSpan" id="kobo.1207.1">At this point, it’s safe to delete the group (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1208.1">devops</span></strong><span class="koboSpan" id="kobo.1209.1">), </span><span class="No-Break"><span class="koboSpan" id="kobo.1210.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1211.1">
sudo groupdel devops</span></pre> <p><span class="koboSpan" id="kobo.1212.1">The outcome from the preceding commands </span><span class="No-Break"><span class="koboSpan" id="kobo.1213.1">is this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer102">
<span class="koboSpan" id="kobo.1214.1"><img alt="Figure 4.16 – Successful attempt to delete the group" src="image/Figure_04_16_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1215.1">Figure 4.16 – Successful attempt to delete the group</span></p>
<p><span class="koboSpan" id="kobo.1216.1">For more information on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1217.1">groupdel</span></strong><span class="koboSpan" id="kobo.1218.1"> command-line utility, check out the related system manual (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1219.1">man groupdel</span></strong><span class="koboSpan" id="kobo.1220.1">), or simply invoke </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1221.1">groupdel --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1222.1">.</span></span></p>
<h4><span class="koboSpan" id="kobo.1223.1">Modifying groups via /etc/group</span></h4>
<p><span class="koboSpan" id="kobo.1224.1">An administrator can also</span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.1225.1"> manually edit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1226.1">/etc/group</span></strong><span class="koboSpan" id="kobo.1227.1"> file to modify group data by updating the related line. </span><span class="koboSpan" id="kobo.1227.2">Although the editing can be done with a text editor of your choice (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1228.1">nano</span></strong><span class="koboSpan" id="kobo.1229.1">), we recommend the use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1230.1">vigr</span></strong><span class="koboSpan" id="kobo.1231.1"> command-line utility for a safer approach. </span><strong class="source-inline"><span class="koboSpan" id="kobo.1232.1">vigr</span></strong><span class="koboSpan" id="kobo.1233.1"> is similar to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1234.1">vipr</span></strong><span class="koboSpan" id="kobo.1235.1"> (for modifying </span><strong class="source-inline"><span class="koboSpan" id="kobo.1236.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.1237.1">) and sets safety locks to prevent possible data corruption during concurrent changes of </span><span class="No-Break"><span class="koboSpan" id="kobo.1238.1">group data.</span></span></p>
<p><span class="koboSpan" id="kobo.1239.1">The following command opens the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1240.1">/etc/group</span></strong><span class="koboSpan" id="kobo.1241.1"> file for editing by also prompting for the preferred text editor (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1242.1">nano</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1243.1">or </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1244.1">vim</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1245.1">):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1246.1">
sudo vigr</span></pre> <p><span class="koboSpan" id="kobo.1247.1">For example, we can change the settings for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1248.1">developers</span></strong><span class="koboSpan" id="kobo.1249.1"> group by editing the </span><span class="No-Break"><span class="koboSpan" id="kobo.1250.1">following line:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1251.1">
developers:x:1200:julian,alex</span></pre> <p><span class="koboSpan" id="kobo.1252.1">When deleting groups</span><a id="_idIndexMarker529"/><span class="koboSpan" id="kobo.1253.1"> using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1254.1">vigr</span></strong><span class="koboSpan" id="kobo.1255.1"> command, we’re also prompted to remove the corresponding entry in the group shadow file </span><strong class="source-inline"><span class="koboSpan" id="kobo.1256.1">(/etc/gshadow</span></strong><span class="koboSpan" id="kobo.1257.1">). </span><span class="koboSpan" id="kobo.1257.2">The related command invokes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1258.1">-s</span></strong><span class="koboSpan" id="kobo.1259.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.1260.1">--shadow</span></strong><span class="koboSpan" id="kobo.1261.1"> option, as </span><span class="No-Break"><span class="koboSpan" id="kobo.1262.1">illustrated here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1263.1">
sudo vigr -s</span></pre> <p><span class="koboSpan" id="kobo.1264.1">For more information on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1265.1">vigr</span></strong><span class="koboSpan" id="kobo.1266.1"> utility, please refer to the related system manual (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1267.1">man vigr</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1268.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1269.1">As with most Linux tasks, all the preceding tasks could have been accomplished in different ways. </span><span class="koboSpan" id="kobo.1269.2">The commands chosen are the most common ones, but there might be cases when a different approach may prove </span><span class="No-Break"><span class="koboSpan" id="kobo.1270.1">more appropriate.</span></span></p>
<p><span class="koboSpan" id="kobo.1271.1">In the next section, we’ll take a glance at how to add users to primary and secondary groups and how to remove users from </span><span class="No-Break"><span class="koboSpan" id="kobo.1272.1">these groups.</span></span></p>
<h3><span class="koboSpan" id="kobo.1273.1">Managing users in groups</span></h3>
<p><span class="koboSpan" id="kobo.1274.1">So far, we’ve only created</span><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.1275.1"> groups that have no users associated. </span><span class="koboSpan" id="kobo.1275.2">There is not much use for empty user groups, so let’s add some users </span><span class="No-Break"><span class="koboSpan" id="kobo.1276.1">to them.</span></span></p>
<h4><span class="koboSpan" id="kobo.1277.1">Adding users to a group</span></h4>
<p><span class="koboSpan" id="kobo.1278.1">Before we start adding</span><a id="_idIndexMarker531"/><span class="koboSpan" id="kobo.1279.1"> users to a group, let’s create a few groups. </span><span class="koboSpan" id="kobo.1279.2">In the following example, we </span><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.1280.1">create the groups by also specifying their GID (via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1281.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.1282.1"> option parameter of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1283.1">groupadd</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1284.1"> command):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1285.1">
sudo groupadd -g 1100 admin
sudo groupadd -g 1200 developers
sudo groupadd -g 1300 devops</span></pre> <p><span class="koboSpan" id="kobo.1286.1">We can check the last groups created by using the </span><span class="No-Break"><span class="koboSpan" id="kobo.1287.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1288.1">
cat /etc/group | tail -n 5</span></pre> <p><span class="koboSpan" id="kobo.1289.1">It will show us the last five lines of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1290.1">/etc/group</span></strong><span class="koboSpan" id="kobo.1291.1"> file. </span><span class="koboSpan" id="kobo.1291.2">We can see the last five </span><span class="No-Break"><span class="koboSpan" id="kobo.1292.1">groups created.</span></span></p>
<p><span class="koboSpan" id="kobo.1293.1">Next, we create a couple of new users (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1294.1">alex2</span></strong><span class="koboSpan" id="kobo.1295.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1296.1">julian2</span></strong><span class="koboSpan" id="kobo.1297.1"> as we already have users </span><strong class="source-inline"><span class="koboSpan" id="kobo.1298.1">alex</span></strong><span class="koboSpan" id="kobo.1299.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1300.1">julian</span></strong><span class="koboSpan" id="kobo.1301.1">) and add them to some of the groups we just created. </span><span class="koboSpan" id="kobo.1301.2">We’ll have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1302.1">admin</span></strong><span class="koboSpan" id="kobo.1303.1"> group set as the </span><em class="italic"><span class="koboSpan" id="kobo.1304.1">primary group</span></em><span class="koboSpan" id="kobo.1305.1"> for both users, while the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1306.1">developers</span></strong><span class="koboSpan" id="kobo.1307.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1308.1">devops</span></strong><span class="koboSpan" id="kobo.1309.1"> groups are defined as </span><em class="italic"><span class="koboSpan" id="kobo.1310.1">secondary</span></em><span class="koboSpan" id="kobo.1311.1"> (or </span><em class="italic"><span class="koboSpan" id="kobo.1312.1">supplementary</span></em><span class="koboSpan" id="kobo.1313.1">) </span><em class="italic"><span class="koboSpan" id="kobo.1314.1">groups</span></em><span class="koboSpan" id="kobo.1315.1">. </span><span class="koboSpan" id="kobo.1315.2">The code can be </span><span class="No-Break"><span class="koboSpan" id="kobo.1316.1">seen here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1317.1">
sudo useradd -g admin -G developers,devops alex2
sudo useradd -g admin -G developers,devops julian2</span></pre> <p><span class="koboSpan" id="kobo.1318.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1319.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.1320.1"> option parameter of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1321.1">useradd</span></strong><span class="koboSpan" id="kobo.1322.1"> command specifies the (unique) primary group (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1323.1">admin</span></strong><span class="koboSpan" id="kobo.1324.1">). </span><span class="koboSpan" id="kobo.1324.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1325.1">-G, --groups</span></strong><span class="koboSpan" id="kobo.1326.1"> option parameter provides a comma-separated list (without intervening spaces) of the secondary group </span><span class="No-Break"><span class="koboSpan" id="kobo.1327.1">names (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1328.1">developers</span></strong></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1329.1">,</span></strong></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1330.1">devops</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1331.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1332.1">We can verify the group</span><a id="_idIndexMarker533"/><span class="koboSpan" id="kobo.1333.1"> memberships for both users with the </span><span class="No-Break"><span class="koboSpan" id="kobo.1334.1">following </span></span><span class="No-Break"><a id="_idIndexMarker534"/></span><span class="No-Break"><span class="koboSpan" id="kobo.1335.1">commands:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1336.1">
id alex2
id julian2</span></pre> <p><span class="koboSpan" id="kobo.1337.1">The output is shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1338.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer103">
<span class="koboSpan" id="kobo.1339.1"><img alt="Figure 4.17 – Assigning groups to new users" src="image/Figure_04_17_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1340.1">Figure 4.17 – Assigning groups to new users</span></p>
<p><span class="koboSpan" id="kobo.1341.1">As we can see, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1342.1">gid</span></strong><span class="koboSpan" id="kobo.1343.1"> attribute shows the primary group membership: </span><strong class="source-inline"><span class="koboSpan" id="kobo.1344.1">gid=1100(admin)</span></strong><span class="koboSpan" id="kobo.1345.1">. </span><span class="koboSpan" id="kobo.1345.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1346.1">groups</span></strong><span class="koboSpan" id="kobo.1347.1"> attribute shows the supplementary (secondary) </span><span class="No-Break"><span class="koboSpan" id="kobo.1348.1">groups: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1349.1">groups=1100(admin),1200(developers),1300(devops)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1350.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1351.1">With users scattered</span><a id="_idIndexMarker535"/><span class="koboSpan" id="kobo.1352.1"> across multiple groups, an administrator is sometimes confronted with the task of moving users between groups. </span><span class="koboSpan" id="kobo.1352.2">The following section shows how to </span><span class="No-Break"><span class="koboSpan" id="kobo.1353.1">do this.</span></span></p>
<h4><span class="koboSpan" id="kobo.1354.1">Moving and removing users across groups</span></h4>
<p><span class="koboSpan" id="kobo.1355.1">Building</span><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.1356.1"> upon the previous </span><a id="_idIndexMarker537"/><span class="koboSpan" id="kobo.1357.1">example, let’s </span><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.1358.1">assume the administrator wants to </span><a id="_idIndexMarker539"/><span class="koboSpan" id="kobo.1359.1">move (or add) the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1360.1">alex2</span></strong><span class="koboSpan" id="kobo.1361.1"> to a new secondary group called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1362.1">managers</span></strong><span class="koboSpan" id="kobo.1363.1">. </span><span class="koboSpan" id="kobo.1363.2">Please note that, according to our previous examples, the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1364.1">alex2</span></strong><span class="koboSpan" id="kobo.1365.1"> has </span><strong class="source-inline"><span class="koboSpan" id="kobo.1366.1">admin</span></strong><span class="koboSpan" id="kobo.1367.1"> as the primary group and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1368.1">developers</span></strong><span class="koboSpan" id="kobo.1369.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.1370.1">devops</span></strong><span class="koboSpan" id="kobo.1371.1"> as secondary groups (see the output of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1372.1">id alex2</span></strong><span class="koboSpan" id="kobo.1373.1"> command in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1374.1">Figure 4</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1375.1">.18</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1376.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1377.1">Let’s create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.1378.1">managers</span></strong><span class="koboSpan" id="kobo.1379.1"> group first, with GID </span><strong class="source-inline"><span class="koboSpan" id="kobo.1380.1">1400</span></strong><span class="koboSpan" id="kobo.1381.1">. </span><span class="koboSpan" id="kobo.1381.2">The code can be </span><span class="No-Break"><span class="koboSpan" id="kobo.1382.1">seen here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1383.1">
sudo groupadd -g 1400 managers</span></pre> <p><span class="koboSpan" id="kobo.1384.1">Next, add our existing user, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1385.1">alex2</span></strong><span class="koboSpan" id="kobo.1386.1">, to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1387.1">managers</span></strong><span class="koboSpan" id="kobo.1388.1"> group. </span><span class="koboSpan" id="kobo.1388.2">We use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1389.1">usermod</span></strong><span class="koboSpan" id="kobo.1390.1"> command with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1391.1">-G, --groups</span></strong><span class="koboSpan" id="kobo.1392.1"> option parameter to specify the secondary groups the user is </span><span class="No-Break"><span class="koboSpan" id="kobo.1393.1">associated</span></span><span class="No-Break"><a id="_idIndexMarker540"/></span><span class="No-Break"><span class="koboSpan" id="kobo.1394.1"> with.</span></span></p>
<p><span class="koboSpan" id="kobo.1395.1">The simplest way to </span><em class="italic"><span class="koboSpan" id="kobo.1396.1">append</span></em><span class="koboSpan" id="kobo.1397.1"> a secondary </span><a id="_idIndexMarker541"/><span class="koboSpan" id="kobo.1398.1">group to a user is by invocation of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1399.1">-a, --append</span></strong><span class="koboSpan" id="kobo.1400.1"> option of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1401.1">usermod</span></strong><span class="koboSpan" id="kobo.1402.1"> command, as </span><span class="No-Break"><span class="koboSpan" id="kobo.1403.1">illustrated here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1404.1">
sudo usermod -a -G managers alex2</span></pre> <p><span class="koboSpan" id="kobo.1405.1">The preceding </span><a id="_idIndexMarker542"/><span class="koboSpan" id="kobo.1406.1">command would preserve the existing secondary </span><a id="_idIndexMarker543"/><span class="koboSpan" id="kobo.1407.1">groups for the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1408.1">alex2</span></strong><span class="koboSpan" id="kobo.1409.1"> while adding the new </span><strong class="source-inline"><span class="koboSpan" id="kobo.1410.1">managers</span></strong><span class="koboSpan" id="kobo.1411.1"> group. </span><span class="koboSpan" id="kobo.1411.2">Alternatively, we could run the </span><span class="No-Break"><span class="koboSpan" id="kobo.1412.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1413.1">
sudo usermod -G developers,devops,managers alex2</span></pre> <p><span class="koboSpan" id="kobo.1414.1">In the preceding command, we specified multiple groups (with no </span><span class="No-Break"><span class="koboSpan" id="kobo.1415.1">intervening whitespace!).</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.1416.1">Important note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.1417.1">We preserved the existing secondary groups (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1418.1">developers</span></strong><span class="koboSpan" id="kobo.1419.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.1420.1">devops</span></strong><span class="koboSpan" id="kobo.1421.1">) and </span><em class="italic"><span class="koboSpan" id="kobo.1422.1">appended</span></em><span class="koboSpan" id="kobo.1423.1"> to the comma-separated list the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1424.1">managers</span></strong><span class="koboSpan" id="kobo.1425.1"> additional secondary group. </span><span class="koboSpan" id="kobo.1425.2">If we only had the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1426.1">managers</span></strong><span class="koboSpan" id="kobo.1427.1"> group specified, the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1428.1">alex2</span></strong><span class="koboSpan" id="kobo.1429.1"> would have been </span><em class="italic"><span class="koboSpan" id="kobo.1430.1">removed</span></em><span class="koboSpan" id="kobo.1431.1"> from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1432.1">developers</span></strong><span class="koboSpan" id="kobo.1433.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1434.1">devops</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1435.1">secondary groups.</span></span></p>
<p><span class="koboSpan" id="kobo.1436.1">To verify whether the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1437.1">alex2</span></strong><span class="koboSpan" id="kobo.1438.1"> is now part of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1439.1">managers</span></strong><span class="koboSpan" id="kobo.1440.1"> group, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.1441.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1442.1">
id alex2</span></pre> <p><span class="koboSpan" id="kobo.1443.1">This is the output of </span><span class="No-Break"><span class="koboSpan" id="kobo.1444.1">the command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1445.1">
uid=1004(alex2) gid=1100(admin) </span><strong class="bold"><span class="koboSpan" id="kobo.1446.1">groups</span></strong><span class="koboSpan" id="kobo.1447.1">=1100(admin),1200(developers),1300(devops),1400(managers)</span></pre> <p><span class="koboSpan" id="kobo.1448.1">As we can see, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1449.1">groups</span></strong><span class="koboSpan" id="kobo.1450.1"> attribute (highlighted) includes the related entry for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1451.1">managers</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1452.1">group: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1453.1">1400(managers)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1454.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1455.1">Similarly, if we wanted to </span><em class="italic"><span class="koboSpan" id="kobo.1456.1">remove</span></em><span class="koboSpan" id="kobo.1457.1"> the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1458.1">alex2</span></strong><span class="koboSpan" id="kobo.1459.1"> from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1460.1">developers</span></strong><span class="koboSpan" id="kobo.1461.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1462.1">devops</span></strong><span class="koboSpan" id="kobo.1463.1"> secondary groups, to only</span><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.1464.1"> be associated with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1465.1">managers</span></strong><span class="koboSpan" id="kobo.1466.1"> secondary group, we would run</span><a id="_idIndexMarker545"/><span class="koboSpan" id="kobo.1467.1"> the </span><span class="No-Break"><span class="koboSpan" id="kobo.1468.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1469.1">
sudo usermod -G managers alex2</span></pre> <p><span class="koboSpan" id="kobo.1470.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1471.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer104">
<span class="koboSpan" id="kobo.1472.1"><img alt="Figure 4.18 – Verifying the secondary groups for the user" src="image/Figure_04_18_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1473.1">Figure 4.18 – Verifying the secondary groups for the user</span></p>
<p><span class="koboSpan" id="kobo.1474.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1475.1">groups</span></strong><span class="koboSpan" id="kobo.1476.1"> tag now shows the primary group </span><strong class="source-inline"><span class="koboSpan" id="kobo.1477.1">admin</span></strong><span class="koboSpan" id="kobo.1478.1"> (by default) and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1479.1">managers</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1480.1">secondary group.</span></span></p>
<p><span class="koboSpan" id="kobo.1481.1">The command to </span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.1482.1">remove the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1483.1">alex2</span></strong><span class="koboSpan" id="kobo.1484.1"> from all secondary groups</span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.1485.1"> is </span><span class="No-Break"><span class="koboSpan" id="kobo.1486.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1487.1">
sudo usermod -G '' alex2</span></pre> <p><span class="koboSpan" id="kobo.1488.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1489.1">usermod</span></strong><span class="koboSpan" id="kobo.1490.1"> command has an empty string (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1491.1">''</span></strong><span class="koboSpan" id="kobo.1492.1">) as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1493.1">-G, --groups</span></strong><span class="koboSpan" id="kobo.1494.1"> option parameter, to ensure no secondary groups are associated with the user. </span><span class="koboSpan" id="kobo.1494.2">We can verify that the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1495.1">alex2</span></strong><span class="koboSpan" id="kobo.1496.1"> has no more secondary group memberships with the </span><span class="No-Break"><span class="koboSpan" id="kobo.1497.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1498.1">
id alex</span></pre> <p><span class="koboSpan" id="kobo.1499.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1500.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer105">
<span class="koboSpan" id="kobo.1501.1"><img alt="Figure 4.19 – Verifying the user has no secondary groups" src="image/Figure_04_19_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1502.1">Figure 4.19 – Verifying the user has no secondary groups</span></p>
<p><span class="koboSpan" id="kobo.1503.1">As we can see, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1504.1">groups</span></strong><span class="koboSpan" id="kobo.1505.1"> tag only contains the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1506.1">1100(admin)</span></strong><span class="koboSpan" id="kobo.1507.1"> primary GID, which by default is always shown for </span><span class="No-Break"><span class="koboSpan" id="kobo.1508.1">a user.</span></span></p>
<p><span class="koboSpan" id="kobo.1509.1">If an administrator chooses to remove the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1510.1">alex2</span></strong><span class="koboSpan" id="kobo.1511.1"> from a primary group or assign them to a different primary group, they must run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1512.1">usermod</span></strong><span class="koboSpan" id="kobo.1513.1"> command with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1514.1">-g, --gid</span></strong><span class="koboSpan" id="kobo.1515.1"> option parameter and specify the primary group name. </span><span class="koboSpan" id="kobo.1515.2">A primary group is always mandatory for a user, and it </span><span class="No-Break"><span class="koboSpan" id="kobo.1516.1">must exist.</span></span></p>
<p><span class="koboSpan" id="kobo.1517.1">For example, to move the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1518.1">alex2</span></strong><span class="koboSpan" id="kobo.1519.1"> to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1520.1">managers</span></strong><span class="koboSpan" id="kobo.1521.1"> primary group, the </span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.1522.1">administrator would run the </span><span class="No-Break"><span class="koboSpan" id="kobo.1523.1">following </span></span><span class="No-Break"><a id="_idIndexMarker549"/></span><span class="No-Break"><span class="koboSpan" id="kobo.1524.1">command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1525.1">
sudo usermod -g managers alex2</span></pre> <p><span class="koboSpan" id="kobo.1526.1">The related user data can be obtained using the </span><span class="No-Break"><span class="koboSpan" id="kobo.1527.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1528.1">
id alex2</span></pre> <p><span class="koboSpan" id="kobo.1529.1">The command yields the </span><span class="No-Break"><span class="koboSpan" id="kobo.1530.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer106">
<span class="koboSpan" id="kobo.1531.1"><img alt="Figure 4.20 – Verifying the user has been assigned to the new primary group" src="image/Figure_04_20_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1532.1">Figure 4.20 – Verifying the user has been assigned to the new primary group</span></p>
<p><span class="koboSpan" id="kobo.1533.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1534.1">gid</span></strong><span class="koboSpan" id="kobo.1535.1"> attribute of the user record in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1536.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1537.1">.21</span></em><span class="koboSpan" id="kobo.1538.1"> reflects the new primary </span><span class="No-Break"><span class="koboSpan" id="kobo.1539.1">group: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1540.1">gid=1400(managers)</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1541.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1542.1">If the administrator </span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.1543.1">chooses to configure the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1544.1">alex2</span></strong><span class="koboSpan" id="kobo.1545.1"> without a specific primary </span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.1546.1">group, they must first create an exclusive </span><em class="italic"><span class="koboSpan" id="kobo.1547.1">group</span></em><span class="koboSpan" id="kobo.1548.1"> (named </span><strong class="source-inline"><span class="koboSpan" id="kobo.1549.1">alex2</span></strong><span class="koboSpan" id="kobo.1550.1">, for convenience), and have the GID matching the UID of the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1551.1">alex2</span></strong><span class="koboSpan" id="kobo.1552.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1553.1">1004</span></strong><span class="koboSpan" id="kobo.1554.1">), </span><span class="No-Break"><span class="koboSpan" id="kobo.1555.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1556.1">
sudo groupadd -g 1004 alex2</span></pre> <p><span class="koboSpan" id="kobo.1557.1">And now, we can remove the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1558.1">alex2</span></strong><span class="koboSpan" id="kobo.1559.1"> from the current primary group (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1560.1">managers</span></strong><span class="koboSpan" id="kobo.1561.1">) by specifying the exclusive primary group we just created (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1562.1">alex2</span></strong><span class="koboSpan" id="kobo.1563.1">), </span><span class="No-Break"><span class="koboSpan" id="kobo.1564.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1565.1">
sudo usermod -g alex2 alex2</span></pre> <p><span class="koboSpan" id="kobo.1566.1">The related user record </span><span class="No-Break"><span class="koboSpan" id="kobo.1567.1">becomes this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1568.1">
id alex2</span></pre> <p><span class="koboSpan" id="kobo.1569.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1570.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer107">
<span class="koboSpan" id="kobo.1571.1"><img alt="Figure 4.21 – Verifying the user has been removed from primary groups" src="image/Figure_04_21_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1572.1">Figure 4.21 – Verifying the user has been removed from primary groups</span></p>
<p><span class="koboSpan" id="kobo.1573.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1574.1">gid</span></strong><span class="koboSpan" id="kobo.1575.1"> attribute of the user record reflects the exclusive primary group (matching the user): </span><strong class="source-inline"><span class="koboSpan" id="kobo.1576.1">gid=1004(alex2)</span></strong><span class="koboSpan" id="kobo.1577.1">. </span><span class="koboSpan" id="kobo.1577.2">Our user doesn’t belong to any other primary </span><span class="No-Break"><span class="koboSpan" id="kobo.1578.1">groups anymore.</span></span></p>
<p><span class="koboSpan" id="kobo.1579.1">Adding, moving, and</span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.1580.1"> removing users across groups may become</span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.1581.1"> increasingly daunting tasks for a Linux</span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.1582.1"> administrator. </span><span class="koboSpan" id="kobo.1582.2">Knowing at any time which users belong to which groups is valuable</span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.1583.1"> information, both for reporting purposes and user automation workflows. </span><span class="koboSpan" id="kobo.1583.2">The following section provides a few commands for viewing user and </span><span class="No-Break"><span class="koboSpan" id="kobo.1584.1">group data.</span></span></p>
<h4><span class="koboSpan" id="kobo.1585.1">Viewing users and groups</span></h4>
<p><span class="koboSpan" id="kobo.1586.1">In this section, we </span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.1587.1">will provide some potentially useful commands for retrieving group and group</span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.1588.1"> membership information. </span><span class="koboSpan" id="kobo.1588.2">Before we</span><a id="_idIndexMarker558"/><span class="koboSpan" id="kobo.1589.1"> get into any commands, we should keep in mind that group</span><a id="_idIndexMarker559"/><span class="koboSpan" id="kobo.1590.1"> information is stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1591.1">/etc/group</span></strong><span class="koboSpan" id="kobo.1592.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1593.1">/etc/gshadow</span></strong><span class="koboSpan" id="kobo.1594.1"> files. </span><span class="koboSpan" id="kobo.1594.2">Among the two, the former has the information we’re most </span><span class="No-Break"><span class="koboSpan" id="kobo.1595.1">interested in.</span></span></p>
<p><span class="koboSpan" id="kobo.1596.1">We can parse the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1597.1">/etc/group</span></strong><span class="koboSpan" id="kobo.1598.1"> file to retrieve all groups, </span><span class="No-Break"><span class="koboSpan" id="kobo.1599.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1600.1">
cat /etc/group | cut -d: -f1 | column | less</span></pre> <p><span class="koboSpan" id="kobo.1601.1">The command yields the </span><span class="No-Break"><span class="koboSpan" id="kobo.1602.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer108">
<span class="koboSpan" id="kobo.1603.1"><img alt="Figure 4.22 – Retrieving all group names" src="image/Figure_04_22_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1604.1">Figure 4.22 – Retrieving all group names</span></p>
<p><span class="koboSpan" id="kobo.1605.1">A similar command would use </span><strong class="source-inline"><span class="koboSpan" id="kobo.1606.1">getent</span></strong><span class="koboSpan" id="kobo.1607.1">, which we can use </span><span class="No-Break"><span class="koboSpan" id="kobo.1608.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1609.1">
getent group | cut -d: -f1 | column | less</span></pre> <p><span class="koboSpan" id="kobo.1610.1">The output of the preceding command is identical to the output shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1611.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1612.1">.22</span></em><span class="koboSpan" id="kobo.1613.1">. </span><span class="koboSpan" id="kobo.1613.2">We </span><a id="_idIndexMarker560"/><span class="koboSpan" id="kobo.1614.1">can retrieve</span><a id="_idIndexMarker561"/><span class="koboSpan" id="kobo.1615.1"> the information of an individual </span><a id="_idIndexMarker562"/><span class="koboSpan" id="kobo.1616.1">group (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1617.1">developers</span></strong><span class="koboSpan" id="kobo.1618.1">) with the </span><a id="_idIndexMarker563"/><span class="No-Break"><span class="koboSpan" id="kobo.1619.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1620.1">
getent group developers</span></pre> <p><span class="koboSpan" id="kobo.1621.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1622.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer109">
<span class="koboSpan" id="kobo.1623.1"><img alt="Figure 4.23 – Retrieving information for a single group" src="image/Figure_04_23_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1624.1">Figure 4.23 – Retrieving information for a single group</span></p>
<p><span class="koboSpan" id="kobo.1625.1">The output of the preceding command also reveals the members of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1626.1">developers</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1627.1">group (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1628.1">julian2</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1629.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1630.1">To list all groups a specific user is a member of, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1631.1">groups</span></strong><span class="koboSpan" id="kobo.1632.1"> command. </span><span class="koboSpan" id="kobo.1632.2">For example, the following command lists all groups the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1633.1">alex</span></strong><span class="koboSpan" id="kobo.1634.1"> is a </span><span class="No-Break"><span class="koboSpan" id="kobo.1635.1">member of:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1636.1">
groups alex</span></pre> <p><span class="koboSpan" id="kobo.1637.1">This is the </span><span class="No-Break"><span class="koboSpan" id="kobo.1638.1">command output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer110">
<span class="koboSpan" id="kobo.1639.1"><img alt="Figure 4.24 – Retrieving group membership information of a user" src="image/Figure_04_24_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1640.1">Figure 4.24 – Retrieving group membership information of a user</span></p>
<p><span class="koboSpan" id="kobo.1641.1">The output of the previous command shows the groups for the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1642.1">alex</span></strong><span class="koboSpan" id="kobo.1643.1">, starting with the primary </span><span class="No-Break"><span class="koboSpan" id="kobo.1644.1">group (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1645.1">alex</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1646.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1647.1">A user can</span><a id="_idIndexMarker564"/><span class="koboSpan" id="kobo.1648.1"> retrieve their own group membership using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1649.1">groups</span></strong><span class="koboSpan" id="kobo.1650.1"> command-line</span><a id="_idIndexMarker565"/><span class="koboSpan" id="kobo.1651.1"> utility without specifying a group name. </span><span class="koboSpan" id="kobo.1651.2">The following command is executed in a terminal session of the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1652.1">packt</span></strong><span class="koboSpan" id="kobo.1653.1">, who is also an </span><span class="No-Break"><span class="koboSpan" id="kobo.1654.1">administrator (superuser):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1655.1">
groups</span></pre> <p><span class="koboSpan" id="kobo.1656.1">The command yields </span><span class="No-Break"><span class="koboSpan" id="kobo.1657.1">this output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer111">
<span class="koboSpan" id="kobo.1658.1"><img alt="Figure 4.25 – The current user’s groups" src="image/Figure_04_25_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1659.1">Figure 4.25 – The current user’s groups</span></p>
<p><span class="koboSpan" id="kobo.1660.1">There are many other ways and commands to retrieve user- and group-related information. </span><span class="koboSpan" id="kobo.1660.2">We hope that the preceding examples provide a basic idea about where and how to look for some of </span><span class="No-Break"><span class="koboSpan" id="kobo.1661.1">this information.</span></span></p>
<p><span class="koboSpan" id="kobo.1662.1">Next, let’s look at how a user can switch or log in to </span><span class="No-Break"><span class="koboSpan" id="kobo.1663.1">specific groups.</span></span></p>
<h4><span class="koboSpan" id="kobo.1664.1">Group login sessions</span></h4>
<p><span class="koboSpan" id="kobo.1665.1">When a user logs in to the system, the </span><a id="_idIndexMarker566"/><span class="koboSpan" id="kobo.1666.1">group membership context is automatically set to the user’s primary group. </span><span class="koboSpan" id="kobo.1666.2">Once the user is logged in, any user-initiated task (such as creating a file or running a program) is associated with the user’s primary group membership permissions. </span><span class="koboSpan" id="kobo.1666.3">A user may also choose to access resources in other groups where they are also a member (that is, supplementary or secondary groups). </span><span class="koboSpan" id="kobo.1666.4">To switch the group context or log in with a new group membership, a user invokes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1667.1">newgrp</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1668.1">command-line utility.</span></span></p>
<p><span class="koboSpan" id="kobo.1669.1">The basic syntax for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1670.1">newgrp</span></strong><span class="koboSpan" id="kobo.1671.1"> command </span><span class="No-Break"><span class="koboSpan" id="kobo.1672.1">is this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1673.1">
newgrp GROUP</span></pre> <p><span class="koboSpan" id="kobo.1674.1">In the following example, we assume a user (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1675.1">julian</span></strong><span class="koboSpan" id="kobo.1676.1">) is a member of multiple groups—</span><strong class="source-inline"><span class="koboSpan" id="kobo.1677.1">admin</span></strong><span class="koboSpan" id="kobo.1678.1"> as the primary group, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1679.1">developers</span></strong><span class="koboSpan" id="kobo.1680.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.1681.1">devops</span></strong><span class="koboSpan" id="kobo.1682.1"> as </span><span class="No-Break"><span class="koboSpan" id="kobo.1683.1">secondary groups:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1684.1">
id julian</span></pre> <p><span class="koboSpan" id="kobo.1685.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1686.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer112">
<span class="koboSpan" id="kobo.1687.1"><img alt="Figure 4.26 – A user with multiple group memberships" src="image/Figure_04_26_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1688.1">Figure 4.26 – A user with multiple group memberships</span></p>
<p><span class="koboSpan" id="kobo.1689.1">Let’s impersonate the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1690.1">julian</span></strong><span class="koboSpan" id="kobo.1691.1"> for a while. </span><span class="koboSpan" id="kobo.1691.2">We are currently logged in as the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1692.1">packt</span></strong><span class="koboSpan" id="kobo.1693.1">. </span><span class="koboSpan" id="kobo.1693.2">To change to the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1694.1">julian</span></strong><span class="koboSpan" id="kobo.1695.1">, we will use the </span><span class="No-Break"><span class="koboSpan" id="kobo.1696.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1697.1">
su julian</span></pre> <p><span class="koboSpan" id="kobo.1698.1">Remember that the user </span><strong class="source-inline"><span class="koboSpan" id="kobo.1699.1">julian</span></strong><span class="koboSpan" id="kobo.1700.1"> needs to have their password set in order </span><span class="No-Break"><span class="koboSpan" id="kobo.1701.1">to authenticate.</span></span></p>
<p><span class="koboSpan" id="kobo.1702.1">When logged in as </span><strong class="source-inline"><span class="koboSpan" id="kobo.1703.1">julian</span></strong><span class="koboSpan" id="kobo.1704.1">, the default login session has the</span><a id="_idIndexMarker567"/><span class="koboSpan" id="kobo.1705.1"> following user and </span><span class="No-Break"><span class="koboSpan" id="kobo.1706.1">group context:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1707.1">
whoami</span></pre> <p><span class="koboSpan" id="kobo.1708.1">In our case, this is </span><span class="No-Break"><span class="koboSpan" id="kobo.1709.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer113">
<span class="koboSpan" id="kobo.1710.1"><img alt="Figure 4.27 – Getting the current user" src="image/Figure_04_27_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1711.1">Figure 4.27 – Getting the current user</span></p>
<p><span class="koboSpan" id="kobo.1712.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1713.1">whoami</span></strong><span class="koboSpan" id="kobo.1714.1"> command provides the current UID (see more details on the command with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1715.1">man whoami</span></strong><span class="koboSpan" id="kobo.1716.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.1717.1">whoami --help</span></strong><span class="koboSpan" id="kobo.1718.1">), </span><span class="No-Break"><span class="koboSpan" id="kobo.1719.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1720.1">
groups</span></pre> <p><span class="koboSpan" id="kobo.1721.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1722.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer114">
<span class="koboSpan" id="kobo.1723.1"><img alt="Figure 4.28 – Getting the current user’s groups" src="image/Figure_04_28_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1724.1">Figure 4.28 – Getting the current user’s groups</span></p>
<p><span class="koboSpan" id="kobo.1725.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1726.1">groups</span></strong><span class="koboSpan" id="kobo.1727.1"> command displays all groups that the current user is a member of (see more details on the command with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1728.1">man groups</span></strong><span class="koboSpan" id="kobo.1729.1"> or </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1730.1">groups --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1731.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1732.1">The user can also view their IDs (user and GIDs) by invoking the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1733.1">id</span></strong><span class="koboSpan" id="kobo.1734.1"> command, </span><span class="No-Break"><span class="koboSpan" id="kobo.1735.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1736.1">
id</span></pre> <p><span class="koboSpan" id="kobo.1737.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.1738.1">the output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer115">
<span class="koboSpan" id="kobo.1739.1"><img alt="Figure 4.29 – Viewing the current user and GID information" src="image/Figure_04_29_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1740.1">Figure 4.29 – Viewing the current user and GID information</span></p>
<p><span class="koboSpan" id="kobo.1741.1">There are various invocations of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1742.1">id</span></strong><span class="koboSpan" id="kobo.1743.1"> command that provide information on the current user and group</span><a id="_idIndexMarker568"/><span class="koboSpan" id="kobo.1744.1"> session. </span><span class="koboSpan" id="kobo.1744.2">The following command (with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1745.1">-g, --group</span></strong><span class="koboSpan" id="kobo.1746.1"> option) retrieves the ID of the current group session for </span><span class="No-Break"><span class="koboSpan" id="kobo.1747.1">the user:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1748.1">
id -g
1100</span></pre> <p><span class="koboSpan" id="kobo.1749.1">In our case, the preceding command shows </span><strong class="source-inline"><span class="koboSpan" id="kobo.1750.1">1100</span></strong><span class="koboSpan" id="kobo.1751.1">—the GID corresponding to the user’s primary group, which is </span><strong class="source-inline"><span class="koboSpan" id="kobo.1752.1">admin</span></strong><span class="koboSpan" id="kobo.1753.1"> (see the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1754.1">gid</span></strong><span class="koboSpan" id="kobo.1755.1"> attribute in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1756.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1757.1">.30</span></em><span class="koboSpan" id="kobo.1758.1">). </span><span class="koboSpan" id="kobo.1758.2">Upon login, the default group session is always the primary group corresponding to the user. </span><span class="koboSpan" id="kobo.1758.3">If the user were to create a file, for example, the file permission attributes would reflect the primary group’s ID. </span><span class="koboSpan" id="kobo.1758.4">We’ll look at the file permissions in more detail in the </span><em class="italic"><span class="koboSpan" id="kobo.1759.1">Managing </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1760.1">permissions</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1761.1"> section.</span></span></p>
<p><span class="koboSpan" id="kobo.1762.1">Now, let’s switch the group session for the current user to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1763.1">developers</span></strong><span class="koboSpan" id="kobo.1764.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.1765.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1766.1">
newgrp developers</span></pre> <p><span class="koboSpan" id="kobo.1767.1">The current group session </span><span class="No-Break"><span class="koboSpan" id="kobo.1768.1">yields this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1769.1">
id -g
1200</span></pre> <p><span class="koboSpan" id="kobo.1770.1">The GID corresponds to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1771.1">developers</span></strong><span class="koboSpan" id="kobo.1772.1"> secondary GID, as displayed by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1773.1">groups</span></strong><span class="koboSpan" id="kobo.1774.1"> attribute in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1775.1">Figure 4</span></em></span><em class="italic"><span class="koboSpan" id="kobo.1776.1">.30</span></em><span class="koboSpan" id="kobo.1777.1">: </span><strong class="source-inline"><span class="koboSpan" id="kobo.1778.1">1200(developers)</span></strong><span class="koboSpan" id="kobo.1779.1">. </span><span class="koboSpan" id="kobo.1779.2">If the user created any files now, the related file permission attributes would have the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1780.1">developers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1781.1"> GID:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer116">
<span class="koboSpan" id="kobo.1782.1"><img alt="Figure 4.30 – Switching the group session" src="image/Figure_04_30_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1783.1">Figure 4.30 – Switching the group session</span></p>
<p><span class="koboSpan" id="kobo.1784.1">If the user attempts to log in to a group they are not a member of (for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1785.1">managers</span></strong><span class="koboSpan" id="kobo.1786.1">), the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1787.1">newgrp</span></strong><span class="koboSpan" id="kobo.1788.1"> command prompts for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1789.1">managers</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1790.1">group’s password:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1791.1">
newgrp managers</span></pre> <p><span class="koboSpan" id="kobo.1792.1">If our user had the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1793.1">managers</span></strong><span class="koboSpan" id="kobo.1794.1"> group password, or if they were a superuser, the group login attempt would succeed. </span><span class="koboSpan" id="kobo.1794.2">Otherwise, the user would be denied access to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1795.1">managers</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1796.1">group’s resources.</span></span></p>
<p><span class="koboSpan" id="kobo.1797.1">We conclude here </span><a id="_idIndexMarker569"/><span class="koboSpan" id="kobo.1798.1">our topic of managing users and groups. </span><span class="koboSpan" id="kobo.1798.2">The examples of the related administrative tasks used throughout this section are certainly all-encompassing. </span><span class="koboSpan" id="kobo.1798.3">In many of these cases, there are multiple ways to achieve the same result, using different commands </span><span class="No-Break"><span class="koboSpan" id="kobo.1799.1">or approaches.</span></span></p>
<p><span class="koboSpan" id="kobo.1800.1">By now, you should be relatively proficient in managing users and groups, and comfortable using the various command-line utilities for operating the related changes. </span><span class="koboSpan" id="kobo.1800.2">Users and groups are managed in a relational fashion, where users belong to a group or groups are associated with users. </span><span class="koboSpan" id="kobo.1800.3">We also learned that creating and managing users and groups requires superuser privileges. </span><span class="koboSpan" id="kobo.1800.4">In Linux, user data is stored in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1801.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.1802.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1803.1">/etc/shadow</span></strong><span class="koboSpan" id="kobo.1804.1"> files, while group information is found in </span><strong class="source-inline"><span class="koboSpan" id="kobo.1805.1">/etc/group</span></strong><span class="koboSpan" id="kobo.1806.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1807.1">/etc/gshadow</span></strong><span class="koboSpan" id="kobo.1808.1">. </span><span class="koboSpan" id="kobo.1808.2">Besides using the dedicated command-line utilities, users and groups can also be altered by manually editing </span><span class="No-Break"><span class="koboSpan" id="kobo.1809.1">these files.</span></span></p>
<p><span class="koboSpan" id="kobo.1810.1">Next, we’ll turn to the security and isolation context of the multiuser group environment. </span><span class="koboSpan" id="kobo.1810.2">In Linux, the related functionality is accomplished by a system-level access layer that controls the read, write, and execute permissions of files and directories, by specific users </span><span class="No-Break"><span class="koboSpan" id="kobo.1811.1">and groups.</span></span></p>
<p><span class="koboSpan" id="kobo.1812.1">The following section explores the management and administrative tasks related to </span><span class="No-Break"><span class="koboSpan" id="kobo.1813.1">these permissions.</span></span></p>
<h1 id="_idParaDest-83"><a id="_idTextAnchor099"/><span class="koboSpan" id="kobo.1814.1">Managing permissions</span></h1>
<p><span class="koboSpan" id="kobo.1815.1">A key tenet of Linux is the ability to allow multiple users to access the system while performing independent tasks simultaneously. </span><span class="koboSpan" id="kobo.1815.2">The</span><a id="_idIndexMarker570"/><span class="koboSpan" id="kobo.1816.1"> smooth operation of this multiuser, multitasking environment is controlled via </span><strong class="bold"><span class="koboSpan" id="kobo.1817.1">permissions</span></strong><span class="koboSpan" id="kobo.1818.1">. </span><span class="koboSpan" id="kobo.1818.2">The Linux kernel provides a robust framework for the underlying security and isolation model. </span><span class="koboSpan" id="kobo.1818.3">At the user level, dedicated tools and command-line utilities help Linux users and system administrators with related permission </span><span class="No-Break"><span class="koboSpan" id="kobo.1819.1">management tasks.</span></span></p>
<p><span class="koboSpan" id="kobo.1820.1">For some Linux users, especially beginners, Linux permissions may appear confusing at times. </span><span class="koboSpan" id="kobo.1820.2">This section attempts to demystify some of the key concepts about file and directory permissions in Linux. </span><span class="koboSpan" id="kobo.1820.3">You will learn about the basic permission </span><em class="italic"><span class="koboSpan" id="kobo.1821.1">rights</span></em><span class="koboSpan" id="kobo.1822.1"> of accessing files and directories—the </span><em class="italic"><span class="koboSpan" id="kobo.1823.1">read</span></em><span class="koboSpan" id="kobo.1824.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1825.1">write</span></em><span class="koboSpan" id="kobo.1826.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.1827.1">execution</span></em><span class="koboSpan" id="kobo.1828.1"> permissions. </span><span class="koboSpan" id="kobo.1828.2">We explore some of the essential administrative tasks for viewing and changing permissions, using system-level </span><span class="No-Break"><span class="koboSpan" id="kobo.1829.1">command-line utilities.</span></span></p>
<p><span class="koboSpan" id="kobo.1830.1">Most of the topics discussed in this </span><a id="_idIndexMarker571"/><span class="koboSpan" id="kobo.1831.1">section should be regarded closely with users and groups. </span><span class="koboSpan" id="kobo.1831.2">The related idioms can be as simple as </span><em class="italic"><span class="koboSpan" id="kobo.1832.1">a user can read or update a file</span></em><span class="koboSpan" id="kobo.1833.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1834.1">a group has access to these files and directories</span></em><span class="koboSpan" id="kobo.1835.1">, or </span><em class="italic"><span class="koboSpan" id="kobo.1836.1">a user can execute </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1837.1">this program</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1838.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1839.1">Let’s start with the basics, introducing file and </span><span class="No-Break"><span class="koboSpan" id="kobo.1840.1">directory permissions.</span></span></p>
<h2 id="_idParaDest-84"><a id="_idTextAnchor100"/><span class="koboSpan" id="kobo.1841.1">File and directory permissions</span></h2>
<p><span class="koboSpan" id="kobo.1842.1">In Linux, permissions can be </span><a id="_idIndexMarker572"/><span class="koboSpan" id="kobo.1843.1">regarded as the </span><em class="italic"><span class="koboSpan" id="kobo.1844.1">rights</span></em><span class="koboSpan" id="kobo.1845.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.1846.1">privileges</span></em><span class="koboSpan" id="kobo.1847.1"> to act upon a file or a directory. </span><span class="koboSpan" id="kobo.1847.2">The basic rights, or </span><em class="italic"><span class="koboSpan" id="kobo.1848.1">permission attributes</span></em><span class="koboSpan" id="kobo.1849.1">, are </span><span class="No-Break"><span class="koboSpan" id="kobo.1850.1">outlined here:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.1851.1">Read</span></strong><span class="koboSpan" id="kobo.1852.1">: A </span><em class="italic"><span class="koboSpan" id="kobo.1853.1">read</span></em><span class="koboSpan" id="kobo.1854.1"> permission </span><a id="_idIndexMarker573"/><span class="koboSpan" id="kobo.1855.1">of a file allows users to view the content of the file. </span><span class="koboSpan" id="kobo.1855.2">On a directory, the read </span><a id="_idIndexMarker574"/><span class="koboSpan" id="kobo.1856.1">permission allows users to list the content of </span><span class="No-Break"><span class="koboSpan" id="kobo.1857.1">the directory.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1858.1">Write</span></strong><span class="koboSpan" id="kobo.1859.1">: A </span><em class="italic"><span class="koboSpan" id="kobo.1860.1">write</span></em><span class="koboSpan" id="kobo.1861.1"> permission</span><a id="_idIndexMarker575"/><span class="koboSpan" id="kobo.1862.1"> of a file </span><a id="_idIndexMarker576"/><span class="koboSpan" id="kobo.1863.1">allows users to modify the content of the file. </span><span class="koboSpan" id="kobo.1863.2">For a directory, the write permission allows users to modify the content of the directory by adding, deleting, or </span><span class="No-Break"><span class="koboSpan" id="kobo.1864.1">renaming files.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1865.1">Execute</span></strong><span class="koboSpan" id="kobo.1866.1">: An </span><em class="italic"><span class="koboSpan" id="kobo.1867.1">execute</span></em><span class="koboSpan" id="kobo.1868.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.1869.1">executable</span></em><span class="koboSpan" id="kobo.1870.1"> permission of a file allows users to run the related script, application, or</span><a id="_idIndexMarker577"/><span class="koboSpan" id="kobo.1871.1"> service appointed</span><a id="_idIndexMarker578"/><span class="koboSpan" id="kobo.1872.1"> by the file. </span><span class="koboSpan" id="kobo.1872.2">For a directory, the execute permission allows users to enter the directory and make it the current working directory (using the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1873.1">cd</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1874.1"> command).</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1875.1">First, let’s take a look at how to reveal the permissions for files </span><span class="No-Break"><span class="koboSpan" id="kobo.1876.1">and directories.</span></span></p>
<h3><span class="koboSpan" id="kobo.1877.1">Viewing permissions</span></h3>
<p><span class="koboSpan" id="kobo.1878.1">The most common</span><a id="_idIndexMarker579"/><span class="koboSpan" id="kobo.1879.1"> way to view the permissions of a file or directory is by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1880.1">ls</span></strong><span class="koboSpan" id="kobo.1881.1"> command-line utility. </span><span class="koboSpan" id="kobo.1881.2">The basic syntax of this command </span><span class="No-Break"><span class="koboSpan" id="kobo.1882.1">is this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1883.1">
ls [OPTIONS] FILE|DIRECTORY</span></pre> <p><span class="koboSpan" id="kobo.1884.1">Here is an example use of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1885.1">ls</span></strong><span class="koboSpan" id="kobo.1886.1"> command to view the permissions of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1887.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1888.1">etc/passwd</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1889.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1890.1">
ls -l /etc/passwd</span></pre> <p><span class="koboSpan" id="kobo.1891.1">The command yields the </span><span class="No-Break"><span class="koboSpan" id="kobo.1892.1">following output:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1893.1">
-rw-r--r-- 1 root root 2010 Mar  9 08:57 /etc/passwd</span></pre> <p><span class="koboSpan" id="kobo.1894.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1895.1">-l</span></strong><span class="koboSpan" id="kobo.1896.1"> option of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1897.1">ls</span></strong><span class="koboSpan" id="kobo.1898.1"> command provides a detailed output by using the </span><em class="italic"><span class="koboSpan" id="kobo.1899.1">long listing format</span></em><span class="koboSpan" id="kobo.1900.1">, according to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1901.1">ls</span></strong><span class="koboSpan" id="kobo.1902.1"> documentation (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1903.1">man ls</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1904.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1905.1">Let’s analyze the output, </span><span class="No-Break"><span class="koboSpan" id="kobo.1906.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1907.1">
-rw-r--r-- 1 root root 2010 Mar  9 08:57 /etc/passwd</span></pre> <p><span class="koboSpan" id="kobo.1908.1">We have nine segments, separated</span><a id="_idIndexMarker580"/><span class="koboSpan" id="kobo.1909.1"> by single whitespace characters (delimiters). </span><span class="koboSpan" id="kobo.1909.2">These are </span><span class="No-Break"><span class="koboSpan" id="kobo.1910.1">outlined here:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1911.1">-rw-r--r--</span></strong><span class="koboSpan" id="kobo.1912.1">: The file </span><span class="No-Break"><span class="koboSpan" id="kobo.1913.1">access permissions</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1914.1">1</span></strong><span class="koboSpan" id="kobo.1915.1">: The number of </span><span class="No-Break"><span class="koboSpan" id="kobo.1916.1">hard links</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1917.1">root</span></strong><span class="koboSpan" id="kobo.1918.1">: The </span><em class="italic"><span class="koboSpan" id="kobo.1919.1">user</span></em><span class="koboSpan" id="kobo.1920.1"> who is the owner of </span><span class="No-Break"><span class="koboSpan" id="kobo.1921.1">the file</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1922.1">root</span></strong><span class="koboSpan" id="kobo.1923.1">: The </span><em class="italic"><span class="koboSpan" id="kobo.1924.1">group</span></em><span class="koboSpan" id="kobo.1925.1"> that is the owner of </span><span class="No-Break"><span class="koboSpan" id="kobo.1926.1">the file</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1927.1">2010</span></strong><span class="koboSpan" id="kobo.1928.1">: The size of </span><span class="No-Break"><span class="koboSpan" id="kobo.1929.1">the file</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1930.1">Mar</span></strong><span class="koboSpan" id="kobo.1931.1">: The month the file </span><span class="No-Break"><span class="koboSpan" id="kobo.1932.1">was created</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1933.1">9</span></strong><span class="koboSpan" id="kobo.1934.1">: The day of the month the file </span><span class="No-Break"><span class="koboSpan" id="kobo.1935.1">was created</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1936.1">08:57</span></strong><span class="koboSpan" id="kobo.1937.1">: The time of day the file </span><span class="No-Break"><span class="koboSpan" id="kobo.1938.1">was created</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1939.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.1940.1">: </span><span class="No-Break"><span class="koboSpan" id="kobo.1941.1">The filename</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1942.1">Let’s examine the file</span><a id="_idIndexMarker581"/><span class="koboSpan" id="kobo.1943.1"> access permissions field (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1944.1">-rw-r--r--</span></strong><span class="koboSpan" id="kobo.1945.1">). </span><span class="koboSpan" id="kobo.1945.2">File access permissions are defined as a 10-character field, grouped </span><span class="No-Break"><span class="koboSpan" id="kobo.1946.1">as follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.1947.1">The first character (attribute) is reserved for the file type (see the </span><em class="italic"><span class="koboSpan" id="kobo.1948.1">File </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1949.1">types</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1950.1"> section).</span></span></li>
<li><span class="koboSpan" id="kobo.1951.1">The next 9 characters represent a 9-bit field, defining the effective permissions as 3 sequences of 3 attributes (bits) each: </span><em class="italic"><span class="koboSpan" id="kobo.1952.1">user owner</span></em><span class="koboSpan" id="kobo.1953.1"> permissions, </span><em class="italic"><span class="koboSpan" id="kobo.1954.1">group owner</span></em><span class="koboSpan" id="kobo.1955.1"> permissions, and </span><em class="italic"><span class="koboSpan" id="kobo.1956.1">all other users’</span></em><span class="koboSpan" id="kobo.1957.1"> permissions (see the </span><em class="italic"><span class="koboSpan" id="kobo.1958.1">Permission </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1959.1">attributes</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1960.1"> section).</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1961.1">Let’s take a look at the file </span><span class="No-Break"><span class="koboSpan" id="kobo.1962.1">type attributes.</span></span></p>
<h4><span class="koboSpan" id="kobo.1963.1">File type attributes</span></h4>
<p><span class="koboSpan" id="kobo.1964.1">The file type attributes</span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.1965.1"> are </span><span class="No-Break"><span class="koboSpan" id="kobo.1966.1">listed here:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1967.1">d</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1968.1">: Directory</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1969.1">-</span></strong><span class="koboSpan" id="kobo.1970.1">: </span><span class="No-Break"><span class="koboSpan" id="kobo.1971.1">Regular file</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1972.1">l</span></strong><span class="koboSpan" id="kobo.1973.1">: </span><span class="No-Break"><span class="koboSpan" id="kobo.1974.1">Symbolic link</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1975.1">p</span></strong><span class="koboSpan" id="kobo.1976.1">: Named pipe—a special file that facilitates communication </span><span class="No-Break"><span class="koboSpan" id="kobo.1977.1">between programs</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1978.1">s</span></strong><span class="koboSpan" id="kobo.1979.1">: Socket—similar to a pipe but with bidirectional </span><span class="No-Break"><span class="koboSpan" id="kobo.1980.1">network communications</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1981.1">b</span></strong><span class="koboSpan" id="kobo.1982.1">: Block device—a file that corresponds to a </span><span class="No-Break"><span class="koboSpan" id="kobo.1983.1">hardware device</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.1984.1">c</span></strong><span class="koboSpan" id="kobo.1985.1">: Character device—similar to a </span><span class="No-Break"><span class="koboSpan" id="kobo.1986.1">block device</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1987.1">Let’s have a closer look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.1988.1">permission attributes.</span></span></p>
<h4><span class="koboSpan" id="kobo.1989.1">Permission attributes</span></h4>
<p><span class="koboSpan" id="kobo.1990.1">As previously noted, the access </span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.1991.1">permissions are represented by a 9-bit field, a group of 3 sequences, each with 3 bits, defined </span><span class="No-Break"><span class="koboSpan" id="kobo.1992.1">as follows:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.1993.1">Bits 1-3</span></strong><span class="koboSpan" id="kobo.1994.1">: </span><em class="italic"><span class="koboSpan" id="kobo.1995.1">User</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.1996.1">owner permissions</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1997.1">Bits 4-6</span></strong><span class="koboSpan" id="kobo.1998.1">: </span><em class="italic"><span class="koboSpan" id="kobo.1999.1">Group</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.2000.1">owner permissions</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.2001.1">Bits 7-9</span></strong><span class="koboSpan" id="kobo.2002.1">: </span><em class="italic"><span class="koboSpan" id="kobo.2003.1">All</span></em><span class="koboSpan" id="kobo.2004.1"> other users’ (or </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.2005.1">world</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.2006.1">) permissions</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2007.1">Each permission attribute is a bit flag in the binary representation of the related 3-bit sequence. </span><span class="koboSpan" id="kobo.2007.2">They can be represented either as a character or as an equivalent numerical value, also known as the </span><em class="italic"><span class="koboSpan" id="kobo.2008.1">octal</span></em><span class="koboSpan" id="kobo.2009.1"> value, depending on the</span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.2010.1"> range of the bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2011.1">they represent.</span></span></p>
<p><span class="koboSpan" id="kobo.2012.1">Here are the permission attributes with their respective </span><span class="No-Break"><span class="koboSpan" id="kobo.2013.1">octal values:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2014.1">r</span></strong><span class="koboSpan" id="kobo.2015.1">: </span><em class="italic"><span class="koboSpan" id="kobo.2016.1">Read</span></em><span class="koboSpan" id="kobo.2017.1"> permission; 2 ^ 2 = </span><strong class="source-inline"><span class="koboSpan" id="kobo.2018.1">4</span></strong><span class="koboSpan" id="kobo.2019.1"> (bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2020.1">2 set)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2021.1">w</span></strong><span class="koboSpan" id="kobo.2022.1">: </span><em class="italic"><span class="koboSpan" id="kobo.2023.1">Write</span></em><span class="koboSpan" id="kobo.2024.1"> permission: 2 ^ 1 = </span><strong class="source-inline"><span class="koboSpan" id="kobo.2025.1">2</span></strong><span class="koboSpan" id="kobo.2026.1"> (bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2027.1">1 set)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2028.1">x</span></strong><span class="koboSpan" id="kobo.2029.1">: </span><em class="italic"><span class="koboSpan" id="kobo.2030.1">Execute</span></em><span class="koboSpan" id="kobo.2031.1"> permission: 2 ^ 0 = </span><strong class="source-inline"><span class="koboSpan" id="kobo.2032.1">1</span></strong><span class="koboSpan" id="kobo.2033.1"> (bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2034.1">0 set)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2035.1">-</span></strong><span class="koboSpan" id="kobo.2036.1">: </span><em class="italic"><span class="koboSpan" id="kobo.2037.1">No</span></em><span class="koboSpan" id="kobo.2038.1"> permission: </span><strong class="source-inline"><span class="koboSpan" id="kobo.2039.1">0</span></strong><span class="koboSpan" id="kobo.2040.1"> (no </span><span class="No-Break"><span class="koboSpan" id="kobo.2041.1">bits set)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2042.1">The resulting corroborated number is </span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.2043.1">also known as the </span><em class="italic"><span class="koboSpan" id="kobo.2044.1">octal value</span></em><span class="koboSpan" id="kobo.2045.1"> of the file permissions (see the </span><em class="italic"><span class="koboSpan" id="kobo.2046.1">File permission examples</span></em><span class="koboSpan" id="kobo.2047.1"> section). </span><span class="koboSpan" id="kobo.2047.2">Here’s an illustration of the file </span><span class="No-Break"><span class="koboSpan" id="kobo.2048.1">permission attributes:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer117">
<span class="koboSpan" id="kobo.2049.1"><img alt="Figure 4.31 – The file permission attributes" src="image/Figure_04_31_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2050.1">Figure 4.31 – The file permission attributes</span></p>
<p><span class="koboSpan" id="kobo.2051.1">Next, let’s consider</span><a id="_idIndexMarker586"/> <span class="No-Break"><span class="koboSpan" id="kobo.2052.1">some examples.</span></span></p>
<h4><span class="koboSpan" id="kobo.2053.1">File permission examples</span></h4>
<p><span class="koboSpan" id="kobo.2054.1">Now, let’s go back and evaluate the file </span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.2055.1">access permissions for </span><strong class="source-inline"><span class="koboSpan" id="kobo.2056.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.2057.1">: </span><strong class="source-inline"><span class="koboSpan" id="kobo.2058.1">-rw-r--r--</span></strong><span class="koboSpan" id="kobo.2059.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.2060.1">as follows:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2061.1">-</span></strong><span class="koboSpan" id="kobo.2062.1">: The first character (byte) denotes the file type (a regular file, in </span><span class="No-Break"><span class="koboSpan" id="kobo.2063.1">our case)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2064.1">rw-</span></strong><span class="koboSpan" id="kobo.2065.1">: The next three-character sequence indicates the user owner permissions; (in our case, read (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2066.1">r</span></strong><span class="koboSpan" id="kobo.2067.1">); write (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2068.1">w</span></strong><span class="koboSpan" id="kobo.2069.1">); octal value = </span><strong class="source-inline"><span class="koboSpan" id="kobo.2070.1">4</span></strong><span class="koboSpan" id="kobo.2071.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2072.1">r</span></strong><span class="koboSpan" id="kobo.2073.1">) + </span><strong class="source-inline"><span class="koboSpan" id="kobo.2074.1">2</span></strong><span class="koboSpan" id="kobo.2075.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2076.1">w</span></strong><span class="koboSpan" id="kobo.2077.1">) = </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2078.1">6</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2079.1"> (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2080.1">rw</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2081.1">))</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2082.1">r--</span></strong><span class="koboSpan" id="kobo.2083.1">: The next 3-byte sequence defines the group owner permissions (in our case, read (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2084.1">r</span></strong><span class="koboSpan" id="kobo.2085.1">); octal value = </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2086.1">4</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2087.1"> (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2088.1">r</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2089.1">))</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2090.1">r--</span></strong><span class="koboSpan" id="kobo.2091.1">: The last three characters denote the permissions for all other users in the system (in our case, read (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2092.1">r</span></strong><span class="koboSpan" id="kobo.2093.1">); octal value = </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2094.1">4</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2095.1"> (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2096.1">r</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2097.1">))</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2098.1">According to the preceding information, the resulting octal value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2099.1">/etc/passwd</span></strong><span class="koboSpan" id="kobo.2100.1"> file access permissions is </span><strong class="source-inline"><span class="koboSpan" id="kobo.2101.1">644</span></strong><span class="koboSpan" id="kobo.2102.1">. </span><span class="koboSpan" id="kobo.2102.2">Alternatively, we can query the octal value with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2103.1">stat</span></strong><span class="koboSpan" id="kobo.2104.1"> command, </span><span class="No-Break"><span class="koboSpan" id="kobo.2105.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2106.1">
stat --format '%a' /etc/passwd</span></pre> <p><span class="koboSpan" id="kobo.2107.1">The command yields the </span><span class="No-Break"><span class="koboSpan" id="kobo.2108.1">following output:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2109.1">
644</span></pre> <p><span class="koboSpan" id="kobo.2110.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2111.1">stat</span></strong><span class="koboSpan" id="kobo.2112.1"> command displays the file or filesystem status. </span><span class="koboSpan" id="kobo.2112.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2113.1">--format</span></strong><span class="koboSpan" id="kobo.2114.1"> option parameter specifies the access rights in octal format (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2115.1">'%a'</span></strong><span class="koboSpan" id="kobo.2116.1">) for </span><span class="No-Break"><span class="koboSpan" id="kobo.2117.1">the output.</span></span></p>
<p><span class="koboSpan" id="kobo.2118.1">Here are a few examples of </span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.2119.1">access permissions, with their corresponding octal values and descriptions. </span><span class="koboSpan" id="kobo.2119.2">The three-character sequences are intentionally delimited with whitespace for clarity. </span><span class="koboSpan" id="kobo.2119.3">The leading file type has </span><span class="No-Break"><span class="koboSpan" id="kobo.2120.1">been omitted:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2121.1">rwx</span></strong><span class="koboSpan" id="kobo.2122.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2123.1">777</span></strong><span class="koboSpan" id="kobo.2124.1">): Read, write, and execute for all users including owner, group, </span><span class="No-Break"><span class="koboSpan" id="kobo.2125.1">and world</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2126.1">rwx r-x</span></strong><span class="koboSpan" id="kobo.2127.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2128.1">755</span></strong><span class="koboSpan" id="kobo.2129.1">): Read and execute for all users; the file owner has </span><span class="No-Break"><span class="koboSpan" id="kobo.2130.1">write permissions</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2131.1">rwx r-x ---</span></strong><span class="koboSpan" id="kobo.2132.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2133.1">750</span></strong><span class="koboSpan" id="kobo.2134.1">): Read and execute for owner and group; the owner has write permissions while others have </span><span class="No-Break"><span class="koboSpan" id="kobo.2135.1">no access</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2136.1">rwx --- ---</span></strong><span class="koboSpan" id="kobo.2137.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2138.1">700</span></strong><span class="koboSpan" id="kobo.2139.1">): Read, write, and execute for owner; everyone else has </span><span class="No-Break"><span class="koboSpan" id="kobo.2140.1">no permissions</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2141.1">rw- rw- rw-</span></strong><span class="koboSpan" id="kobo.2142.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2143.1">666</span></strong><span class="koboSpan" id="kobo.2144.1">): Read and write for all users; there are no </span><span class="No-Break"><span class="koboSpan" id="kobo.2145.1">execute permissions</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2146.1">rw- rw- r--</span></strong><span class="koboSpan" id="kobo.2147.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2148.1">664</span></strong><span class="koboSpan" id="kobo.2149.1">): Read and write for owner and group; read </span><span class="No-Break"><span class="koboSpan" id="kobo.2150.1">for others</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2151.1">rw- rw- ---</span></strong><span class="koboSpan" id="kobo.2152.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2153.1">660</span></strong><span class="koboSpan" id="kobo.2154.1">): Read and write for owner and group; others have </span><span class="No-Break"><span class="koboSpan" id="kobo.2155.1">no permissions</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2156.1">rw- r-- r--</span></strong><span class="koboSpan" id="kobo.2157.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2158.1">644</span></strong><span class="koboSpan" id="kobo.2159.1">): Read and write for owner; read for group </span><span class="No-Break"><span class="koboSpan" id="kobo.2160.1">and others</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2161.1">rw- r-- ---</span></strong><span class="koboSpan" id="kobo.2162.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2163.1">640</span></strong><span class="koboSpan" id="kobo.2164.1">): Read and write for owner; read for group; no permissions </span><span class="No-Break"><span class="koboSpan" id="kobo.2165.1">for others</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2166.1">rw- --- ---</span></strong><span class="koboSpan" id="kobo.2167.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2168.1">600</span></strong><span class="koboSpan" id="kobo.2169.1">): Read and write for owner; no permissions for group </span><span class="No-Break"><span class="koboSpan" id="kobo.2170.1">and others</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2171.1">r-- --- ---</span></strong><span class="koboSpan" id="kobo.2172.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2173.1">400</span></strong><span class="koboSpan" id="kobo.2174.1">): Read for owner; no permissions </span><span class="No-Break"><span class="koboSpan" id="kobo.2175.1">for others</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2176.1">Read, write, and execute are the most common types of file access permissions. </span><span class="koboSpan" id="kobo.2176.2">So far, we have mostly focused on permission types and their representation. </span><span class="koboSpan" id="kobo.2176.3">In the next section, we will explore a</span><a id="_idIndexMarker589"/><span class="koboSpan" id="kobo.2177.1"> few command-line tools used for </span><span class="No-Break"><span class="koboSpan" id="kobo.2178.1">altering permissions.</span></span></p>
<h3><span class="koboSpan" id="kobo.2179.1">Changing permissions</span></h3>
<p><span class="koboSpan" id="kobo.2180.1">Modifying file and </span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.2181.1">directory access permissions is a common Linux administrative task. </span><span class="koboSpan" id="kobo.2181.2">In this section, we will learn about a few command-line utilities that are handy when it comes to changing permissions and ownership of files and directories. </span><span class="koboSpan" id="kobo.2181.3">These tools are installed with any modern-day Linux distribution, and their use is similar across most </span><span class="No-Break"><span class="koboSpan" id="kobo.2182.1">Linux platforms.</span></span></p>
<h4><span class="koboSpan" id="kobo.2183.1">Using chmod</span></h4>
<p><span class="koboSpan" id="kobo.2184.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2185.1">chmod</span></strong><span class="koboSpan" id="kobo.2186.1"> command is</span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.2187.1"> short for </span><em class="italic"><span class="koboSpan" id="kobo.2188.1">change mode</span></em><span class="koboSpan" id="kobo.2189.1">, and it’s used to set access permissions on files and directories. </span><span class="koboSpan" id="kobo.2189.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2190.1">chmod</span></strong><span class="koboSpan" id="kobo.2191.1"> command can </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.2192.1">be used by both the current user (owner) and </span><span class="No-Break"><span class="koboSpan" id="kobo.2193.1">a superuser.</span></span></p>
<p><span class="koboSpan" id="kobo.2194.1">Changing permissions can be done in two different modes: </span><strong class="bold"><span class="koboSpan" id="kobo.2195.1">relative</span></strong><span class="koboSpan" id="kobo.2196.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.2197.1">absolute</span></strong><span class="koboSpan" id="kobo.2198.1">. </span><span class="koboSpan" id="kobo.2198.2">Let’s take a look at each </span><span class="No-Break"><span class="koboSpan" id="kobo.2199.1">of them.</span></span></p>
<h4><span class="koboSpan" id="kobo.2200.1">Using chmod in relative mode</span></h4>
<p><span class="koboSpan" id="kobo.2201.1">Changing permissions in </span><strong class="bold"><span class="koboSpan" id="kobo.2202.1">relative</span></strong><strong class="bold"><a id="_idIndexMarker593"/></strong><span class="koboSpan" id="kobo.2203.1"> mode is </span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.2204.1">probably the easiest of the two. </span><span class="koboSpan" id="kobo.2204.2">It is important to remember </span><span class="No-Break"><span class="koboSpan" id="kobo.2205.1">the following:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.2206.1">To whom</span></em><span class="koboSpan" id="kobo.2207.1"> we change permissions: </span><strong class="source-inline"><span class="koboSpan" id="kobo.2208.1">u</span></strong><span class="koboSpan" id="kobo.2209.1"> = user (owner), </span><strong class="source-inline"><span class="koboSpan" id="kobo.2210.1">g</span></strong><span class="koboSpan" id="kobo.2211.1"> = group, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2212.1">o</span></strong><span class="koboSpan" id="kobo.2213.1"> = </span><span class="No-Break"><span class="koboSpan" id="kobo.2214.1">others</span></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.2215.1">How</span></em><span class="koboSpan" id="kobo.2216.1"> we change permissions: </span><strong class="source-inline"><span class="koboSpan" id="kobo.2217.1">+</span></strong><span class="koboSpan" id="kobo.2218.1"> = add, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2219.1">-</span></strong><span class="koboSpan" id="kobo.2220.1"> = remove, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2221.1">=</span></strong><span class="koboSpan" id="kobo.2222.1"> = exactly </span><span class="No-Break"><span class="koboSpan" id="kobo.2223.1">as is</span></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.2224.1">Which</span></em><span class="koboSpan" id="kobo.2225.1"> permission we change: </span><strong class="source-inline"><span class="koboSpan" id="kobo.2226.1">r</span></strong><span class="koboSpan" id="kobo.2227.1"> = read, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2228.1">w</span></strong><span class="koboSpan" id="kobo.2229.1"> = write, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2230.1">x</span></strong><span class="koboSpan" id="kobo.2231.1"> = </span><span class="No-Break"><span class="koboSpan" id="kobo.2232.1">execute</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2233.1">Let’s explore a few examples of using </span><strong class="source-inline"><span class="koboSpan" id="kobo.2234.1">chmod</span></strong><span class="koboSpan" id="kobo.2235.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.2236.1">relative mode.</span></span></p>
<p><span class="koboSpan" id="kobo.2237.1">In our first example, we want to add write (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2238.1">w</span></strong><span class="koboSpan" id="kobo.2239.1">) permissions for all </span><em class="italic"><span class="koboSpan" id="kobo.2240.1">other</span></em><span class="koboSpan" id="kobo.2241.1"> (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2242.1">o</span></strong><span class="koboSpan" id="kobo.2243.1">) users (</span><em class="italic"><span class="koboSpan" id="kobo.2244.1">world</span></em><span class="koboSpan" id="kobo.2245.1">), to </span><strong class="source-inline"><span class="koboSpan" id="kobo.2246.1">myfile</span></strong><span class="koboSpan" id="kobo.2247.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.2248.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2249.1">
chmod o+w myfile</span></pre> <p><span class="koboSpan" id="kobo.2250.1">The related command-line output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2251.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer118">
<span class="koboSpan" id="kobo.2252.1"><img alt="Figure 4.32 – Setting write permissions to all other users" src="image/Figure_04_32_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2253.1">Figure 4.32 – Setting write permissions to all other users</span></p>
<p><span class="koboSpan" id="kobo.2254.1">In the </span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.2255.1">next example, we</span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.2256.1"> remove the read (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2257.1">r</span></strong><span class="koboSpan" id="kobo.2258.1">) and write (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2259.1">w</span></strong><span class="koboSpan" id="kobo.2260.1">) permissions for the current user owner (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2261.1">u</span></strong><span class="koboSpan" id="kobo.2262.1">) of </span><strong class="source-inline"><span class="koboSpan" id="kobo.2263.1">myfile</span></strong><span class="koboSpan" id="kobo.2264.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.2265.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2266.1">
chmod u-rw myfile</span></pre> <p><span class="koboSpan" id="kobo.2267.1">The command-line output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2268.1">shown here:</span></span></p>
<p class="IMG---Figure"/>
<div>
<div class="IMG---Figure" id="_idContainer119">
<span class="koboSpan" id="kobo.2269.1"><img alt="Figure 4.33 – Removing read-write permissions for owner" src="image/Figure_04_33_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2270.1">Figure 4.33 – Removing read-write permissions for owner</span></p>
<p><span class="koboSpan" id="kobo.2271.1">We did not use </span><strong class="source-inline"><span class="koboSpan" id="kobo.2272.1">sudo</span></strong><span class="koboSpan" id="kobo.2273.1"> in either of the preceding examples since we carried out the operations as the current owner of the </span><span class="No-Break"><span class="koboSpan" id="kobo.2274.1">file (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2275.1">packt</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2276.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2277.1">In the following example, we assume that </span><strong class="source-inline"><span class="koboSpan" id="kobo.2278.1">myfile</span></strong><span class="koboSpan" id="kobo.2279.1"> has read, write, and execute permissions for everyone. </span><span class="koboSpan" id="kobo.2279.2">Then, we carry out the </span><span class="No-Break"><span class="koboSpan" id="kobo.2280.1">following changes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.2281.1">Remove the read (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2282.1">r</span></strong><span class="koboSpan" id="kobo.2283.1">) permission for the </span><span class="No-Break"><span class="koboSpan" id="kobo.2284.1">owner (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2285.1">u</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2286.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.2287.1">Remove the write (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2288.1">w</span></strong><span class="koboSpan" id="kobo.2289.1">) permission for the owner (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2290.1">u</span></strong><span class="koboSpan" id="kobo.2291.1">) and </span><span class="No-Break"><span class="koboSpan" id="kobo.2292.1">group (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2293.1">g</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2294.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.2295.1">Remove the read (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2296.1">r</span></strong><span class="koboSpan" id="kobo.2297.1">), write (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2298.1">w</span></strong><span class="koboSpan" id="kobo.2299.1">), and execute (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2300.1">x</span></strong><span class="koboSpan" id="kobo.2301.1">) permissions for everyone </span><span class="No-Break"><span class="koboSpan" id="kobo.2302.1">else (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2303.1">o</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2304.1">)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2305.1">This is illustrated in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.2306.1">code snippet:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2307.1">
chmod u-r,ug-w,o-rwx myfile</span></pre> <p><span class="koboSpan" id="kobo.2308.1">The command-line</span><a id="_idIndexMarker597"/><span class="koboSpan" id="kobo.2309.1"> output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2310.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer120">
<span class="koboSpan" id="kobo.2311.1"><img alt="Figure 4.34 – A relatively complex invocation of chmod in relative mode" src="image/Figure_04_34_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2312.1">Figure 4.34 – A relatively complex invocation of chmod in relative mode</span></p>
<p><span class="koboSpan" id="kobo.2313.1">Next, let’s look</span><a id="_idIndexMarker598"/><span class="koboSpan" id="kobo.2314.1"> at a second way of changing permissions: using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2315.1">chmod</span></strong><span class="koboSpan" id="kobo.2316.1"> command-line utility in absolute mode, by specifying the octal number corresponding to the </span><span class="No-Break"><span class="koboSpan" id="kobo.2317.1">access permissions.</span></span></p>
<h4><span class="koboSpan" id="kobo.2318.1">Using chmod in absolute mode</span></h4>
<p><span class="koboSpan" id="kobo.2319.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.2320.1">absolute</span></strong><span class="koboSpan" id="kobo.2321.1"> mode invocation of </span><strong class="source-inline"><span class="koboSpan" id="kobo.2322.1">chmod</span></strong><span class="koboSpan" id="kobo.2323.1"> changes all </span><a id="_idIndexMarker599"/><span class="koboSpan" id="kobo.2324.1">permission attributes at once, using an </span><em class="italic"><span class="koboSpan" id="kobo.2325.1">octal</span></em><span class="koboSpan" id="kobo.2326.1"> number. </span><span class="koboSpan" id="kobo.2326.2">The </span><em class="italic"><span class="koboSpan" id="kobo.2327.1">absolute</span></em><span class="koboSpan" id="kobo.2328.1"> designation of this method is due to changing permissions without any </span><a id="_idIndexMarker600"/><span class="koboSpan" id="kobo.2329.1">reference to existing ones, by simply assigning the octal value corresponding to the </span><span class="No-Break"><span class="koboSpan" id="kobo.2330.1">access permissions.</span></span></p>
<p><span class="koboSpan" id="kobo.2331.1">Here’s a quick list of the octal values corresponding to </span><span class="No-Break"><span class="koboSpan" id="kobo.2332.1">effective permissions:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2333.1">7</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.2334.1">rwx</span></strong><span class="koboSpan" id="kobo.2335.1">: Read, write, </span><span class="No-Break"><span class="koboSpan" id="kobo.2336.1">and execute</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2337.1">6</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.2338.1">rw-</span></strong><span class="koboSpan" id="kobo.2339.1">: Read </span><span class="No-Break"><span class="koboSpan" id="kobo.2340.1">and write</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2341.1">5</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.2342.1">r-w</span></strong><span class="koboSpan" id="kobo.2343.1">: Read </span><span class="No-Break"><span class="koboSpan" id="kobo.2344.1">and execute</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2345.1">4</span></strong> <span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2346.1">r--</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2347.1">: Read</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2348.1">3</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.2349.1">-wx</span></strong><span class="koboSpan" id="kobo.2350.1">: Write </span><span class="No-Break"><span class="koboSpan" id="kobo.2351.1">and execute</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2352.1">2</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.2353.1">-</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2354.1">w-</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2355.1">: Write</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2356.1">1</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.2357.1">--</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2358.1">x</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2359.1">: Execute</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2360.1">0</span></strong> <strong class="source-inline"><span class="koboSpan" id="kobo.2361.1">---</span></strong><span class="koboSpan" id="kobo.2362.1">: </span><span class="No-Break"><span class="koboSpan" id="kobo.2363.1">No permissions</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2364.1">In the following example, we change the permissions of </span><strong class="source-inline"><span class="koboSpan" id="kobo.2365.1">myfile</span></strong><span class="koboSpan" id="kobo.2366.1"> to read (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2367.1">r</span></strong><span class="koboSpan" id="kobo.2368.1">), write (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2369.1">w</span></strong><span class="koboSpan" id="kobo.2370.1">), and execute (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2371.1">x</span></strong><span class="koboSpan" id="kobo.2372.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.2373.1">for</span></span><span class="No-Break"><a id="_idIndexMarker601"/></span><span class="No-Break"><span class="koboSpan" id="kobo.2374.1"> everybody:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2375.1">
chmod 777 myfile</span></pre> <p><span class="koboSpan" id="kobo.2376.1">The related change is illustrated by the following </span><span class="No-Break"><span class="koboSpan" id="kobo.2377.1">command-line output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer121">
<span class="koboSpan" id="kobo.2378.1"><img alt="Figure 4.35 – The chmod invocation in absolute mode" src="image/Figure_04_35_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2379.1">Figure 4.35 – The chmod invocation in absolute mode</span></p>
<p><span class="koboSpan" id="kobo.2380.1">For more information </span><a id="_idIndexMarker602"/><span class="koboSpan" id="kobo.2381.1">about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2382.1">chmod</span></strong><span class="koboSpan" id="kobo.2383.1"> command, please refer to the related documentation (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2384.1">man chmod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2385.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2386.1">Let’s now look at our next command-line utility, specializing in file and directory </span><span class="No-Break"><span class="koboSpan" id="kobo.2387.1">ownership changes.</span></span></p>
<h4><span class="koboSpan" id="kobo.2388.1">Using chown</span></h4>
<p><span class="koboSpan" id="kobo.2389.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2390.1">chown</span></strong><span class="koboSpan" id="kobo.2391.1"> command (short for </span><em class="italic"><span class="koboSpan" id="kobo.2392.1">change owner</span></em><span class="koboSpan" id="kobo.2393.1">) is</span><a id="_idIndexMarker603"/><span class="koboSpan" id="kobo.2394.1"> used to set</span><a id="_idIndexMarker604"/><span class="koboSpan" id="kobo.2395.1"> the ownership of files and directories. </span><span class="koboSpan" id="kobo.2395.2">Typically, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2396.1">chmod</span></strong><span class="koboSpan" id="kobo.2397.1"> command can only be run with </span><em class="italic"><span class="koboSpan" id="kobo.2398.1">superuser</span></em><span class="koboSpan" id="kobo.2399.1"> privileges (that is, by a </span><em class="italic"><span class="koboSpan" id="kobo.2400.1">sudoer</span></em><span class="koboSpan" id="kobo.2401.1">). </span><span class="koboSpan" id="kobo.2401.2">Regular users can only change the </span><em class="italic"><span class="koboSpan" id="kobo.2402.1">group</span></em><span class="koboSpan" id="kobo.2403.1"> ownership of their files, and only when they are a member of the </span><span class="No-Break"><span class="koboSpan" id="kobo.2404.1">target group.</span></span></p>
<p><span class="koboSpan" id="kobo.2405.1">The syntax of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2406.1">chown</span></strong><span class="koboSpan" id="kobo.2407.1"> command is </span><span class="No-Break"><span class="koboSpan" id="kobo.2408.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2409.1">
chown [OPTIONS] [OWNER][:[GROUP]] FILE</span></pre> <p><span class="koboSpan" id="kobo.2410.1">Usually, we invoke the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2411.1">chown</span></strong><span class="koboSpan" id="kobo.2412.1"> command with both user </span><em class="italic"><span class="koboSpan" id="kobo.2413.1">and</span></em><span class="koboSpan" id="kobo.2414.1"> group ownerships—for example, </span><span class="No-Break"><span class="koboSpan" id="kobo.2415.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2416.1">
sudo chown julian:developers myfile</span></pre> <p><span class="koboSpan" id="kobo.2417.1">The related command-line output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2418.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer122">
<span class="koboSpan" id="kobo.2419.1"><img alt="Figure 4.36 – A simple invocation of the chown command" src="image/Figure_04_36_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2420.1">Figure 4.36 – A simple invocation of the chown command</span></p>
<p><span class="koboSpan" id="kobo.2421.1">One of the most common uses of </span><strong class="source-inline"><span class="koboSpan" id="kobo.2422.1">chown</span></strong><span class="koboSpan" id="kobo.2423.1"> is for </span><em class="italic"><span class="koboSpan" id="kobo.2424.1">recursive mode</span></em><span class="koboSpan" id="kobo.2425.1"> invocation, with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2426.1">-R, --recursive</span></strong><span class="koboSpan" id="kobo.2427.1"> option. </span><span class="koboSpan" id="kobo.2427.2">The</span><a id="_idIndexMarker605"/><span class="koboSpan" id="kobo.2428.1"> following</span><a id="_idIndexMarker606"/><span class="koboSpan" id="kobo.2429.1"> example changes the ownership permissions of all files in </span><strong class="source-inline"><span class="koboSpan" id="kobo.2430.1">mydir</span></strong><span class="koboSpan" id="kobo.2431.1"> (directory), initially owned by </span><strong class="source-inline"><span class="koboSpan" id="kobo.2432.1">root</span></strong><span class="koboSpan" id="kobo.2433.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.2434.1">to </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2435.1">julian</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2436.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2437.1">
sudo chown -R julian:julian mydir/</span></pre> <p><span class="koboSpan" id="kobo.2438.1">The related changes are shown in the following </span><span class="No-Break"><span class="koboSpan" id="kobo.2439.1">command-line output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer123">
<span class="koboSpan" id="kobo.2440.1"><img alt="Figure 4.37 – Invoking ls and chown in recursive mode" src="image/Figure_04_37_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2441.1">Figure 4.37 – Invoking ls and chown in recursive mode</span></p>
<p><span class="koboSpan" id="kobo.2442.1">For more information</span><a id="_idIndexMarker607"/><span class="koboSpan" id="kobo.2443.1"> about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2444.1">chown</span></strong><span class="koboSpan" id="kobo.2445.1"> command, please refer to the related documentation (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2446.1">man chown</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2447.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2448.1">Next, let’s briefly look at a</span><a id="_idIndexMarker608"/><span class="koboSpan" id="kobo.2449.1"> similar command-line utility that specializes exclusively in group </span><span class="No-Break"><span class="koboSpan" id="kobo.2450.1">ownership changes.</span></span></p>
<h4><span class="koboSpan" id="kobo.2451.1">Using chgrp</span></h4>
<p><span class="koboSpan" id="kobo.2452.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2453.1">chgrp</span></strong><span class="koboSpan" id="kobo.2454.1"> command (short for </span><em class="italic"><span class="koboSpan" id="kobo.2455.1">change group</span></em><span class="koboSpan" id="kobo.2456.1">) </span><a id="_idIndexMarker609"/><span class="koboSpan" id="kobo.2457.1">is used to</span><a id="_idIndexMarker610"/><span class="koboSpan" id="kobo.2458.1"> change the </span><em class="italic"><span class="koboSpan" id="kobo.2459.1">group</span></em><span class="koboSpan" id="kobo.2460.1"> ownership for files and directories. </span><span class="koboSpan" id="kobo.2460.2">In Linux, files and directories typically belong to a user (owner) or a group. </span><span class="koboSpan" id="kobo.2460.3">We can set user ownership by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2461.1">chown</span></strong><span class="koboSpan" id="kobo.2462.1"> command-line utility, while group ownership can be set </span><span class="No-Break"><span class="koboSpan" id="kobo.2463.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2464.1">chgrp</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2465.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.2466.1">The syntax for </span><strong class="source-inline"><span class="koboSpan" id="kobo.2467.1">chgrp</span></strong><span class="koboSpan" id="kobo.2468.1"> is </span><span class="No-Break"><span class="koboSpan" id="kobo.2469.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2470.1">
chgrp [OPTIONS] GROUP FILE</span></pre> <p><span class="koboSpan" id="kobo.2471.1">The following example changes the group ownership of </span><strong class="source-inline"><span class="koboSpan" id="kobo.2472.1">myfile</span></strong><span class="koboSpan" id="kobo.2473.1"> to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2474.1">developers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2475.1"> group:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2476.1">
sudo chgrp developers myfile</span></pre> <p><span class="koboSpan" id="kobo.2477.1">The changes are shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.2478.1">following output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer124">
<span class="koboSpan" id="kobo.2479.1"><img alt="Figure 4.38 - Using chgrp to change group ownership" src="image/Figure_04_38_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2480.1">Figure 4.38 - Using chgrp to change group ownership</span></p>
<p><span class="koboSpan" id="kobo.2481.1">The preceding command has </span><a id="_idIndexMarker611"/><span class="koboSpan" id="kobo.2482.1">been invoked with superuser privileges (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2483.1">sudo</span></strong><span class="koboSpan" id="kobo.2484.1">) since the current user (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2485.1">packt</span></strong><span class="koboSpan" id="kobo.2486.1">) is not </span><a id="_idIndexMarker612"/><span class="koboSpan" id="kobo.2487.1">an admin for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2488.1">developers</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2489.1"> group.</span></span></p>
<p><span class="koboSpan" id="kobo.2490.1">For more information about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2491.1">chgrp</span></strong><span class="koboSpan" id="kobo.2492.1"> utility, please refer to the tool’s command-line help (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2493.1">chgrp --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2494.1">).</span></span></p>
<h4><span class="koboSpan" id="kobo.2495.1">Using umask</span></h4>
<p><span class="koboSpan" id="kobo.2496.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2497.1">umask</span></strong><span class="koboSpan" id="kobo.2498.1"> command is </span><a id="_idIndexMarker613"/><span class="koboSpan" id="kobo.2499.1">used to view</span><a id="_idIndexMarker614"/><span class="koboSpan" id="kobo.2500.1"> or set the default </span><em class="italic"><span class="koboSpan" id="kobo.2501.1">file mode mask</span></em><span class="koboSpan" id="kobo.2502.1"> in the system. </span><span class="koboSpan" id="kobo.2502.2">The file mode represents the default permissions for any new files and directories created by a user. </span><span class="koboSpan" id="kobo.2502.3">For example, the default file mode masks in Ubuntu are </span><span class="No-Break"><span class="koboSpan" id="kobo.2503.1">given here:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2504.1">0002</span></strong><span class="koboSpan" id="kobo.2505.1"> for a </span><span class="No-Break"><span class="koboSpan" id="kobo.2506.1">regular user</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2507.1">0022</span></strong><span class="koboSpan" id="kobo.2508.1"> for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2509.1">root</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2510.1"> user</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2511.1">As a general rule in Linux, the </span><em class="italic"><span class="koboSpan" id="kobo.2512.1">default permissions</span></em><span class="koboSpan" id="kobo.2513.1"> for new files and directories are calculated with the </span><span class="No-Break"><span class="koboSpan" id="kobo.2514.1">following formulas:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2515.1">0666 – umask</span></strong><span class="koboSpan" id="kobo.2516.1">: For a new file created by a </span><span class="No-Break"><span class="koboSpan" id="kobo.2517.1">regular user</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2518.1">0777 – umask</span></strong><span class="koboSpan" id="kobo.2519.1">: For a new directory created by a </span><span class="No-Break"><span class="koboSpan" id="kobo.2520.1">regular user</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2521.1">According to the preceding formula, on Ubuntu, we have the following </span><span class="No-Break"><span class="koboSpan" id="kobo.2522.1">default permissions:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.2523.1">File (regular user): </span><strong class="source-inline"><span class="koboSpan" id="kobo.2524.1">0666 – 0002 = </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2525.1">0664</span></strong></span></li>
<li><span class="koboSpan" id="kobo.2526.1">File (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2527.1">root</span></strong><span class="koboSpan" id="kobo.2528.1">): </span><strong class="source-inline"><span class="koboSpan" id="kobo.2529.1">0666 – 0022 = </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2530.1">0644</span></strong></span></li>
<li><span class="koboSpan" id="kobo.2531.1">Directory (regular user): </span><strong class="source-inline"><span class="koboSpan" id="kobo.2532.1">0777 – 0002 = </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2533.1">0775</span></strong></span></li>
<li><span class="koboSpan" id="kobo.2534.1">Directory (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2535.1">root</span></strong><span class="koboSpan" id="kobo.2536.1">): </span><strong class="source-inline"><span class="koboSpan" id="kobo.2537.1">0777 – 0022 = </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2538.1">0755</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2539.1">In the following </span><a id="_idIndexMarker615"/><span class="koboSpan" id="kobo.2540.1">examples, run on Ubuntu, we create a file (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2541.1">myfile</span></strong><span class="koboSpan" id="kobo.2542.1">) and a directory (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2543.1">mydir</span></strong><span class="koboSpan" id="kobo.2544.1">), using the terminal session of a regular user (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2545.1">packt</span></strong><span class="koboSpan" id="kobo.2546.1">). </span><span class="koboSpan" id="kobo.2546.2">Then, we query the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2547.1">stat</span></strong><span class="koboSpan" id="kobo.2548.1"> command for each and </span><a id="_idIndexMarker616"/><span class="koboSpan" id="kobo.2549.1">verify that the default permissions match the values enumerated previously for regular users (file: </span><strong class="source-inline"><span class="koboSpan" id="kobo.2550.1">664</span></strong><span class="koboSpan" id="kobo.2551.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.2552.1">directory: </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2553.1">775</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2554.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2555.1">Let’s start with the default file permissions first, </span><span class="No-Break"><span class="koboSpan" id="kobo.2556.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2557.1">
touch myfile2
stat --format '%a' myfile2</span></pre> <p><span class="koboSpan" id="kobo.2558.1">The related output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2559.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2560.1">
664</span></pre> <p><span class="koboSpan" id="kobo.2561.1">Next, let’s verify the default directory permissions, </span><span class="No-Break"><span class="koboSpan" id="kobo.2562.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2563.1">
mkdir mydir2
stat --format '%a' mydir2</span></pre> <p><span class="koboSpan" id="kobo.2564.1">The related output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2565.1">shown here:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2566.1">
775</span></pre> <p><span class="koboSpan" id="kobo.2567.1">Here’s a list with the typical </span><strong class="source-inline"><span class="koboSpan" id="kobo.2568.1">umask</span></strong><span class="koboSpan" id="kobo.2569.1"> values for files and directories on </span><span class="No-Break"><span class="koboSpan" id="kobo.2570.1">Linux systems:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer125">
<span class="koboSpan" id="kobo.2571.1"><img alt="Figure 4.39 – Typical umask values on Linux" src="image/Figure_04_39_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2572.1">Figure 4.39 – Typical umask values on Linux</span></p>
<p><span class="koboSpan" id="kobo.2573.1">For more information about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2574.1">umask</span></strong><span class="koboSpan" id="kobo.2575.1"> utility, please refer to the tool’s command-line help (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2576.1">umask --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2577.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2578.1">File and directory </span><a id="_idIndexMarker617"/><span class="koboSpan" id="kobo.2579.1">permissions are critical for a secure environment. </span><span class="koboSpan" id="kobo.2579.2">Users and processes should operate exclusively within the isolation and security constraints controlled by permissions, to avoid inadvertent or deliberate interference with the use and ownership of system resources. </span><span class="koboSpan" id="kobo.2579.3">There are cases, particularly in user impersonation situations, when</span><a id="_idIndexMarker618"/><span class="koboSpan" id="kobo.2580.1"> the access rights may involve some special permission attributes. </span><span class="koboSpan" id="kobo.2580.2">Let’s have a look </span><span class="No-Break"><span class="koboSpan" id="kobo.2581.1">at them.</span></span></p>
<h3><span class="koboSpan" id="kobo.2582.1">Special permissions</span></h3>
<p><span class="koboSpan" id="kobo.2583.1">In Linux, the ownership of </span><a id="_idIndexMarker619"/><span class="koboSpan" id="kobo.2584.1">files and directories is usually determined by the UID and GID of the user—or group—who created them. </span><span class="koboSpan" id="kobo.2584.2">The same principle applies to applications and processes—they are owned by the users who launch them. </span><span class="koboSpan" id="kobo.2584.3">The special permissions are meant to change this default behavior </span><span class="No-Break"><span class="koboSpan" id="kobo.2585.1">when needed.</span></span></p>
<p><span class="koboSpan" id="kobo.2586.1">Here are the special permission flags, with their respective </span><span class="No-Break"><span class="koboSpan" id="kobo.2587.1">octal values:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2588.1">setuid</span></strong><span class="koboSpan" id="kobo.2589.1">: 2 ^ 2 = </span><strong class="source-inline"><span class="koboSpan" id="kobo.2590.1">4</span></strong><span class="koboSpan" id="kobo.2591.1"> (bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2592.1">2 set)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2593.1">setgid</span></strong><span class="koboSpan" id="kobo.2594.1">: 2 ^ 1 = </span><strong class="source-inline"><span class="koboSpan" id="kobo.2595.1">2</span></strong><span class="koboSpan" id="kobo.2596.1"> (bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2597.1">1 set)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2598.1">sticky</span></strong><span class="koboSpan" id="kobo.2599.1">: 2 ^ 0 = </span><strong class="source-inline"><span class="koboSpan" id="kobo.2600.1">1</span></strong><span class="koboSpan" id="kobo.2601.1"> (bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2602.1">0 set)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2603.1">When any of these special bits are set, the overall octal number of the access permissions will have an extra digit, with the leading (high-order) digit corresponding to the special permission’s </span><span class="No-Break"><span class="koboSpan" id="kobo.2604.1">octal value.</span></span></p>
<p><span class="koboSpan" id="kobo.2605.1">Let’s look at these special permission flags, with examples </span><span class="No-Break"><span class="koboSpan" id="kobo.2606.1">for each.</span></span></p>
<h4><span class="koboSpan" id="kobo.2607.1">The setuid permission</span></h4>
<p><span class="koboSpan" id="kobo.2608.1">With the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2609.1">setuid</span></strong><span class="koboSpan" id="kobo.2610.1"> bit set, when an</span><a id="_idIndexMarker620"/><span class="koboSpan" id="kobo.2611.1"> executable file is launched, it will run with the privileges of the file owner instead of the user who launched it. </span><span class="koboSpan" id="kobo.2611.2">For example, if the executable is owned by </span><strong class="source-inline"><span class="koboSpan" id="kobo.2612.1">root</span></strong><span class="koboSpan" id="kobo.2613.1"> and launched by a </span><em class="italic"><span class="koboSpan" id="kobo.2614.1">regular</span></em><span class="koboSpan" id="kobo.2615.1"> user, it will run with </span><strong class="source-inline"><span class="koboSpan" id="kobo.2616.1">root</span></strong><span class="koboSpan" id="kobo.2617.1"> privileges. </span><span class="koboSpan" id="kobo.2617.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2618.1">setuid</span></strong><span class="koboSpan" id="kobo.2619.1"> permission could pose a potential security risk when used inadequately, or when vulnerabilities of the underlying process could </span><span class="No-Break"><span class="koboSpan" id="kobo.2620.1">be exploited.</span></span></p>
<p><span class="koboSpan" id="kobo.2621.1">In the file access permission field, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2622.1">setuid</span></strong><span class="koboSpan" id="kobo.2623.1"> bit could have either of the </span><span class="No-Break"><span class="koboSpan" id="kobo.2624.1">following representations:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2625.1">s</span></strong> <em class="italic"><span class="koboSpan" id="kobo.2626.1">replacing</span></em><span class="koboSpan" id="kobo.2627.1"> the corresponding executable bit (</span><strong class="source-inline"><span class="koboSpan" id="kobo.2628.1">x</span></strong><span class="koboSpan" id="kobo.2629.1">) (when the executable bit </span><span class="No-Break"><span class="koboSpan" id="kobo.2630.1">is present)</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.2631.1">S</span></strong><span class="koboSpan" id="kobo.2632.1"> (the capital letter) for a </span><span class="No-Break"><span class="koboSpan" id="kobo.2633.1">non-executable file</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.2634.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2635.1">setuid</span></strong><span class="koboSpan" id="kobo.2636.1"> permission can be set via the following </span><strong class="source-inline"><span class="koboSpan" id="kobo.2637.1">chmod</span></strong><span class="koboSpan" id="kobo.2638.1"> command (for example, for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2639.1">myscript.sh</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.2640.1">executable file):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2641.1">
chmod u+s myscript.sh</span></pre> <p><span class="koboSpan" id="kobo.2642.1">The resulting file permissions are shown here (including the octal value): </span><strong class="source-inline"><span class="koboSpan" id="kobo.2643.1">-</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2644.1">rwsrwxr-x</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2645.1"> (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2646.1">4775</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2647.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2648.1">Here is the related </span><span class="No-Break"><span class="koboSpan" id="kobo.2649.1">command-line output:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<span class="koboSpan" id="kobo.2650.1"><img alt="Figure 4.40 – The setuid permission" src="image/Figure_04_40_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2651.1">Figure 4.40 – The setuid permission</span></p>
<p><span class="koboSpan" id="kobo.2652.1">In the preceding screenshot, you can see the difference in permissions. </span><span class="koboSpan" id="kobo.2652.2">Before applying the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2653.1">chmod</span></strong><span class="koboSpan" id="kobo.2654.1"> command, the permissions are </span><strong class="source-inline"><span class="koboSpan" id="kobo.2655.1">-rwxrwxr-x</span></strong><span class="koboSpan" id="kobo.2656.1">, and after applying the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2657.1">setuid</span></strong><span class="koboSpan" id="kobo.2658.1"> permission with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2659.1">chmod</span></strong><span class="koboSpan" id="kobo.2660.1"> command, an </span><strong class="source-inline"><span class="koboSpan" id="kobo.2661.1">s</span></strong><span class="koboSpan" id="kobo.2662.1"> (referring to </span><strong class="source-inline"><span class="koboSpan" id="kobo.2663.1">setuid</span></strong><span class="koboSpan" id="kobo.2664.1">) is included in the user’s permission, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2665.1">-rwsrwxr-x</span></strong><span class="koboSpan" id="kobo.2666.1">. </span><span class="koboSpan" id="kobo.2666.2">For more information on </span><strong class="source-inline"><span class="koboSpan" id="kobo.2667.1">setuid</span></strong><span class="koboSpan" id="kobo.2668.1">, please visit </span><a href="https://docs.oracle.com/cd/E19683-01/816-4883/secfile-69/index.html"><span class="koboSpan" id="kobo.2669.1">https://docs.oracle.com/cd/E19683-01/816-4883/secfile-69/index.html</span></a><span class="koboSpan" id="kobo.2670.1"> or refer to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2671.1">chmod</span></strong><span class="koboSpan" id="kobo.2672.1"> command-line</span><a id="_idIndexMarker621"/><span class="koboSpan" id="kobo.2673.1"> utility documentation (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2674.1">man chmod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2675.1">).</span></span></p>
<h4><span class="koboSpan" id="kobo.2676.1">The setgid permission</span></h4>
<p><span class="koboSpan" id="kobo.2677.1">While </span><strong class="source-inline"><span class="koboSpan" id="kobo.2678.1">setuid</span></strong><span class="koboSpan" id="kobo.2679.1"> controls user</span><a id="_idIndexMarker622"/><span class="koboSpan" id="kobo.2680.1"> impersonation privileges, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2681.1">setgid</span></strong><span class="koboSpan" id="kobo.2682.1"> has a similar effect on group </span><span class="No-Break"><span class="koboSpan" id="kobo.2683.1">impersonation permissions.</span></span></p>
<p><span class="koboSpan" id="kobo.2684.1">When an executable file has the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2685.1">setgid</span></strong><span class="koboSpan" id="kobo.2686.1"> bit set, it runs using the permissions of the group that owns the file, rather than the group of the user who initiated it. </span><span class="koboSpan" id="kobo.2686.2">In other words, the GID of the process is the same as the GID of </span><span class="No-Break"><span class="koboSpan" id="kobo.2687.1">the file.</span></span></p>
<p><span class="koboSpan" id="kobo.2688.1">When used on a directory, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2689.1">setgid</span></strong><span class="koboSpan" id="kobo.2690.1"> bit changes the default ownership behavior so that files created within the directory will have group ownership of the parent directory instead of the group associated with the user who created them. </span><span class="koboSpan" id="kobo.2690.2">This behavior could be adequate in file-sharing situations when files can be changed by all users associated with the parent directory’s </span><span class="No-Break"><span class="koboSpan" id="kobo.2691.1">owner group.</span></span></p>
<p><span class="koboSpan" id="kobo.2692.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2693.1">setgid</span></strong><span class="koboSpan" id="kobo.2694.1"> permission can be set via the following </span><strong class="source-inline"><span class="koboSpan" id="kobo.2695.1">chmod</span></strong><span class="koboSpan" id="kobo.2696.1"> command (for example, for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2697.1">myscript.sh</span></strong><span class="koboSpan" id="kobo.2698.1"> executable file, the original file, before applying </span><strong class="source-inline"><span class="koboSpan" id="kobo.2699.1">setuid</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.2700.1">to it):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2701.1">
chmod g+s myscript.shw</span></pre> <p><span class="koboSpan" id="kobo.2702.1">The resulting file permissions are shown here (including the octal value): </span><strong class="source-inline"><span class="koboSpan" id="kobo.2703.1">-</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2704.1">rwxrwsr-x</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2705.1"> (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2706.1">2775</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2707.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2708.1">The command-line output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2709.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer127">
<span class="koboSpan" id="kobo.2710.1"><img alt="Figure 4.41 – The setgid permission" src="image/Figure_04_41_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2711.1">Figure 4.41 – The setgid permission</span></p>
<p><span class="koboSpan" id="kobo.2712.1">For more information on </span><strong class="source-inline"><span class="koboSpan" id="kobo.2713.1">setgid</span></strong><span class="koboSpan" id="kobo.2714.1">, please visit </span><a href="https://en.wikipedia.org/wiki/Setuid"><span class="koboSpan" id="kobo.2715.1">https://en.wikipedia.org/wiki/Setuid</span></a><span class="koboSpan" id="kobo.2716.1"> or refer to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2717.1">chmod</span></strong><span class="koboSpan" id="kobo.2718.1"> command-line utility</span><a id="_idIndexMarker623"/><span class="koboSpan" id="kobo.2719.1"> documentation (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2720.1">man chmod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2721.1">).</span></span></p>
<h4><span class="koboSpan" id="kobo.2722.1">The sticky permission</span></h4>
<p><span class="koboSpan" id="kobo.2723.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2724.1">sticky</span></strong><span class="koboSpan" id="kobo.2725.1"> bit has no effect </span><a id="_idIndexMarker624"/><span class="koboSpan" id="kobo.2726.1">on files. </span><span class="koboSpan" id="kobo.2726.2">For a directory with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2727.1">sticky</span></strong><span class="koboSpan" id="kobo.2728.1"> permission, only the user owner or group owner of the directory can delete or rename files within the directory. </span><span class="koboSpan" id="kobo.2728.2">Users or groups with write access to the directory, by way of user or group ownership, cannot delete or modify files in the directory. </span><span class="koboSpan" id="kobo.2728.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2729.1">sticky</span></strong><span class="koboSpan" id="kobo.2730.1"> permission is useful when a directory is owned by a privileged group whose members share write access to files in </span><span class="No-Break"><span class="koboSpan" id="kobo.2731.1">that directory.</span></span></p>
<p><span class="koboSpan" id="kobo.2732.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.2733.1">sticky</span></strong><span class="koboSpan" id="kobo.2734.1"> permission can be set via the following </span><strong class="source-inline"><span class="koboSpan" id="kobo.2735.1">chmod</span></strong><span class="koboSpan" id="kobo.2736.1"> command (for example, for the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2737.1">mydir</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2738.1"> directory):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.2739.1">
chmod +t mydir</span></pre> <p><span class="koboSpan" id="kobo.2740.1">The resulting directory permissions are shown here (including the octal value): </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2741.1">drwxrwxr-t</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2742.1"> (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2743.1">1775</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2744.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2745.1">The command-line output is </span><span class="No-Break"><span class="koboSpan" id="kobo.2746.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer128">
<span class="koboSpan" id="kobo.2747.1"><img alt="Figure 4.42 – The sticky permission" src="image/Figure_04_42_B19682.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.2748.1">Figure 4.42 – The sticky permission</span></p>
<p><span class="koboSpan" id="kobo.2749.1">For more information on </span><strong class="source-inline"><span class="koboSpan" id="kobo.2750.1">sticky</span></strong><span class="koboSpan" id="kobo.2751.1">, please visit </span><a href="https://en.wikipedia.org/wiki/Setuid"><span class="koboSpan" id="kobo.2752.1">https://en.wikipedia.org/wiki/Setuid</span></a><span class="koboSpan" id="kobo.2753.1"> or refer to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2754.1">chmod</span></strong><span class="koboSpan" id="kobo.2755.1"> command-line utility documentation (</span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2756.1">man chmod</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.2757.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.2758.1">Interpreting permissions </span><a id="_idIndexMarker625"/><span class="koboSpan" id="kobo.2759.1">can be a daunting task. </span><span class="koboSpan" id="kobo.2759.2">This section aimed to demystify some of the related intricacies, and we hope that you will feel more comfortable handling file and directory permissions in everyday Linux </span><span class="No-Break"><span class="koboSpan" id="kobo.2760.1">administration tasks.</span></span></p>
<h1 id="_idParaDest-85"><a id="_idTextAnchor101"/><span class="koboSpan" id="kobo.2761.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.2762.1">In this chapter, we explored some of the essential concepts related to managing users and groups in Linux. </span><span class="koboSpan" id="kobo.2762.2">We learned about file and directory permissions and the different access levels of a multiuser environment. </span><span class="koboSpan" id="kobo.2762.3">For each main topic, we focused on basic administrative tasks, providing various practical examples and using typical command-line tools for everyday user access and permission </span><span class="No-Break"><span class="koboSpan" id="kobo.2763.1">management operations.</span></span></p>
<p><span class="koboSpan" id="kobo.2764.1">Managing users and groups, and the related filesystem permissions that come into play, is an indispensable skill of a Linux administrator. </span><span class="koboSpan" id="kobo.2764.2">The knowledge gained in this chapter will, we hope, put you on track to becoming a </span><span class="No-Break"><span class="koboSpan" id="kobo.2765.1">proficient superuser.</span></span></p>
<p><span class="koboSpan" id="kobo.2766.1">In the following chapter, we continue our journey of mastering Linux internals by exploring processes, daemons, and </span><strong class="bold"><span class="koboSpan" id="kobo.2767.1">inter-process communication</span></strong><span class="koboSpan" id="kobo.2768.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.2769.1">IPC</span></strong><span class="koboSpan" id="kobo.2770.1">) mechanisms. </span><span class="koboSpan" id="kobo.2770.2">An important aspect to keep in mind is that processes and daemons are also </span><em class="italic"><span class="koboSpan" id="kobo.2771.1">owned</span></em><span class="koboSpan" id="kobo.2772.1"> by users or groups. </span><span class="koboSpan" id="kobo.2772.2">The skills learned in this chapter will help us navigate the related territory when we look at </span><em class="italic"><span class="koboSpan" id="kobo.2773.1">who runs what</span></em><span class="koboSpan" id="kobo.2774.1"> at any given time in </span><span class="No-Break"><span class="koboSpan" id="kobo.2775.1">the system.</span></span></p>
<h1 id="_idParaDest-86"><a id="_idTextAnchor102"/><span class="koboSpan" id="kobo.2776.1">Questions</span></h1>
<p><span class="koboSpan" id="kobo.2777.1">Here are a few thoughts and questions that sum up the main ideas covered in </span><span class="No-Break"><span class="koboSpan" id="kobo.2778.1">this chapter:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.2779.1">What is </span><span class="No-Break"><span class="koboSpan" id="kobo.2780.1">a superuser?</span></span></li>
</ol>
<p><strong class="bold"><span class="koboSpan" id="kobo.2781.1">Hint</span></strong><span class="koboSpan" id="kobo.2782.1">: </span><span class="No-Break"><span class="koboSpan" id="kobo.2783.1">Try </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2784.1">sudo</span></strong></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.2785.1">Think of a command-line utility for creating users. </span><span class="koboSpan" id="kobo.2785.2">Can you think of </span><span class="No-Break"><span class="koboSpan" id="kobo.2786.1">another one?</span></span></li>
</ol>
<p><strong class="bold"><span class="koboSpan" id="kobo.2787.1">Hint</span></strong><span class="koboSpan" id="kobo.2788.1">: Think about </span><strong class="source-inline"><span class="koboSpan" id="kobo.2789.1">adduser</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.2790.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2791.1">useradd</span></strong></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.2792.1">What is the octal value of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.2793.1">-rw-rw-r—</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.2794.1">access permission?</span></span></li>
</ol>
<p><strong class="bold"><span class="koboSpan" id="kobo.2795.1">Hint</span></strong><span class="koboSpan" id="kobo.2796.1">: Remember what the values of </span><strong class="source-inline"><span class="koboSpan" id="kobo.2797.1">r</span></strong><span class="koboSpan" id="kobo.2798.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2799.1">w</span></strong><span class="koboSpan" id="kobo.2800.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.2801.1">x</span></strong><span class="koboSpan" id="kobo.2802.1"> are: </span><strong class="source-inline"><span class="koboSpan" id="kobo.2803.1">4</span></strong><span class="koboSpan" id="kobo.2804.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.2805.1">2</span></strong><span class="koboSpan" id="kobo.2806.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.2807.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.2808.1">1</span></strong></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.2809.1">What is the difference between a primary group and a secondary (</span><span class="No-Break"><span class="koboSpan" id="kobo.2810.1">supplementary) group?</span></span></li>
<li><span class="koboSpan" id="kobo.2811.1">How do you change the ownership of a user’s </span><span class="No-Break"><span class="koboSpan" id="kobo.2812.1">home directory?</span></span></li>
<li><span class="koboSpan" id="kobo.2813.1">Can you remove a user from the system without deleting their home </span><span class="No-Break"><span class="koboSpan" id="kobo.2814.1">directory? </span><span class="koboSpan" id="kobo.2814.2">How?</span></span></li>
</ol>
<h1 id="_idParaDest-87"><a id="_idTextAnchor103"/><span class="koboSpan" id="kobo.2815.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.2816.1">Here are a few Packt titles that can help you with the task of </span><span class="No-Break"><span class="koboSpan" id="kobo.2817.1">user management:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.2818.1">Mastering Ubuntu Server – Fourth Edition</span></em><span class="koboSpan" id="kobo.2819.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.2820.1">Jay LaCroix</span></em></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.2821.1">Red Hat Enterprise Linux 9 Administration – Second Edition</span></em><span class="koboSpan" id="kobo.2822.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2823.1">Pablo Iranzo Gómez</span></em><span class="koboSpan" id="kobo.2824.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2825.1">Pedro Ibáñez Requena</span></em><span class="koboSpan" id="kobo.2826.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2827.1">Miguel Pérez Colino</span></em><span class="koboSpan" id="kobo.2828.1">, and </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.2829.1">Scott McCarty</span></em></span></li>
</ul>
</div>
</body></html>