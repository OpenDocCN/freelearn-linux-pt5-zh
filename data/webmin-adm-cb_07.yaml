- en: Chapter 7. Backing Up Your System
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章 备份系统
- en: 'In this chapter, we will cover the following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论以下主题：
- en: Backing up configuration files
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 备份配置文件
- en: Restoring configuration files from backup
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从备份恢复配置文件
- en: Automatically backing up configuration files
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动备份配置文件
- en: Creating a backup of a selected directory
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建选定目录的备份
- en: Creating a backup of an entire mount point
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建整个挂载点的备份
- en: Backing up to a remote host
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 备份到远程主机
- en: Setting up automatic backups
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置自动备份
- en: Backing up databases
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 备份数据库
- en: Introduction
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 引言
- en: Data stored on your server is usually more important and valuable than the server
    hardware on which it is stored. Keeping your server secure and your data safe
    is one of the top priorities of a system administrator. As much as we hope to
    avoid trouble such as hardware failures or malicious security breaches, we need
    to be prepared to fix the consequences of these problems. Making regular backups
    of your data is essential to recover from unforeseen disasters. You should also
    regularly test the backups you create to make sure they will actually allow you
    to recover data when you need it.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 存储在服务器上的数据通常比存储数据的服务器硬件更为重要和有价值。保持服务器的安全性和数据的安全是系统管理员的首要任务之一。尽管我们希望避免硬件故障或恶意安全攻击等问题，但我们需要为解决这些问题的后果做好准备。定期备份数据对于从意外灾难中恢复至关重要。你还应该定期测试所创建的备份，确保它们在需要时能够恢复数据。
- en: 'In this chapter, we will provide recipes that demonstrate how Webmin helps
    you keep a backup of the following things:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将提供一些示例，演示Webmin如何帮助你备份以下内容：
- en: Data files on your server, such as the source code of your applications and
    data entered and uploaded by users. See *Creating a backup of a selected directory*.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务器上的数据文件，例如应用程序的源代码和用户输入或上传的数据。请参阅*创建选定目录的备份*。
- en: Information stored in databases. See *Backing up databases*.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存储在数据库中的信息。请参阅*备份数据库*。
- en: Configuration settings. See *Backing up configuration files*.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置设置。请参阅*备份配置文件*。
- en: The entire server filesystem. See *Creating a backup of an entire mount point*.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 整个服务器文件系统。请参阅*创建整个挂载点的备份*。
- en: 'Keep the following things in mind when designing your backup strategy:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在设计备份策略时，请牢记以下事项：
- en: '**Complete or incremental backups**: A complete backup of a server or directory
    stores every file from that location. A backup of this type may be quite large,
    even if it is compressed, and your server may need a long time to create it. An
    incremental backup, on the other hand, stores only the files that were changed
    since the previous backup. This consumes much less space and can be completed
    quickly. On the other hand, incremental backups are slightly harder to restore,
    because you must first restore your last complete backup and then add files from
    the incremental backups created since the complete backup was created.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**完整备份或增量备份**：服务器或目录的完整备份会存储该位置的所有文件。此类备份可能非常大，即使是压缩后，创建备份也可能需要很长时间。另一方面，增量备份只会存储自上次备份以来已更改的文件。这会占用更少的空间，并且可以迅速完成。然而，增量备份恢复起来稍微有些困难，因为你必须先恢复上一个完整备份，然后再从增量备份中添加自上次完整备份以来创建的文件。'
- en: '**Online or offline backups**: An online backup is readily accessible by your
    server or another computer, while an offline backup hand is stored on a tape or
    disconnected disk on a shelf. It cannot be accessed without the intervention of
    a human. Online backups are more convenient, but if a malicious attacker takes
    over your system, he/she can erase them. It''s a good idea to keep offline copies
    of your data, as well.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**在线或离线备份**：在线备份可以被服务器或其他计算机轻松访问，而离线备份则存储在磁带或断开连接的磁盘上，通常放在架子上。没有人工干预，无法访问它。在线备份更方便，但如果恶意攻击者接管了你的系统，他/她可以将其删除。最好也保留离线备份副本。'
- en: '**Local or offsite backups**: Keeping your backups in the same building as
    your servers will not protect you in the case of a fire or other disaster. You
    may want to keep additional backups in another remote location.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**本地或异地备份**：将备份保存在与服务器同一建筑物中，在火灾或其他灾难发生时无法保护数据。你可能希望将额外的备份存放在另一个远程位置。'
- en: A perfect backup strategy would store daily (and maybe even hourly) incremental
    backups and periodic (weekly or monthly) full backups in offline and offsite form.
    The number of backups you keep will determine how far back in time you can go
    to retrieve a lost or corrupted file.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 一个完美的备份策略应该存储每日（甚至每小时）的增量备份，并定期（每周或每月）进行完整备份，最好是以离线和异地形式保存。你保留的备份数量将决定你能追溯多长时间来恢复丢失或损坏的文件。
- en: Tip
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Backups may contain sensitive data, such as passwords or other confidential
    information. Make sure to store backups securely, perhaps consider encrypting
    files stored offsite.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 备份可能包含敏感数据，如密码或其他机密信息。请确保安全存储备份，可能考虑加密存储在异地的文件。
- en: In this chapter, we'll demonstrate how to create backups, but it's up to you
    to make sure that the backup files are stored in a safe location and regularly
    tested.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将演示如何创建备份，但你需要确保备份文件存储在安全位置并定期进行测试。
- en: Backing up configuration files
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 备份配置文件
- en: You spend a lot of time setting up your system and optimizing its settings for
    the best performance and features. Erasing a configuration file or even making
    changes that turn out not to be optimal can have dire consequences, especially
    in a production setting. Before making changes, you should make a backup of configuration
    files and keep it handy in case you need to revert to the previous configuration.
    Webmin has a facility to help you do just that.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 你花费了大量时间来设置系统并优化其配置，以获得最佳的性能和功能。删除配置文件或甚至做出不最优的更改可能会带来严重后果，尤其是在生产环境中。在进行更改之前，你应先备份配置文件，并保持备份文件，以便在需要时恢复到先前的配置。Webmin
    提供了一个帮助你做到这一点的功能。
- en: Getting ready
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: In this recipe, we will create backup files with names containing the current
    date. We need to enable this feature. So, before starting the backup process,
    navigate to **Webmin** | **Backup Configuration Files** | **Module Config** and
    answer **Yes** to the question, **Do strftime substitution of backup destinations?**.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将创建包含当前日期的备份文件名。我们需要启用此功能。因此，在开始备份过程之前，进入**Webmin** | **备份配置文件** | **模块配置**，并对**是否进行备份目标的
    strftime 替代？**的问题回答**是**。
- en: How to do it...
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to back up the configuration files:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以备份配置文件：
- en: Create a directory to store local backups in the root directory, for example,
    `/backups`.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在根目录下创建一个用于存储本地备份的目录，例如`/backups`。
- en: Tip
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Make sure that your backup directory is stored on a partition with enough disk
    space so you don't accidentally fill up your entire disk. Placing `/backups` on
    a separate partition or in `/var/backups` may be a good idea.
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 确保你的备份目录存储在一个有足够磁盘空间的分区上，以免意外填满整个磁盘。将`/backups`放在单独的分区或`/var/backups`目录中可能是一个好主意。
- en: You should also protect the backup location from prying eyes. You can use permissions
    and ACLs to do this, as explained in the *Changing ACLs on a directory* section
    of the *Changing file ownership and permissions* recipe in [Chapter 6](ch06.html
    "Chapter 6. Managing Files on Your System"), *Managing Files on Your System*.
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你还应该保护备份位置免受窥探。你可以使用权限和 ACL 来实现这一点，具体操作可以参考[第6章](ch06.html "第6章 管理系统文件")中*更改文件所有权和权限*部分的*更改目录的
    ACL*一节，*管理系统文件*。
- en: Navigate to **Webmin** | **Backup Configuration Files**.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进入**Webmin** | **备份配置文件**。
- en: Select the **Backup now** tab.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**立即备份**选项卡。
- en: From the **Modules to back up** list, select the module you're planning to work
    with, for instance, **Webmin Configuration**.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**要备份的模块**列表中，选择你打算操作的模块，例如**Webmin 配置**。
- en: Tip
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You can backup multiple modules, or even all of them, if you want a more complete
    backup.
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以备份多个模块，甚至所有模块，以获取更完整的备份。
- en: 'Set **Backup destination** to **Local file** and specify the following for
    a filename: `/backups/webmin-config-%Y%m%d%H%M.tgz`.'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份目标**设置为**本地文件**，并为文件名指定以下路径：`/backups/webmin-config-%Y%m%d%H%M.tgz`。
- en: Set **Include in backup** to **Server configuration files**:![How to do it...](img/5849_07_03.jpg)
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**包含在备份中**设置为**服务器配置文件**：![如何操作...](img/5849_07_03.jpg)
- en: Click the **Backup Now** button.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即备份**按钮。
- en: Webmin configuration files will be backed up in a file in the `/backups` directory.
    The name of the file will contain the date and time of the backup.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 配置文件将以文件形式备份到`/backups`目录中。文件名将包含备份的日期和时间。
- en: How it works...
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Webmin knows which configuration files are used by the services it helps you
    configure. When you back up configuration files for a given module, Webmin creates
    a compressed `TAR` file with those files in the location you specify.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 知道哪些配置文件被它帮助配置的服务使用。当你备份某个模块的配置文件时，Webmin 会将这些文件压缩成一个 `TAR` 文件并存储在你指定的位置。
- en: Since we activated `strftime` substitution, patterns preceded by a percent sign
    (`%`) are replaced by date components. For instance, `%Y` is replaced by the year
    number and `%m` by the month number. A full list of available tokens can be found
    by clicking the **Do strftime substitution of backup destinations?** link in the
    **Module Config** screen.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们激活了 `strftime` 替换，前面带有百分号（`%`）的模式将被日期组件替换。例如，`%Y` 将被年份数字替换，`%m` 被月份数字替换。完整的可用标记列表可以通过点击**是否对备份目标执行
    strftime 替换？**链接在**模块配置**界面中找到。
- en: Tip
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Webmin only backs up the files that it is aware of. If you would like to perform
    a complete backup of all configuration files on your server, you should consider
    making a backup of the entire `/etc` directory. Take a look at the *Creating a
    backup of a selected directory* recipe in this chapter for more information.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 仅备份它所知道的文件。如果你想对服务器上的所有配置文件进行完整备份，你应该考虑备份整个`/etc`目录。更多信息请参考本章中的*创建指定目录的备份*章节。
- en: There's more...
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Webmin allows you to back up files to a remote server using the FTP or SFTP
    (SSH) protocol. The steps to do this are the same as listed in the preceding section,
    except for changing the **Backup destination** option to **FTP Server** or **SSH
    Server**. To transfer files to a remote server, you also need to specify the remote
    server's IP or domain name and a username and password on the remote server. You
    may also choose to download the backup to the computer from which you are connecting
    to Webmin by choosing the **Download in browser** destination option.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 允许你使用 FTP 或 SFTP（SSH）协议将文件备份到远程服务器。操作步骤与前面部分列出的一样，唯一不同的是需要将**备份目的地**选项更改为**FTP
    服务器**或**SSH 服务器**。为了将文件传输到远程服务器，你还需要指定远程服务器的 IP 地址或域名，以及远程服务器上的用户名和密码。你还可以选择将备份文件下载到你用来连接
    Webmin 的计算机上，选择**在浏览器中下载**作为目的地选项。
- en: See also
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: There are two other recipes in this chapter related to Webmin's backups of configuration
    settings files. Take a look at the *Restoring configuration files from backup*
    and *Automatically backing up configuration files* recipes of this chapter.
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章还有其他两个与 Webmin 配置文件备份相关的章节。请参阅本章中的*从备份恢复配置文件*和*自动备份配置文件*章节。
- en: Restoring configuration files from backup
  id: totrans-53
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从备份恢复配置文件
- en: If you use Webmin to create backups of configuration files, you can use them
    later to restore system settings if you run into problems with the changes that
    you made since the backup.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用 Webmin 创建配置文件的备份，当你在备份后修改了设置并遇到问题时，可以使用这些备份文件恢复系统设置。
- en: How to do it...
  id: totrans-55
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'To restore the configuration backups, follow these steps:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复配置备份，请按照以下步骤操作：
- en: Navigate to **Webmin** | **Backup Configuration Files**.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**Webmin** | **备份配置文件**。
- en: Select the **Restore now** tab.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**立即恢复**选项卡。
- en: From the **Modules to restore** list, select the module associated with the
    software whose configuration you would like to restore, for instance, **Webmin
    Configuration**.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**要恢复的模块**列表中，选择与您要恢复其配置的软件相关的模块，例如**Webmin 配置**。
- en: Set **Restore from** to **Local file**, click the ellipsis (**…**) button to
    bring up the file chooser, and select the backup file.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**从**设置为**本地文件**，点击省略号（**…**）按钮打开文件选择器，选择备份文件。
- en: Tip
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You may also choose a file located on a remote FTP or SSH server, or upload
    a file from the computer you're using to connect to Webmin.
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你还可以选择一个位于远程 FTP 或 SSH 服务器上的文件，或从你用来连接 Webmin 的计算机上传文件。
- en: Set **Apply configurations?** to **Yes**.
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**应用配置？**设置为**是**。
- en: Set **Just show what will be restored?** to **No**.
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**仅显示将恢复的内容？**设置为**否**。
- en: Click the **Restore Now** button.
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即恢复**按钮。
- en: How it works...
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Webmin keeps an index of files used by each module inside the backup archive.
    When you select one or more modules to restore, Webmin will replace their active
    configuration files with their backed up counterparts. If it's necessary, Webmin
    will restart the services that use the restored configuration files.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin在备份档案内保持每个模块使用的文件的索引。当您选择一个或多个模块进行恢复时，Webmin将用备份的配置文件替换它们的活动配置文件。如果有必要，Webmin将重新启动使用恢复的配置文件的服务。
- en: There's more...
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: It's a good idea to check which files would be restored from backup without
    actually making any changes before restoring the actual backup. To do this, follow
    the preceding section, but set the **Just show what will be restored?** option
    to **Yes**.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在恢复实际备份之前，最好先检查从备份中恢复的文件，而不实际做出任何更改。为此，请按照前面的步骤操作，但将**仅显示将要恢复的内容？**选项设置为**是**。
- en: If you want, you can also inspect the content of the configuration files stored
    in the backup. After all, the backup is just a compressed `TAR` archive, so you
    can extract the files and view them. Take a look at the *Managing files and directories
    on the server* recipe in [Chapter 6](ch06.html "Chapter 6. Managing Files on Your
    System"), *Managing Files on Your System*, to see how you can do this without
    leaving Webmin.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要，您还可以检查存储在备份中的配置文件的内容。毕竟，备份只是一个压缩的`TAR`档案，所以您可以解压文件并查看它们。请查看[第6章](ch06.html
    "第6章。管理系统文件")的*管理服务器上的文件和目录*示例，了解如何在不离开Webmin的情况下进行此操作。
- en: See also
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参见
- en: There are two other recipes in this chapter related to Webmin's backups of configuration
    settings files. Take a look at the *Backing up configuration files* and *Automatically
    backing up configuration files* recipes of this chapter.
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本章节中还有两个与Webmin备份配置设置文件相关的示例。请查看本章节中的*备份配置文件*和*自动备份配置文件*示例。
- en: Automatically backing up configuration files
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自动备份配置文件
- en: Webmin allows you to set up a schedule it will follow to create backups of system
    configuration files automatically. You can use this option to keep a rolling archive
    of configuration changes made on your system.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin允许您设置一个定时计划，自动创建系统配置文件的备份。您可以使用此选项来保留系统配置更改的滚动存档。
- en: Getting ready
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: In this recipe, we will create backup files with names containing the current
    date. We need to enable this feature, so before starting, navigate to **Webmin**
    | **Backup Configuration Files** | **Module Config** and answer **Yes** to the
    question, **Do strftime substitution of backup destinations?**.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个示例中，我们将创建包含当前日期的备份文件名。我们需要启用此功能，因此在开始之前，请导航到**Webmin** | **备份配置文件** | **模块配置**，并对问题**是否进行备份目标的strftime替换？**回答**是**。
- en: How to do it...
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to automatically back up the configuration files:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以自动备份配置文件：
- en: Create a directory to store local backups in the root directory, for example,
    `/backups`.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在根目录下创建一个目录来存储本地备份，例如`/backups`。
- en: Tip
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Make sure that your backup directory is stored on a partition with enough disk
    space so you don't accidentally fill up your entire disk. Placing `/backups` on
    a separate partition or in `/var/backups` may be a good idea.
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 确保备份目录存储在具有足够磁盘空间的分区上，以避免意外填满整个磁盘。将`/backups`放在单独的分区上或放置在`/var/backups`中可能是一个好主意。
- en: You should also protect the backup location from prying eyes. You can use permissions
    and ACLs to do this, as explained in the *Changing ACLs on a directory* section
    of the *Changing file ownership and permissions* recipe in [Chapter 6](ch06.html
    "Chapter 6. Managing Files on Your System"), *Managing Files on Your System*.
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您还应该保护备份位置免受窥探。您可以使用权限和ACL来做到这一点，正如在[第6章](ch06.html "第6章。管理系统文件")的*更改目录的ACL*部分中所解释的那样，*管理系统上的文件*。
- en: Navigate to **Webmin** | **Backup Configuration Files**.
  id: totrans-83
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**Webmin** | **备份配置文件**。
- en: Select the **Scheduled backups** tab.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**定时备份**选项卡。
- en: Click the **Add a new scheduled backup** link.
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加一个新的定时备份**链接。
- en: Select all modules in the **Modules to backup** list.
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**要备份的模块**列表中选择所有模块。
- en: 'Set **Backup destination** to **Local file** and specify the following for
    a filename: `/backups/system-config-%Y%m%d%H%M.tgz`.'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份目标**设置为**本地文件**，并为文件名指定以下内容：`/backups/system-config-%Y%m%d%H%M.tgz`。
- en: Set **Include in backup** to **Server configuration files**.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份中包含的内容**设置为**服务器配置文件**。
- en: Open the **Backup schedule** section.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开**备份计划**部分。
- en: Provide your e-mail address in the **Email result to address** field.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**电子邮件结果发送到地址**字段中提供你的电子邮件地址。
- en: Set **When to send email** to **Always**.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**何时发送电子邮件**设置为**始终**。
- en: Tip
  id: totrans-92
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: After you receive a few e-mails to confirm that backups are working as expected,
    you can come back and switch this option to **Only when an error occurs**.
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在收到几封确认备份正常工作的电子邮件后，你可以回来将此选项切换为**仅当发生错误时**。
- en: Set **Scheduled backup enabled?** to **Yes**, select **Simple schedule**, and
    choose **Daily (at midnight)** from the dropdown.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**启用定期备份？**设置为**是**，选择**简单计划**，然后从下拉菜单中选择**每天（午夜时分）**。
- en: Click the **Create** button.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**按钮。
- en: System configuration files will be backed up every day at midnight to a file
    in the `/backups` directory. The name of the file will contain the date and time
    of the backup.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 系统配置文件将每天午夜备份到`/backups`目录中的一个文件。该文件名将包含备份的日期和时间。
- en: How it works...
  id: totrans-97
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Webmin creates a **cron** job that runs at every midnight. The task creates
    a compressed `TAR` archive containing all the configuration files that Webmin
    is aware of. If an error occurs while creating the backup archive, an e-mail will
    be sent to the provided address.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 创建了一个**cron**作业，该作业在每个午夜运行。该任务会创建一个压缩的 `TAR` 归档，包含 Webmin 所知道的所有配置文件。如果在创建备份归档时发生错误，将会发送电子邮件到提供的地址。
- en: See also
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: Take a look at the *Restoring configuration files from backup* recipe of this
    chapter for information about getting your settings back in case of a problem.
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看本章的*从备份恢复配置文件*部分，以了解在出现问题时如何恢复设置。
- en: Creating a backup of a selected directory
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建选定目录的备份
- en: Webmin allows you to easily back up the contents of a directory to a `TAR` (tape
    archive) file. Backup tasks are saved, so you can perform the backup again with
    a single click in the future.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 允许你轻松地将目录内容备份到一个`TAR`（磁带归档）文件中。备份任务会被保存，因此你将来可以通过单击一次来重新执行备份。
- en: Note
  id: totrans-103
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The `TAR` file format preserves information about file ownership and permissions
    set on each file. It does not, however, store the extended attributes of the files.
    If you're using extended attributes and an `ext` filesystem, you should use the
    `dump` command instead. Take a look at the *Creating a backup of an entire mount
    point* recipe of this chapter for more information about making backups with the
    `dump` command.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: '`TAR` 文件格式保留了有关每个文件的所有权和权限设置的信息。然而，它并不存储文件的扩展属性。如果你正在使用扩展属性并且使用的是 `ext` 文件系统，应该使用
    `dump` 命令。有关使用 `dump` 命令进行备份的更多信息，请参阅本章的*创建整个挂载点的备份*。'
- en: Getting ready
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: In this recipe, we will create backup files with names containing the current
    date. We need to enable this feature. So, before starting, navigate to **System**
    | **Filesystem Backup** | **Module Config** and answer **Yes** to the question,
    **Do strftime substitution of backup destinations?**.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将创建包含当前日期的备份文件名。我们需要启用此功能。所以，在开始之前，请导航到**系统** | **文件系统备份** | **模块配置**并对问题**是否执行备份目标的strftime替换？**回答**是**。
- en: How to do it...
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: Create a directory to store backups in the root directory, for example, `/backups`.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在根目录下创建一个目录来存储备份，例如`/backups`。
- en: Navigate to **System** | **Filesystem Backup**.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**系统** | **文件系统备份**。
- en: Enter the path of the directory you would like to back up, for example, `/var/www`
    in the text field.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文本框中输入你希望备份的目录路径，例如`/var/www`。
- en: Select the **In TAR format** option.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**TAR格式**选项。
- en: Click the **Add a new backup of directory** button.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加一个新的目录备份**按钮。
- en: Set **Backup to** to **File or tape device** and enter the destination backup
    filename in the text field, for example, `/backups/www-%Y%m%d%H%M.tgz`.
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份到**设置为**文件或磁带设备**，并在文本框中输入目标备份文件名，例如 `/backups/www-%Y%m%d%H%M.tgz`。
- en: Open the **Backup Options** section.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开**备份选项**部分。
- en: Set **Compress archive?** to **Yes, with gzip**.
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**压缩归档？**设置为**是，使用gzip**。
- en: Click the **Create and Backup Now** button.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即创建并备份**按钮。
- en: A backup of the directory will be created in a compressed `TAR` archive at the
    specified destination. The filename will include the date and time of creation.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 目录的备份将以压缩的`TAR`归档形式创建，并保存到指定的目标位置。文件名将包括创建的日期和时间。
- en: How it works...
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'Webmin creates a Gzip compressed `TAR` archive of the selected directory in
    the specified backup location. This is roughly equivalent to running the following
    command at the command line:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 会在指定的备份位置创建所选目录的 Gzip 压缩 `TAR` 归档。这大致等同于在命令行中运行以下命令：
- en: '[PRE0]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Before creating the backup, Webmin also executes the `sync` command that flushes
    the filesystem buffers, committing unwritten changes to the disk.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建备份之前，Webmin 还会执行 `sync` 命令，刷新文件系统缓冲区，将未写入的更改提交到磁盘。
- en: There's more...
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: When the time comes to restore files from a backup, you have a number of options.
    You can restore the files to a separate directory and then move them to the original
    location. You can also restore files from the archive directly to their original
    locations.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 当需要从备份中恢复文件时，您有多种选择。您可以先将文件恢复到一个单独的目录，然后再将它们移动到原始位置。您还可以直接将文件从归档恢复到原始位置。
- en: Restoring files from a backup archive
  id: totrans-124
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从备份归档中恢复文件
- en: 'The following steps extract files to a temporary location from which you''ll
    have to move them to their final locations:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤会将文件提取到临时位置，您需要将它们移动到最终位置：
- en: Create a temporary directory (`/tmp/restore`) in which we'll store restored
    files before putting them in their original places.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个临时目录（`/tmp/restore`），我们将在其中存储恢复的文件，然后再将它们放回原来的位置。
- en: Navigate to **System** | **Filesystem Backup**.
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**系统** | **文件系统备份**。
- en: If you are presented with the option of filesystem type to restore, select **TAR**.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果系统提示选择恢复的文件系统类型，请选择**TAR**。
- en: Click the **Restore backup of filesystem** button.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**恢复文件系统备份**按钮。
- en: Set **Restore from file or device** to **File or tape device** and use the file
    chooser (the **...** button) to locate the backup archive you would like to restore.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**从文件或设备恢复**设置为**文件或磁带设备**，然后使用文件选择器（**...**按钮）找到您想要恢复的备份归档。
- en: Set **Restore to directory** to `/tmp/restore`.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**恢复到目录**设置为`/tmp/restore`。
- en: Set **Only show files in backup?** to **No**.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**仅显示备份中的文件？**设置为**否**。
- en: If your backup archive was compressed with Gzip, set **Uncompress archive?**
    to **Yes, with gzip**.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您的备份归档是使用 Gzip 压缩的，请将**解压归档？**设置为**是，使用 gzip**。
- en: Click the **Restore Backup Now** button.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即恢复备份**按钮。
- en: Move the files you want to restore from the `/tmp/restore` directory to their
    original locations.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将您想要恢复的文件从`/tmp/restore`目录移动到原始位置。
- en: Delete the `/tmp/restore` directory.
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除`/tmp/restore`目录。
- en: Tip
  id: totrans-137
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: To place files in their original locations automatically, use the root directory
    (`/`) as **Restore to directory**. Note that this option will place files from
    the backup back in place, but will not delete files created since the backup was
    created. If you would like to restore only those files that were deleted since
    backing up, use the **Don't overwrite files?** option.
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 若要将文件自动放回原位置，请将根目录（`/`）作为**恢复到目录**。请注意，选择此选项会将备份中的文件放回原处，但不会删除自备份以来创建的文件。如果您只想恢复自备份以来已删除的文件，可以使用**不覆盖文件？**选项。
- en: See also
  id: totrans-139
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: Take a look at the *Creating a backup of an entire mount point*, *Backing up
    to a remote host*, and *Setting up automatic backups* recipes of this chapter
    for more information about backing up files on your system.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参阅本章中的*创建整个挂载点的备份*、*备份到远程主机*和*设置自动备份*的相关内容，了解更多关于系统文件备份的信息。
- en: Creating a backup of an entire mount point
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建整个挂载点的备份
- en: Webmin allows you to set up backup tasks that use the UNIX `dump` command to
    archive the entire `ext` filesystem's mount points. This strategy has a number
    of advantages over creating archives using `TAR`. Firstly, all information contained
    in the filesystem is preserved, including extended file attributes, ACLs, special
    files, and so on.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 允许您设置使用 UNIX `dump` 命令的备份任务，以归档整个 `ext` 文件系统的挂载点。与使用 `TAR` 创建归档相比，这种策略有许多优势。首先，文件系统中包含的所有信息都得以保留，包括扩展文件属性、ACL、特殊文件等。
- en: Secondly, `dump` allows you to create incremental archives containing only the
    files changed since the previous backup. The `dump` command uses the concept of
    levels to distinguish between full and partial backups. A level 0 backup will
    archive all files (full backup), while a level 1 will only archive files changed
    since the last level 0 backup. A level 2 backup will archive all files changed
    since the last level 1 backup, and so on. There are 10 levels to choose from,
    and you don't need to use consecutive level numbers. One possible `dump` strategy
    is to perform a level 0 backup every month, a level 3 backup every week, and a
    level 6 backup every day. This means that the daily backups will be relatively
    small and fast, as they keep track only of changes made during the week.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 其次，`dump` 允许您创建增量存档，仅包含自上次备份以来更改的文件。`dump` 命令使用级别概念区分完整和部分备份。级别 0 备份将存档所有文件（完整备份），而级别
    1 将仅存档自上次级别 0 备份以来更改的文件。级别 2 备份将存档自上次级别 1 备份以来更改的所有文件，依此类推。共有 10 个级别可供选择，您不需要使用连续级别编号。一个可能的
    `dump` 策略是每月执行一次级别 0 备份，每周执行一次级别 3 备份，每天执行一次级别 6 备份。这意味着每日备份相对较小且速度快，因为它们仅跟踪本周内的更改。
- en: If you use an incremental backup strategy with `dump`, you'll need to restore
    backups from archives of each level. For example, if you followed the 0-3-6 strategy
    described in the previous paragraph, you would start by restoring files from the
    most recent level 0, then the most recent level 3, and finally, the most recent
    level 6 archive.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您使用 `dump` 的增量备份策略，您将需要从每个级别的存档中恢复备份。例如，如果您遵循上一段描述的 0-3-6 策略，则应从最近的级别 0 开始恢复文件，然后是最近的级别
    3，最后是最近的级别 6 存档。
- en: Tip
  id: totrans-145
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: The `dump` command was designed to write backup archives to magnetic tape drives.
    Webmin will be able to assist you in writing files to a tape device; just specify
    the device name instead of a destination filename when creating a backup task.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: '`dump` 命令旨在将备份存档写入磁带驱动器。Webmin 将能够帮助您将文件写入磁带设备；在创建备份任务时，只需指定设备名称而不是目标文件名。'
- en: Getting ready
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Before starting, install the `dump` package on your system, or check that it
    is installed. Refer to the *Installing software packages* recipe from [Chapter
    1](ch01.html "Chapter 1. Setting Up Your System"), *Setting Up Your System*, for
    more information.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，请在系统上安装 `dump` 包，或检查其是否已安装。有关更多信息，请参阅 [第一章](ch01.html "第 1 章。 设置您的系统")
    中的 *安装软件包* 配方，*设置您的系统*。
- en: You should also prepare a backup destination that is located on another filesystem,
    other than the one you're planning to back up. This may be an external drive,
    a network filesystem, or a magnetic tape device. In this recipe, I will assume
    you're backing up to an external disk mounted as `/media/backups`.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 您还应准备备份目的地，该目的地位于除您计划备份的文件系统之外的其他文件系统上。这可以是外部驱动器、网络文件系统或磁带设备。在本示例中，假设您正在备份到作为
    `/media/backups` 挂载的外部磁盘。
- en: How to do it...
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何做...
- en: Navigate to **System** | **Filesystem Backup**.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 **系统** | **文件系统备份**。
- en: In the text field, enter the mount point that you would like to back up, for
    example, `/`.
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文本字段中，输入要备份的挂载点，例如 `/`。
- en: Click the **Add a new backup of directory** button.
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击 **添加新目录备份** 按钮。
- en: Set **Backup to** to **File or tape device** and enter the destination backup
    filename in the text field, for example, `/media/backups/root-fs-level0-%Y%m%d%H%M.ext4dump`.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **Backup to** 设置为 **文件或磁带设备** 并在文本字段中输入目标备份文件名，例如 `/media/backups/root-fs-level0-%Y%m%d%H%M.ext4dump`。
- en: Note
  id: totrans-155
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: You don't need the file extension, but you may find it useful in the future
    to quickly check what type of filesystem is contained in a backup archive. Change
    `ext4` to `ext3` or `ext2`, depending on your system.
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 不需要文件扩展名，但将来快速检查备份存档中包含的文件系统类型可能会有用。根据您的系统更改 `ext4` 为 `ext3` 或 `ext2`。
- en: Open the **Backup Options** section.
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 **备份选项** 部分。
- en: Set **Update /etc/dumpdates file?** to **Yes**.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **Update /etc/dumpdates file?** 设置为 **是**。
- en: Set **Dump level** to **0 (full backup)**.
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **Dump level** 设置为 **0 (完整备份)**。
- en: Set **Compress data?** to **Yes, with level** and enter `2`.
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **Compress data?** 设置为 **是，级别为** 并输入 `2`。
- en: Click the **Create and Backup Now** button:![How to do it...](img/5849_07_01.jpg)
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击 **创建并立即备份** 按钮:![如何做...](img/5849_07_01.jpg)
- en: A backup of the entire filesystem's mount point will be created in a compressed
    `dump` archive at the specified destination. The filename will include the date
    and time of creation.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 将整个文件系统的挂载点备份为压缩的 `dump` 存档到指定的目的地。文件名将包括创建的日期和时间。
- en: How it works...
  id: totrans-163
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Webmin uses the `dump` command to create a backup archive containing all the
    files from the filesystem mounted in the specified source directory. All the metadata
    contained in the filesystem is also stored in the archive. The backup is compressed
    using the `bzip` algorithm to reduce the size of the archive.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin使用`dump`命令创建一个备份档案，其中包含指定源目录挂载的文件系统中的所有文件。文件系统中包含的所有元数据也被存储在档案中。备份通过`bzip`算法进行压缩，以减小档案的大小。
- en: There's more...
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: In order to create an incremental backup that will be completed more quickly
    and use less disk space, create a `dump` of a level other than 0.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 为了创建一个增量备份，使其更快完成并使用更少的磁盘空间，请创建一个非0级别的`dump`备份。
- en: Creating an incremental backup archive
  id: totrans-167
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建增量备份档案
- en: A `dump` archive of another level will contain only the files that were modified
    since the most recent dump of a lower level was performed. Follow the same steps
    that were given in the preceding section to create an incremental backup, but
    change the **Dump level** parameter to a different value and make sure that the
    filename (or tape label) reflects that this archive contains a backup of this
    level. Remember that you will need the most recent archives of all levels, down
    to level 0, to restore all backed up files.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 另一级别的`dump`档案将只包含自上次进行较低级别备份以来修改过的文件。按照前面章节中的相同步骤创建增量备份，但将**Dump级别**参数更改为其他值，并确保文件名（或磁带标签）反映此档案包含该级别的备份。请记住，您需要所有级别的最新备份档案，包括0级备份，才能恢复所有备份的文件。
- en: Restoring data from a backup archive
  id: totrans-169
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从备份档案恢复数据
- en: 'To restore a backup from a `dump` archive, follow these steps:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 要从`dump`档案恢复备份，请按照以下步骤操作：
- en: Navigate to **System** | **Filesystem Backup**.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**系统** | **文件系统备份**。
- en: If you are presented with the option of the type of filesystem to restore, select
    the type of filesystem you backed up, for example, **EXT4**.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果系统提示选择恢复的文件系统类型，请选择您备份的文件系统类型，例如**EXT4**。
- en: Click the **Restore backup of filesystem** button.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**恢复文件系统备份**按钮。
- en: Set **Restore from file or device** to **File or tape device** and use the file
    chooser (the **...** button) to locate the backup archive you would like to restore.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**从文件或设备恢复**设置为**文件或磁带设备**，并使用文件选择器（**...**按钮）来查找您要恢复的备份档案。
- en: Set **Restore to directory** to the location of the mount point which was backed
    up, for example, `/` for the root mount point, `/home/`, and so on.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**恢复到目录**设置为已备份的挂载点位置，例如根挂载点的`/`、`/home/`等。
- en: Tip
  id: totrans-176
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You do not have to enter the original path as the restore destination. You can
    enter another path to extract the backup to a different location.
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您不必输入原始路径作为恢复目标。您可以输入另一个路径，将备份提取到不同的位置。
- en: Set **Files to restore** to **Everything in backup**.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**恢复的文件**设置为**备份中的所有文件**。
- en: Set **Only show files in backup?** to **No**.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**仅显示备份中的文件？**设置为**否**。
- en: Click the **Restore Backup Now** button.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即恢复备份**按钮。
- en: Tip
  id: totrans-181
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You can check what files are contained in the backup archive by choosing the
    **Only show files in backup?** option.
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过选择**仅显示备份中的文件？**选项，您可以查看备份档案中包含的文件。
- en: If you would like to restore only a few files or directories, set **Files to
    restore** to **Listed files** and enter a list of pathnames separated by spaces.
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果您只想恢复少数文件或目录，请将**恢复的文件**设置为**列出的文件**，并输入以空格分隔的路径列表。
- en: See also
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: Take a look at the *Backing up to a remote host* and *Setting up automatic backups*
    recipes of this chapter for more information about backing up files on your system.
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查看本章中的*备份到远程主机*和*设置自动备份*章节，以获取有关如何备份系统文件的更多信息。
- en: Backing up to a remote host
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 备份到远程主机
- en: Storing backup archives locally on the same machine will not protect you from
    hardware failure or malicious attack. When the machine goes down, backups will
    go down with it. For this reason, backups should be stored remotely on another
    server.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 将备份档案存储在本机的本地硬盘上，并不能保护您免受硬件故障或恶意攻击。当机器出现故障时，备份也会丢失。因此，备份应存储在另一台远程服务器上。
- en: The easiest way to back up to a remote host is to use a network file sharing
    protocol such as NFS or CIFS. You start by creating a network volume on the remote
    server and then mount the volume on your server. Now, you can back up to the files
    on the remote system just as easily as if they were stored locally. Take a look
    at [Chapter 6](ch06.html "Chapter 6. Managing Files on Your System"), *Managing
    Files on Your System*, for instructions on setting up network file sharing using
    NFS or CIFS.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 最简单的备份远程主机的方式是使用网络文件共享协议，如NFS或CIFS。首先，在远程服务器上创建一个网络卷，然后将该卷挂载到本地服务器上。现在，你可以像访问本地存储的文件一样，轻松地备份远程系统上的文件。查看[第6章](ch06.html
    "第6章. 管理系统文件")，*管理系统文件*，获取使用NFS或CIFS设置网络文件共享的说明。
- en: If you have only SSH access to the remote host or want to back up to a remote
    magnetic tape device, you can follow the steps outlined in this recipe. We'll
    demonstrate how Webmin helps you set up either `tar` or `dump` to create remote
    backups over SSH.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你只有SSH访问权限，或者希望备份到远程磁带设备，可以按照此处所列的步骤进行操作。我们将演示Webmin如何帮助你通过SSH设置`tar`或`dump`来进行远程备份。
- en: Getting ready
  id: totrans-190
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: The `root` user of our server will need to access the remote server over SSH
    without entering a password. Instead of a password, SSH will use a key; so, we'll
    need to instruct the remote server to accept it.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 我们服务器的`root`用户需要通过SSH访问远程服务器，而无需输入密码。SSH将使用密钥而非密码；因此，我们需要指示远程服务器接受该密钥。
- en: Let's start by locating the public RSA key of our server's `root` user. The
    key is stored in a file named `/root/.ssh/id_rsa.pub` by default.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 首先找到我们服务器`root`用户的公钥。默认情况下，密钥存储在名为`/root/.ssh/id_rsa.pub`的文件中。
- en: 'If this file does not exist, you may need to create a SSH public and private
    key pair for the `root` user of your server. This can be done by entering the
    following command at the terminal, but by substituting `root@my_server` with the
    e-mail of your server''s root user:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 如果此文件不存在，你可能需要为服务器的`root`用户创建一个SSH公钥和私钥对。可以通过在终端中输入以下命令来完成，但需要将`root@my_server`替换为你服务器`root`用户的电子邮件地址：
- en: '[PRE1]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The next step is to instruct the remote server to accept SSH connections using
    this key. Let's say that we are going to log in as a user called `backups` on
    the remote server. We would need to append the content of the `/root/.ssh/id_rsa.pub`
    file from our local server to the end of the `/home/backups/.ssh/authorized_keys`
    file in the home directory of the user on the remote server.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是指示远程服务器接受使用此密钥的SSH连接。假设我们要以名为`backups`的用户身份登录远程服务器。我们需要将本地服务器`/root/.ssh/id_rsa.pub`文件的内容追加到远程服务器上用户主目录中的`/home/backups/.ssh/authorized_keys`文件末尾。
- en: Note
  id: totrans-196
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Connections made using any of the keys placed in a file named `~/.ssh/authorized_keys`
    in a users' home directory are treated as legitimate, authorized connections.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在用户主目录中名为`~/.ssh/authorized_keys`的文件中放置任何密钥所建立的连接，将被视为合法的、授权的连接。
- en: When this is done, the `root` user of our server should be able to log in over
    SSH to the remote server as the user, `backups`, without providing a password.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此操作后，我们服务器的`root`用户应该能够通过SSH以`backups`用户身份登录到远程服务器，而无需提供密码。
- en: The final step is to make sure that the `rmt` command is installed on the remote
    host while also noting the path to the `rmt` binary. You can check for this by
    running the command, `which rmt` as `root`. If the command is not found, install
    the `rmt` or `tar` package on the remote host.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一步是确保远程主机上安装了`rmt`命令，并注意`rmt`二进制文件的路径。你可以通过以`root`用户身份运行命令`which rmt`来检查。如果命令未找到，请在远程主机上安装`rmt`或`tar`软件包。
- en: How to do it...
  id: totrans-200
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'You can convert any filesystem backup task created in Webmin into a remote
    backup. Start by creating a backup task as described in the *Creating a backup
    of a selected directory* or *Creating a backup of an entire mount point* recipes
    of this chapter. Perform the following steps to back up to a remote host:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以将Webmin中创建的任何文件系统备份任务转换为远程备份。首先，按照本章中*创建指定目录的备份*或*创建整个挂载点的备份*的步骤创建一个备份任务。然后执行以下步骤进行远程备份：
- en: Navigate to **System** | **Filesystem Backup**.
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**系统** | **文件系统备份**。
- en: Click a link in the **Directory to backup** column for the backup that you would
    like to modify.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击**要备份的目录**列中的链接，以修改你想要的备份。
- en: Switch the **Backup to** option to **Host** and enter the IP address or domain
    name of the remote host, followed by the name of the user and the path to the
    backup file on the remote server.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **备份到** 选项切换为 **主机**，并输入远程主机的 IP 地址或域名，后跟用户名和远程服务器上备份文件的路径。
- en: Set **Remote backup command** to **SSH**:![How to do it...](img/5849_07_02.jpg)
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **远程备份命令** 设置为 **SSH**：![如何操作...](img/5849_07_02.jpg)
- en: Open the **Backup options** section.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 **备份选项** 部分。
- en: If you're modifying a `TAR` backup job, set the **Path to rmt on remote system**
    to the path where the `rmt` binary is located on the remote server.
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您正在修改一个 `TAR` 备份任务，将 **远程系统中的 rmt 路径** 设置为 `rmt` 二进制文件在远程服务器上的路径。
- en: Click the **Save and Backup Now** button.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **保存并立即备份** 按钮。
- en: The backup job will run and an archive containing the backup will be created
    in the location specified on the remote server.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 备份任务将会运行，并且一个包含备份的归档文件将在远程服务器上指定的位置创建。
- en: How it works...
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Modern versions of both the `tar` and `dump` commands are able to use the SSH
    protocol to transfer backup archives securely over the Internet to a remote destination
    backup server. Webmin assists you by setting the slightly complex set of options
    needed to run `tar` or `dump` over SSH.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '`tar` 和 `dump` 命令的现代版本能够使用 SSH 协议，将备份归档通过互联网安全地传输到远程备份服务器。Webmin 会帮助您设置运行 `tar`
    或 `dump` 通过 SSH 所需的稍微复杂的选项。'
- en: Setting up automatic backups
  id: totrans-212
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置自动备份
- en: Backups should be performed on a regular schedule. You can use cron to automate
    this process and run backup tasks at specified times. Webmin's backup facility
    makes this very simple.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 备份应定期执行。您可以使用 cron 来自动化此过程，并在指定的时间运行备份任务。Webmin 的备份功能使这变得非常简单。
- en: How to do it...
  id: totrans-214
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'You can convert any filesystem backup task created in Webmin into an automatic
    backup. Start by creating a backup task as described in *Creating a backup of
    a selected directory* or *Creating a backup of an entire mount point* recipes
    of this chapter. Perform the following steps to set up automatic backups:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以将 Webmin 中创建的任何文件系统备份任务转换为自动备份。首先按照本章中 *创建选定目录的备份* 或 *创建整个挂载点的备份* 配方中的描述创建一个备份任务。然后执行以下步骤来设置自动备份：
- en: Navigate to **System** | **Filesystem Backup**.
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航至 **系统** | **文件系统备份**。
- en: Click a link in the **Directory to backup** column for the backup you would
    like to modify.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **要备份的目录** 列中的链接，以修改您想要的备份。
- en: Open the **Backup schedule** section.
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 **备份计划** 部分。
- en: Set **Scheduled backup enabled?** to **Enabled, at times chosen below**.
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置 **计划备份启用？** 为 **启用，按以下所选时间**。
- en: Tip
  id: totrans-220
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If you have a series of backups that you would like to run together, Webmin
    allows you to schedule a backup to run after another backup completes.
  id: totrans-221
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果您有一系列希望一起运行的备份任务，Webmin 允许您安排在一个备份完成后，运行下一个备份任务。
- en: Select **Simple schedule** and **Weekly (on Sunday)**.
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 **简单计划** 和 **每周（星期天）**。
- en: Tip
  id: totrans-223
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Choose a more complex schedule—if you require one—by marking the minutes, hours,
    and days of the month at which the job is to be performed.
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果需要，可以选择更复杂的计划，标记任务将在每月的哪几分钟、几小时和哪几天执行。
- en: Set **Email scheduled output** to your e-mail address.
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **电子邮件计划输出** 设置为您的电子邮件地址。
- en: Click the **Save** button.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **保存** 按钮。
- en: How it works...
  id: totrans-227
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Webmin adds an entry, which starts the backup job to the cron table of your
    system's `root` user. Whenever cron is running during the scheduled time, the
    backup job will be started. When the backup task is completed, you should receive
    a message with information about the success or failure of the job.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 会在系统 `root` 用户的 cron 表中添加一个条目，启动备份任务。每当 cron 在预定时间运行时，备份任务将会启动。当备份任务完成时，您应该会收到一条关于任务成功或失败的消息。
- en: Backing up databases
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 备份数据库
- en: Webmin can help you set up a schedule to perform automatic backups of all databases
    hosted on your system. Webmin will dump the databases as SQL files into a directory
    on your local filesystem or locally mounted remote network volume.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 可以帮助您设置一个计划，自动备份托管在系统上的所有数据库。Webmin 会将数据库作为 SQL 文件转储到本地文件系统的目录中，或本地挂载的远程网络卷中。
- en: Tip
  id: totrans-231
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You can make backups of databases to a local directory and back that directory
    up to a remote server. You can also instruct Webmin to run a command that will
    remove old local backups after transferring them to a remote location.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以将数据库的备份保存到本地目录，并将该目录的备份传输到远程服务器。您还可以指示 Webmin 运行一个命令，在将本地备份传输到远程位置后删除旧的本地备份。
- en: How to do it...
  id: totrans-233
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: Depending on the database system you're using, click either the **MySQL Database
    Server** or **PostgreSQL Database Server** link in the **Servers** section of
    Webmin's main menu.
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据你使用的数据库系统，在Webmin主菜单的**服务器**部分点击**MySQL数据库服务器**或**PostgreSQL数据库服务器**链接。
- en: Click the **Backup Databases** button.
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**备份数据库**按钮。
- en: In the **Backup to directory** field, enter a directory where the database backups
    will be created, for instance, `/backups/databases`.
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**备份到目录**字段中，输入一个目录，备份将保存在该目录下，例如`/backups/databases`。
- en: Set **Create destination directory?** to **Yes**. Webmin will create a directory
    with the appropriate owner and permissions for the database system to write output
    there.
  id: totrans-237
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**是否创建目标目录？**设置为**是**。Webmin将创建一个具有适当所有者和权限的目录，以便数据库系统将输出写入其中。
- en: In the **Backup schedule** section, set **Scheduled backup enabled?** to **Yes,
    at times chosen below**.
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**备份计划**部分，将**启用定时备份？**设置为**是，在下面选择的时间**。
- en: Enter your e-mail address in the **Send backup status email to** field.
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**将备份状态邮件发送到**字段中，输入你的电子邮件地址。
- en: Set **Send email for** to **All backups**.
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**发送电子邮件通知**设置为**所有备份**。
- en: Tip
  id: totrans-241
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: After you receive a few e-mails to confirm that backups are working as expected,
    you can come back and switch this option to **Only when an error occurs**.
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在你收到几封电子邮件确认备份按预期工作后，你可以回来将此选项切换为**仅在发生错误时**。
- en: Choose **Simple schedule** and select **Daily (at midnight)**.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**简单计划**并选择**每日（午夜时）**。
- en: Tip
  id: totrans-244
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Choose a more complex schedule—if you require one—by marking the minutes, hours,
    and days of the month at which the job is to be performed.
  id: totrans-245
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 选择一个更复杂的计划—如果需要的话—通过标记任务执行时的分钟、小时和日期。
- en: '![How to do it...](img/5849_07_04.jpg)'
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5849_07_04.jpg)'
- en: Click the **Save** button.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: Tip
  id: totrans-248
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You can click the **Backup Now** button to save the databases to SQL files immediately.
  id: totrans-249
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 你可以点击**立即备份**按钮，立即将数据库保存为SQL文件。
- en: How it works...
  id: totrans-250
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Webmin accesses your database system and creates an SQL dump file for each database
    on your server. The database files are stored on the disk in the specified directory.
    When you set up a schedule for automatic backups, Webmin adds a job to the `root`
    user's cron table to create the backups at specified times. When a backup task
    is completed, Webmin sends an e-mail to the address specified, but we set it to
    only send e-mails in the event of problems to avoid spamming you unnecessarily.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin访问你的数据库系统，并为服务器上的每个数据库创建一个SQL转储文件。数据库文件将存储在指定目录的磁盘中。当你为自动备份设置计划时，Webmin会将一项任务添加到`root`用户的cron表中，以在指定的时间创建备份。当备份任务完成时，Webmin会将电子邮件发送到指定的地址，但我们将其设置为仅在发生问题时发送电子邮件，以避免不必要的垃圾邮件。
- en: See also
  id: totrans-252
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: Take a look at [Chapter 9](ch09.html "Chapter 9. Running a MySQL Database Server"),
    *Running a MySQL Database Server*, and [Chapter 10](ch10.html "Chapter 10. Running
    a PostgreSQL Database Server"), *Running a PostgreSQL Database Server*, for more
    information about running a database server with the assistance of Webmin.
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请查看[第9章](ch09.html "第9章. 运行MySQL数据库服务器")，*运行MySQL数据库服务器*，以及[第10章](ch10.html
    "第10章. 运行PostgreSQL数据库服务器")，*运行PostgreSQL数据库服务器*，了解更多关于使用Webmin帮助下运行数据库服务器的信息。
