- en: Chapter 9. General Troubleshooting
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 9 章。一般故障排除
- en: It is a common experience amongst all of us that from time to time our computers
    don't always work as we expect and we need to hunt down and resolve problems with
    them. Troubleshooting can be time consuming especially if you have limited experience
    with the software or system you are using. This chapter is a guide on how to solve
    problems with your FreeNAS server. It covers where to look for information about
    the problem as well as how to hunt down problems by being methodical. It also
    looks at the common problems people have with their FreeNAS servers including
    networking problems and problems with RAID.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我们所有人都有过这样的经历：有时我们的计算机无法按照预期工作，我们需要寻找并解决它们的问题。故障排除可能会非常耗时，特别是如果你对所使用的软件或系统经验有限时。本章是关于如何解决
    FreeNAS 服务器问题的指南。它涵盖了在哪里查找问题的信息，以及如何通过系统化的方式排查问题。它还讨论了人们常遇到的 FreeNAS 服务器问题，包括网络问题和
    RAID 问题。
- en: Where to Look for Log Information
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 查找日志信息的位置
- en: 'The first place to head whenever you have a configuration problem with FreeNAS
    is to the related configuration section and check that it is configured as expected.
    If, having double checked the settings, the problem persists, the next port of
    call is the log and information files in the Diagnostics: section of the web interface.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 每当你遇到 FreeNAS 配置问题时，首先应该查看相关的配置部分，检查是否按预期进行了配置。如果经过仔细检查设置后，问题依然存在，下一步就是查看 Web
    界面中诊断部分的日志和信息文件。
- en: Note
  id: totrans-4
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Keep Diagnostics Section Expanded**'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '**保持诊断部分展开**'
- en: 'By default, the menu tree in the Diagnostics section of the web interface is
    collapsed, meaning the menu items aren''t visible. To see the menu items, you
    need to click the word Diagnostics and the tree will expand. During initial setup
    and if you are doing lots of troubleshooting, you can save yourself a click by
    having the Diagnostics section permanently expanded. To set this option, go to
    System: Advanced and click on the **Navigation - Keep diagnostics in navigation
    expanded** tick box.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Web 界面中诊断部分的菜单树是折叠的，这意味着菜单项不可见。要查看菜单项，你需要点击“诊断”一词，菜单树将展开。在初始设置过程中，如果你进行大量故障排除，可以通过让诊断部分始终展开来节省点击次数。要设置此选项，请转到“系统：高级”并勾选
    **导航 - 保持诊断在导航中展开** 复选框。
- en: The Diagnostics sections has five sections, the first two are logs and information
    pages about the status of the FreeNAS server. The other three are networking diagnostic
    tools and information.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 诊断部分包含五个小节，前两个是关于 FreeNAS 服务器状态的日志和信息页面。其他三个是网络诊断工具和信息。
- en: 'Diagnostics: Logs'
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 诊断：日志
- en: 'This section collates all the different log files that are generated by the
    FreeNAS server into one convenient place. There are several tabs, one for each
    different service to log file type. Some of the information can be very technical,
    especially in the System tab. However, with some key information they can become
    more readable. The tabs are as follows:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将 FreeNAS 服务器生成的所有不同日志文件整理到一个方便的地方。有多个标签，每个标签对应不同的服务日志文件类型。有些信息可能非常技术性，特别是在“系统”标签中。然而，通过一些关键信息，它们可以变得更易读。标签如下：
- en: '| Tab | Meaning |'
  id: totrans-10
  prefs: []
  type: TYPE_TB
  zh: '| 标签 | 含义 |'
- en: '| --- | --- |'
  id: totrans-11
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| System | When FreeBSD (the underlying OS of FreeNAS) boots, various log entries
    are recorded here about the hardware of the server and various messages about
    the boot process. |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
  zh: '| 系统 | 当 FreeBSD（FreeNAS 的底层操作系统）启动时，这里记录了有关服务器硬件的各种日志条目以及启动过程中的各类信息。 |'
- en: '| FTP | This shows the activity on the FTP server including successful logins
    and failed logins. |'
  id: totrans-13
  prefs: []
  type: TYPE_TB
  zh: '| FTP | 这显示了 FTP 服务器上的活动，包括成功的登录和登录失败的记录。 |'
- en: '| RSYNC | The log information for the RSYNC server (see chapter 7) is divided
    into three sections: Server, Client, and Local. Depending on which type of RSYNC
    operation you are interested, click the appropriate tab. |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '| RSYNC | RSYNC 服务器的日志信息（参见第 7 章）分为三个部分：服务器、客户端和本地。根据你感兴趣的 RSYNC 操作类型，点击相应的标签。
    |'
- en: '| SSHD | Here you will find log entries from the SSH server including some
    limited startup information and records of logins and failed login attempts. |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
  zh: '| SSHD | 在这里你将找到来自 SSH 服务器的日志条目，包括一些有限的启动信息以及登录和登录失败尝试的记录。 |'
- en: '| SMARTD | This tab logs the output of the S.M.A.R.T daemon. See chapter 8
    for more details on S.M.A.R.T. |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| SMARTD | 这个标签记录了 S.M.A.R.T 守护进程的输出。有关 S.M.A.R.T 的更多细节，请参见第 8 章。 |'
- en: '| Daemon | Any other minor system service like the built-in HTTP server, the
    Apple Filing Protocol server and Windows networking server (Samab) will log information
    to this page. |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| Daemon | 任何其他较小的系统服务，如内置的HTTP服务器、Apple文件协议服务器和Windows网络服务器（Samba），都会将信息记录到此页面。
    |'
- en: '| UPnP | The log information from the FreeNAS UPnP server called "MediaTomb"
    is displayed here. The logging can be quite verbose so careful attention is needed
    when reading it. Don''t be distracted by entires such as "INFO: Config: option
    not found:" as this is just the server logging that it will be using a default
    value for that particular attribute. |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| UPnP | 这里显示的是FreeNAS UPnP服务器“MediaTomb”的日志信息。日志记录可能会非常详细，因此阅读时需要特别注意。不要被类似“INFO:
    Config: option not found:”这样的条目分心，因为这只是服务器记录它将使用该特定属性的默认值。 |'
- en: '| Settings | The settings tab allows you to change how the log information
    is displayed including the sort order and the number of entries shown. |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '| 设置 | 设置标签允许你更改日志信息的显示方式，包括排序顺序和显示的条目数。 |'
- en: Note
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**What is a Daemon?**'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '**什么是守护进程？**'
- en: In UNIX speak, a Daemon is a system service. It is a program that runs in the
    background performing certain tasks. The Daemons in FreeNAS don't work with the
    users in an interactive mode (via the monitor, mouse, and keyboard) and as such
    need a place to log the results (or problems) of their actives. The FreeNAS Daemons
    are launched automatically by FreeBSD when it boots and some are dependent on
    being enabled in the web interface.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在UNIX术语中，守护进程（Daemon）是一个系统服务。它是一个在后台运行的程序，执行某些任务。FreeNAS中的守护进程不与用户进行交互（通过显示器、鼠标和键盘），因此需要一个地方来记录其活动的结果（或问题）。FreeNAS中的守护进程在FreeBSD启动时自动启动，有些守护进程依赖于在Web界面中启用。
- en: 'Understanding Diagnostics—Logs: System'
  id: totrans-23
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解诊断—日志：系统
- en: The most complicated of all the log pages is the System log page. Here, FreeBSD
    logs information about the system, its hardware, and the startup process. At first,
    this page can seem intimidating but with a little help, this page can be very
    helpful particularly in tracking down hardware or driver related problems.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 所有日志页面中最复杂的是系统日志页面。在这里，FreeBSD记录有关系统、硬件和启动过程的信息。刚开始时，这个页面可能会让人觉得有些吓人，但稍加帮助后，这个页面可以非常有用，特别是在追踪硬件或驱动程序相关问题时。
- en: Note
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**50 Log Entries Might Not be Enough**'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**50条日志条目可能不够**'
- en: 'The default number of log entries shown on the Diagnostics: Logs page is 50\.
    For most situations, this will be sufficient but there can be times when it is
    not enough. For example in the Diagnostics: Logs: System tab, the total number
    of log entries made during the boot up process is more than 50\. If you want to
    see how much system memory has been recognized by FreeBSD, you won''t find it
    within the standard 50 entries. The solution is to increase the *Number of log
    entries to show* parameter on the Diagnostics: Logs: Setting tab.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在“诊断：日志”页面上，默认显示的日志条目数量是50\。在大多数情况下，这个数量是足够的，但有时候它可能不足。例如，在“诊断：日志：系统”标签中，启动过程中产生的日志条目总数超过了50\。如果你想查看FreeBSD识别了多少系统内存，你不会在标准的50条条目中找到它。解决方法是增加“诊断：日志：设置”标签中的*显示的日志条目数*参数。
- en: 'The best way to learn to read the Diagnostics: Logs: System page is by example,
    below are several different log entry examples including logs about the CPU, memory,
    disks, and disk controllers:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 学习如何读取“诊断：日志：系统”页面的最佳方式是通过示例，下面是几种不同的日志条目示例，包括关于CPU、内存、磁盘和磁盘控制器的日志：
- en: '[PRE0]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This first entry shows the heritage of the FreeNAS server. It is based on FreeBSD
    and in this particular case, we see that this version of FreeNAS is using FreeBSD
    6.2\. There are plans (which may have already become reality) to use FreeBSD version
    7.0 as the base for FreeNAS.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 第一个条目显示了FreeNAS服务器的起源。它基于FreeBSD，在这个特定的案例中，我们看到这个版本的FreeNAS使用的是FreeBSD 6.2\.
    计划中（也许已经实现）是将FreeBSD 7.0作为FreeNAS的基础。
- en: '[PRE1]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Here, the type of CPU that was detected by the FreeBSD is displayed. In this
    case, it is an Intel Xeon CPU running at 1.7GHz.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，显示了FreeBSD检测到的CPU类型。在这种情况下，它是一个运行在1.7GHz的Intel Xeon CPU。
- en: '[PRE2]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'If your system has more than one CPU or is a dual core machine then you will
    see an entry in the log file (like the one above) recognizing the second CPU.
    If your machine has Hyper-threading technology, then the second logical processor
    will be reported like this: *Logical CPUs per core: 2*'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的系统有多个CPU或是双核机器，那么你将在日志文件中看到一个条目（如上所示）识别第二个CPU。如果你的机器支持超线程技术，那么第二个逻辑处理器将以这种方式显示：*每个核心的逻辑CPU数：2*
- en: '[PRE3]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: These log entries show how much memory the system has detected. The difference
    in size between real memory and available memory is the difference between the
    amount of RAM physically installed in the computer and the amount of memory left
    over after the FreeBSD kernel is loaded.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 这些日志条目显示了系统检测到的内存大小。实际内存和可用内存之间的大小差异是计算机中实际安装的内存量与FreeBSD内核加载后剩余内存量之间的差距。
- en: '[PRE4]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: For disks to work on your FreeNAS server, a disk controller is needed and it
    will be either a standard ATA/IDE controller, a SATA controller or a SCSI controller.
    Above are the log entries for a standard ATA controller built into the motherboard.
    You can see that it is an Intel controller and that two channels have been seen
    (the primary and the secondary).
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 要让磁盘在你的FreeNAS服务器上正常工作，必须有一个磁盘控制器，它可以是标准的ATA/IDE控制器、SATA控制器或SCSI控制器。上面是内建在主板上的标准ATA控制器的日志条目。你可以看到它是一个英特尔控制器，并且已经识别到两个通道（主通道和次通道）。
- en: '[PRE5]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Like the ATA controller listed a moment ago, SATA controllers are all recognized
    at boot up. Here is a SiS 181 SATA 150 controller with two channels. They are
    listed as devices `ata2` and `ata3`—as `ata0` and `ata1` are used by the standard
    ATA/IDE controller.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 像之前提到的ATA控制器一样，SATA控制器在启动时会被系统识别。这里是一个SiS 181 SATA 150控制器，具有两个通道。它们分别列为设备`ata2`和`ata3`——因为`ata0`和`ata1`已被标准ATA/IDE控制器占用。
- en: '[PRE6]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Like IDE and SATA controllers, all recognized SCSI drivers are listed in the
    boot up system log. Here, the controller is an LSILogic 1030 Ultra4.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 像IDE和SATA控制器一样，所有已识别的SCSI驱动程序都会在启动时的系统日志中列出。这里，控制器是LSILogic 1030 Ultra4。
- en: '[PRE7]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Once the disk controllers are recognized by the system, FreeBSD can search to
    see which disks are attached. Above is an example of a Western Digital 500GB hard
    drive using the standard ATA100 interface at 100MB/s. There is also a 500GB Seagate
    drive connected using the SATA interface.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦磁盘控制器被系统识别，FreeBSD就可以开始搜索哪些磁盘已连接。上面是一个西部数据500GB硬盘的示例，使用标准ATA100接口，速度为100MB/s。还有一个500GB的希捷硬盘，连接使用SATA接口。
- en: '[PRE8]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: When the CDROM (which is normally attached to an ATA/IDE controller) is recognized,
    it will look like the above.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 当CDROM（通常连接到ATA/IDE控制器）被识别时，它会像上面那样显示。
- en: '[PRE9]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: SCSI addressing is a little more complicated than that of ATA/IDE. In SCSI land,
    you have a controller, a channel (bus), a disk (target), and the Logical Unit
    Number (LUN). The example above shows that a disk (which has been assigned the
    device name `da0`) is found on the controller `ahd0` on `bus 0`, as `target 0`
    with the `LUN 0`. SCSI controllers can have multiple buses and multiple targets.
    Further down, you can see that the disk is a MAXTOR 73GB SCSI-3 disk.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: SCSI寻址比ATA/IDE更复杂。在SCSI系统中，你有控制器、通道（总线）、磁盘（目标）和逻辑单元号（LUN）。上面的示例显示了一个磁盘（已被分配设备名称`da0`）位于控制器`ahd0`的`bus
    0`上，作为`target 0`，并且具有`LUN 0`。SCSI控制器可以有多个总线和多个目标。进一步来看，你会看到该磁盘是一个MAXTOR 73GB SCSI-3磁盘。
- en: '[PRE10]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: If you are using a USB flash disk for storing the configuration information,
    it will most likely appear in the log file as a type of SCSI disk. The above example
    shows a 1GB Verbatim Store 'n' Go disk.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用USB闪存盘存储配置信息，它很可能在日志文件中显示为一种SCSI磁盘类型。上面的示例显示的是一个1GB的Verbatim Store 'n'
    Go磁盘。
- en: '[PRE11]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Another important device that needs to work correctly on your system is the
    network interface card. Like disk controllers and disks, it will be logged in
    the log file when FreeBSD recognizes it. Above is an example of an AMD Lance/PCNet-based
    Ethernet adapter. Each Ethernet card has a unique address know as the Ethernet
    address or the MAC address. It is made up of 6 numbers specified using a colon
    notation. Once found, FreeBSD queries the card to find its MAC address and logs
    the result. In the above example, it is "00:0c:29:a5:9a:28".
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个需要在系统上正常工作的设备是网络接口卡。像磁盘控制器和磁盘一样，当FreeBSD识别到它时，它会在日志文件中记录。上面是一个基于AMD Lance/PCNet的以太网适配器示例。每个以太网卡都有一个唯一的地址，称为以太网地址或MAC地址。它由6个数字组成，并使用冒号分隔符表示。一旦发现，FreeBSD会查询该卡以获取其MAC地址并记录结果。在上述示例中，它是"00:0c:29:a5:9a:28"。
- en: Converting between Device Names and the Real World
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 在设备名称与实际设备之间进行转换
- en: In the SCSI example above, the SCSI controller listed is *ahd0*. The trick to
    understanding these log entries better is to know how to interpret the device
    name *ahd0*. First of all *ahd0* means it is a device using the *ahd* driver and
    it is the first one in the system (with numbering starting from 0).
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面的SCSI例子中，列出的SCSI控制器是*ahd0*。理解这些日志条目的关键是了解如何解释设备名称*ahd0*。首先，*ahd0*表示这是一个使用*ahd*驱动的设备，并且它是系统中的第一个设备（编号从0开始）。
- en: 'So what is a ahd? The first place to look is further up in the log file. There
    should be an entry like:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，什么是ahd呢？首先需要查看日志文件的上方。应该会有类似以下的条目：
- en: '[PRE12]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'This shows that the particular device is an `Adaptec 39320 SCSI 3` controller.
    You can also find out more about the the *ahd* driver (and all FreeBSD drivers)
    at:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 这显示了特定设备是`Adaptec 39320 SCSI 3`控制器。你还可以在以下链接中找到更多关于*ahd*驱动的信息（以及所有FreeBSD驱动）：
- en: '[http://www.freebsd.org/releases/6.2R/hardware-i386.html](http://www.freebsd.org/releases/6.2R/hardware-i386.html)'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.freebsd.org/releases/6.2R/hardware-i386.html](http://www.freebsd.org/releases/6.2R/hardware-i386.html)'
- en: Search for ahd and you will find which controllers this driver supports (in
    this case, they are all controllers from Adaptec. If you click on the link provided,
    you will be taken to a specific help page about this driver.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索ahd，你将能找到该驱动支持的控制器（在这种情况下，它们都是来自Adaptec的控制器。如果你点击提供的链接，将会跳转到有关该驱动的具体帮助页面）。
- en: 'When FreeNAS moves to FreeBSD 7, then the relevant web page will be:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 当FreeNAS升级到FreeBSD 7时，相应的网页将会是：
- en: '[http://www.freebsd.org/releases/7.0R/hardware.html](http://www.freebsd.org/releases/7.0R/hardware.html)'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.freebsd.org/releases/7.0R/hardware.html](http://www.freebsd.org/releases/7.0R/hardware.html)'
- en: Networking Problems
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络问题
- en: Having reliable networking with Network Attached Storage is, of course, essential.
    This section is aimed at those who are having networking problems.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 与网络附加存储（NAS）建立可靠的网络连接，当然是至关重要的。本节内容是针对那些遇到网络问题的用户。
- en: 'In general, networking problems can be categorized into two: Physical problems
    and software problems. In the physical category are such problems as broken cables
    and faulty hardware and in the software category problems range from device driver
    problems to network configuration errors.'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，网络问题可以分为两类：物理问题和软件问题。物理问题包括如断开电缆和硬件故障，而软件问题则涵盖了从设备驱动问题到网络配置错误等各种情况。
- en: On the surface, most network problems appear the same, the network doesn't work,
    you can't connect. To hunt down the problem there are different things you can
    try.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 从表面上看，大多数网络问题看起来都是一样的，网络无法正常工作，你无法连接。为了找出问题，你可以尝试不同的方法。
- en: General Connection Problems
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 常见连接问题
- en: 'Having booted your FreeNAS server, the first step is to configure the networking.
    This is covered in detail in chapter 2\. Assuming you have configured the networking,
    the next step is to connect to the FreeNAS server using a web browser. If the
    web browser connection fails, the web browser (Firefox in this case) will show
    something like this:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 启动你的FreeNAS服务器后，第一步是配置网络。这部分内容将在第二章详细介绍。假设你已配置好网络，下一步是使用网页浏览器连接到FreeNAS服务器。如果网页浏览器连接失败，网页浏览器（此处以Firefox为例）会显示类似如下的内容：
- en: '![General Connection Problems](img/4688_09_Images_01a.jpg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![常见连接问题](img/4688_09_Images_01a.jpg)'
- en: There are two machines involved in this operation, one is the FreeNAS server
    and the other is the computer with the web browser. First, test that the machine
    with the web browser is working normally. Make sure it can access the Internet
    as well as other machines or devices on your network. If it can't, you need to
    start there!
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 此操作涉及两台机器，一台是FreeNAS服务器，另一台是带有网页浏览器的计算机。首先，测试带有网页浏览器的机器是否正常工作。确保它能访问互联网以及网络中的其他机器或设备。如果不能，你需要从那里开始排查！
- en: 'If the web browser machine is working then the problem could be with the FreeNAS
    server, it is time to find the problem. Use this checklist to make sure everything
    is as it should be:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 如果网页浏览器所在的机器工作正常，那么问题可能出在FreeNAS服务器上，这时就该开始排查问题了。使用以下检查清单来确保一切都按预期进行：
- en: Check that the cable is plugged into the network card of the FreeNAS server.
    It might sound simple, but I have had cases where the cable didn't click in quite
    correct and so the networking didn't work. Assuming that the other end of the
    cable is also plugged in correctly, check that the link LED lights on the FreeNAS
    server and also lights on the switch or hub where it is connected. If you get
    green lights all round then things are good.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查电缆是否插入了 FreeNAS 服务器的网络卡。听起来很简单，但我曾经遇到过电缆插得不完全正确，导致网络无法工作的情况。假设电缆的另一端也插入正确，请检查
    FreeNAS 服务器上的连接 LED 是否亮起，以及交换机或集线器上的指示灯是否亮起。如果看到全绿的指示灯，那就说明一切正常。
- en: 'Check that the network was recognized during the boot up of FreeNAS server.
    As you can''t access the web interface you will need to check this on the console.
    You are looking for something like this:'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查 FreeNAS 服务器启动时是否识别了网络。由于无法访问 web 界面，您需要在控制台上检查此项。您需要查看类似这样的信息：
- en: '![General Connection Problems](img/4688_09_Images_01.jpg)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![常见连接问题](img/4688_09_Images_01.jpg)'
- en: Note
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**What If My Network Card Isn''t Found?**'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '**如果找不到我的网络卡怎么办？**'
- en: 'This probably means that the network card in your machine isn''t supported
    by FreeNAS or more specifically by FreeBSD. Check the FreeBSD hardware compatibility
    page for more information: [http://www.freebsd.org/releases/6.2R/hardware-i386.html](http://www.freebsd.org/releases/6.2R/hardware-i386.html)'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 这很可能意味着您的机器中的网络卡不被 FreeNAS 或更具体地说，FreeBSD 支持。请查看 FreeBSD 硬件兼容页面获取更多信息：[http://www.freebsd.org/releases/6.2R/hardware-i386.html](http://www.freebsd.org/releases/6.2R/hardware-i386.html)
- en: If the cabling is right and the network is found, it is time to double check
    the network settings. The most common mistake is in setting the subnet mask. The
    subnet mask determines which network a machine is on. When you set the subnet
    mask using the console menu system, if the subnet mask isn't the same as the machine
    with the web browser, then connectivity can be lost. Also, incorrect subnet masks
    can cause odd behavior, for example the machine with web browser might be able
    to connect to the FreeNAS server but the server may not be able to reply. A typo
    of 25 (instead of the desired 24) can cause connection problems.
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果电缆连接正确且网络已找到，就该仔细检查网络设置了。最常见的错误是设置子网掩码时出错。子网掩码决定了设备所在的网络。当您使用控制台菜单系统设置子网掩码时，如果子网掩码与使用浏览器的机器不相同，可能会导致连接丢失。此外，错误的子网掩码可能会引起异常行为，例如使用浏览器的机器能够连接到
    FreeNAS 服务器，但服务器可能无法回复。比如，子网掩码输入 25（而不是预期的 24）可能会导致连接问题。
- en: Is the IP address unique? If you have set a static IP address, have you set
    the right one? If two machines are assigned the same IP address, strange things
    can happen. With packets of data destined for one machine arriving at the other
    and so on. Ensure the IP address is correct and that it is unique.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IP 地址是唯一的吗？如果您设置了静态 IP 地址，是否设置了正确的地址？如果两台机器分配了相同的 IP 地址，就会发生奇怪的事情。例如，数据包本应发送到一台机器，却到达了另一台机器，等等。确保
    IP 地址正确且唯一。
- en: If you are using DHCP, ensure that the DHCP server is up and running and it
    has free addresses to issue. If you see that the FreeNAS server has the address
    0.0.0.0, it means that it was unable to get an IP address from the DHCP server.
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果您使用的是 DHCP，请确保 DHCP 服务器正在运行并且有可分配的地址。如果您看到 FreeNAS 服务器的地址是 0.0.0.0，这意味着它无法从
    DHCP 服务器获取 IP 地址。
- en: '![General Connection Problems](img/4688_09_Images_02.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![常见连接问题](img/4688_09_Images_02.jpg)'
- en: Using Ping
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 Ping
- en: Most operating systems (including Windows, Linux, and OS X) have a tool called
    ping that allows you to test the low level connectivity between two machines.
    To test the connection to the FreeNAS machine, you can *ping* it and also you
    can get the FreeNAS server to *ping* other machines.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数操作系统（包括 Windows、Linux 和 OS X）都有一个叫做 ping 的工具，可以用来测试两台机器之间的低层连接。为了测试与 FreeNAS
    机器的连接，您可以*ping*它，也可以让 FreeNAS 服务器*ping*其他机器。
- en: 'On Windows XP to run *ping*, click **Run...** and then type **cmd** in the
    dialog box. Press Enter and a black command prompt will appear. The command to
    *ping* is simply *ping* followed by the IP address. So to *ping* the FreeNAS server
    on its standard address of 192.168.1.250 you would type:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Windows XP 中运行 *ping*，点击 **运行...**，然后在对话框中输入 **cmd**。按 Enter 键后，黑色的命令提示符将会出现。执行
    *ping* 的命令就是输入 *ping*，后面跟上 IP 地址。例如，要对 FreeNAS 服务器的标准地址 192.168.1.250 进行 *ping*，你可以输入：
- en: '[PRE13]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'If all is well, then the FreeNAS server will reply. The output should look
    something like this:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一切正常，那么 FreeNAS 服务器会回复。输出应该类似于下面这样：
- en: '![Using Ping](img/4688_09_Images_03.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![使用 Ping](img/4688_09_Images_03.jpg)'
- en: If the PC can't contact the FreeNAS server then it will report "Request timed
    out" errors.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 如果PC无法联系到FreeNAS服务器，则会报告“请求超时”错误。
- en: 'You can also use the FreeNAS server to ping other machines on the network.
    From the console choose option 5\. You will then be asked to enter an IP address.
    The IP address this time won''t be that of the FreeNAS server, as this command
    is running from the FreeNAS server, but rather of another machine on the network.
    Enter the address and press enter. The output should be something like this:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以使用FreeNAS服务器ping网络上的其他机器。在控制台选择选项5。然后系统会要求你输入一个IP地址。这次输入的IP地址不是FreeNAS服务器的，而是网络上另一台机器的IP地址。输入地址并按回车。输出应该如下所示：
- en: '![Using Ping](img/4688_09_Images_05.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![使用Ping](img/4688_09_Images_05.jpg)'
- en: Note
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Discovering the IP Address of an XP Machine**'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '**发现XP机器的IP地址**'
- en: 'To find out the IP address of an XP machine: Click **Start** then **Run...**
    In the dialog box type **cmd** and press *ENTER*. In the command prompt window,
    type **ipconfig /all**. The resulting output will reveal the IP address along
    with the subnet mask and so on.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 要查找XP机器的IP地址：点击**开始**，然后**运行...** 在对话框中输入**cmd**并按*ENTER*。在命令提示符窗口中，输入**ipconfig
    /all**。结果输出将显示IP地址、子网掩码等信息。
- en: Using Ping from within the Web Interfaces
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在Web界面中使用Ping
- en: 'If you have access to the FreeNAS server''s web interface and you want to *ping*
    another machine to ensure that the FreeNAS server can contact it, then go to Diagnostics:
    Ping. Enter the IP address of the machine you wish to ping in *Host* and click
    *Ping*.'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你可以访问FreeNAS服务器的Web界面，并且你想要*ping*另一台机器以确保FreeNAS服务器能够与其通信，那么进入诊断：Ping。输入你希望ping的机器的IP地址到*主机*栏并点击*Ping*。
- en: 'The output for a successful ping will look like this:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 成功ping的输出如下所示：
- en: '[PRE14]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'A failed ping will look like this:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 失败的ping输出如下所示：
- en: '[PRE15]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Notice the `100% packet loss`, which means that none of the pings got to their
    destination.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 注意到`100%数据包丢失`，这意味着没有任何ping到达其目的地。
- en: If you have multiple network cards in your machine, you can select which card
    to use in the *Interface* drop down box. This can be very useful when you want
    to check the connectivity on a second Ethernet interface card.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的机器有多个网络卡，你可以在*接口*下拉框中选择使用哪个卡。当你想要检查第二个以太网接口卡的连接性时，这非常有用。
- en: If you want to see which route the network packets are taking (through which
    switches and gateways), you can use the traceroute tool which is on the Traceroute.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想查看网络数据包走的是哪条路（通过哪些交换机和网关），你可以使用位于Traceroute中的traceroute工具。
- en: Using ARP Tables to Solve Network Problems
  id: totrans-102
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用ARP表来解决网络问题
- en: Deep down in the murky depths of internals of Ethernet is a thing known as ARP.
    The Address Resolution Protocol (ARP) is the standard method for finding a host's
    hardware address (or MAC address) when only its IP address is known. To send a
    packet of information to an IP address, the networking software needs to know
    the physical address of the network card which is serving that IP address. To
    do this, it sends out and ARP request and gets an ARP response with the MAC address
    in it.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 以太网的内部深处有一个被称为ARP的东西。地址解析协议（ARP）是查找主机硬件地址（或MAC地址）时的标准方法，当只知道其IP地址时。为了向IP地址发送信息包，网络软件需要知道服务该IP地址的网卡的物理地址。为此，它会发送一个ARP请求并得到一个包含MAC地址的ARP响应。
- en: 'On the Diagnostics: ARP tables page, there is a table of all the MAC addresses
    known to the FreeNAS server along with the corresponding IP address. This table
    is useful as it allows you to see if the networking layers of the FreeNAS server
    where we are able to at least discover the MAC address of the remote server/PC
    in question. If the MAC address is known but ping fails, then the problem could
    be a firewall.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在诊断：ARP表页面上，有一个显示所有FreeNAS服务器已知的MAC地址及其对应IP地址的表格。这个表格非常有用，因为它可以让你查看FreeNAS服务器的网络层，我们至少能够发现目标远程服务器/PC的MAC地址。如果已知MAC地址但ping失败，那么问题可能是防火墙。
- en: This table is also useful to make sure that two machines don't have the same
    IP address by mistake. You can tally the IP address with the MAC address to be
    certain that the right server has been contacted.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 此表格也有助于确保两台机器不会误用相同的IP地址。你可以通过比对IP地址和MAC地址，确认已联系到正确的服务器。
- en: Note
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**What is a MAC Address?**'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: '**什么是MAC地址？**'
- en: A Media Access Control address (MAC address) or Ethernet address is a globally
    unique identifier attached to most network adapters by the manufacturer. It can
    be likened to the postal address of your house, which is unique, so that all things
    sent to that address are received there by you. The address is made up of 6 numbers
    specified using a colon notation. An example MAC address is "00:0c:29:a5:9a:28".
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 媒体访问控制地址（MAC地址）或以太网地址是附加到大多数网络适配器上的全球唯一标识符，由制造商指定。它可以比作你家里的邮政地址，地址是唯一的，所有寄送到这个地址的东西都会由你收到。该地址由6个数字组成，采用冒号表示法。一个示例MAC地址是"00:0c:29:a5:9a:28"。
- en: '[http://www.coffer.com/mac_find/](http://www.coffer.com/mac_find/) is a useful
    website to find out which manufacturer (or vendor as they are known) created any
    given MAC address.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '[http://www.coffer.com/mac_find/](http://www.coffer.com/mac_find/) 是一个有用的网站，用于查找哪个制造商（或称为供应商）创建了任何给定的MAC地址。'
- en: Gigabit Transfers are Slow
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 千兆传输很慢
- en: 'Gigabit networking isn''t the silver bullet that some people think it is. Unfortunately,
    you are never going to get 125MB/s (1000 divided by 8) transfer rates between
    FreeNAS and your PC. There are several reasons for this, some are theoretical
    and some practical. To get the best transfers rates over Gigabit Ethernet, to
    and from your FreeNAS server, you need to consider the following:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 千兆网络并不是一些人认为的万能法宝。不幸的是，你永远无法在FreeNAS和你的PC之间达到125MB/s（1000除以8）的传输速度。造成这种情况的原因有几个，其中一些是理论性的，有一些则是实际问题。要获得最佳的千兆以太网传输速度，进出FreeNAS服务器时，你需要考虑以下几点：
- en: 'First of all, make sure that you have enabled the tuning of some kernel variables.
    You will find this option on the System: Advanced: Advanced Setup page. Tick the
    *Tuning* box and save the settings.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，确保你已启用某些内核变量的调优。你可以在“系统：高级：高级设置”页面找到这个选项。勾选*调优*框并保存设置。
- en: Make sure your Gigabit Ethernet switch and your Gigabit Ethernet card can handle
    Jumbo frames. Without Jumbo frame support, the increases over 100Mb/s networking
    will be marginal.
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保你的千兆以太网交换机和千兆以太网卡能够处理Jumbo帧。没有Jumbo帧支持，超过100Mb/s的网络速度提升将是微乎其微的。
- en: Use a PCI Express Gigabit network card when possible.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽可能使用PCI Express千兆网络卡。
- en: Ensure that your CPU is able to handle the load placed on it by the networking
    and the disk activity.
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确保你的CPU能够处理网络和磁盘活动带来的负载。
- en: Configure your disks in the optimum configuration for speed throughput. This
    almost certainly means you need to be using some kind of RAID, either hardware
    or software.
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据速度吞吐量优化配置磁盘。这几乎肯定意味着你需要使用某种类型的RAID，无论是硬件RAID还是软件RAID。
- en: Problems Connecting to Shares (via CIFS)
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 连接共享时的问题（通过CIFS）
- en: One of the most popular ways to connect to the FreeNAS server is via the Windows
    protocol CIFS. In the majority of environments, people will connect to FreeNAS
    from a Windows machine and probably mount the 'share' as a network drive on the
    machine.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 连接FreeNAS服务器的最常见方式之一是通过Windows协议CIFS。在大多数环境中，人们会从Windows机器连接到FreeNAS，并可能将“共享”挂载为该机器上的网络驱动器。
- en: There are many versions of Microsoft Windows in use today with some people still
    using Windows 98 or Millennium while others are using Windows 2000, Windows XP
    or Windows Vista. Each version of Windows has slightly different ideas about networking
    and a setup—which works with Windows 2000 or Windows 98 might not work with Windows
    Vista.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 如今使用的Microsoft Windows版本有很多，有些人仍在使用Windows 98或Millennium，而其他人则在使用Windows 2000、Windows
    XP或Windows Vista。每个Windows版本对网络和设置有略微不同的理解——在Windows 2000或Windows 98中可行的设置可能在Windows
    Vista中无法工作。
- en: Here are some problems might be encountered when using Microsoft Windows with
    FreeNAS.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是使用Microsoft Windows与FreeNAS时可能遇到的一些问题。
- en: Windows Vista Asks for My Username and Password for Anonymous Shares
  id: totrans-121
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Windows Vista要求提供我的用户名和密码以访问匿名共享
- en: 'This can happen when the *Null passwords* field is enabled on the Services:
    CIFS/SMB page (in the advanced settings section). To resolve the problem, disable
    the *Null password* field.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 当“服务：CIFS/SMB”页面中的*空密码*字段启用时，可能会发生这种情况（在高级设置部分）。要解决此问题，请禁用*空密码*字段。
- en: There are Two FreeNAS Servers on the Network, but Windows Can only See One
  id: totrans-123
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络中有两台FreeNAS服务器，但Windows只能看到一台。
- en: During the configuration of these two FreeNAS servers, you probably made sure
    that each machine had its own IP address and hostname. You also need to make sure
    that the default name for the CIFS server in FreeNAS isn't the same for both of
    your servers. Although you can connect to their web interfaces without any problems
    when you try to use Windows networking, only one machine will be seen.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置这两台FreeNAS服务器时，你可能已经确保每台机器都有自己的IP地址和主机名。你还需要确保FreeNAS中CIFS服务器的默认名称对于两台服务器不是相同的。尽管你可以毫无问题地连接它们的Web界面，但在尝试使用Windows网络时，只能看到其中一台机器。
- en: 'To solve this, go to Services: CIFS/SMB and set the *NetBiosName* name to something
    unique for each server.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决这个问题，请进入“服务：CIFS/SMB”，将*NetBiosName*设置为每台服务器的唯一名称。
- en: Turning On Logging to Help Solve Windows Networking Problems
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开启日志记录以帮助解决Windows网络问题
- en: If you find that you have a Windows networking (CIFS) problem that you can't
    solve then try enabling more logging for the Windows networking server (called
    Samba) and see if the log files reveal any hints to the problem could be.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现无法解决Windows网络（CIFS）问题，可以尝试启用更多Windows网络服务器（称为Samba）的日志记录，看看日志文件中是否有提示问题所在。
- en: 'To enable logging, go to Services: CIFS/SMB and set the *Log Level* to Normal
    rather than Minimal. The logging created by Samba will be visible on the Diagnostics:
    Logs page under the Daemon tab. Entries starting with *smbd* are about the Windows
    networking server and those starting with *nmdb* are about the Windows networking
    name service.'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 要启用日志记录，请进入“服务：CIFS/SMB”，将*日志级别*设置为正常（Normal），而不是最小（Minimal）。Samba生成的日志将显示在诊断：日志页面的守护进程（Daemon）标签下。以*smbd*开头的条目是关于Windows网络服务器的，而以*nmdb*开头的条目是关于Windows网络名称服务的。
- en: If the Normal logging level doesn't help then you can try the Full level and
    even the Debug level but these will provide lots of output that you might find
    difficult to comprehend.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 如果正常日志级别没有帮助，你可以尝试全级别（Full）甚至调试级别（Debug），但这些会产生大量输出，可能会让你感到难以理解。
- en: 'If the logging is producing lots of log entries, see the "50 Log entries might
    not be enough" tip in the Understanding Diagnostics: Logs: System section earlier
    in this chapter. Also remember that you can clear the logs at any time by pressing
    the "Clear log" button on any of the Diagnostics: Logs pages.'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 如果日志生成了大量的日志条目，请参考本章早些时候《理解诊断：日志：系统》部分中的“50个日志条目可能不足够”提示。还要记住，你可以通过在任何诊断：日志页面上按下“清除日志”按钮来随时清除日志。
- en: Don't forget to turn the logging back to Minimal when you are done.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 完成后，别忘了将日志级别设置回最小（Minimal）。
- en: 'Diagnostics: Information'
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 诊断：信息
- en: 'As well as the Diagnostics: Logs page, there is also an information page in
    the Diagnostics: section. The Logs concentrates on the output from the various
    system services in the FreeNAS server where as the information page aims to provide
    status and configuration information about a variety of sections of the FreeNAS
    server.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 除了诊断：日志页面外，诊断：部分还有一个信息页面。日志页面集中显示来自FreeNAS服务器中各种系统服务的输出，而信息页面则旨在提供关于FreeNAS服务器各个部分的状态和配置信息。
- en: '![Diagnostics: Information](img/4688_09_Images_07.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![诊断：信息](img/4688_09_Images_07.jpg)'
- en: 'To access this page, go to Diagnostics: Information. At the top, there are
    lots of tabs. Here is what they mean:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问此页面，请进入“诊断：信息”。页面顶部有很多标签。以下是它们的含义：
- en: '| Tab | Information |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| 标签 | 信息 |'
- en: '| --- | --- |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Disks | A list of the detected hard disks including all ATA/IDE disks, SATA
    disks, and SCSI disks. |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| 磁盘 | 列出检测到的所有硬盘，包括ATA/IDE磁盘、SATA磁盘和SCSI磁盘。 |'
- en: '| Disks (ATA) | A list of the advanced capabilities on all ATA/IDE disks including
    the ATA revision, the disk geometry, the disk''s capacity, and its S.M.A.R.T capabilities.
    |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| 磁盘（ATA） | 列出所有ATA/IDE磁盘的高级功能，包括ATA版本、磁盘几何结构、磁盘容量和S.M.A.R.T功能。 |'
- en: '| Partitions | Information about the partitions on each of the disks. |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| 分区 | 关于每个磁盘上分区的信息。 |'
- en: '| S.M.A.R.T. | List of SMART capabilities on all detected disks. |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| S.M.A.R.T. | 列出所有检测到的磁盘的SMART功能。 |'
- en: '| Space Used | Information about the disk space usage on the server. Each filesystem
    is listed with its total size, space used, space available, and what percentage
    of the disk is used. |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| 已用空间 | 关于服务器磁盘空间使用情况的信息。每个文件系统都会列出其总大小、已用空间、可用空间以及磁盘的使用百分比。 |'
- en: '| Mounts | List of mount points with the filesystem type. |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| 挂载点 | 列出带有文件系统类型的挂载点列表。 |'
- en: '| Software RAID | Information about the software RAID configuration of the
    FreeNAS server. Each RAID level is listed separately along with data about which
    disks are used. |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| Software RAID | FreeNAS服务器的软件RAID配置的信息。每个RAID级别单独列出，并显示使用的磁盘信息。 |'
- en: '| iSCSI Initiator | Information about the iSCSI initiator. |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| iSCSI Initiator | 关于iSCSI启动器的信息。 |'
- en: '| MS Domain | Microsoft Active Directory information. |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '| MS Domain | Microsoft Active Directory信息。 |'
- en: '| Swap | List of currently configured swap spaces. |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| Swap | 当前配置的交换空间列表。 |'
- en: '| FTP users | List of currently connected FTP users. |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| FTP users | 当前连接的FTP用户列表。 |'
- en: '| RSYNC Client | Each configured RSYNC client is listed along with its configuration
    parameters. The most useful information is the ''Detected shares on this server
    section''. It shows that the RSYNC client can contact the server and lists the
    available RSYNC modules. |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| RSYNC Client | 每个配置的RSYNC客户端都会列出及其配置参数。最有用的信息是“检测到的此服务器共享”部分。它显示RSYNC客户端可以联系到服务器，并列出可用的RSYNC模块。
    |'
- en: '| Sockets | This is a list of the active Internet connections (including servers)
    as well as the active UNIX domain sockets. From this list, you can see which network
    servers are running and if there are any connected users to that server. |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| Sockets | 这是活动的互联网连接（包括服务器）以及活动的UNIX域套接字的列表。通过此列表，你可以看到哪些网络服务器正在运行，以及是否有用户连接到该服务器。
    |'
- en: Replacing a Failed Hard Drive in a RAID Set
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在RAID阵列中更换故障硬盘
- en: The key feature of RAID is the capability of the RAID set to continue working
    when one of the drives fails. When a drive fails, the RAID set enters a DEGRADED
    state, meaning the system is working but one of the drives has failed. This drive
    needs to be replaced as soon as possible.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: RAID的关键特点是当一个磁盘故障时，RAID阵列仍然能够继续工作。当磁盘故障时，RAID阵列进入DEGRADED状态，这意味着系统仍在运行，但其中一个磁盘已故障。该磁盘需要尽快更换。
- en: 'To check the status of your RAID disks, go to Disks: Software RAID. Click on
    all the RAID types you have on your FreeNAS server and check that they are in
    the COMPLETE state. If a RAID set is in the DEGRADED state, you need to replace
    a disk.'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: '要检查RAID磁盘的状态，请进入**Disks: Software RAID**页面。点击你在FreeNAS服务器上拥有的所有RAID类型，检查它们是否处于COMPLETE状态。如果某个RAID阵列处于DEGRADED状态，你需要更换磁盘。'
- en: 'Here is an example of a RAID 1 set in the degraded state:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个RAID 1阵列处于降级状态的示例：
- en: '![Replacing a Failed Hard Drive in a RAID Set](img/4688_09_Images_06.jpg)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![RAID阵列中的硬盘故障替换](img/4688_09_Images_06.jpg)'
- en: 'The first thing you need to know is which disk to replace. Go to Disk: Management
    page and check the status of each disk. If the disk is healthy, it should have
    the status of ONLINE. Once you have found the broken disk, you need to replace
    it. Some disk controllers have the ability to hot swapping, which means that the
    disk can be unplugged and a new disk added while the system is running. This is
    often a feature (but not exclusively) of SATA controllers. If you are unsure,
    then shutdown the FreeNAS server and replace the disk with server switched off.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '首先，你需要知道应该更换哪个磁盘。进入**Disk: Management**页面，检查每个磁盘的状态。如果磁盘正常，它应该显示为ONLINE。一旦你找到了故障磁盘，需要更换它。有些磁盘控制器具有热插拔功能，这意味着即使系统正在运行，也可以拔掉磁盘并插入新磁盘。这通常是SATA控制器的一个特点（但并非仅限于此）。如果不确定，最好关闭FreeNAS服务器，并在服务器关闭时更换磁盘。'
- en: Rebuilding a RAID 1 Array After Disk Failure
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 磁盘故障后重建RAID 1阵列
- en: 'Now that you have replaced the disk, it is time to bring the system up to normal
    operations levels. This involves 2 steps that are all performed in the tools section
    of the **RAID 1** tab on the **Disks: Software RAID** page.'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '现在你已经更换了磁盘，是时候将系统恢复到正常操作水平了。这个过程包括两个步骤，全部在**RAID 1**标签页下的**Disks: Software
    RAID**页面的工具部分中完成。'
- en: The first step is to tell the FreeNAS server to forget any devices that were
    in this RAID set but are now no longer connected.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是告诉FreeNAS服务器忘记任何曾经在此RAID阵列中但现在已不再连接的设备。
- en: '1\. Go to **Disks: Software RAID** and click on the **RAID 1** tab.'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '1\. 进入**Disks: Software RAID**页面，点击**RAID 1**标签。'
- en: 2\. Click on the **Tools** tab.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 点击**Tools**标签。
- en: 3\. Select the name of the degraded array in the **Volume Name** field and select
    the **Command forget**. The **Disk** field isn't used with the forget command.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 在**Volume Name**字段中选择降级阵列的名称，并选择**Command forget**。**Disk**字段在忘记命令中不使用。
- en: 4\. Click **Send Command!** and the array will be told to forget about non-connected
    devices.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 点击**Send Command!**，阵列将被指示忘记未连接的设备。
- en: 5\. The output from the command should read **Done**.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 命令的输出应显示**Done**。
- en: '![Rebuilding a RAID 1 Array After Disk FailureRAID setfailed hard drive, replacing](img/4688_09_Images_09.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![RAID 1阵列重建后，硬盘故障替换](img/4688_09_Images_09.jpg)'
- en: 'The second step is to insert the new disk back into the array. Remaining in
    the **Tools** tab of the RAID 1 array:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 第二步是将新磁盘重新插入阵列。继续在RAID 1阵列的**工具**标签页中：
- en: 1\. Select the degraded array in the **Volume Name** field.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 在**卷名称**字段中选择降级的阵列。
- en: 2\. Select the new disk from the **Disk** drop down box.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 从**磁盘**下拉框中选择新磁盘。
- en: 3\. Select the **insert** command and click **Send Command!**
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 选择**插入**命令并点击**发送命令！**
- en: 4\. The output from the command should read **Done**.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 命令的输出应该显示为**Done**。
- en: 'The array will now start rebuilding. You can check that it is rebuilding on
    the **Diagnostics: Information: Software RAID** page (watch the **Synchronized:**
    field for percentage completed) and the Manage RAID tab on the **Disks: Software
    RAID: RAID1:** page will show COMPLETE when the RAID is rebuilt.'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 阵列现在开始重建。你可以在**诊断：信息：软件RAID**页面上检查它是否正在重建（查看**同步：**字段中的完成百分比），并且在**磁盘：软件RAID：RAID1：**页面的管理RAID标签中，当RAID重建完成时会显示为COMPLETE。
- en: Rebuilding a RAID 5 Array After Disk Failure
  id: totrans-172
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: RAID 5阵列重建后，硬盘故障替换
- en: 'Having replaced the disk, you are ready to synchronize it with the other disks
    in the RAID set. This involves a single step that is performed in the tools section
    of the RAID 5 tab on the **Disks: Software RAID** page.'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 更换磁盘后，你准备好与RAID阵列中的其他磁盘同步。这个过程包括一个步骤，在**磁盘：软件RAID**页面的RAID 5标签页中的工具部分执行。
- en: 'You need to insert the new disk back into the array. In the **Tools** tab of
    the RAID 1 array:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要将新磁盘重新插入阵列。在RAID 1阵列的**工具**标签页中：
- en: 1\. Select the degraded array in the **Volume Name** field.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 在**卷名称**字段中选择降级的阵列。
- en: 2\. Select the new disk from the **Disk** drop down box.
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 从**磁盘**下拉框中选择新磁盘。
- en: 3\. Select the **insert** command and click **Send Command!**
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 选择**插入**命令并点击**发送命令！**
- en: 4\. The output from the command should read Done.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 命令的输出应该显示为Done。
- en: '![Rebuilding a RAID 5 Array After Disk Failure](img/4688_09_Images_08.jpg)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![RAID 5阵列重建后，硬盘故障替换](img/4688_09_Images_08.jpg)'
- en: 'The array will now start rebuilding. You can check that it is rebuilding on
    the **Diagnostics: Information: Software RAID** page (watch the **Synchronized:**
    field for percentage completed) and the Manage RAID tab on the **Disks: Software
    RAID: RAID 5:** page will show COMPLETE when the RAID is rebuilt.'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 阵列现在开始重建。你可以在**诊断：信息：软件RAID**页面上检查它是否正在重建（查看**同步：**字段中的完成百分比），并且在**磁盘：软件RAID：RAID
    5：**页面的管理RAID标签中，当RAID重建完成时会显示为COMPLETE。
- en: Where to Go for More Help
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 寻求更多帮助的地方
- en: If you find yourself really stuck and are not able to track down your problem
    then the best place for support is the online FreeNAS Help Forums.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你发现自己真的卡住了，无法找出问题所在，最好的支持地方是FreeNAS的在线帮助论坛。
- en: These are found at the SourceForge.net site and you need to sign up for a free
    SourceForge.net account to be able to post to the forums.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 这些可以在SourceForge.net网站上找到，你需要注册一个免费的SourceForge.net账户才能在论坛上发布内容。
- en: To find the support forum, go to the FreeNAS website at [http://freenas.org](http://freenas.org)
    and click on the Support link. From there, go to the Help forum.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 要查找支持论坛，请访问FreeNAS网站：[http://freenas.org](http://freenas.org)，然后点击“Support”链接。从那里，进入Help论坛。
- en: Summary
  id: totrans-185
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have looked at some of the tools that are available to help
    track down problems with the configuration of the FreeNAS server. We have looked
    at networking problems and possible solutions along with how to handle RAID failures.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了一些可以帮助跟踪FreeNAS服务器配置问题的工具。我们讨论了网络问题及其可能的解决方案，以及如何处理RAID故障。
- en: The next and final chapter is about FreeBSD, the underlying operating system
    of FreeNAS.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章也是最后一章将介绍FreeBSD，这是FreeNAS的底层操作系统。
