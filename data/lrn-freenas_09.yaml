- en: Chapter 10. FreeBSD and Command Line Tools
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第10章 FreeBSD与命令行工具
- en: FreeBSD is the bedrock of the FreeNAS server. In this chapter, we will look
    at some simple FreeBSD commands and also some fundamental FreeBSD administration
    tasks, including stop and starting different services as well as controlling RAID
    from the command line.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: FreeBSD是FreeNAS服务器的基石。在本章中，我们将介绍一些简单的FreeBSD命令以及一些基础的FreeBSD管理任务，包括停止和启动不同的服务，以及从命令行控制RAID。
- en: Introduction to FreeBSD
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: FreeBSD简介
- en: Every computer has what is known as an operating system that is a specialized
    software to control and manage the different resources in the computer including
    memory, video, networking, and hard disks. Some popular operating systems today
    include Microsoft Windows, Apple OS X, Linux, and FreeBSD.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 每台计算机都有一个被称为操作系统的特殊软件，用于控制和管理计算机中的各种资源，包括内存、视频、网络和硬盘。现在一些流行的操作系统包括Microsoft
    Windows、Apple OS X、Linux和FreeBSD。
- en: As an operating system, FreeBSD has a very respectable heritage and can trace
    its parentage to the original UNIX operating system of the late 1970's. Version
    1 of FreeBSD saw the light of day in the 1993 and as such has had over 15 years
    of development. The result is a stable, robust, well-designed, and scalable operating
    system that can compete with the best.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 作为一种操作系统，FreeBSD有着非常值得尊敬的历史，并且可以追溯到1970年代末期的原始UNIX操作系统。FreeBSD的第一个版本于1993年问世，因此已经有超过15年的发展历程。结果是一个稳定、强大、设计良好且可扩展的操作系统，能够与最好的操作系统竞争。
- en: At its core, FreeBSD is a terminal or console-based operating system. This means
    that you don't need a fancy graphics card, a high-resolution monitor, and an optical
    mouse to run FreeBSD. All commands are executed by typing them at the keyboard
    and hitting *ENTER*. This is essential when FreeBSD is being used as a server.
    Servers traditionally don't have powerful graphic capabilities and often don't
    even have a monitor attached to them. So, the ability to be able to connect and
    administer the server using simple command line tools is very important.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 从本质上讲，FreeBSD是一个基于终端或控制台的操作系统。这意味着你不需要一张花哨的显卡、一个高分辨率的显示器以及一个光学鼠标来运行FreeBSD。所有命令都是通过在键盘上输入并按下*ENTER*来执行的。当FreeBSD作为服务器使用时，这一点尤为重要。服务器通常不具备强大的图形能力，甚至可能没有连接显示器。因此，能够使用简单的命令行工具来连接和管理服务器是非常重要的。
- en: As well as being a solid server operating system, FreeBSD also serves as a desktop
    OS and comes with a full windowing desktop environment.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 除了作为一个坚固的服务器操作系统，FreeBSD还可以作为桌面操作系统使用，并配有完整的窗口桌面环境。
- en: Your First FreeBSD Commands
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 你的第一个FreeBSD命令
- en: The easiest way to get to the FreeBSD command line is via the FreeNAS console
    menu. With FreeNAS up and running, go to the FreeNAS machine and press *ENTER*
    to make the splash screen disappear and the console menu will appear. Option 6
    is for Shell, so type 6 and press ENTER.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 进入FreeBSD命令行的最简单方法是通过FreeNAS控制台菜单。FreeNAS启动并运行后，前往FreeNAS机器并按下*ENTER*键，使启动画面消失，控制台菜单将出现。选项6是Shell，输入6并按下ENTER。
- en: 'You will now see a prompt like this:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在将看到一个像这样的提示：
- en: '[PRE0]'
  id: totrans-10
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Print the Working Directory with pwd
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用pwd打印工作目录
- en: This is FreeBSD! To run your first FreeBSD command type `pwd` and press ENTER.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是FreeBSD！要运行你的第一个FreeBSD命令，输入`pwd`并按下ENTER。
- en: '[PRE1]'
  id: totrans-13
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '`pwd` means Print Working Directory. This tells you your current folder. In
    this case, it is the folder called `root`. In FreeBSD, the administrator user
    is known as root. When you connect to FreeBSD via the FreeNAS console, you are
    automatically logged in as root and you have full administration rights. The `/root`
    folder is the home directory for the user root.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '`pwd`意味着打印工作目录。它告诉你当前的文件夹。在此例中，它是名为`root`的文件夹。在FreeBSD中，管理员用户被称为root。当你通过FreeNAS控制台连接到FreeBSD时，你会自动以root身份登录，并且拥有完全的管理员权限。`/root`文件夹是root用户的家目录。'
- en: Note
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Consider Disabling the Console Menu**'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '**考虑禁用控制台菜单**'
- en: 'As you can see, by default, the console gives you unfettered access to the
    FreeBSD command line and gives you full administrator rights from the go. If your
    FreeNAS server is in an environment where others can access the console menu then
    you should consider disabling the console (on the **System: Advanced** page in
    the web interface). This will stop unauthorized and potentially dangerous access
    to your FreeNAS server.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '如你所见，默认情况下，控制台为你提供了对FreeBSD命令行的完全访问权限，并且从一开始就赋予你完全的管理员权限。如果你的FreeNAS服务器处于他人可以访问控制台菜单的环境中，那么你应该考虑禁用控制台（在Web界面的**System:
    Advanced**页面中）。这将防止未经授权和可能具有危险的访问你的FreeNAS服务器。'
- en: With the console menu disabled, you will still be able to access the FreeBSD
    command line via the SSH protocol.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 禁用控制台菜单后，你仍然可以通过SSH协议访问FreeBSD命令行。
- en: Directory Listings (ls)
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 目录列表（ls）
- en: 'To see the contents of the current folder, you use the `ls` (list) command:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看当前文件夹的内容，你可以使用`ls`（列出）命令：
- en: '[PRE2]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: By default, there isn't very much in the `/root` folder. Here, we can see that
    there are 4 files. Notice that they all start with a dot. This means they are
    hidden files but because you are the administrator, hidden files are shown by
    default. If a normal user uses the `ls` command then the files starting with dot
    are not shown.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`/root`文件夹中没有太多内容。在这里，我们可以看到有4个文件。注意，它们的名字都以点（.）开头。这意味着它们是隐藏文件，但因为你是管理员，隐藏文件默认会显示。如果普通用户使用`ls`命令，文件名以点开头的文件将不会显示。
- en: 'To get more information about the files like their size and their read/write
    permissions, use the `-l` (long format) option:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取更多文件的信息，例如文件大小及其读写权限，请使用`-l`（长格式）选项：
- en: '[PRE3]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: This long format shows more information about each of the files starting with
    the file permissions, number of links, owner name, group name, size of the file
    in bytes, the date and time the file was lost or modified, and of course, the
    file name.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 这种长格式会显示关于每个文件的更多信息，首先是文件权限、链接数量、所有者名称、组名称、文件大小（以字节为单位）、文件最后修改的日期和时间，当然还有文件名。
- en: The file permissions field can look a little complicated but it is easy to understand
    with a little guidance. The field, if made up of 10 flags, which are either a
    letter, like r or w, or the hyphen sign (-).
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 文件权限字段可能看起来有点复杂，但稍加指导就能理解。该字段由10个标志组成，标志可以是字母，如r或w，或者是连字符（-）。
- en: '| File type(1 flag) | User permissions(3 flags) | Group permissions(3 flags)
    | Other permissions(3 flags) |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| 文件类型（1个标志） | 用户权限（3个标志） | 组权限（3个标志） | 其他权限（3个标志） |'
- en: '| --- | --- | --- | --- |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| d for directory, - for a regular file. | r, w, and x meaning user readable,
    user writable, and user executable. | r, w, and x meaning group readable, group
    writable and group executable. | r, w, and x meaning world readable, world writable,
    and world executable. |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| d表示目录，-表示常规文件。 | r、w和x表示用户可读、可写和可执行。 | r、w和x表示组用户可读、可写和可执行。 | r、w和x表示所有人可读、可写和可执行。
    |'
- en: For example, the above directory list contains an entry for the `.cshrc file`.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，上面的目录列表包含了`.cshrc`文件的条目。
- en: '[PRE4]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: This means that it is a regular file (as the first flag is `-`) and that it
    is readable and writable by the user, but not executable (`rw-`). It is normal
    that the file isn't executable as it isn't a program file. The group permissions
    (`r--`) mean that users in the same group (wheel) can read the file but can't
    write to it and the same is true of other users (`r--`).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这意味着它是一个常规文件（因为第一个标志是`-`），并且它对于用户来说是可读可写的，但不可执行（`rw-`）。文件不可执行是正常的，因为它不是一个程序文件。组权限（`r--`）意味着同组用户（wheel组）可以读取该文件，但不能写入，其他用户（`r--`）的权限也是如此。
- en: Change Directory with cd
  id: totrans-33
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用`cd`命令更改目录
- en: 'To complete the simple file system commands, there is the `cd` (change directory)
    command. This will change the current working directory to another directory as
    specified. To change directory to the very top of the file system you would type:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 为了完成简单的文件系统命令，可以使用`cd`（更改目录）命令。这个命令会将当前工作目录更改为指定的其他目录。要将目录切换到文件系统的最顶层，你可以输入：
- en: '[PRE5]'
  id: totrans-35
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: From here, you can see all the folders that exist below the top, in a tree like
    structure.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 从这里，你可以看到所有位于最上层下面的文件夹，呈树状结构显示。
- en: '[PRE6]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'To move to another directory, you just enter `cd` followed by its name:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 要切换到另一个目录，只需输入`cd`后跟目录名：
- en: '[PRE7]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'And then, deeper still:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，继续深入：
- en: '[PRE8]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'To go back up a directory level, use the special name :'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 要返回上一级目录，使用特殊名称：
- en: '[PRE9]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'You can also go directly to a deep folder by specifying its full path in the
    `cd` command. Before that, we changed directory into the `/usr` directory and
    then deeper down into the `bin` directory. To do that in one go type:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以通过在`cd`命令中指定完整路径，直接进入一个深层文件夹。在此之前，我们已将目录切换到`/usr`目录，然后进一步进入`bin`目录。你可以通过输入以下命令一次性完成：
- en: '[PRE10]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Copy a File and Change Its Permissions (cp and chmod)
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 复制文件并更改文件权限（cp和chmod）
- en: 'To copy a file, you need to use the `cp` (copy) command. To copy the `.cshrc`
    file to `test`, you would type:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 要复制一个文件，你需要使用`cp`（复制）命令。要将`.cshrc`文件复制到`test`目录，你可以输入：
- en: '[PRE11]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Using the `ls` command afterwards, shows that the file has been copied. To
    see the file permissions of the file `test` type:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用`ls`命令后，可以看到文件已被复制。要查看`test`文件夹中文件的权限，可以输入：
- en: '[PRE12]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: To change the file so that only the user has read and write permissions and
    the no others (including those in the same group) can read it, use the `chmod`
    (change file mode) command.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 要更改文件，使得只有用户具有读写权限，且其他任何人（包括同组成员）都无法读取，使用 `chmod`（更改文件模式）命令。
- en: '[PRE13]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '`chmod` takes two parameters: the first is a 3 digit number representing the
    file permissions you wish to set, and the second is the name of the file or directory
    you wish to change. Each digit represents the file permissions for either the
    user, group or world (in that order).'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '`chmod` 需要两个参数：第一个是一个三位数，表示您希望设置的文件权限，第二个是您希望更改的文件或目录的名称。每个数字表示文件的权限，分别是用户、组和其他用户（按此顺序）。'
- en: 'The numbers for the file permissions are as follows:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 文件权限的数字表示如下：
- en: '| File permission | Flags | Meaning |'
  id: totrans-55
  prefs: []
  type: TYPE_TB
  zh: '| 文件权限 | 标志 | 含义 |'
- en: '| --- | --- | --- |'
  id: totrans-56
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| 0 | --- | Nothing, no Read, Write or Execute |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| 0 | --- | 无权限，既不能读、写也不能执行 |'
- en: '| 1 | --x | Execute |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| 1 | --x | 执行 |'
- en: '| 2 | -w- | Write |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| 2 | -w- | 写 |'
- en: '| 3 | -wx | Execute & Write |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| 3 | -wx | 执行 & 写 |'
- en: '| 4 | r-- | Read |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| 4 | r-- | 只读 |'
- en: '| 5 | r-x | Execute & Read |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 5 | r-x | 执行 & 读 |'
- en: '| 6 | rw- | Read & Write |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 6 | rw- | 读与写 |'
- en: '| 7 | rwx | Execute & Read & Write |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 7 | rwx | 执行 & 读 & 写 |'
- en: Therefore, setting the file permission to 600 means read and write for the user
    and nothing for the group or world (rw-------). Similarly 640 means read and write
    for the user, read for the group, and nothing for others (rw-r-----). The most
    open you can make a file is 777, which grants read, write, and executable permission
    to user, group, and world (rwxrwxrwx ).
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，将文件权限设置为 600 表示用户具有读写权限，组和其他用户没有权限（rw-------）。类似地，640 表示用户具有读写权限，组具有读权限，其他用户没有权限（rw-r-----）。您可以为文件设置的最大权限是
    777，这意味着用户、组和其他用户都具有读、写和执行权限（rwxrwxrwx）。
- en: Optionally, chmod all takes a -R flag that can be used on a directory and will
    cause chmod to set the file permission of all the file and subfolders of the directory.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 可选地，chmod 所有文件可以使用 -R 标志，该标志可以用于目录，并将使 chmod 设置该目录及其所有子文件夹的文件权限。
- en: Connecting to FreeBSD Using Putty
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 Putty 连接到 FreeBSD
- en: To get access to the FreeBSD command line, without using the console, you can
    connect to the FreeNAS server via SSH.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 要访问 FreeBSD 命令行而不使用控制台，您可以通过 SSH 连接到 FreeNAS 服务器。
- en: SSH (Secure Shell) is a network protocol that allows data to be exchanged over
    an encrypted (secure) channel between two computers. It is most commonly used
    as a secure command line interface to a remote computer. This means that you can
    access the command line interface of the FreeNAS server from a remote computer
    without having to have access to the keyboard and monitor of the FreeNAS server.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: SSH（安全外壳协议）是一种网络协议，它允许通过加密（安全）通道在两台计算机之间交换数据。它最常用于作为远程计算机的安全命令行接口。这意味着，您可以从远程计算机访问
    FreeNAS 服务器的命令行接口，而无需访问 FreeNAS 服务器的键盘和显示器。
- en: 'By default, SSH access is disabled, to enable it, go to **Services: SSHD**
    and enable the **SSH Daemon** (server) by ticking **Enable** in the title of the
    configuration data table. Click **Save and Restart** to start the SSH server.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，SSH 访问是禁用的，要启用它，请转到**服务：SSHD**并通过选中配置数据表标题中的**启用**来启用**SSH 守护进程**（服务器）。点击**保存并重启**以启动
    SSH 服务器。
- en: 'There are two types of SSH users on the FreeNAS server. The first is the normal
    user without administrator access. For each user created on the **Access: Users**
    page, you can enable Full Shell access that will allow the users to connect and
    use the FreeBSD command line on the server via SSH.'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: FreeNAS 服务器上有两种类型的 SSH 用户。第一种是没有管理员访问权限的普通用户。对于在**访问：用户**页面上创建的每个用户，您可以启用完全
    Shell 访问，这将允许用户通过 SSH 连接并使用服务器上的 FreeBSD 命令行。
- en: 'The second type of user is root. By default, root is not allowed to log in
    to the FreeNAS server via SSH. To allow root to log in, go to **Services: SSHD**
    and tick **Permit root login**. Then click **Save and Restart** to finish start
    the SSH server.'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 第二种类型的用户是 root。默认情况下，root 用户不允许通过 SSH 登录 FreeNAS 服务器。要允许 root 登录，请转到**服务：SSHD**并勾选**允许
    root 登录**。然后点击**保存并重启**，以完成启动 SSH 服务器。
- en: Note
  id: totrans-73
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Root Password**'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '**根密码**'
- en: The root password is the same as the web interface password, which by default
    is *freenas*. If the web interface password is changed, so does the root password.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 根密码与 Web 界面密码相同，默认情况下是*freenas*。如果 Web 界面密码被更改，根密码也会随之更改。
- en: 'To connect via SSH on Linux or Apple OS X, you can use the SSH command line
    program. So, to connect to the FreeNAS server, you would use:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 Linux 或 Apple OS X 上通过 SSH 连接，您可以使用 SSH 命令行程序。所以，要连接到 FreeNAS 服务器，您可以使用：
- en: '[PRE14]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The `-l` parameter allows you to specify the user name which in this case was
    root.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '`-l`参数允许你指定用户名，在本例中为root。'
- en: Windows doesn't come with a SSH utility by default so you need to use a free
    utility called PuTTY. PuTTY is a great tool written by Simon Tatham.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: Windows默认没有SSH工具，所以你需要使用一个名为PuTTY的免费工具。PuTTY是由Simon Tatham编写的一个非常棒的工具。
- en: You can download PuTTY from [http://www.chiark.greenend.org.uk/~sgtatham/putty/](http://www.chiark.greenend.org.uk/~sgtatham/putty/)
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从[http://www.chiark.greenend.org.uk/~sgtatham/putty/](http://www.chiark.greenend.org.uk/~sgtatham/putty/)下载PuTTY。
- en: '![Connecting to FreeBSD Using Putty](img/4688_10_01.jpg)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![连接到FreeBSD使用PuTTY](img/4688_10_01.jpg)'
- en: Once downloaded, double click on the executable (there is no installer for PuTTY,
    you just use the downloaded file). The main PuTTY window has lots of options but
    all you need to do to use it is enter the IP address of the FreeNAS server in
    the Host Name field in the top half of the window. Leave everything else as it
    is and click Open. A window with a black background will appear. If this is the
    first time you have connected to this FreeNAS server using PuTTY, you will also
    be asked if you trust the machine to which you have connected. Click Yes.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 下载后，双击可执行文件（PuTTY没有安装程序，你只需要使用下载的文件）。主PuTTY窗口有很多选项，但你只需要做的就是在窗口上半部分的主机名字段中输入FreeNAS服务器的IP地址。其他设置保持不变，点击“Open”。将会出现一个黑色背景的窗口。如果这是你第一次使用PuTTY连接到这个FreeNAS服务器，你还会被询问是否信任连接的机器。点击“Yes”。
- en: 'At the login as: prompt type root and press *ENTER* and then enter the password
    which will be the same as the web interface password. You will then see the, hopefully
    now, familiar *freenas*:~# prompt.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 在“login as:”提示符下输入root并按*ENTER*，然后输入与网页界面密码相同的密码。你将看到， hopefully现在已经熟悉的*freenas*:~#
    提示符。
- en: From herein, you have access to FreeBSD as you did from the console menu shell.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 从此处开始，你可以像在控制台菜单shell中一样访问FreeBSD。
- en: Monitoring your FreeNAS Server from the Command Line
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 从命令行监控你的FreeNAS服务器
- en: FreeBSD contains several tools for system monitoring including monitoring the
    disk space and the system processes.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: FreeBSD包含多个用于系统监控的工具，包括监控磁盘空间和系统进程。
- en: See Which Disks are Mounted with mount
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查看哪些磁盘已挂载使用mount命令
- en: 'To see which disks are mounted on the FreeNAS server, use the `mount` command:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看哪些磁盘已挂载到FreeNAS服务器上，请使用`mount`命令：
- en: '[PRE15]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'This yields the same output as the **Diagnostics: Information: Mounts** page
    on the web interface. Each device is listed along with its mount point and what
    type of filing system it is and any options. From the above, we can see the top
    most directory/(also refereed to as root but not to be confused with the user
    root) that contains the FreeBSD and FreeNAS software is on the first IDE drive
    (ad0). We can also see that this FreeNAS server has a raid5 configuration mounted
    on /mnt/raid.'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这将产生与**诊断：信息：挂载**页面相同的输出。每个设备都列出其挂载点、文件系统类型和任何选项。从上面可以看到，包含FreeBSD和FreeNAS软件的最顶层目录/（也称为根目录，但不要与用户root混淆）位于第一个IDE驱动器（ad0）上。我们还可以看到，这台FreeNAS服务器有一个raid5配置，挂载在/mnt/raid上。
- en: Check Disk Space Usage with df
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用df命令检查磁盘空间使用情况
- en: 'Another useful command (which is also available on the web interface at **Diagnostics:
    Information: Space Used** ) is the df command. df shows the disk space usage.
    It has an optional parameter `-h` (the human readable flag), which makes the output
    more friendly.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个有用的命令（也可以在网页界面的**诊断：信息：已用空间**中找到）是df命令。df显示磁盘空间的使用情况。它有一个可选参数`-h`（人类可读标志），使输出更友好。
- en: '[PRE16]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Each filesystem is listed with its total size, space used, space available,
    and what percentage of the disk is used.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 每个文件系统都会列出其总大小、已用空间、可用空间以及磁盘使用的百分比。
- en: Discover the Size of Directories Using du
  id: totrans-95
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用du命令发现目录的大小
- en: Another very useful command which isn't included in the web interface is the
    *du* command. The *du* command displays the disk space usage for each file and
    for each folder given including the subfolders or for the current folder if none
    is given.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个非常有用的命令是*du*命令，虽然它没有包含在网页界面中。*du*命令显示每个文件和每个文件夹（包括子文件夹）的磁盘空间使用情况，或者如果未指定文件夹，则显示当前文件夹的磁盘空间使用情况。
- en: 'From the example above, we see that the RAID 5 array has 239MB used. If we
    change directory into `the /mnt/raid5` directory and then run the `du` command
    (with the `-h` flag for human readability and `-s` for summary) we see that the
    239MB listed in the `df` command is also listed from the `du` command:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 从上面的例子可以看出，RAID 5 数组已使用了 239MB。如果我们进入`/mnt/raid5`目录，然后运行带有`-h`（人类可读）和`-s`（汇总）标志的`du`命令，我们会发现`df`命令中列出的
    239MB 也出现在`du`命令的输出中。
- en: '[PRE17]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'Inside the `/mnt/raid5`, there is a folder called `pictures`, to discover how
    much disk space is used by the pictures folder use the `du` command, either by
    changing directory to that folder or specifying it directly:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在`/mnt/raid5`内，有一个名为`pictures`的文件夹，要查看`pictures`文件夹使用了多少磁盘空间，可以使用`du`命令，可以直接切换到该文件夹或直接指定它：
- en: '[PRE18]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Process Monitoring Using ps and top
  id: totrans-101
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 ps 和 top 进行进程监控
- en: FreeBSD is able to run many programs at the same time. The FreeNAS server includes
    a web server, an FTP server, and a SSH server etc which all run at the same time.
    Each of these programs runs as a separate process. Each process uses time on a
    system's CPU, as well as other system resources such as memory and disk space.
    If a program goes wrong, it can start to use too much CPU time or memory and so
    deny other programs the resources they need to run. There are some FreeBSD commands
    to monitor the status of the process running on your server.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: FreeBSD 能够同时运行许多程序。FreeNAS 服务器包括 Web 服务器、FTP 服务器和 SSH 服务器等，它们都同时运行。每个程序作为一个单独的进程运行。每个进程都使用系统的
    CPU 时间，以及内存和磁盘空间等其他系统资源。如果程序出现问题，它可能会开始使用过多的 CPU 时间或内存，从而拒绝其他程序运行所需的资源。有一些 FreeBSD
    命令可以监视服务器上正在运行的进程的状态。
- en: '`ps` shows the current processes running on the machine. `ps` has many different
    options, but one of the most useful invocations is `ps aux`, which shows every
    process on the system.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: '`ps`显示当前在机器上运行的进程。`ps`有许多不同的选项，但最有用的之一是`ps aux`，它显示系统上的每个进程。'
- en: 'A normal FreeNAS server will have some 60 to 70 processes running after boot
    up, so the output from the `ps` command can be quite long. Here are the first
    few lines from a FreeNAS server:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 正常的 FreeNAS 服务器在启动后会运行大约 60 到 70 个进程，因此`ps`命令的输出可能会相当长。以下是从 FreeNAS 服务器中提取的前几行：
- en: '[PRE19]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Here is a brief explanation of each of the columns:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是每列的简要解释：
- en: '| Column | Meaning |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '| 列名 | 含义 |'
- en: '| --- | --- |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| USER | This is the name of the user that owns the processes. |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '| USER | 这是拥有进程的用户的名称。 |'
- en: '| PID | Each process has a unique process ID (or PID for short). |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
  zh: '| PID | 每个进程都有一个唯一的进程 ID（或简称 PID）。 |'
- en: '| %CPU | Shows the CPU utilization of the process. It is a decaying average
    over up to a minute of previous (real) time. |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '| %CPU | 显示进程的 CPU 利用率。这是前面（实际）时间的一分钟的衰减平均值。 |'
- en: '| %MEM | This is the amount of the physical memory the process is using. |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
  zh: '| %MEM | 进程使用的物理内存量。 |'
- en: '| VSZ | Shows the virtual memory size of the process in kilobytes. |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
  zh: '| VSZ | 显示进程的虚拟内存大小（以千字节为单位）。 |'
- en: '| RSS | This is similar to VSZ, but rather than virtual memory size, RSS shows
    how much non-swapped, physical memory the process is using in kilobytes. |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
  zh: '| RSS | 类似于 VSZ，但 RSS 显示进程正在使用的非交换物理内存大小（以千字节为单位）。 |'
- en: '| TT | The controlling terminal. Means there isn''t one. |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '| TT | 控制终端。表示没有一个。 |'
- en: '| STAT | The status of the process, where S means the process is sleeping and
    can be woken at any time, L means the process is waiting to acquire a lock. R
    marks a runnable process. |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '| STAT | 进程的状态，其中 S 表示进程正在睡眠并且可以随时唤醒，L 表示进程正在等待获取锁定。R 标记一个可运行的进程。 |'
- en: '| STARTED | Shows when the process was started. |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| STARTED | 显示进程启动的时间。 |'
- en: '| TIME | Is the accumulated CPU time. This includes time spent running the
    processes and time spent in the kernel on behalf of that process. |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| TIME | 累积的 CPU 时间。这包括运行进程和代表该进程在内核中运行的时间。 |'
- en: '| COMMAND | Shows the command which was given to launch the program. |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| COMMAND | 显示启动程序时给出的命令。 |'
- en: 'Finding a specific process in such a long list can be a problem. To help, you
    can use the grep command to look for matches in the text. For example, to look
    for the ftp server process, use the command:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在如此长的列表中找到特定的进程可能会有问题。为了帮助解决问题，您可以使用 grep 命令在文本中查找匹配项。例如，要查找 ftp 服务器进程，可以使用以下命令：
- en: '[PRE20]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: When you run it, the `grep` command itself will be shown (in this case PID 1407)
    as it matches the string we are looking for, namely ftp. But of course, it isn't
    part of the ftp service.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 运行时，`grep` 命令本身会显示（在本例中为 PID 1407），因为它与我们正在查找的字符串匹配，即 ftp。但当然，它并不是 ftp 服务的一部分。
- en: While `ps` shows only a snapshot of the system process, the `top` program provides
    a dynamic real-time view of a system. It displays a system summary (with CPU usage,
    memory usage, and other statistics) as well as a list of running processes that
    changes dynamically as the system is in use. It lists the processes using the
    most CPU first.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 `ps` 仅显示系统进程的快照，但 `top` 程序提供动态实时的系统视图。它显示系统摘要（包括 CPU 使用率、内存使用率和其他统计信息），以及一个动态变化的运行进程列表，按照
    CPU 使用率最高的顺序排列。
- en: '[PRE21]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: The bottom part of the output is similar to the output from the `ps` command.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 输出的底部部分类似于 `ps` 命令的输出。
- en: Advanced FreeBSD Commands for FreeNAS
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: FreeNAS 的高级 FreeBSD 命令
- en: Up until now, we have really been in read-only mode as far as using the underlying
    FreeBSD system. We have looked and monitored but we haven't actually changed anything.
    That is about to change.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 直到现在，我们实际上一直处于只读模式，只是使用底层的 FreeBSD 系统进行查看和监控，但我们实际上还没有做任何更改。这将要改变。
- en: Starting and Stopping Services
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 启动和停止服务
- en: You will have probably noticed that many of the configuration pages on the web
    interface say **Save and Restart**. This is because many of the FreeNAS server
    components need to restart to accept new configurations. As such, it is also possible
    to restart a service manually using the command line. This might be necessary
    if a particular service, for example the FTP server or the AFP server stopped
    responding (this isn't a slur on the FTP server or the AFP server, just merely
    an example).
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能已经注意到，在 Web 界面上许多配置页面上都写着 **保存并重启**。这是因为许多 FreeNAS 服务器组件需要重新启动才能接受新的配置。因此，也可以使用命令行手动重启服务。如果某个特定服务停止响应，例如
    FTP 服务器或 AFP 服务器，这可能是必要的（这并不是针对 FTP 服务器或 AFP 服务器的诋毁，只是一个例子）。
- en: 'Using the command line, it is possible to start, stop, and restart each individual
    service. All of the scripts to control the various services are kept in `/etc/rc.d`
    and to manage a service, you call the respective script directly from that directory.
    To restart the AFP service, you would type:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 使用命令行，可以启动、停止和重启每个单独的服务。所有控制各种服务的脚本都保存在 `/etc/rc.d` 中，要管理一个服务，可以直接从该目录调用相应的脚本。要重新启动
    AFP 服务，可以键入：
- en: '[PRE22]'
  id: totrans-131
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Restart is not the only command that is accepted by the scripts:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 重启并不是脚本接受的唯一命令：
- en: '| Command | Meaning |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| Command | 意义 |'
- en: '| --- | --- |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| start | Starts the service. If the service is already running, no action
    will be taken. |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| start | 启动服务。如果服务已经运行，则不会执行任何操作。 |'
- en: '| stop | Stop the service. If the service isn''t running, nothing will happen.
    |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| stop | 停止服务。如果服务未运行，则不会发生任何操作。 |'
- en: '| restart | Performs a stop and then a start. If the service isn''t running,
    the stop will fail but the script will continue to start the service. |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| restart | 执行停止然后启动。如果服务未运行，则停止将失败，但脚本将继续启动服务。 |'
- en: '| status | Shows if the service is running. |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| status | 显示服务是否正在运行。 |'
- en: 'Here is a table of the possible services you can start and stop:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是你可以启动和停止的可能服务的表格：
- en: '| Name | Service description |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| Name | 服务描述 |'
- en: '| --- | --- |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| afpd | The Apple Filing Protocol Daemon. This provides the connectivity to
    Apple Mac computers. |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| afpd | 苹果文件协议守护程序。提供与苹果 Mac 计算机的连接。 |'
- en: '| lighttpd | The built-in web server for the web interface. |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| lighttpd | 内置的 Web 服务器，用于 Web 接口。 |'
- en: '| mediatomb.sh | The UPnP server. |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| mediatomb.sh | UPnP 服务器。 |'
- en: '| nfsd | The NFS server for sharing files with UNIX type clients. |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
  zh: '| nfsd | 用于与 UNIX 类型客户端共享文件的 NFS 服务器。 |'
- en: '| nfslocking | Part of the NFS server and needs to be controlled separately.
    |'
  id: totrans-146
  prefs: []
  type: TYPE_TB
  zh: '| nfslocking | NFS 服务器的一部分，需要单独控制。 |'
- en: '| pureftpd | The FTP server. |'
  id: totrans-147
  prefs: []
  type: TYPE_TB
  zh: '| pureftpd | FTP 服务器。 |'
- en: '| rsync_client | The RSYNC client. |'
  id: totrans-148
  prefs: []
  type: TYPE_TB
  zh: '| rsync_client | RSYNC 客户端。 |'
- en: '| rsync_local | The local RSYNC client for synchronization between two local
    disks. |'
  id: totrans-149
  prefs: []
  type: TYPE_TB
  zh: '| rsync_local | 用于在两个本地磁盘之间同步的本地 RSYNC 客户端。 |'
- en: '| rsyncd | The RSYNC server. |'
  id: totrans-150
  prefs: []
  type: TYPE_TB
  zh: '| rsyncd | RSYNC 服务器。 |'
- en: '| samba | The CIFS/SMB server for Windows connectivity. |'
  id: totrans-151
  prefs: []
  type: TYPE_TB
  zh: '| samba | 用于 Windows 连接的 CIFS/SMB 服务器。 |'
- en: '| smartd | The hard disk monitoring service. |'
  id: totrans-152
  prefs: []
  type: TYPE_TB
  zh: '| smartd | 硬盘监控服务。 |'
- en: '| sshd | The secure shell service. |'
  id: totrans-153
  prefs: []
  type: TYPE_TB
  zh: '| sshd | 安全 Shell 服务。 |'
- en: '| unison | The unison synchronization service. |'
  id: totrans-154
  prefs: []
  type: TYPE_TB
  zh: '| unison | unison 同步服务。 |'
- en: Getting Drastic with kill and killall
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 用 kill 和 killall 实现极端控制
- en: The `kill` command attempts to shut down a running process. In FreeBSD, a process
    is stopped when the operating system sends it a signal telling it to shut down.
    The default signal for `kill` is TERM (signal 15), meaning software terminate.
    When the process receives the signal, it should shut down in an orderly way. If
    the process has become rogue, chances are that it won't respond to being told
    politely to shut down. In that case, you have to send the KILL signal (signal
    9 for short). So to kill off a running process (e.g. process 1234) we would use
    `kill -9 1234`.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '`kill`命令尝试关闭正在运行的进程。在FreeBSD中，当操作系统向进程发送信号以告知其关闭时，进程会停止。`kill`的默认信号是TERM（信号15），表示软件终止。当进程接收到该信号时，它应该以有序的方式关闭。如果进程变得异常，可能不会响应“请正常关闭”的指令。在这种情况下，你必须发送KILL信号（简写为信号9）。因此，要杀死一个正在运行的进程（例如，进程1234），我们会使用`kill
    -9 1234`。'
- en: 'The `killall` command kills running processes by name rather than by PID. This
    has the advantage that to kill a process you don''t need to look for the PID using
    the `ps` command. As with `kill, killall` takes a signal parameter, and `-9` is
    used to terminate the processes. So to kill off all the ftp processes you would
    use:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: '`killall`命令通过进程名称而非PID来杀死正在运行的进程。这有一个优点，即在杀死进程时，你无需使用`ps`命令来查找PID。与`kill`一样，`killall`也接受信号参数，`-9`用于终止进程。因此，要杀死所有的ftp进程，你可以使用：'
- en: '[PRE23]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: One thing to note about `killall` is that you need to specify the exact name
    of the process, using `killall -9 pure or killall -9 ftp` will not stop the FTP
    server.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 关于`killall`有一点需要注意：你需要指定进程的确切名称，使用`killall -9 pure`或`killall -9 ftp`不会停止FTP服务器。
- en: A couple of useful parameters to `killall` are `-s` and `-v`.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '`killall`的几个有用参数是`-s`和`-v`。'
- en: '`-s` will show only what would be done, but does not send any signal.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`-s`只会显示将要执行的操作，但不会发送任何信号。'
- en: '`-v` will show a similar output to that of `-s` but will actually send the
    signal while reporting what has been done.'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '`-v`会显示类似于`-s`的输出，但它实际上会在报告所做操作时发送信号。'
- en: '[PRE24]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: RAID Command Line Tools
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: RAID命令行工具
- en: Reading the FreeNAS support forums on sourceforge.net seem to show that a fair
    percentage of users have troubles with RAID configurations. The RAID software
    in FreeNAS is of the highest quality but things can go wrong. All the RAID functions
    (and more) that are available in the web interface are available on the command
    line.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 阅读FreeNAS的支持论坛，似乎有相当一部分用户在RAID配置上遇到困难。FreeNAS中的RAID软件质量非常高，但总会有一些问题出现。所有在Web界面中可用的RAID功能（及更多）在命令行中也同样可用。
- en: 'Each different type of RAID level (RAID 0, RAID 1, and so on) uses a different
    command as it is a specialized program to deal with that RAID level. A utility
    to manage RAID 1 sets knows nothing RAID 5 and vice-versa. The RAID utilities
    are: gconcat, gstripe, gmirror, and graid5.'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 每种RAID级别（RAID 0、RAID 1等）使用不同的命令，因为它们是专门用来处理该RAID级别的程序。管理RAID 1阵列的工具对RAID 5一无所知，反之亦然。RAID工具有：gconcat、gstripe、gmirror和graid5。
- en: Warning
  id: totrans-167
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 警告
- en: A word of warning before starting. With the command line, you have complete
    freedom to manage and control your RAID sets. But this also means you have complete
    freedom to wreck your RAID sets. Be careful that you don't destroy your RAID sets
    by mistake. If you are uncomfortable with managing the RAID sets via the command
    line, you should return to using the web interface as that offers some level of
    protection.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前有个警告。使用命令行时，你可以完全自由地管理和控制你的RAID阵列。但这也意味着你完全有可能破坏你的RAID阵列。小心不要错误地摧毁RAID阵列。如果你对通过命令行管理RAID阵列感到不舒服，你应该回到使用Web界面，因为它提供了一定的保护。
- en: Another possible problem is that the web interface can become out-of-sync with
    the current server configuration when you are using the command line. In one sense
    it is like doing things behind the back of the web interface and it doesn't know
    what has changed. For example if disk *da0* fails in a RAID set, and another disk
    *da1* is added to the system and that disk is used to repair the RAID array, then
    although the RAID will function correctly, the web interface will know nothing
    about the disk *da1*. At its worst, this is just an annoyance, especially if the
    new disk *da1* saved your valuable data.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个可能的问题是，当你使用命令行时，Web界面可能与当前的服务器配置不同步。从某种意义上来说，这就像是你在Web界面背后做事，而它并不知道发生了什么变化。例如，如果RAID阵列中的磁盘*da0*出现故障，且添加了另一块磁盘*da1*到系统中，并用该磁盘修复RAID阵列，那么尽管RAID将正常运行，Web界面却对磁盘*da1*一无所知。在最糟糕的情况下，这只是一个困扰，尤其是当新磁盘*da1*挽救了你宝贵的数据时。
- en: List and Status Commands
  id: totrans-170
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 列表和状态命令
- en: Although each of the utilities for managing RAID levels is different, they do
    have some common commands. Every utility accepts the `list` and `status` commands.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管管理 RAID 级别的每个工具有所不同，但它们有一些共同的命令。每个工具都接受 `list` 和 `status` 命令。
- en: 'The `status` command provides a short summary of the disks that make up the
    RAID set and the current status of the RAID set. Here is the example output of
    status for a RAID 5 array:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: '`status` 命令提供了组成 RAID 阵列的磁盘及其当前状态的简要概述。以下是 RAID 5 阵列的状态输出示例：'
- en: '[PRE25]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: From this, we can see that the RAID5 is COMPLETE (no disks missing), which also
    means it isn't rebuilding, and that disks *da0, ad3*, and *ad1* make up the RAID
    set.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 从这可以看出，RAID5 阵列为 COMPLETE（没有磁盘丢失），这也意味着它没有在重建，并且磁盘 *da0, ad3* 和 *ad1* 组成了该 RAID
    阵列。
- en: The output from the list command is more comprehensive and in many ways is debug
    information. When your RAID array is working well, this information isn't very
    interesting, but when you are having troubles with your RAID set, this information
    can be very valuable.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: '`list` 命令的输出更加全面，并且在许多方面是调试信息。当 RAID 阵列运行正常时，这些信息并不有趣，但在遇到 RAID 阵列问题时，这些信息可能非常有价值。'
- en: 'To get the list information for a RAID 5, you would type:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取 RAID 5 的列表信息，可以输入：
- en: '[PRE26]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'I have split the output into different sections to aid easier reading:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 我已将输出分成不同的部分，以便更容易阅读：
- en: '[PRE27]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: This first section shows us that this RAID set is called `myraid5` and that
    it is `COMPLETE` and `CALM`. It is made up of 3 disks of which all 3 are online.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 第一部分显示了该 RAID 阵列名为 `myraid5`，并且状态为 `COMPLETE` 和 `CALM`。该阵列由 3 个磁盘组成，所有磁盘都在线。
- en: '[PRE28]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: The next section shows different internal information about how the RAID set
    is implemented. Each RAID level will have different information in this section.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 下一部分展示了有关 RAID 阵列实现的不同内部信息。每个 RAID 级别在此部分会有不同的信息。
- en: '[PRE29]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: This section shows us what this RAID set provides for the system. It provides
    a RAID 5 array that is 4 Gigabytes in size.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 本部分展示了该 RAID 阵列为系统提供的内容。它提供了一个 4GB 大小的 RAID 5 阵列。
- en: '[PRE30]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: The consumers are the disks that are used to make this RAID set. The disk name
    is listed along with its size, disk number (the order the disks are used in),
    and its error state.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 消费者是用来构建该 RAID 阵列的磁盘。磁盘名称列出时会显示其大小、磁盘编号（磁盘在阵列中的使用顺序）和错误状态。
- en: JBOD and gconcat
  id: totrans-187
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: JBOD 和 gconcat
- en: 'Because JBOD (Just a Bunch of Disks) doesn''t offer any kind of protection
    against disk failure, there isn''t much that can be done on the command line.
    The status of the JBOD array can be checked using `gconcat status` as follows:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 由于 JBOD（Just a Bunch of Disks）没有提供任何磁盘故障保护，因此在命令行上无法做太多操作。可以使用 `gconcat status`
    来检查 JBOD 阵列的状态，如下所示：
- en: '[PRE31]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: It is possible to create, format, and mount JBOD arrays completely from the
    command line but it is of little value as the web interface will know nothing
    about the newly created array and as such it can be used (via the web interface).
    Also, because the array isn't saved in the FreeNAS configuration it will be forgotten
    when the machine is rebooted.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 可以完全通过命令行创建、格式化和挂载 JBOD 阵列，但这没有太大意义，因为 web 界面无法识别新创建的阵列，因此无法通过 web 界面使用。此外，由于该阵列未保存在
    FreeNAS 配置中，机器重启后会丢失。
- en: RAID 0 and gstripe
  id: totrans-191
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: RAID 0 和 gstripe
- en: 'Like JBOD, RAID 0 doesn''t provide any protection against disk failure and
    so there is little that can be done on the command line. The status of the RAID
    0 array can be checked using the `gstripe status` command:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 与 JBOD 类似，RAID 0 不提供任何磁盘故障保护，因此在命令行上无法做太多操作。RAID 0 阵列的状态可以通过 `gstripe status`
    命令检查：
- en: '[PRE32]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: It is possible to create, format, and mount RAID1 arrays completely from the
    command line but it is of little value as the web interface will know nothing
    about the newly created array and as such, it can be used (via the web interface).
    Also, because the array isn't saved in the FreeNAS configuration, it will be forgotten
    when the machine is rebooted.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 可以完全通过命令行创建、格式化和挂载 RAID1 阵列，但这没有太大意义，因为 web 界面无法识别新创建的阵列，因此无法通过 web 界面使用。此外，由于该阵列未保存在
    FreeNAS 配置中，因此机器重启后会丢失。
- en: RAID 1 and gmirror
  id: totrans-195
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: RAID 1 和 gmirror
- en: RAID 1 (mirroring) is the first of the 4 basic RAID levels provided by FreeBSD/FreeNAS
    that offers some kind of protection against disk failure.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 1（镜像）是 FreeBSD/FreeNAS 提供的四个基本 RAID 级别中的第一个，它对磁盘故障提供了一定的保护。
- en: 'Here is the output from gmirror status when one of the disks (da0) from the
    mirror set is missing:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 当镜像阵列中的一个磁盘（da0）丢失时，gmirror 状态的输出如下：
- en: '[PRE33]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: The steps to rebuild a mirror array are the same as those set down is chapter
    9\. The command line can be used to rebuild the array rather than the web interface.
    Once the new disk has been put back into the system, you need to use the `forget`
    command. This command sounds a bit harsh but don't worry it isn't going to forget
    the whole mirror set, only the drives that are not currently available. Having
    issued the forget command, you can insert the new disk and the array will rebuild.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 重建镜像阵列的步骤与第9章中描述的相同。可以使用命令行来重建阵列，而不是使用网页界面。将新的磁盘重新安装到系统后，需要使用 `forget` 命令。这个命令听起来有点严厉，但不用担心，它不会忘记整个镜像集合，只会忘记那些当前不可用的硬盘。执行
    `forget` 命令后，可以插入新磁盘，阵列将开始重建。
- en: '[PRE34]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Once the mirror set is rebuilt, the status will be like this:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦镜像集合重建完成，状态将变成这样：
- en: '[PRE35]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: RAID 5 and graid5
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: RAID 5 和 graid5
- en: The procedure to repair a RAID 5 array after disk failure is exactly the same
    as described in chapter 9 but this time we will use the command line rather than
    the web interface.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 磁盘故障后修复 RAID 5 阵列的过程与第9章中描述的完全相同，但这次我们将使用命令行而非网页界面。
- en: 'Using the status command, we can see that there is a problem with this array:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `status` 命令，我们可以看到该阵列存在问题：
- en: '[PRE36]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: The disk `da0` is missing and the RAID is running in a degraded state. Having
    replaced the disk, we are ready to synchronize it with the other disks in the
    RAID set.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 磁盘 `da0` 丢失，RAID 正在以降级状态运行。在替换磁盘后，我们准备与 RAID 集合中的其他磁盘同步。
- en: The new disk needs to be placed back into the array. This is done using the
    `graid5 insert` command.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 新的磁盘需要被放回阵列中。可以使用 `graid5 insert` 命令来完成此操作。
- en: '[PRE37]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'The array will now start rebuilding. You can check that it is rebuilding by
    using the `graid5 status` command again:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 阵列现在将开始重建。你可以通过再次使用 `graid5 status` 命令来检查它是否正在重建：
- en: '[PRE38]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: Once the array is rebuilt, it will return to its `COMPLETE` status.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦阵列重建完成，它将恢复为 `COMPLETE` 状态。
- en: '[PRE39]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: Where the FreeNAS Stores Things
  id: totrans-214
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: FreeNAS 存储数据的位置
- en: There are several places like /etc/rc.d where the FreeNAS server stores important
    files. Here is a summary of some key directories from FreeBSD that the FreeNAS
    server uses.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: FreeNAS 服务器在多个地方（如 /etc/rc.d）存储重要文件。以下是 FreeBSD 系统中一些 FreeNAS 服务器使用的关键目录的汇总。
- en: '| Directory | Importance |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| 目录 | 重要性 |'
- en: '| --- | --- |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| /root | The home directory of the root user |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '| /root | root 用户的主目录 |'
- en: '| /mnt | All disks and RAID sets are mounted under this directory |'
  id: totrans-219
  prefs: []
  type: TYPE_TB
  zh: '| /mnt | 所有磁盘和 RAID 集合都挂载在此目录下 |'
- en: '| /bin & /usr/bin | Store all the user runnable utilities like *chmod* and
    *kill* |'
  id: totrans-220
  prefs: []
  type: TYPE_TB
  zh: '| /bin & /usr/bin | 存储所有用户可执行的工具，如 *chmod* 和 *kill* |'
- en: '| /sbin & /usr/sbin | Store all the root runnable utiliteis like the RAID utilities
    |'
  id: totrans-221
  prefs: []
  type: TYPE_TB
  zh: '| /sbin & /usr/sbin | 存储所有 root 可执行的工具，如 RAID 工具 |'
- en: '| /etc | This directory contains the various configuration files needed by
    FreeNAS. Many of them are created at bootup. |'
  id: totrans-222
  prefs: []
  type: TYPE_TB
  zh: '| /etc | 该目录包含 FreeNAS 所需的各种配置文件。许多文件在启动时会创建。 |'
- en: '| /usr/local/www | Here are the web pages for the FreeNAS web interface. |'
  id: totrans-223
  prefs: []
  type: TYPE_TB
  zh: '| /usr/local/www | 这里存储了 FreeNAS 网页界面的网页文件。 |'
- en: '| /var/log | Here and in directories below it are all the log files stored
    by the FreeNAS server. |'
  id: totrans-224
  prefs: []
  type: TYPE_TB
  zh: '| /var/log | 这里以及其下的所有目录中存储了 FreeNAS 服务器的日志文件。 |'
- en: Note
  id: totrans-225
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that the embedded version of FreeNAS only runs from RAM (and is initially
    loaded from the hard disk or USB flash disk) and any changes made to the operating
    system files will only be temporary, and when the system is rebooted it will return
    to its original state.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，FreeNAS 的嵌入式版本只运行在 RAM 中（最初从硬盘或 USB 闪存盘加载），对操作系统文件所做的任何更改将是临时性的，系统重启后将恢复到原始状态。
- en: Miscellaneous & Sundries
  id: totrans-227
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 杂项 & 零散
- en: There are a variety of commands that can be useful when using the command line
    but they aren't quite big enough to warrant a section of their own, so I have
    grouped them all together here.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 有许多命令在使用命令行时非常有用，虽然它们不大到足以单独成章，因此我将它们都放在这里一起介绍。
- en: Using ping and arp from the Command Line
  id: totrans-229
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用命令行中的 ping 和 arp
- en: 'In chapter 9, we looked at the ping and arp commands. These are available from
    the web interface but they are also available from the command line. To ping another
    machine from the command line type:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 在第9章中，我们看过 ping 和 arp 命令。这些命令可以通过网页界面使用，也可以通过命令行使用。要从命令行 ping 另一台机器，输入：
- en: '[PRE40]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: 'The ping command is a bit different to that of other platforms (like Windows)
    in that it will keep on pinging until you press *CTRL+C* and then it will stop.
    Alternatively, you can use the `-c` parameter that sends only the specified number
    of pings:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: ping命令与其他平台（如Windows）有所不同，它会一直ping，直到你按下 *CTRL+C* 停止。或者，你可以使用 `-c` 参数，只发送指定数量的ping：
- en: '[PRE41]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Also, to look at the arp tables type:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，要查看ARP表，可以输入：
- en: '[PRE42]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Creating Directories and Deleting Things
  id: totrans-236
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建目录和删除文件
- en: 'Earlier on, we looked at some simple file system command like change directory
    (cd), print working directory (pwd), and copy (cp). Here are a few more commands
    that you might find useful when working with the file system from the command
    line:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 之前我们看了一些简单的文件系统命令，比如更改目录（cd）、打印工作目录（pwd）和复制（cp）。这里有一些你在使用命令行操作文件系统时可能会用到的其他命令：
- en: '| Command | Description |'
  id: totrans-238
  prefs: []
  type: TYPE_TB
  zh: '| 命令 | 描述 |'
- en: '| --- | --- |'
  id: totrans-239
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| mv | Move a file from one place to another, which also has the effect of
    doing a rename. eg. *mv oldfilename newfilename* |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
  zh: '| mv | 将文件从一个位置移动到另一个位置，也可以实现重命名。例如 *mv oldfilename newfilename* |'
- en: '| mkdir | Create a directory. eg. *mkdir temp* |'
  id: totrans-241
  prefs: []
  type: TYPE_TB
  zh: '| mkdir | 创建一个目录。例如 *mkdir temp* |'
- en: '| rmdir | Remove a directory. The directory must be empty. eg. *rmdir temp*
    |'
  id: totrans-242
  prefs: []
  type: TYPE_TB
  zh: '| rmdir | 删除一个目录。目录必须为空。例如 *rmdir temp* |'
- en: '| rm | Remove (delete) a file. eg. *rm deleteme* |'
  id: totrans-243
  prefs: []
  type: TYPE_TB
  zh: '| rm | 删除（删除）一个文件。例如 *rm deleteme* |'
- en: '| rm -rf | Remove (delete) a non empty directory and delete all the file and
    sub directories in it. Use with care! eg. *rm -rf goodbyeworld* |'
  id: totrans-244
  prefs: []
  type: TYPE_TB
  zh: '| rm -rf | 删除（删除）一个非空目录，并删除其中的所有文件和子目录。使用时请小心！例如 *rm -rf goodbyeworld* |'
- en: Editing Files Using nano
  id: totrans-245
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用nano编辑文件
- en: Included in the FreeNAS software is a small text editor called nano. Provided
    by GNU, nano is small and friendly. Besides basic text editing, nano offers many
    extra features like an interactive search and replace, go to line and column number,
    auto-indentation, feature toggles, internationalization support, and filename
    tab completion.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: FreeNAS软件中包括一个名为nano的小型文本编辑器。它由GNU提供，nano体积小且易于使用。除了基本的文本编辑功能，nano还提供了许多额外的功能，如交互式查找与替换、跳转到行和列号、自动缩进、功能切换、国际化支持和文件名自动补全。
- en: 'To edit a file, say a text file on one of your disks you would type:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 要编辑一个文件，例如在某个磁盘上的文本文件，你可以输入：
- en: '[PRE43]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: The basic keys are displayed at the bottom of the text editor to help you quickly
    find the key you need. This is especially handy if you are not familiar with the
    editor. The ^ symbol means press the *CTRL* key and the letter mentioned at the
    same time, so ^X means *CTRL+X*.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 基本快捷键会显示在文本编辑器底部，帮助你快速找到所需的按键。如果你不熟悉编辑器，这一点特别有用。^ 符号表示按住 *CTRL* 键和提到的字母同时按下，因此
    ^X 表示 *CTRL+X*。
- en: 'Basic keys include:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 基本的快捷键包括：
- en: ^O WriteOut (Save)
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: ^O 写出（保存）
- en: ^R Read File
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: ^R 读取文件
- en: ^Y Prev Page
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: ^Y 上一页
- en: ^X Exit
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: ^X 退出
- en: ^J Justify
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: ^J 对齐
- en: ^V Next Page
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: ^V 下一页
- en: 'You can get more information on nano at: [http://www.nano-editor.org/](http://www.nano-editor.org/)'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在此获取更多关于nano的信息：[http://www.nano-editor.org/](http://www.nano-editor.org/)
- en: Shutting Down Using the Command Line
  id: totrans-258
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用命令行关闭系统
- en: We are now at the last section of the last chapter this book and as the book
    draws to an end, it seems appropriate to show you how to shutdown the FreeNAS
    server from the command line. To shutdown the server, use the `shutdown` command.
    Used with the `-p` parameter, the server will be shut down and powered off (if
    the hardware supports it) and with `-r` the server will be rebooted. The command
    also needs a time on when to shutdown, and for immediate shutdowns use the word
    `now`.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经来到了本书最后一章的最后部分，随着书籍的结束，似乎适合展示如何通过命令行关闭FreeNAS服务器。要关闭服务器，请使用 `shutdown`
    命令。使用 `-p` 参数时，服务器将关闭并关闭电源（如果硬件支持），使用 `-r` 参数时，服务器将重启。该命令还需要指定关闭时间，若立即关机，请使用 `now`
    关键字。
- en: '[PRE44]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: or
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 或
- en: '[PRE45]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'If you don''t want to shutdown now but want to schedule the shutdown for some
    time in the future then you can change the word `now` to be a number of minutes
    until shutdown with a plus sign in front. So to shutdown in 5 minutes from now
    use:'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不想立即关机，而是想安排未来某个时间关机，你可以将 `now` 改为以加号开头的数字，表示多少分钟后关机。例如，若要在5分钟后关机，可以使用：
- en: '[PRE46]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Finally, if you want to schedule a shutdown for a certain day at a certain time
    then the time of shutdown can be specified as *yymmddhhmm* if you leave out the
    *yymmdd* then the time will be take to be today.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，如果你想安排在某个特定的时间关机，可以使用 *yymmddhhmm* 格式指定关机时间，如果省略 *yymmdd*，则默认为今天。
- en: 'Shutdown at 23:15 tonight is:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 今晚23:15的关机命令是：
- en: '[PRE47]'
  id: totrans-267
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'And to shutdown on the 1^(st) May 2009 at 22:30 (which happens to be a Friday)
    is:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 在2009年5月1日22:30（恰好是星期五）关闭的命令是：
- en: '[PRE48]'
  id: totrans-269
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: Summary
  id: totrans-270
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have looked at FreeBSD. We have covered the basic commands
    for file manipulation as well as some more complex commands for managing processing
    including starting and stopping the various FreeNAS services. We also looked at
    commands for managing RAID sets.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们已经了解了FreeBSD。我们介绍了用于文件操作的基本命令，以及一些更复杂的命令来管理进程，包括启动和停止各种FreeNAS服务。我们还介绍了用于管理RAID阵列的命令。
