- en: Chapter 6. Configuring Storage
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 6 章 配置存储
- en: In this chapter, we will look how to manage hard disks in the FreeNAS server
    and how to configure them to form RAID sets that improve fault tolerance and increase
    drive performance.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何在 FreeNAS 服务器中管理硬盘，并如何配置它们以形成 RAID 集合，提升容错性并提高磁盘性能。
- en: Introduction
  id: totrans-2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: The essence of the FreeNAS server is to provide storage that is easily accessible
    from the network. To this end, it is important to understand how FreeNAS handles
    the storage or more specifically hard disks and how they can be configured and
    used to provide the best and most reliable storage for your network. In this chapter,
    we shall use the words storage and hard disk almost interchangeably. Technically,
    a hard disk is a type of storage and there are many other types of storage besides
    hard disks, but as FreeNAS is primarily concerned with using hard disks as storage,
    the two terms will at times seem like one. The only exception to this will be
    when we look at iSCSI, as iSCSI allows remote storage to be added to the FreeNAS
    server as if it was a local hard disk. Of course, ultimately the remote storage
    is also a hard disk!
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: FreeNAS 服务器的本质是提供一个可以轻松从网络访问的存储。因此，了解 FreeNAS 如何处理存储，或更具体地说，如何处理硬盘，并了解如何配置和使用它们以提供最佳、最可靠的存储对于网络非常重要。在本章中，我们将几乎交替使用存储和硬盘这两个词。技术上讲，硬盘是一种存储设备，除了硬盘，还有许多其他类型的存储，但由于
    FreeNAS 主要关注将硬盘用作存储，因此这两个术语有时会显得相似。唯一的例外是当我们讨论 iSCSI 时，因为 iSCSI 允许将远程存储添加到 FreeNAS
    服务器，就像它是本地硬盘一样。当然，最终远程存储也是一种硬盘！
- en: How FreeNAS Handles Data Disks
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: FreeNAS 如何处理数据磁盘
- en: 'As mentioned in Chapter 2, adding storage to the FreeNAS server is done in
    4 steps:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 如第 2 章所述，将存储添加到 FreeNAS 服务器是通过 4 个步骤完成的：
- en: 1\. The FreeNAS server is "told" about a physical hard disk.
  id: totrans-6
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1. FreeNAS 服务器被“告知”了一个物理硬盘。
- en: 2\. This disk is formatted.
  id: totrans-7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2. 该磁盘已格式化。
- en: 3\. The resulting storage space is mounted and made available internally.
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3. 结果存储空间被挂载并在内部提供。
- en: 4\. The mounted storage space is made available on the network via services
    like CIFS and NFS.
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4. 挂载的存储空间通过 CIFS 和 NFS 等服务在网络上提供。
- en: 'Step one, telling the FreeNAS server about the disks at its disposal is handled
    in Disks: Management. On opening this page, you will see a list of disks that
    are already configured and using the add circle you have the possibility to add
    more. To add a disk, click the add circle and you will be taken to the **Disks:
    Management: Disk: Add** page.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步，告知 FreeNAS 服务器可以使用哪些磁盘，是通过“磁盘：管理”来处理的。打开此页面时，您将看到已经配置的磁盘列表，通过点击添加按钮，您可以添加更多磁盘。要添加磁盘，点击添加按钮，您将进入
    **磁盘：管理：磁盘：添加** 页面。
- en: '![How FreeNAS Handles Data Disks](img/4688_06_01.jpg)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![FreeNAS 如何处理数据磁盘](img/4688_06_01.jpg)'
- en: The most important field on this page is the **Disk** field where you select
    which disk you want to add to the FreeNAS configuration. You can select the disk
    using a drop down box.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 这一页面上最重要的字段是 **磁盘** 字段，在这里您可以选择要添加到 FreeNAS 配置中的磁盘。您可以通过下拉框选择磁盘。
- en: UNIX Device Names
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: UNIX 设备名称
- en: 'In a UNIX type operating systems, including FreeBSD, devices like hard disks
    are usually referred to by a slightly cryptic name which looks something like
    this:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在 UNIX 类型的操作系统中，包括 FreeBSD，像硬盘这样的设备通常会以一种略显晦涩的名称来引用，类似于以下形式：
- en: '[PRE0]'
  id: totrans-15
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: It isn't actually all that difficult once you understand how the name is made
    up. The first bit `/dev` is easy. It is a special directory on the server that
    holds information about all the devices on the system, where dev is short for
    device. Therefore, all devices start with `/dev`.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 其实一旦了解了名称的组成方式，实际上并不那么难。第一部分 `/dev` 是很简单的，它是服务器上的一个特殊目录，存储着系统中所有设备的信息，dev 是
    device（设备）的缩写。因此，所有设备都以 `/dev` 开头。
- en: 'The second part is the device itself. Here, it can be a bit more complicated,
    but `ad0` means `disk 0`, or the first hard disk as listed in the BIOS. Here is
    a table with some common device names:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 第二部分是设备本身。在这里，它可能会稍微复杂一些，但 `ad0` 代表的是 `disk 0`，即 BIOS 列表中的第一个硬盘。以下是一些常见设备名称的表格：
- en: '| Free BSD device name | Description |'
  id: totrans-18
  prefs: []
  type: TYPE_TB
  zh: '| Free BSD 设备名称 | 描述 |'
- en: '| --- | --- |'
  id: totrans-19
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| /dev/ad* | ATA and SATA hard disks |'
  id: totrans-20
  prefs: []
  type: TYPE_TB
  zh: '| /dev/ad* | ATA 和 SATA 硬盘 |'
- en: '| /dev/da* | SCSI and USB flash storage |'
  id: totrans-21
  prefs: []
  type: TYPE_TB
  zh: '| /dev/da* | SCSI 和 USB 闪存存储 |'
- en: '| /dev/acd* | IDE CD drives |'
  id: totrans-22
  prefs: []
  type: TYPE_TB
  zh: '| /dev/acd* | IDE CD 驱动器 |'
- en: '| /dev/cd* | SCSI CD drives |'
  id: totrans-23
  prefs: []
  type: TYPE_TB
  zh: '| /dev/cd* | SCSI CD 驱动器 |'
- en: '| /dev/fd* | Floppy disks |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| /dev/fd* | 软盘 |'
- en: The `*` is a wild card, which in the real world is a number starting from 0\.
    So `/dev/da2` is the 3^(rd) (as it starts from 0) SCSI hard disk in the system.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '`*` 是一个通配符，实际应用中它代表从 0 开始的数字。所以 `/dev/da2` 是系统中第 3 个（从 0 开始计算）SCSI 硬盘。'
- en: Note
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**RAID Controllers**'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '**RAID 控制器**'
- en: If you are using a hardware RAID controller, for the disks attached it, don't
    use the standard device names for each disk. Instead, these RAID controllers present
    a virtual disk for each RAID set, using a device named after the RAID controller
    driver. For example, the *amr* driver (which supports controllers by MegaRAID
    and some Dell and Intel cards) presents its virtual disks as `/dev/amrd*`. Also,
    some RAID cards present their hard drives as `/dev/da*` devices.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是硬件 RAID 控制器，连接到它的磁盘不要使用标准的设备名称，而是这些 RAID 控制器会为每个 RAID 集合提供一个虚拟磁盘，使用以
    RAID 控制器驱动程序命名的设备。例如，*amr* 驱动程序（支持 MegaRAID 和部分 Dell 与 Intel 卡的控制器）会将虚拟磁盘呈现为 `/dev/amrd*`。此外，一些
    RAID 卡将其硬盘呈现为 `/dev/da*` 设备。
- en: Adding the Disk
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 添加磁盘
- en: Once you have selected the right disk from the drop down box, you can normally
    just go ahead and click **Add**. However, there are some parameters that you can
    tweak and the final field **Preformatted FS** needs to be set correctly if this
    disk is already formatted and has data on it.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你从下拉框中选择了正确的磁盘，通常可以直接点击 **添加** 按钮。然而，有一些参数你可以调整，并且如果该磁盘已经格式化并且上面有数据，那么最后一个字段
    **预格式化文件系统（Preformatted FS）** 需要正确设置。
- en: '| Disk parameter | Description |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| 磁盘参数 | 描述 |'
- en: '| --- | --- |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| UDMA mode | Normally, the interface speed of you hard disk is automatically
    detected. You can force interface speed (called the UDMA mode) if you have ''UDMA_ERROR....
    LBA'' message with your hard drive. |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| UDMA 模式 | 通常情况下，硬盘的接口速度会自动检测。如果你在硬盘上看到 ''UDMA_ERROR.... LBA'' 的信息，你可以强制设置接口速度（称为
    UDMA 模式）。 |'
- en: '| Hard disk standby time | Puts the hard disk into standby mode when the selected
    amount of time after the last access has elapsed. Do not use this with flash memory
    devices. |'
  id: totrans-34
  prefs: []
  type: TYPE_TB
  zh: '| 硬盘待机时间 | 在最后一次访问后的选定时间后，将硬盘置于待机模式。请不要在闪存设备上使用此功能。 |'
- en: '| Advanced Power Management | This allows you to lower the power consumption
    of the drive, at the expense of performance. Success will vary depending on your
    BIOS and hard disk. Do not use this with flash memory devices. |'
  id: totrans-35
  prefs: []
  type: TYPE_TB
  zh: '| 高级电源管理 | 这允许你在牺牲性能的情况下降低硬盘的功耗。成功与否取决于你的 BIOS 和硬盘。请不要在闪存设备上使用此功能。 |'
- en: '| Acoustic level | This allows you to set how loud the drive is while it''s
    operating. Success will vary depending on your BIOS and hard disk. Do not use
    this with flash memory devices. |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| 声音级别 | 这允许你设置硬盘在操作时的音量。成功与否取决于你的 BIOS 和硬盘。请不要在闪存设备上使用此功能。 |'
- en: '| Pre-formatted FS | This allows you to set the file system type for pre-formated
    disk with data. Leave ''unformatted'' for an unformatted disk and then use format
    menu for format it. |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 预格式化文件系统（Pre-formatted FS） | 这允许你设置已预格式化并含有数据的磁盘的文件系统类型。对于未格式化的磁盘，保持为 ''未格式化''，然后使用格式菜单进行格式化。
    |'
- en: Note
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Don''t Erase Existing Data by Mistake**'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '**小心不要误删现有数据**'
- en: If you have converted an existing server into a FreeNAS server or you have put
    disks in your FreeNAS server with data already on them, then you need to be sure
    you set the **Preformatted FS** field correctly. Apart from the native UFS format
    of the FreeBSD, FreeNAS supports FAT32, NTFS, and EXT2.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你已经将现有服务器转换为 FreeNAS 服务器，或者你已经将带有数据的磁盘放入 FreeNAS 服务器中，你需要确保正确设置 **预格式化文件系统（Preformatted
    FS）** 字段。除了 FreeBSD 的原生 UFS 格式外，FreeNAS 还支持 FAT32、NTFS 和 EXT2 格式。
- en: Once you have selected the disk from the drop down menu and set any of the optional
    parameters, you can click the **Add** button. Don't forget you also need to apply
    the changes.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你从下拉菜单中选择了磁盘并设置了任何可选参数，你可以点击 **添加** 按钮。别忘了，你还需要应用这些更改。
- en: 'The **Disks: Management** page will now show your disk(s) in a table including
    information about the disk name, size, and file system.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '**磁盘：管理** 页面现在会显示你的磁盘（们）以表格形式，包含磁盘名称、大小和文件系统的信息。'
- en: The next step is to format the disk.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是格式化磁盘。
- en: Formatting a Newly Added Disk
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 格式化新添加的磁盘
- en: Once the disk has been *added* to the FreeNAS server, it needs to be formatted.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦磁盘被 *添加* 到 FreeNAS 服务器，它需要被格式化。
- en: '1\. Go to the **Disks: Format** page.'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1. 转到 **磁盘：格式化** 页面。
- en: '2\. Select which disk you wish to format. Only the disks you have added in
    the **Disks: Management** page are available to be formatted. If the disk you
    want to format doesn''t appear in the drop down list, then go back to the **Disks:
    Management** page and check that your disk has been added correctly.'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 选择要格式化的磁盘。只有您在**磁盘：管理**页面中添加的磁盘才能被格式化。如果您要格式化的磁盘没有出现在下拉列表中，请返回**磁盘：管理**页面，检查磁盘是否已正确添加。
- en: 3\. Next, you must choose the file system you want to use on this disk. The
    default will be UFS and unless you specifically need FAT32 or EXT2, it is best
    to format the disk with UFS.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 接下来，您必须选择要在此磁盘上使用的文件系统。默认情况下将选择UFS，除非您特别需要FAT32或EXT2，否则最好使用UFS格式化磁盘。
- en: Note
  id: totrans-49
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**UFS is Best**'
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**UFS 是最佳选择**'
- en: UFS is the NATIVE file format for FreeBSD (the underlying OS of FreeNAS). Attempting
    to use other file formats such as FAT, FAT32, EXT2, EXT3, or NTFS can result in
    unpredictable results, file corruption, and loss of data!
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: UFS是FreeBSD（FreeNAS底层操作系统）的原生文件格式。尝试使用其他文件格式，如FAT、FAT32、EXT2、EXT3或NTFS，可能会导致不可预见的结果、文件损坏和数据丢失！
- en: 4\. You can also enter an optional volume label for the disk, but it isn't very
    useful as it isn't used in the FreeNAS web interface.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 您还可以为磁盘输入一个可选的卷标签，但由于在FreeNAS的网页界面中并不使用此标签，因此其实际用途不大。
- en: 5\. Leave the minimum free space percentage at its default 8% as lowering the
    threshold can adversely affect performance and auto-defragmentation.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 将最小空闲空间百分比保持为默认的8%，因为降低该阈值可能会影响性能和自动碎片整理功能。
- en: 6\. The final option allows you to tweak the way the disk is formatted, specifically
    to not replace the Mater Boot Record (MBR) with a new one during the format process.
    Normally, this shouldn't be needed but some hardware RAID cards store information
    in the MBR. If you find that the drive doesn't format correctly and you are using
    a hardware RAID card, you can try formatting the disk with the option enabled.
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 最后一个选项允许您调整磁盘的格式化方式，特别是避免在格式化过程中替换主引导记录（MBR）。通常，这不需要，但某些硬件RAID卡将信息存储在MBR中。如果您发现磁盘格式化不正确并且使用了硬件RAID卡，可以尝试启用此选项进行格式化。
- en: 7\. Once you click **Format Disk**, you will asked if you are sure that you
    wish to format the disk. Click **OK** to proceed.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 一旦点击**格式化磁盘**，系统会询问您是否确定要格式化磁盘。点击**确定**以继续操作。
- en: 'The output of formatting the disk will look something like this:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 格式化磁盘后的输出结果大致如下：
- en: '![Formatting a Newly Added Disk](img/4688_06_02.jpg)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![格式化新添加的磁盘](img/4688_06_02.jpg)'
- en: 'The key is to look for the **Done!** comment at the end and the long list of
    superblock numbers before it. If you see that, then everything is OK. If the formatting
    failed for some reason then before the **Done!**, you will see an error message.
    For example if spaces aren''t permitted in the volume label, trying to format
    a disk like this will result in the last lines of the output reading:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 关键是要寻找**完成！**的评论以及它前面的一长串超级块编号。如果看到这些，那么一切正常。如果格式化因某些原因失败，您会在**完成！**之前看到错误消息。例如，如果卷标签中不允许使用空格，尝试格式化这样的磁盘时，输出的最后几行将显示：
- en: '[PRE1]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Mounting Your Newly Formatted Disks
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 挂载您刚格式化的磁盘
- en: Once you have formatted the disk, you need to make it available internally in
    the FreeNAS server. This processing is called *mounting* the disk and is a term
    left over from the early days of computing when an operator had to mount a magnetic
    tape or hard disk on a spindle before using it. Mounting a disk makes it available
    for use within the server and only previously *added* and *formatted* disks can
    be mounted.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 格式化磁盘后，您需要在FreeNAS服务器内部使其可用。此过程称为*挂载*磁盘，这是计算机早期时代遗留下来的术语，当时操作员需要在使用磁带或硬盘之前将其挂载到主轴上。挂载磁盘后，它可以在服务器内部使用，只有以前*添加*并*格式化*过的磁盘才能挂载。
- en: '1\. To mount a disk go to **Disks: Mount Point** and click the add circle.'
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 要挂载磁盘，请转到**磁盘：挂载点**并点击添加按钮。
- en: 'There are five important fields to fill in here: **Type, Disk, Partition, File
    System**, and Name.'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这里有五个重要字段需要填写：**类型、磁盘、分区、文件系统**和**名称**。
- en: Note
  id: totrans-64
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Partitions**'
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**分区**'
- en: To partition a disk means to divide it into parts. All disks need at least one
    partition and having a single partition means using the whole disk. It is also
    possible to partition a disk into many parts. Under FreeNAS, if you install the
    server software on a hard disk, then two partitions are created, the first for
    the operating system software and the second for data. When mounting disks, you
    need to know which partitions you wish to mount.
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对磁盘进行分区意味着将其划分为多个部分。所有磁盘至少需要一个分区，且使用单个分区即表示使用整个磁盘。也可以将磁盘分成多个部分。在FreeNAS中，如果你在硬盘上安装了服务器软件，则会创建两个分区，第一个用于操作系统软件，第二个用于数据存储。在挂载磁盘时，你需要知道你想挂载哪个分区。
- en: By default, FreeNAS doesn't use the legacy method to partition disks, which
    involved storing the partition data in the Mater Boot Record (MBR); instead it
    used the GUID Partition Table (GPT) which is part of the Extensible Firmware Interface
    (EFI) standard proposed by Intel as a replacement for the soon to be obsolescent
    PC BIOS.
  id: totrans-67
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 默认情况下，FreeNAS不使用传统的分区方法，即将分区数据存储在主引导记录（MBR）中；相反，它使用GUID分区表（GPT），这是英特尔提出的可扩展固件接口（EFI）标准的一部分，用来替代即将过时的PC
    BIOS。
- en: '**Type:** Here, you can select if you want to mount a disk or an ISO file.
    For new physical disks, you need to select disk. The ISO option is useful if you
    have an `.iso` file and you wish to make its contents available on your network.'
  id: totrans-68
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**类型：** 在这里，你可以选择是要挂载磁盘还是ISO文件。对于新的物理磁盘，你需要选择磁盘。如果你有一个`.iso`文件并希望将其内容提供到网络上，选择ISO选项将非常有用。'
- en: '**Disk:** Select the disk which you wish to mount. This will be the same disk
    as you used in the **Disks: Management** (to add the disk) and **Disks: Format**
    (to format it).'
  id: totrans-69
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**磁盘：** 选择你希望挂载的磁盘。这个磁盘将与在**磁盘：管理**（添加磁盘）和**磁盘：格式化**（格式化磁盘）中使用的磁盘相同。'
- en: '**Partition:** If you have just formatted this disk using FreeNAS, then you
    will need to select EFI GPT here. If your disk has previous data on it then you
    need to select which partition the data is on. If you have installed FreeNAS on
    a disk and you want to use the rest of the disk for data then select 2.'
  id: totrans-70
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分区：** 如果你刚刚使用FreeNAS格式化了这个磁盘，那么你需要在这里选择EFI GPT。如果磁盘上已有数据，你需要选择数据所在的分区。如果你已经在某个磁盘上安装了FreeNAS并希望将剩余的磁盘空间用于数据存储，那么选择2。'
- en: '**File System:** For disks that have been formatted using FreeNAS, you need
    to select UFS. If you have chosen to use another file system format or the disk
    already had data on it, you need to select the appropriate file system type (one
    of FAT, NTFS, EXT2).'
  id: totrans-71
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件系统：** 对于已使用FreeNAS格式化的磁盘，你需要选择UFS。如果你选择了其他文件系统格式或磁盘上已有数据，你需要选择适当的文件系统类型（FAT、NTFS、EXT2中的一种）。'
- en: '**Name:** Each mounted disk needs a name to distinguish it from other disks.
    It does seem possible to use spaces in the name but for safety I would recommend
    using a simple single word mount point name. The name specified will used to mount
    the disk under the **/mnt** directory on the FreeNAS server, so if we used *store2*
    then the disk will be mounted on **/mnt/store2** and that would be the name used
    to share the disk on the network using CIFS etc.'
  id: totrans-72
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称：** 每个挂载的磁盘需要一个名称，以便与其他磁盘区分开来。名称中似乎可以使用空格，但为了安全起见，我建议使用一个简单的单词作为挂载点名称。指定的名称将用于在FreeNAS服务器上的**/mnt**目录下挂载磁盘，因此，如果我们使用*store2*，那么磁盘将被挂载在**/mnt/store2**，这个名称也将用于通过CIFS等共享该磁盘。'
- en: '**Description:** You can fill in an optional description for this mount point.'
  id: totrans-73
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**描述：** 你可以为此挂载点填写一个可选的描述。'
- en: '**Read only:** Tick this to mount the file system as read-only, even the Administrator
    account (super user/root) may not write it.'
  id: totrans-74
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**只读：** 勾选此项将文件系统挂载为只读，即使是管理员账户（超级用户/root）也无法对其进行写操作。'
- en: Note
  id: totrans-75
  prefs:
  - PREF_IND
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Using Disks Formatted under Older Versions of FreeNAS**'
  id: totrans-76
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**使用在旧版本FreeNAS下格式化的磁盘**'
- en: If your disks were configured using a version of FreeNAS prior to version 0.683b
    then you need to manually select partition 1 for a UFS formatted drive or software
    RAID volume. The *File System* type should be set to UFS.
  id: totrans-77
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你的磁盘是在FreeNAS 0.683b版本之前配置的，那么你需要手动选择UFS格式化驱动器或软件RAID卷的分区1。*文件系统*类型应设置为UFS。
- en: 2\. Once you have filled in all the data, click the **Add** button.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2. 填写完所有数据后，点击**添加**按钮。
- en: 3\. You will be shown a table with a list of the mounted drives on the FreeNAS
    server. Their status will be listed as **Configuring**.
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3. 你将看到一个包含FreeNAS服务器上已挂载驱动器列表的表格。它们的状态将显示为**正在配置**。
- en: 4\. You now need to click **Apply changes**. Once the changes have been applied,
    the newly displayed table should include the new mount point with the status of
    OK.
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 现在你需要点击**应用更改**。一旦更改应用成功，新的显示表格应包括新的挂载点，状态为OK。
- en: Making the New Disk Available on the Network
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在网络上使新磁盘可用
- en: Now that the new disk is formatted and mounted, it can be made available on
    the network. To do this, enable the appropriate network services like CIFS, NFS,
    and AFP and if necessary, (for example with CIFS) add the new disk as a shared
    resource. For NFS and AFP, all mounted drives are automatically shared. See chapter
    4 for more details.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，新磁盘已经格式化并挂载，可以通过网络提供使用。为此，启用相应的网络服务，如CIFS、NFS和AFP，如果需要（例如对于CIFS），将新磁盘添加为共享资源。对于NFS和AFP，所有挂载的驱动器会自动共享。更多细节请参见第4章。
- en: Configuring Software RAID on FreeNAS
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在FreeNAS上配置软件RAID
- en: FreeNAS has the ability to combine disks and either use them in a concatenated
    manner (meaning they are added together and will appear as one large disk) or
    use them together for redundancy and improved performance (by spreading the data
    across several disks). Using many disks in a set like this is called a RAID (Redundant
    Arrays of Inexpensive Disks) configuration. We looked at RAID in some detail in
    Chapter 3 but to save you from turning there again, here is a summary (you will
    need to go back to Chapter 3 if you need more details).
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: FreeNAS具有将磁盘合并的功能，可以选择以串联的方式使用它们（意味着它们被合并在一起，并显示为一个大磁盘），或者将它们一起使用以实现冗余和提高性能（通过将数据分布在多个磁盘上）。将多个磁盘按这种方式组合使用被称为RAID（廉价冗余磁盘阵列）配置。我们在第三章中详细讨论了RAID，但为了节省你翻到那一章的时间，下面是一个总结（如果你需要更多详细信息，还是需要回到第三章）。
- en: RAID is a system that divides and duplicates data across several hard disks.
    Depending on which scheme you use, your data is copied, in full or in part, across
    other disks in the RAID set, and if one of those disks fails, the other disks
    (with the copy of the data) continue to work and the data as a whole remains intact.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: RAID是一种将数据分割并复制到多个硬盘上的系统。根据你使用的方案，你的数据将完全或部分地复制到RAID集中的其他磁盘上，如果其中一个磁盘发生故障，其他磁盘（含有数据副本的磁盘）继续工作，数据整体保持完整。
- en: 'FreeNAS supports several different RAID configurations that are called RAID
    levels:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: FreeNAS支持几种不同的RAID配置，这些配置被称为RAID级别：
- en: '**JBOD** (Just a Bunch of Disks): This is simple form of disk concatenation,
    the resulting disk appears as one large disk and there is no attempt to spread
    the data across the two disks. Data that falls in the first half of the RAID disk
    is written to disk 1, and data in second half to disk 2\. There is no fault tolerance.'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**JBOD**（仅为一堆磁盘）：这是一种简单的磁盘串联形式，结果磁盘显示为一个大磁盘，并没有尝试将数据分布在两个磁盘上。RAID磁盘的前半部分数据写入磁盘1，后半部分数据写入磁盘2。没有容错机制。'
- en: '**RAID 0** (Striped set without redundancy): RAID 0 is a way of joining two
    disks together to create one big disk. The data is interleaved between the two
    disks and so it improves performance but there is no fault tolerance.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '**RAID 0**（没有冗余的条带集）：RAID 0是一种将两个磁盘结合起来创建一个大磁盘的方式。数据被交替存储在两个磁盘之间，因此它提高了性能，但没有冗余容错。'
- en: '**RAID 1** (mirroring): Here, two disks are used with one disk mirroring the
    contents of the other disk. If either of the disks fails, the RAID continues using
    the remaining disk. When the faulty disk is replaced, the new disk will be synchronized
    with the good disk and the mirroring will continue as before.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '**RAID 1**（镜像）：这里，使用两个磁盘，其中一个磁盘镜像另一个磁盘的内容。如果其中一个磁盘发生故障，RAID会继续使用剩余的磁盘。当故障磁盘被替换后，新磁盘将与正常磁盘同步，镜像将像之前一样继续。'
- en: '**RAID 5** (striped set with distributed parity): This is one of the most popular
    and arguable one of the most useful RAID levels. It allows you to combine a larger
    number of physical disks, and still maintain some redundancy. RAID 5 can be used
    on three or more disks. If one disk fails, the data remains intact. RAID 5 can
    survive one disk failure.'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '**RAID 5**（带有分布式奇偶校验的条带集）：这是最受欢迎且可能是最有用的RAID级别之一。它允许你合并多个物理磁盘，同时保持一定的冗余。RAID
    5可以在三个或更多磁盘上使用。如果其中一个磁盘发生故障，数据仍然完好无损。RAID 5可以在发生一个磁盘故障时继续运行。'
- en: RAID All Starts with Adding the Disks
  id: totrans-91
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: RAID的开始从添加磁盘开始
- en: 'The first step in configuring a RAID set is in the adding of disks on the **Disks:
    Management** page. Click the add circle and select the first disk you wish to
    make part of a RAID set. You do this by selecting it from the drop down box of
    available disks. You can''t use a disk that is already mounted.'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 RAID 集的第一步是在**磁盘：管理**页面添加磁盘。点击添加圆圈，然后选择你希望成为 RAID 集一部分的第一个磁盘。你可以从可用磁盘的下拉框中选择它。不能使用已经挂载的磁盘。
- en: The trick now is to set the **Preformatted FS** field to **Software RAID**.
    This isn't instantly obvious as the disk isn't pre-formatted and in fact, it will
    be formatted later, but in essence what is happening is that this disk is being
    marked as a disk available for software RAID. Then, in the next step, when the
    RAID set is defined, it will appear in the list of disks available for RAID.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 诀窍是将**预格式化 FS**字段设置为**软件 RAID**。这并不立即显现出来，因为磁盘并未预先格式化，实际上，它将在之后格式化，但本质上发生的情况是，该磁盘被标记为可用于软件
    RAID 的磁盘。然后，在下一步中，当 RAID 集定义好后，它将出现在可用于 RAID 的磁盘列表中。
- en: '![RAID All Starts with Adding the DisksRAIDRADI 5, levels](img/4688_06_03.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![RAID 所有从添加磁盘开始RAIDRADI 5，级别](img/4688_06_03.jpg)'
- en: Click on **Add**, and then on **Apply changes**. The list of disks will now
    show the disk added but notice now that the File system column says, SoftRaid
    and not UFS.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**添加**，然后点击**应用更改**。磁盘列表现在会显示已添加的磁盘，但请注意，现在“文件系统”列显示的是 SoftRaid，而不是 UFS。
- en: You need to add at least two disks to use JBOD, RAID 0, and RAID 1\. For RAID
    5, you need at least 3 disks. Repeat the above procedure to add the other disks.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要至少添加两个磁盘才能使用 JBOD、RAID 0 和 RAID 1。对于 RAID 5，至少需要三个磁盘。重复上述步骤以添加其他磁盘。
- en: The next step is to add the disk together to make a RAID set (sometimes referred
    to as a RAID array). The process is almost identical for all the RAID levels.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是将磁盘添加到一起以创建 RAID 集（有时也称为 RAID 数组）。对于所有 RAID 等级，此过程几乎是相同的。
- en: Configuring RAID 1
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置 RAID 1
- en: 'To define a RAID 1 set, go to the **Disks: Software RAID** page. The title
    of the initial page will read **Disks: Geom Mirror: Manage RAID**. At the top,
    there is a series of tabs to select other RAID pages including JBOD, RAID 0, RAID
    1, and RAID 5.'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 要定义一个 RAID 1 集，转到**磁盘：软件 RAID**页面。初始页面的标题将显示为**磁盘：Geom Mirror：管理 RAID**。在页面顶部，有一系列标签可以选择其他
    RAID 页面，包括 JBOD、RAID 0、RAID 1 和 RAID 5。
- en: Note
  id: totrans-100
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**GEOM**'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '**GEOM**'
- en: GEOM is FreeBSD's disk management system. GEOM provides an infrastructure system
    that allows the FreeBSD developers to easily write modules for different types
    of disk functionality. The RAID capabilities of the FreeNAS server come from Geom
    Concat, Geom Stripe, Geom Mirror, and Geom Raid5 modules.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: GEOM 是 FreeBSD 的磁盘管理系统。GEOM 提供了一个基础设施系统，允许 FreeBSD 开发者轻松编写不同类型磁盘功能的模块。FreeNAS
    服务器的 RAID 功能来自 GEOM Concat、Geom Stripe、Geom Mirror 和 Geom Raid5 模块。
- en: To set up mirroring, you need two disks where one will be the mirror of the
    other i.e. if one fails then the other disk works in its place. During read operations
    from the disk set, either disk can be used to fetch the data and so read performance
    is significantly improved.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 要设置镜像，你需要两个磁盘，其中一个将是另一个的镜像，也就是说，如果一个磁盘发生故障，另一个磁盘将顶替它。在从磁盘集中读取数据时，任何一个磁盘都可以用来提取数据，因此读取性能得到了显著提升。
- en: To create a RAID array, click on the add circle. In essence, to get the RAID1
    array working, you need to enter an array name of your choosing and then tick
    the disks that are part of the array. Finally, click **Add**.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个 RAID 数组，点击添加圆圈。本质上，要使 RAID1 数组工作，你需要输入一个你选择的数组名称，然后勾选属于该数组的磁盘。最后，点击**添加**。
- en: The array name should be descriptive and you should consider using useful information
    in the name like the type of raid and the size of the disks, so a mirror of two
    80GB disks could be called *mirror80gb* or *80gbraid*1 etc.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 数组名称应该具有描述性，并且你应该考虑在名称中使用有用的信息，如 RAID 类型和磁盘的大小，因此，两个 80GB 磁盘的镜像可以命名为*mirror80gb*或*80gbraid*1等。
- en: The **Members of this volume** field offers a list of disks that have been previously
    added to the system with the **Preformatted FS** field set to **Software RAID**.
    Tick each disk you want to include in the RAID array.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '**此卷的成员**字段提供了一个磁盘列表，这些磁盘之前已被添加到系统中，并且**预格式化 FS**字段设置为**软件 RAID**。勾选你希望包含在
    RAID 数组中的每个磁盘。'
- en: Note
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Mixing Your Buses**'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '**混合你的总线**'
- en: It is possible to uses IDE, SCSI, and SATA disks in RAID arrays and mix and
    match them. On a "professional" server, there are often several SCSI cards and
    disks, used from different SCSI cards to make the array. The reason for this is
    to limit the load on any one part of the system. So, you might find that performance
    increases by say using SATA and SCSI together. Of course, any performance benefit
    will be nulled if one of the disks is physically significantly slower that the
    other. Here, the bottleneck becomes the disk itself and not the interface servicing
    it. This might be the case if you have fast, expensive SCSI drives but only "consumer"
    level SATA drives, mixing the disks here won't improve you overall system speed.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在RAID阵列中使用IDE、SCSI和SATA磁盘，并将它们混合使用。在“专业”服务器上，通常有多个SCSI卡和磁盘，通过不同的SCSI卡来构建阵列。这样做的原因是为了限制系统某一部分的负载。因此，你可能会发现，通过同时使用SATA和SCSI磁盘，性能有所提升。当然，如果其中一个磁盘的物理速度显著慢于另一个，那么任何性能提升都将被抵消。在这种情况下，瓶颈变成了磁盘本身，而不是它的接口。如果你有快速且昂贵的SCSI驱动器，但只有“消费级”SATA驱动器，那么混合这些磁盘不会提高整体系统速度。
- en: With RAID1, there is one other option that isn't available in the other RAID
    configurations and that is the **Balance algorithm**. FreeBSD offers 3 different
    algorithms for controlling how data is read from the mirror set.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在RAID1中，有一个在其他RAID配置中不可用的选项，那就是**平衡算法（Balance algorithm）**。FreeBSD提供了三种不同的算法来控制如何从镜像集读取数据。
- en: '**Round-robin read:** Here, the disks are used in turn to read data from the
    RAID array and hence the load is equally split over the two.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**循环读取（Round-robin read）**：在这里，磁盘轮流读取RAID阵列中的数据，因此负载均匀分配到两个磁盘上。'
- en: '**Split request:** Here, larger read requests are split into two requests and
    one sent to disk1 and the other to disk2.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分割请求（Split request）**：在这里，较大的读取请求被分割成两个请求，一个发送到磁盘1，另一个发送到磁盘2。'
- en: '**Read from lowest load:** This attempts to read from this disk with the lowest
    load.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**从最低负载磁盘读取（Read from lowest load）**：此算法尝试从负载最小的磁盘读取数据。'
- en: It is generally considered that the round-robin balance algorithm is the best.
    You can of course, try the other settings and see if you get any performance increases.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 一般认为，循环平衡算法是最好的。你当然可以尝试其他设置，看看是否能获得任何性能提升。
- en: 'Once you click on **Add**, the RAID array will start to be formed. Creating
    a RAID array isn''t an instant thing and sometimes several minutes (or even hours)
    can pass before the array is set up. Don''t forget also to apply the changes.
    The **Disks: Software RAID** page will keep you up-to-date on the status of the
    array. When the array is forming, the status of the array will be listed as **Configuring**
    and when the array is ready it will read **COMPLETE**. You will need to keep going
    back to the **Disks: Software RAID** page to check the progress.'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦点击**添加**，RAID阵列将开始创建。创建RAID阵列不是瞬间完成的，有时可能需要几分钟（甚至几个小时）才能完成阵列设置。别忘了应用更改。**磁盘：软件RAID**页面将实时显示阵列的状态。当阵列正在创建时，阵列状态将显示为**配置中（Configuring）**，当阵列完成时，它将显示为**完成（COMPLETE）**。你需要不断返回**磁盘：软件RAID**页面来检查进度。
- en: '![Configuring RAID 1](img/4688_06_04.jpg)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![配置RAID 1](img/4688_06_04.jpg)'
- en: From here, this RAID set is considered by FreeNAS as a single disk. Of course,
    it is made up of two disks, but logically, it is now one disk. It can be formatted,
    mounted, and shared on the network just like any other disk.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 从此处开始，FreeNAS将此RAID阵列视为一个单一的磁盘。当然，它由两个磁盘组成，但在逻辑上，它现在是一个磁盘。它可以像其他任何磁盘一样进行格式化、挂载和共享。
- en: So, once the array is ready, the next step is to format it. **Don't try and
    format the array before it is ready**.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，一旦阵列准备好，下一步就是格式化它。**在阵列准备好之前不要尝试格式化它**。
- en: 'Go to the **Disks: Format** page. Find the RAID set in the drop down disk menu.
    It will be named according to the name you gave the mirror when you created the
    array followed by its size and finally, by **Software gmirror RAID 1**.'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 转到**磁盘：格式化**页面。在下拉磁盘菜单中找到RAID阵列。它将根据你创建阵列时为镜像命名的名称显示，后面跟着其大小，最后是**软件gmirror
    RAID 1**。
- en: Make sure the **File system** is set to UFS, enter the optional volume name
    and click **Format disk**. Confirm that you want to format the mirror and just
    like formatting a single drive, you will see the output of the commands used to
    format the RAID set and it should end with list of super block numbers and the
    reassuring **Done!**
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 确保**文件系统**设置为UFS，输入可选的卷名称并点击**格式化磁盘**。确认是否格式化镜像，就像格式化单个驱动器一样，你将看到用于格式化RAID阵列的命令输出，并且它应以超级块号码列表和令人安心的**完成！**结束。
- en: 'Now, the disk can be mounted exactly like any other disk. To mount the disk,
    go to **Disks: Mount Point** and click the add circle. Select the disk from the
    drop down menu. On the format page, it will be named according to the name you
    gave the mirror when you created the array followed by its size and finally, by
    **Software gmirror RAID 1**. Make sure that the **Type** is **Disk, Partition**
    is **EFI GPT** and the **File system** is **UFS**. Enter the name for the mount
    point and click **Add**. Apply the changes and your disk is now ready and mounted.
    It can now be exported to the network using CIFS, NFS and AFP as before.'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，磁盘可以像任何其他磁盘一样挂载。要挂载磁盘，请前往**磁盘：挂载点**并点击添加圆圈。从下拉菜单中选择磁盘。在格式页面上，它会按照你创建阵列时给镜像命名，后面跟上大小，最后是**软件
    gmirror RAID 1**。确保**类型**为**磁盘**，**分区**为**EFI GPT**，**文件系统**为**UFS**。输入挂载点的名称并点击**添加**。应用更改后，你的磁盘现在已经准备好并挂载。它现在可以像之前一样通过CIFS、NFS和AFP导出到网络。
- en: Configuring RAID 5
  id: totrans-122
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置RAID 5
- en: RAID 5 uses the striping of RAID 0 but now with three disks in the array parity
    data is also stored. If one disk fails, the data remains intact. Configuring a
    RAID 5 set is very similar to that of a RAID 1, except that a RAID 5 array must
    have at least 3 disks.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 5使用RAID 0的条带化技术，但现在阵列中有三个磁盘，并且还存储了校验数据。如果其中一个磁盘发生故障，数据仍然保持完整。配置RAID 5集与RAID
    1非常相似，唯一的区别是RAID 5阵列必须至少包含3个磁盘。
- en: 'To define a RAID 5 set, go to the **Disks: Software RAID** page, and click
    on the **RAID 5** tab. Now click the add circle. The page to define the RAID array
    is very similar to that of RAID 1\. Enter a name for the array (remembering to
    be descriptive) and then tick the disks that you want to include in the array
    (with a minimum of 3).'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 要定义RAID 5阵列，请前往**磁盘：软件RAID**页面，并点击**RAID 5**标签。然后点击添加圆圈。定义RAID阵列的页面与RAID 1非常相似。输入阵列的名称（记得描述性命名），然后勾选你想要包含在阵列中的磁盘（至少需要3个磁盘）。
- en: Click on **Add the RAID array** to start off the formation of the array. Apply
    the changes and wait for the array to become ready. Revisit the RAID 5 page until
    the status reads **COMPLETE**.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**添加RAID阵列**，开始阵列的创建。应用更改并等待阵列准备好。返回RAID 5页面，直到状态显示**完成**。
- en: 'Go to the **Disks: Format** page. Find the RAID set in the drop down disk menu.
    It will be named according to the name you gave the RAID 5 set when you created
    the array followed by its size and finally by **Software graid5 RAID 5**.'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 前往**磁盘：格式化**页面。在下拉磁盘菜单中找到RAID集。它的名称会按照你创建RAID 5阵列时给RAID 5集命名，后面跟上大小，最后是**软件
    graid5 RAID 5**。
- en: Make sure the **File system** is set to **UFS**, enter the optional volume name
    and click **Format disk**. Confirm that you want to format the logical disk and
    just like formatting a single drive, you will see the output of the commands used
    to format the RAID set and it should end with list of super block numbers and
    the reassuring **Done!**
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 确保**文件系统**设置为**UFS**，输入可选的卷名称并点击**格式化磁盘**。确认你要格式化逻辑磁盘，就像格式化单个驱动器一样，你将看到格式化RAID集所使用的命令输出，并且应该以超级块编号列表和令人放心的**完成！**结束。
- en: 'Now the disk can be mounted exactly like any other disk. To mount the disk,
    go to **Disks: Mount Point** and click the add circle. Select the disk from the
    drop down menu. As on the format page, it will be named according to the name
    you gave the RAID 5 set when you created the array followed by its size and finally,
    by **Software graid5 RAID 5**. Make sure that the **Type** is **Disk, Partition**
    is **EFI GPT** and the **File system** is **UFS**. Enter the name for the mount
    point and click **Add**. Apply the changes and your disk is now ready and mounted.
    It can now be exported to the network using CIFS, NFS and AFP as before.'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，磁盘可以像任何其他磁盘一样挂载。要挂载磁盘，请前往**磁盘：挂载点**并点击添加圆圈。从下拉菜单中选择磁盘。在格式页面上，它会按照你创建阵列时给RAID
    5集命名，后面跟上大小，最后是**软件 graid5 RAID 5**。确保**类型**为**磁盘**，**分区**为**EFI GPT**，**文件系统**为**UFS**。输入挂载点的名称并点击**添加**。应用更改后，你的磁盘现在已经准备好并挂载。它现在可以像之前一样通过CIFS、NFS和AFP导出到网络。
- en: Configuring JBOD or RAID 0
  id: totrans-129
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置JBOD或RAID 0
- en: 'JBOD (Just a Bunch of Disks) and RAID 0 (Stripe set) are configured in a very
    similar way to RAID 1\. Go to the **Disks: Software RAID** page, and click on
    the **JBOD** or **RAID 0** tab as required. Now click the add circle. The page
    to define the RAID array is very similar to that of RAID 1\. Enter a name for
    the array (remembering to be descriptive) and then tick the disks that you want
    to include in the array.'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: JBOD（只是一些磁盘）和 RAID 0（条带集）的配置方式与 RAID 1 非常相似。进入**磁盘：软件 RAID**页面，点击所需的**JBOD**或**RAID
    0**标签。然后点击添加圆圈。定义 RAID 阵列的页面与 RAID 1 非常相似。输入阵列的名称（记得具有描述性），然后勾选你想要包含在阵列中的磁盘。
- en: Click on **Add the RAID array** to start off the formation of the array. Apply
    the changes and wait for the array to become ready. Revisit the page until the
    status reads **COMPLETE**.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 点击**添加 RAID 阵列**开始阵列的创建。应用更改并等待阵列准备好。重新访问页面，直到状态显示为**完成**。
- en: 'Go to the **Disks: Format** page. Find the RAID set in the drop down disk menu.
    It will be named according to the name you gave the RAID set when you created
    the array followed by its size and finally, by **Software gconcat JBOD** or **Software
    gstripe RAID 0** for JBOD and RAID 0 respectively.'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 进入**磁盘：格式化**页面。找到下拉菜单中的 RAID 集。它将根据你创建阵列时给 RAID 集命名的方式命名，后面跟着其大小，最后是**软件 gconcat
    JBOD**或**软件 gstripe RAID 0**，分别用于 JBOD 和 RAID 0。
- en: 'Now the logical RAID disk can be mounted exactly like any other disk. To mount
    the disk go to **Disks: Mount Point** and click the add circle. Select the disk
    from the drop down menu. It will be named as it was in the format page. Make sure
    that the **Type** is **Disk, Partition** is **EFI GPT** and the **File system**
    is **UFS**. Enter the name for the mount point and click **Add**. Apply the changes
    and your disk is now ready and mounted. It can now be exported to the network
    using CIFS, NFS and AFP as before.'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，逻辑 RAID 磁盘可以像其他任何磁盘一样挂载。要挂载磁盘，进入**磁盘：挂载点**页面，点击添加圆圈。从下拉菜单中选择磁盘。它将按照格式化页面中的命名方式显示。确保**类型**是**磁盘**，**分区**是**EFI
    GPT**，**文件系统**是**UFS**。输入挂载点的名称并点击**添加**。应用更改，你的磁盘现在已经准备好并被挂载。它现在可以像之前一样通过 CIFS、NFS
    和 AFP 导出到网络中。
- en: Nested RAID Configurations
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 嵌套 RAID 配置
- en: '![Nested RAID Configurations](img/4688_06_Graphics.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![嵌套 RAID 配置](img/4688_06_Graphics.jpg)'
- en: As well as the standard RAID levels, it is possible to create hybrid levels
    by combining one logical RAID disk with another logical RAID disk in a new RAID
    array. This is sometimes called nesting RAID levels.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 除了标准的 RAID 级别外，还可以通过将一个逻辑 RAID 磁盘与另一个逻辑 RAID 磁盘结合在一个新的 RAID 阵列中来创建混合级别。这有时被称为嵌套
    RAID 级别。
- en: For example you can configure two disks to be a RAID 1 mirror and then another
    two disks to be a second RAID 1 mirror. These two mirror sets can be combined
    with RAID 0 to make a new striped RAID set.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，你可以将两个磁盘配置为 RAID 1 镜像，然后将另外两个磁盘配置为第二个 RAID 1 镜像。这两个镜像集可以与 RAID 0 结合，形成一个新的条带
    RAID 集。
- en: There are many possible combination of RAID levels, of which some of the most
    popular are RAID 1+0, RAID 0+1, RAID 5+0, and RAID 5+1.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 级别有很多可能的组合，其中一些最常见的组合是 RAID 1+0、RAID 0+1、RAID 5+0 和 RAID 5+1。
- en: Sometimes, these hybrid RAID level are named without the plus sign, so RAID
    1+0 becomes RAID 10, RAID 5+1 becomes RAID 51, and so on.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，这些混合 RAID 级别会去掉加号，因此 RAID 1+0 变成 RAID 10，RAID 5+1 变成 RAID 51，依此类推。
- en: Note
  id: totrans-140
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Read the RAID Levels Backwards**'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: '**倒着阅读 RAID 级别**'
- en: The simplest way to understand what each RAID level means is to read the RAID
    levels backwards, so RAID 1+0 is a RAID 0 array at the highest level made up of
    RAID 1 sets beneath it. Alternatively, it might help you picture it by understanding
    that as you read from left to right you are going up the nested RAID tree with
    the first RAID level being at the bottom, working with the actual hard disks.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 理解每个 RAID 级别的最简单方法是倒着阅读 RAID 级别，因此 RAID 1+0 是一个 RAID 0 阵列，其上面是 RAID 1 集合。或者，理解这一点可能有助于你通过从左到右阅读，逐步进入嵌套的
    RAID 树，最底层的 RAID 级别操作的是实际的硬盘。
- en: Configuring RAID 1+0
  id: totrans-143
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置 RAID 1+0
- en: RAID 1+0 is a stripe of mirrors meaning the there are two (or more) RAID 1 (mirror)
    arrays and these are combined in a RAID 0 stripe set.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 1+0 是一个镜像条带，意味着有两个（或更多）RAID 1（镜像）阵列，这些阵列在 RAID 0 条带集中组合在一起。
- en: 1\. To create a RAID 1+0 set with FreeNAS, you will need at least 4 hard disks.
    Create two RAID 1 mirrors sets (which I will refer to as mirror1 and mirror2)
    as described in the *Configuring RAID 1* section above but do not format or mount
    the RAID arrays.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 要在FreeNAS中创建RAID 1+0集，您至少需要4个硬盘。按照上面*配置RAID 1*部分描述的方式创建两个RAID 1镜像集（我将其称为mirror1和mirror2），但不要格式化或挂载RAID数组。
- en: '2\. Go to the **Disks: Format** page and select **mirror1**. Change the **File
    system** to **Software RAID** and format the disk. The output will be short and
    simple:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 转到**磁盘：格式**页面，并选择**mirror1**。将**文件系统**更改为**软件RAID**并格式化磁盘。输出将简短而简单：
- en: '[PRE2]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: What has happened is that the RAID 1 mirror set, mirror1, as of now has itself
    been marked as a disk (albeit a logical disk) for software RAID.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 发生的事情是，RAID 1镜像集mirror1目前已经标记为软件RAID的磁盘（尽管是逻辑磁盘）。
- en: 3\. Repeat the process for mirror2.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 重复mirror2的过程。
- en: '4\. Now, go back to the **Disks: Software RAID** page. On the **RAID 1** tab,
    the two mirror sets will be listed. Click on the **RAID 0** tab and then click
    the add circle.'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 现在，返回到**磁盘：软件RAID**页面。在**RAID 1**选项卡上，将列出两个镜像集。单击**RAID 0**选项卡，然后单击添加圆圈。
- en: 'The first thing to notice is that in the **Members of this volume** field,
    there are now two additional disks listed:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: '**这卷的成员**字段中的第一件事是，现在列出了另外两个附加的磁盘：'
- en: '[PRE3]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Above them, will be the other 4 drives that you have used to create these two
    mirror sets. Also, notice that they are grayed out and you can't tick them for
    inclusion in another RAID set, which is of course correct as they are already
    in use for mirror1 and mirror2.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在它们上面，会有另外4个驱动器，这些驱动器用于创建这两个镜像集。同时注意到它们变灰且无法勾选以包含在另一个RAID设置中，这当然是正确的，因为它们已经用于mirror1和mirror2。
- en: 5\. Enter the name for the RAID set, let's say **raid10** and then tick **mirror1**
    and **mirror2** to include them in the RAID array. Click **Add** and apply the
    changes.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 输入RAID设置的名称，比如**raid10**，然后勾选**mirror1**和**mirror2**以将它们包含在RAID阵列中。点击**添加**并应用更改。
- en: 6\. Once the RAID is formed, its status will read **UP**. Once the RAID 1+0
    is **UP**, it can be formatted and mounted just like any other disk.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 一旦RAID形成，其状态将显示为**UP**。一旦RAID 1+0为**UP**，它可以像任何其他磁盘一样格式化和挂载。
- en: '7\. Go to the **Disks: Format** page. Find the RAID 1+0 set in the drop down
    disk menu. It will be named according to the name you gave the raid set when you
    created the array (**raid10**) followed by its size and finally by **Software
    gstripe RAID 0**.'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 转到**磁盘：格式**页面。在下拉磁盘菜单中找到RAID 1+0集。它将根据创建数组时给予RAID设置的名称（**raid10**）命名，后跟其大小，最后是**软件gstripe
    RAID 0**。
- en: '8\. Now the logical RAID 1+0 disk can be mounted exactly like any other disk.
    To mount the disk, go to **Disks: Mount Point** and click the add circle. Select
    the disk from the drop down menu. It will be named as it was in the format page.
    Make sure that the **Type** is **Disk**, Partition is **EFI GPT** and the **File
    system** is **UFS**. Enter the name for the mount point and click **Add**. Apply
    the changes and your disk is now ready and mounted. It can now be exported to
    the network using CIFS, NFS, and AFP as before.'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. 现在逻辑RAID 1+0磁盘可以像任何其他磁盘一样挂载。要挂载磁盘，转到**磁盘：挂载点**并点击添加圆圈。从下拉菜单中选择磁盘。它将与格式页面中的命名相同。确保**类型**为**磁盘**，分区为**EFI
    GPT**，**文件系统**为**UFS**。输入挂载点的名称，然后点击**添加**。应用更改，您的磁盘现在已准备好并已挂载。现在可以像以前一样通过CIFS、NFS和AFP导出到网络。
- en: Configuring RAID 0+1
  id: totrans-158
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置RAID 0+1
- en: RAID 0+1 is a mirror of two stripe sets. The key difference from RAID 1+0 is
    that RAID 0+1 creates a secondary stripe set to mirror the first striped set.
    A RAID 1+0 setup can cope with two disk failures as long as they are in the same
    stripe set or in other words, one whole side of the mirrored configuration can
    fail and the mirror will keep on working.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 0+1是两个条带集的镜像。与RAID 1+0的主要区别在于RAID 0+1创建一个次要条带集来镜像第一个条带集。RAID 1+0设置可以处理两个磁盘故障，只要它们位于同一条带集中，换句话说，镜像配置的整个一侧可以失败，而镜像仍将继续工作。
- en: Creating a RAID 0+1 configuration is similar to that of a RAID 1+0 set and it
    is best that you have read that section before you proceed here.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 创建RAID 0+1配置类似于RAID 1+0设置，最好在进行本操作之前已经阅读了该部分。
- en: '1\. To create a RAID 0+1 set, two RAID 0 sets need to be created as described
    in the **Configuring JBOD or RAID 0** section. Let''s call these **raid0a** and
    **raid0b** After the sets have been created, they need to formatted as Software
    RAID on the **Disks: Format** page.'
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 要创建 RAID 0+1 集，需要像**配置 JBOD 或 RAID 0**章节描述的那样创建两个 RAID 0 集。让我们称这些为 **raid0a**
    和 **raid0b**。创建完集后，需要在 **磁盘：格式** 页面上将它们格式化为软件 RAID。
- en: '2\. Now, go back to the **Disks: Software RAID** page. On the **RAID 0** tab,
    the two **raid0** sets will be listed. On the **RAID 1** tab, click the add circle.'
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 现在，回到 **磁盘：软件 RAID** 页面。在 **RAID 0** 选项卡上，将列出这两个 **raid0** 集。在 **RAID 1**
    选项卡上，点击添加按钮。
- en: Listed in the Members of this volume field will be the two RAID 0 sets, **raid0a**
    and **raid0b**.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在 **此卷的成员** 字段中将列出两个 RAID 0 集，**raid0a** 和 **raid0b**。
- en: 3\. Enter the name for the RAID set, let's say **raid01** and then tick **raid0a**
    and **raid0b** to include them in the RAID array. Click **Add** and apply the
    changes.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 输入 RAID 集的名称，假设为 **raid01**，然后选中 **raid0a** 和 **raid0b** 以包含它们在 RAID 阵列中。点击
    **添加** 并应用更改。
- en: Once the RAID is formed, its status will read **COMPLETED**. It can now be formatted
    and mounted just like any other disk.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 形成后，其状态将显示为 **已完成**。现在可以像任何其他磁盘一样格式化和挂载它。
- en: '4\. Go to the **Disks: Format** page. Find the RAID 0+1 set in the drop down
    disk menu. It will be named according to the name you gave the RAID set when you
    created the array (**raid01**) followed by its size and finally, by **Software
    gmirror RAID 1**.'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 转到 **磁盘：格式** 页面。在下拉磁盘菜单中找到 RAID 0+1 集。它将根据您在创建阵列时给出的名称（**raid01**）命名，并按其大小和最后按
    **软件 gmirror RAID 1**。
- en: '5\. Now the logical RAID 0+1 disk can be mounted exactly like any other disk.
    To mount the disk, go to **Disks: Mount Point** and click the add circle. Select
    the disk from the drop down menu. It will be named as it was in the format page.
    Make sure that the **Type** is **Disk, Partition** is **EFI GPT** and the **File
    system** is **UFS**. Enter the name for the mount point and click **Add**. Apply
    the changes and your disk is now ready and mounted. It can now be exported to
    the network using CIFS, NFS and AFP as before.'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 现在，逻辑 RAID 0+1 磁盘可以像任何其他磁盘一样挂载。要挂载磁盘，转到 **磁盘：挂载点** 并点击添加按钮。从下拉菜单中选择磁盘。它将按照格式页面中的名称命名。确保
    **类型** 为 **磁盘，分区** 为 **EFI GPT**，**文件系统** 为 **UFS**。输入挂载点名称，然后点击 **添加**。应用更改，您的磁盘现在已准备就绪并已挂载。现在可以像以前一样使用
    CIFS、NFS 和 AFP 导出到网络。
- en: Configuring RAID 5+0
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置 RAID 5+0
- en: RAID 5+0 is a stripe of RAID 5 sets meaning that there are two (or more) RAID
    5 (stripes with parity) arrays and these are combined in a RAID 0 stripe set.
    You need a minimum of 6 disks to build a RAID 5+0 array.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 5+0 是 RAID 5 集的条带化，意味着有两个（或更多）RAID 5（带奇偶校验的条带）阵列，并且这些阵列组合在一个 RAID 0 条带集中。构建
    RAID 5+0 阵列至少需要 6 块磁盘。
- en: 1\. To create a RAID 5+0 array, you must first create two RAID 5 sets called
    (for example) **raid5a** and **raid5b**. This is described in the *Configuring
    RAID 5* section. Do **not** format them as UFS disks.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 要创建 RAID 5+0 阵列，必须首先创建两个 RAID 5 集，例如称为 **raid5a** 和 **raid5b**。这在 *配置 RAID
    5* 章节中有描述。不要将它们格式化为 UFS 磁盘。
- en: '![Configuring RAID 5+0](img/4688_06_06.jpg)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![配置 RAID 5+0](img/4688_06_06.jpg)'
- en: '2\. Go to the **Disks: Format** page and select **raid5a**. Change the **File
    system** to **Software RAID** and format the disk. The output will be short and
    simple:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 转到 **磁盘：格式** 页面，选择 **raid5a**。将 **文件系统** 更改为 **软件 RAID** 并格式化磁盘。输出将简短而简单：
- en: '[PRE4]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The RAID 5 set, **raid5a** is now marked as a disk (albeit a logical disk) ready
    for use in a software RAID set.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 5 集 **raid5a** 现在被标记为一个磁盘（虽然是逻辑磁盘），准备在软件 RAID 集中使用。
- en: 3\. Repeat the process for raid5b.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 重复 raid5b 的过程。
- en: '4\. Now, go back to the **Disks: Software RAID** page. On the **RAID 5** tab,
    the two RAID sets will be listed. Now click on the **RAID 0** tab and then click
    the add circle.'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 现在，返回到 **磁盘：软件 RAID** 页面。在 **RAID 5** 选项卡上，将列出这两个 RAID 集。现在转到 **RAID 0**
    选项卡，然后点击添加按钮。
- en: 'Notice that in the **Members of this volume** field there are now two additional
    disks listed:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，在 **此卷的成员** 字段中，现在列出了两个额外的磁盘：
- en: '[PRE5]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Above them will be the other 6 drives that you have used to create these two
    RAID 5 sets.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 在它们上方将是您用来创建这两个 RAID 5 集的其他 6 个驱动器。
- en: 5\. Enter the name for the raid set, let's say **raid50** and then tick **raid5a**
    and **raid5b** to include them in the RAID array. Click **Add** and apply the
    changes.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 输入 RAID 集的名称，例如 **raid50**，然后选中 **raid5a** 和 **raid5b** 以包含它们在 RAID 阵列中。点击
    **添加** 并应用更改。
- en: 6\. Once the RAID is formed, its status will read **UP**. Once the RAID 5+0
    is **UP** it can be formatted and mounted just like any other disk.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 一旦RAID阵列形成，其状态将显示为**UP**。当RAID 5+0阵列显示为**UP**时，就可以像其他磁盘一样进行格式化和挂载。
- en: '7\. Go to the **Disks: Format** page. Find the RAID 5+0 set in the drop down
    disk menu. It will be named according to the name you gave the RAID set when you
    created the array (**raid50**) followed by its size and finally, by **Software
    gstripe RAID 0**.'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 进入**磁盘：格式化**页面。在下拉磁盘菜单中找到RAID 5+0阵列。它将按照你在创建阵列时为RAID阵列设置的名称（**raid50**），后面跟着大小，最后是**Software
    gstripe RAID 0**。
- en: '8\. Now the logical RAID 5+0 disk can be mounted exactly like any other disk.
    To mount the disk, go to **Disks: Mount Point** and click the add circle. Select
    the disk from the drop down menu. It will be named as it was in the format page.
    Make sure that the **Type** is **Disk, Partition** is **EFI GPT** and the File
    system is **UFS**. Enter the name for the mount point and click **Add**. Apply
    the changes and your disk is now ready and mounted.It can now be exported to the
    network using CIFS, NFS, and AFP as before.'
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. 现在，逻辑RAID 5+0磁盘可以像其他磁盘一样进行挂载。要挂载磁盘，进入**磁盘：挂载点**并点击添加圆圈。从下拉菜单中选择磁盘。它将按照格式化页面中的名称命名。确保**类型**为**磁盘，分区**为**EFI
    GPT**，文件系统为**UFS**。输入挂载点的名称并点击**添加**。应用更改后，磁盘现在已经准备好并成功挂载。它现在可以像之前一样通过CIFS、NFS和AFP导出到网络。
- en: Configuring RAID 5+1
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置RAID 5+1
- en: A RAID 5+1 array is a mirror of two RAID 5 sets. Such a configuration can handle
    the failure of two disks as long as each disk is in a different RAID 5 set and
    multiple disk failures are inside the same RAID 5 set.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: RAID 5+1阵列是两个RAID 5阵列的镜像。这样的配置可以承受两个磁盘的故障，只要每个磁盘位于不同的RAID 5阵列中，并且多个磁盘故障发生在同一个RAID
    5阵列内。
- en: Configuration of a RAID 5+1 is very similar to that of a RAID 5+0 set and you
    should familiarize yourself with the *Configuring RAID 5+0* section before proceeding.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 配置RAID 5+1与RAID 5+0阵列非常相似，在继续操作之前，你应该先熟悉*配置RAID 5+0*部分。
- en: 1\. As with RAID 5+0, you must first create two RAID 5 sets called (for example)
    **raid5a** and **raid5b**. This is described in the **Configuring RAID 5** section.
    Do **not** format them as UFS disks.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 和RAID 5+0一样，你必须首先创建两个RAID 5阵列，例如命名为**raid5a**和**raid5b**。这部分内容在**配置RAID
    5**中有描述。请**不要**将它们格式化为UFS磁盘。
- en: '2\. Go to the **Disks: Format** page and select **raid5a**. Change the **File
    system** to **Software RAID** and format the disk. The RAID 5 set, **raid5a**
    is now marked as a disk (albeit a logical disk) ready for use in a software RAID
    set. Repeat the process for **raid5b**.'
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 进入**磁盘：格式化**页面，选择**raid5a**。将**文件系统**更改为**Software RAID**并格式化磁盘。RAID 5阵列**raid5a**现在被标记为磁盘（尽管是逻辑磁盘），可以用于软件RAID阵列。对**raid5b**重复相同的过程。
- en: '3\. Now go back to the **Disks: Software RAID** page. On the **RAID 5** tab,
    the two RAID sets will be listed. Now click on the **RAID 1** tab and then click
    the add circle.'
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 现在返回**磁盘：软件RAID**页面。在**RAID 5**标签页下，将列出这两个RAID阵列。然后点击**RAID 1**标签页，并点击添加圆圈。
- en: 'Notice that in the **Members of this volume** field there are now two additional
    disks listed:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在**该卷的成员**字段中，现在列出了另外两个磁盘：
- en: '[PRE6]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Above them will be the other 6 drives which you have used to create these two
    RAID 5 sets.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 在它们上方将会显示你用来创建这两个RAID 5阵列的其他6个磁盘。
- en: 4\. Enter the name for the RAID set, let's say **raid51** and then tick **raid5a**
    and **raid5b** to include them in the RAID array. Click **Add** and apply the
    changes.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 输入RAID阵列的名称，比如**raid51**，然后勾选**raid5a**和**raid5b**，将它们包含在RAID阵列中。点击**添加**并应用更改。
- en: 5\. Once the RAID is formed, its status will read **UP**. Once the RAID 5+1
    is **UP**, it can be formatted and mounted just like any other disk.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 一旦RAID阵列形成，其状态将显示为**UP**。当RAID 5+1阵列显示为**UP**时，它可以像其他磁盘一样进行格式化和挂载。
- en: '6\. Go to the **Disks: Format** page. Find the RAID 5+1 set in the drop down
    disk menu. It will be named according to the name you gave the RAID set when you
    created the array (**raid51**) followed by its size and finally by **Software
    gmirror RAID 1**.'
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 进入**磁盘：格式化**页面。在下拉磁盘菜单中找到RAID 5+1阵列。它将按照你在创建阵列时为RAID阵列设置的名称（**raid51**），后面跟着大小，最后是**Software
    gmirror RAID 1**。
- en: '7\. Now the logical RAID 5+1 disk can be mounted exactly like any other disk.
    To mount the disk, go to **Disks: Mount Point** and click the add circle. Select
    the disk from the drop down menu. It will be named as it was in the format page.
    Make sure that the **Type** is **Disk, Partition** is **EFI GPT** and the **File
    system** is **UFS**. Enter the name for the mount point and click **Add**. Apply
    the changes and your disk is now ready and mounted. It can now be exported to
    the network using CIFS, NFS, and AFP as before.'
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '7\. 现在，逻辑RAID 5+1磁盘可以像其他磁盘一样挂载。要挂载该磁盘，前往**Disks: Mount Point**并点击添加按钮。通过下拉菜单选择磁盘。它将按格式页面中的名称显示。确保**Type**为**Disk，Partition**为**EFI
    GPT**，并且**File system**为**UFS**。输入挂载点名称并点击**Add**。应用更改后，磁盘即已准备好并挂载。现在，可以像以前一样通过CIFS、NFS和AFP将其导出到网络。'
- en: RAID 10+0 and Beyond
  id: totrans-197
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: RAID 10+0及更高版本
- en: As any RAID array can be formatted as **Software RAID** and then that logical
    disk used inside another RAID array, the number of permutations of nested RAID
    levels is endless, if not always useful. It is technically possible to create
    a mirror of a mirror (a RAID 1+1) or a RAID 5 of three mirror sets (a RAID 15)
    or a stripe of two RAID 15 arrays (a RAID 150—two RAID 5 sets of three mirrors
    sets) and so on.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 由于任何RAID阵列都可以格式化为**软件RAID**，并且该逻辑磁盘可以在另一个RAID阵列中使用，因此嵌套RAID级别的排列组合是无穷无尽的，尽管并不总是有用。从技术上讲，可以创建镜像的镜像（RAID
    1+1）或三个镜像集的RAID 5（RAID 15），或两个RAID 15阵列的条带（RAID 150——两个包含三个镜像集的RAID 5阵列），依此类推。
- en: Another popular RAID format is the so called RAID 10+0 or RAID 100\. A RAID
    10+0 is a stripe of two RAID 10 sets. It is generally implemented using software
    RAID 0 over hardware RAID 10\. With FreeNAS, it is possible to implement it with
    just software.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种流行的RAID格式是所谓的RAID 10+0或RAID 100。RAID 10+0是两个RAID 10阵列的条带。它通常通过在硬件RAID 10上实现软件RAID
    0来实现。使用FreeNAS，只需通过软件就能实现它。
- en: For complicated RAID sets, the combination of hardware RAID and software RAID
    can be very powerful, along with the spreading of the load over different interface
    cards. Whatever your RAID needs, FreeNAS can almost certainly do it!
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 对于复杂的RAID阵列，硬件RAID和软件RAID的结合非常强大，并且可以通过不同的接口卡分担负载。无论你需要什么样的RAID，FreeNAS几乎都能满足！
- en: iSCSI Initiator
  id: totrans-201
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: iSCSI发起器
- en: Another way to add storage to a FreeNAS server is via iSCSI. In Chapter 4, we
    looked at how the FreeNAS server can act as an iSCSI target, that is a remote
    hard disk that can be accessed by an iSCSI initiator (a client). We also saw how
    one FreeNAS server can initiate an iSCSI connection to another FreeNAS server
    and use the storage of the target server as if it was local storage.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 将存储添加到FreeNAS服务器的另一种方式是通过iSCSI。在第4章中，我们介绍了FreeNAS服务器如何作为iSCSI目标，即可以通过iSCSI发起器（客户端）访问的远程硬盘。我们还展示了如何通过iSCSI连接一个FreeNAS服务器到另一个FreeNAS服务器，并将目标服务器的存储像本地存储一样使用。
- en: The iSCSI technology in FreeNAS isn't only limited to working between FreeNAS
    servers. The FreeNAS server can also connect to Windows, Linux, and Solaris iSCSI
    targets. This way, it is possible to extend the storage capacity of your FreeNAS
    server using SCSI over IP.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: FreeNAS中的iSCSI技术不仅限于在FreeNAS服务器之间工作。FreeNAS服务器还可以连接到Windows、Linux和Solaris iSCSI目标。通过这种方式，你可以通过SCSI
    over IP扩展FreeNAS服务器的存储容量。
- en: To demonstrate the FreeNAS server using iSCSI to a different platform, we shall
    look at using Windows.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 为了演示FreeNAS服务器如何使用iSCSI连接到其他平台，我们将以Windows为例。
- en: There are several different iSCSI solutions for Windows including a special
    version of the Windows server called the Windows Storage Server. However, the
    Windows Storage Server is an OEM version of Windows and isn't available for consumer
    purchase. But there are other iSCSI solutions for Windows. A company called Rocket
    Division Software ([http://www.rocketdivision.com](http://www.rocketdivision.com))
    has a free (for personal use) iSCSI target solution called StarWind. It allows
    you to create RAM disks and images files and serve them as iSCSI targets.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: Windows有几种不同的iSCSI解决方案，包括一个名为Windows Storage Server的Windows服务器特别版本。然而，Windows
    Storage Server是Windows的OEM版本，无法供消费者购买。但也有其他适用于Windows的iSCSI解决方案。Rocket Division
    Software公司（[http://www.rocketdivision.com](http://www.rocketdivision.com)）提供了一款名为StarWind的免费iSCSI目标解决方案（仅供个人使用）。它允许你创建RAM磁盘和镜像文件，并将它们作为iSCSI目标提供。
- en: To test FreeNAS with StarWind on Windows, you need to download and install the
    StarWind software. Use the documentation to familiarize yourself with the StarWind
    software and then create an iSCSI target called *istore*. This can be a RAM disk
    or an image file.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 要在Windows上使用StarWind测试FreeNAS，您需要下载并安装StarWind软件。使用文档熟悉StarWind软件，然后创建一个名为*istore*的iSCSI目标。这可以是一个RAM磁盘或镜像文件。
- en: Note
  id: totrans-207
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: One thing to watch when using iSCSI software on Windows is that you may need
    to explicitly open port 3260 in the Windows firewall for the connections to work.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Windows上的iSCSI软件时需要注意的一点是，您可能需要在Windows防火墙中显式打开3260端口，以确保连接正常工作。
- en: 'To configure the iSCSI initiator on FreeNAS, you need to:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 要在FreeNAS上配置iSCSI发起者，您需要：
- en: '1\. On the FreeNAS initiator server, go to the **Disks: Management** page and
    click on the **iSCSI Initiator** tab. Now click the add circle.'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 1\. 在FreeNAS发起者服务器上，进入**磁盘：管理**页面，并点击**iSCSI发起者**标签。然后点击添加按钮。
- en: 2\. Enter a name for the iSCSI disk, say **iSCSI0**. It isn't too important
    as it for information only (it is not using during iSCSI negotiation).
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 2\. 输入iSCSI磁盘的名称，例如**iSCSI0**。这个名称并不重要，因为它仅供参考（在iSCSI协商过程中并不会使用）。
- en: '3\. For the initiator name, enter: **iqn.1994-04.org.netbsd.iscsi-initiator:freenas**.'
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 3\. 对于发起者名称，输入：**iqn.1994-04.org.netbsd.iscsi-initiator:freenas**。
- en: '4\. For the target name, enter: **istore**, which is the target name your created
    in StarWind.'
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 4\. 对于目标名称，输入：**istore**，这是您在StarWind中创建的目标名称。
- en: 5\. Enter the IP address of the Windows target server. And then click **Add**.
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 5\. 输入Windows目标服务器的IP地址，然后点击**添加**。
- en: '6\. Now back to the **Disks: Management** page. Click the add circle and select
    the iSCSI device from the Disk drop down menu. It should read something like:'
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 6\. 现在返回**磁盘：管理**页面。点击添加按钮，并从磁盘下拉菜单中选择iSCSI设备。它应显示类似如下内容：
- en: '[PRE7]'
  id: totrans-216
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: or
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 或
- en: '[PRE8]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 7\. Add the disk in the normal way and apply the changes.
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 7\. 以正常方式添加磁盘并应用更改。
- en: '8\. Now the disk can be formatted from the **Disks: Format** page and mounted
    on the **Disks: Mount Point: Management** page exactly as we have done previously
    in the quick start guide in Chapter 2.'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 8\. 现在，可以从**磁盘：格式**页面格式化磁盘，并像我们在第2章的快速入门指南中所做的那样，在**磁盘：挂载点：管理**页面上挂载它。
- en: After that, you will be able to use the disk via any of the protocols of your
    choosing including CIFS, NFS, AFP, and FTP.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 之后，您将能够通过选择的任何协议使用该磁盘，包括CIFS、NFS、AFP和FTP。
- en: Summary
  id: totrans-222
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have looked how FreeNAS handles disks and how these disks
    can be used in combination to create RAID sets that provide fault tolerance and
    improved performance compared to disks used in isolation.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们已经探讨了FreeNAS如何处理磁盘，以及如何将这些磁盘结合使用来创建RAID阵列，这些阵列相比单独使用磁盘提供了容错能力和更好的性能。
- en: In the next chapter, we shall look at the different backup strategies that can
    be used with the FreeNAS server.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将讨论可以与FreeNAS服务器一起使用的不同备份策略。
