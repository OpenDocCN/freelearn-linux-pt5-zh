- en: Chapter 10. Running a PostgreSQL Database Server
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第 10 章：运行 PostgreSQL 数据库服务器
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍以下内容：
- en: Installing the PostgreSQL database server
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装 PostgreSQL 数据库服务器
- en: Locating the PostgreSQL server configuration files
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定位 PostgreSQL 服务器配置文件
- en: Allowing access to PostgreSQL over the network
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 允许通过网络访问 PostgreSQL
- en: Accessing the PostgreSQL server over an SSH tunnel
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过 SSH 隧道访问 PostgreSQL 服务器
- en: Creating a new database
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建新数据库
- en: Creating users and granting permissions
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建用户并授予权限
- en: Creating a backup of your database
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建数据库的备份
- en: Executing custom SQL commands
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行自定义 SQL 命令
- en: Restoring a database from backup
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从备份恢复数据库
- en: Editing the structure of your database
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编辑数据库结构
- en: Editing records in a database
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编辑数据库中的记录
- en: Installing phpPgAdmin
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装 phpPgAdmin
- en: Introduction
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: PostgreSQL is a powerful open source relational **database management system**
    (**DBMS**). It features a powerful type system and advanced programming functions.
    This allows it to store and perform calculations on complex values, such as geographic
    coordinates, JSON objects, and arrays.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 是一个强大的开源关系 **数据库管理系统**（**DBMS**）。它具有强大的类型系统和高级编程功能。这使得它能够存储和处理复杂值，如地理坐标、JSON
    对象和数组。
- en: PostgreSQL uses a distributed client-server architecture, which means that the
    database server and client applications can run on separate machines. If the client
    and server are running on the same system, they can communicate using Unix sockets;
    otherwise, they communicate over the network by using TCP sockets. The Postgres
    server uses port number 5432 by default, but this setting can be changed if needed.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 使用分布式客户端-服务器架构，这意味着数据库服务器和客户端应用程序可以在不同的机器上运行。如果客户端和服务器在同一系统上运行，它们可以使用
    Unix 套接字进行通信；否则，它们通过网络使用 TCP 套接字进行通信。PostgreSQL 服务器默认使用端口号 5432，但如果需要，可以更改此设置。
- en: Note
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Unix domain sockets are channels used for inter-process communication. Different
    programs running on the same machine can read and write information to a socket,
    enabling communication between the programs. Unix sockets are represented as nodes
    of the filesystem, so you can find a socket by listing the contents of a directory
    in which it was created.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Unix 域套接字是用于进程间通信的通道。运行在同一台机器上的不同程序可以读写套接字信息，从而实现程序之间的通信。Unix 套接字作为文件系统的节点进行表示，因此你可以通过列出创建它的目录的内容来找到一个套接字。
- en: The PostgreSQL DBMS is very popular and most operating system distributions
    provide packages for its easy installation. Each Postgres server hosts a database
    **cluster** that consists of a collection of databases, associated configuration
    files, and running processes. On some systems, the cluster must be initiated after
    package installation. Initiation creates the directory structure of the cluster
    and fills it with standard databases. The standard database, `template1`, plays
    a special role, because all new databases are created as its copies by default.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 数据库管理系统（DBMS）非常流行，大多数操作系统发行版都提供了其易于安装的软件包。每个 PostgreSQL 服务器都托管一个
    **集群**，该集群由一组数据库、相关的配置文件和正在运行的进程组成。在某些系统上，集群必须在安装软件包后初始化。初始化会创建集群的目录结构，并用标准数据库填充它。标准数据库
    `template1` 扮演着特殊的角色，因为所有新数据库默认都是以它为模板创建的。
- en: Installation of the Postgres system involves the creation of a special user,
    usually named `postgres`. This user has complete administrative control over your
    databases, and Webmin will run most database commands and scripts as this user.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 系统的安装涉及创建一个特殊用户，通常命名为 `postgres`。该用户对你的数据库拥有完全的管理员控制权限，Webmin 将以该用户身份运行大多数数据库命令和脚本。
- en: Webmin allows you to perform many tasks related to the running of the Postgres
    database server. In this chapter, we will demonstrate how Webmin can help you
    install PostgreSQL, set up access to the server over a network, manage user accounts,
    create databases, and edit their structure and data. We'll also demonstrate how
    to automatically back up databases and restore backup files. If you find that
    you need an even more advanced web-based management tool, we will demonstrate
    how to set up phpPgAdmin on your server.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 允许你执行与 PostgreSQL 数据库服务器运行相关的许多任务。在本章中，我们将演示如何通过 Webmin 安装 PostgreSQL、设置通过网络访问服务器、管理用户账户、创建数据库并编辑其结构和数据。我们还将演示如何自动备份数据库并恢复备份文件。如果你发现需要一个更高级的基于
    Web 的管理工具，我们将演示如何在服务器上设置 phpPgAdmin。
- en: Installing the PostgreSQL database server
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 PostgreSQL 数据库服务器
- en: Most operating systems that come with a package management solution for open
    source software make PostgreSQL packages available for installation. In this recipe,
    we will install PostgreSQL from a package and set it up on your system. Installing
    the server package automatically installs the PostgreSQL command-line client package,
    as well.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数带有开源软件包管理解决方案的操作系统都提供PostgreSQL软件包以供安装。在本食谱中，我们将从软件包安装PostgreSQL，并在你的系统上进行设置。安装服务器软件包时，会自动安装PostgreSQL命令行客户端软件包。
- en: How to do it...
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to install the PostgreSQL database server:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤安装PostgreSQL数据库服务器：
- en: Follow the steps described in the *Installing software packages* recipe in [Chapter
    1](ch01.html "Chapter 1. Setting Up Your System"), *Setting Up Your System*, to
    find and install the PostgreSQL database server package.
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照[第1章](ch01.html "第1章. 设置你的系统")中*安装软件包*的步骤，*设置你的系统*，查找并安装PostgreSQL数据库服务器软件包。
- en: Note
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: In most package repositories, the PostgreSQL server package is simply named
    `postgresql-server`. If your distribution allows you to select among different
    versions of PostgreSQL, the package names will contain version numbers such as
    `postgresql-9.1` or `postgresql93-server`. Pick the package with the latest version
    unless you have reasons to stick with an older one.
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在大多数软件包仓库中，PostgreSQL服务器的软件包简单地命名为`postgresql-server`。如果你的发行版允许你选择不同版本的PostgreSQL，则软件包名称将包含版本号，例如`postgresql-9.1`或`postgresql93-server`。除非你有理由坚持使用旧版本，否则选择包含最新版本的软件包。
- en: Click the **Refresh Modules** link at the bottom of Webmin's main menu and reload
    the browser to update the menu.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击Webmin主菜单底部的**刷新模块**链接，并重新加载浏览器以更新菜单。
- en: Navigate to **Servers** | **PostgreSQL Database Server**. You should see a screen
    that lists installed databases. It should include the default databases such as
    `postgresql` and `template1`.
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进入**服务器** | **PostgreSQL数据库服务器**。你应该能看到一个列出已安装数据库的界面，其中应包含`postgresql`和`template1`等默认数据库。
- en: If you do not see the list of databases, but instead a message which indicates
    that the database system has not yet been initialized, click the **Initialize
    Database** button.
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你没有看到数据库列表，而是看到一个表示数据库系统尚未初始化的消息，请点击**初始化数据库**按钮。
- en: Tip
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: 'At the bottom of the screen, if you see the message, **Warning: The Perl modules
    DBI and DBD::Pg are not installed on your system**, click the link and follow
    Webmin''s instructions to install the missing Perl modules.'
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在屏幕底部，如果你看到消息**警告：你的系统上没有安装Perl模块DBI和DBD::Pg**，点击链接并按照Webmin的说明安装缺失的Perl模块。
- en: Navigate to **System** | **Bootup and Shutdown** and verify that the init script,
    `postgresql`, is set to start at boot. If it isn't, select its checkbox and click
    the **Start Now and On Boot** button.
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 进入**系统** | **启动与关机**，并验证初始化脚本`postgresql`是否设置为开机启动。如果没有，选中它的复选框，并点击**立即启动并开机启动**按钮。
- en: How it works...
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: Webmin helps you find and install the `postgresql-server` package from your
    distribution's repositories. The package installs the database server, client,
    and an init script that starts the server during system boot.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin帮助你从发行版的仓库中找到并安装`postgresql-server`软件包。该软件包安装数据库服务器、客户端以及一个初始化脚本，用于在系统启动时启动服务器。
- en: Before Postgres can be used to manage databases, a new cluster must be created.
    A PostgreSQL cluster is a collection of databases managed by a single server.
    Creating the cluster involves the creation of a directory in which the database
    files will be stored, and filling it with a few standard databases. The standard
    database named `template1` plays a special role, because all new databases in
    the cluster will be made by copying this template.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在Postgres用于管理数据库之前，必须创建一个新的集群。PostgreSQL集群是由单一服务器管理的一组数据库。创建集群涉及创建一个目录，在其中存储数据库文件，并用一些标准数据库填充它。名为`template1`的标准数据库起着特殊的作用，因为集群中的所有新数据库将通过复制该模板来创建。
- en: 'If your package installation script does not initialize a database cluster
    for you, you can ask Webmin to do it by clicking the **Initialize Database** button.
    This runs the following subcommand of the init script:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的软件包安装脚本没有为你初始化数据库集群，可以通过点击**初始化数据库**按钮请求Webmin来完成此操作。这将运行初始化脚本的以下子命令：
- en: '[PRE0]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: See also
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: If you want to allow other computers to access your databases, take a look at
    the recipe, *Allowing access to PostgreSQL over the network*.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你想允许其他计算机访问你的数据库，请查看食谱*允许通过网络访问PostgreSQL*。
- en: Locating the PostgreSQL server configuration files
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 定位PostgreSQL服务器配置文件
- en: The main configuration file of the PostgreSQL server is usually named `postgresql.conf`,
    and is stored in the database cluster data directory by default. Various system
    distributions move this configuration outside of the data directory and place
    it in a different location, for example, in the `/etc/` directory. In this recipe,
    we will demonstrate how to find the `postgresql.conf` and change it to modify
    the server's configuration. Webmin does not assist you in the modification of
    the basic settings of PostgreSQL, so you will need to edit the configuration file
    manually.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL服务器的主配置文件通常名为`postgresql.conf`，默认情况下存储在数据库集群的数据目录中。不同的系统发行版会将该配置文件移动到数据目录外部并放置在其他位置，例如`/etc/`目录。在本教程中，我们将演示如何查找`postgresql.conf`并修改它以调整服务器配置。Webmin不会帮助你修改PostgreSQL的基本设置，因此你需要手动编辑配置文件。
- en: Getting ready
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Make sure that the PostgreSQL server is installed and running, and that you
    are able to connect to it via Webmin before starting. The recipe, *Installing
    the PostgreSQL database server*, provides more information.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 确保已经安装并运行了PostgreSQL服务器，并且在开始之前你能够通过Webmin连接到它。关于此的详细信息，请参考*安装 PostgreSQL 数据库服务器*。
- en: How to do it...
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Follow these steps to locate PostgreSQL''s main configuration file on your
    system:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤定位系统中PostgreSQL的主配置文件：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon of the default database, `postgres`.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击默认数据库的图标，`postgres`。
- en: Click the **Execute SQL** button.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**执行SQL**按钮。
- en: 'Enter the following SQL command in the provided text area:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在提供的文本框中输入以下SQL命令：
- en: '[PRE1]'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Click the **Execute** button and you will see the output of the SQL command,
    which provides the full path to the main server configuration file, as shown in
    the following screenshot:![How to do it...](img/5849OS_10_01.jpg)
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**执行**按钮，你将看到SQL命令的输出，其中提供了主服务器配置文件的完整路径，如下图所示：![如何操作...](img/5849OS_10_01.jpg)
- en: How it works...
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: When an init script starts the PostgreSQL server, it may specify the location
    of the database cluster's data directory or the location of the server's main
    configuration file (customarily called `postgresql.conf`). By default, the main
    configuration file is stored inside of the data directory, but package maintainers
    often move it to a different location (such as `/etc/`) to keep system configuration
    files in order. The SQL command, `SHOW config_file;`, can be used to check where
    the main configuration file is located.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 当初始化脚本启动PostgreSQL服务器时，它可能会指定数据库集群数据目录的位置或服务器主配置文件的位置（通常叫做`postgresql.conf`）。默认情况下，主配置文件存储在数据目录内部，但软件包维护者通常将其移到不同的位置（例如`/etc/`），以便保持系统配置文件的整洁。SQL命令`SHOW
    config_file;`可以用来检查主配置文件的位置。
- en: There's more...
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: The location of other configuration files and the values of other settings can
    also be displayed using the SQL `SHOW` command.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 其他配置文件的位置和其他设置的值也可以使用SQL `SHOW`命令显示。
- en: Determining location of other configuration files and data files
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 确定其他配置文件和数据文件的位置
- en: 'Use the following commands to check where other configuration files are located:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令检查其他配置文件的位置：
- en: '| Setting | Command |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| 设置 | 命令 |'
- en: '| --- | --- |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Main configuration file (`postgresql.conf`) | `SHOW config_file;` |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| 主配置文件（`postgresql.conf`） | `SHOW config_file;` |'
- en: '| Data directory | `SHOW data_directory;` |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| 数据目录 | `SHOW data_directory;` |'
- en: '| Host-based access configuration file (`pg_hba.conf`) | `SHOW hba_file;` |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| 基于主机的访问配置文件（`pg_hba.conf`） | `SHOW hba_file;` |'
- en: '| Identity mapping file (`pg_ident.conf`) | `SHOW ident_file;` |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| 身份映射文件（`pg_ident.conf`） | `SHOW ident_file;` |'
- en: '| Directory where the Unix-domain socket will be created | `SHOW unix_socket_directory;`
    |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| Unix 域套接字创建目录 | `SHOW unix_socket_directory;` |'
- en: Checking values of other settings
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 检查其他设置的值
- en: 'You can also reveal the values of all settings by issuing the following command:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以通过发出以下命令来显示所有设置的值：
- en: '[PRE2]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Allowing access to PostgreSQL over the network
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 允许通过网络访问PostgreSQL
- en: Programs that access PostgreSQL databases, which are called clients, may be
    running on the same machine as the server. In this case, the client and server
    will communicate most efficiently using a Unix-domain socket, a channel of inter-process
    communication accessed through the filesystem such as a file or directory. Access
    to a socket is controlled by filesystem permissions.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 访问PostgreSQL数据库的程序（称为客户端）可能与服务器运行在同一台机器上。在这种情况下，客户端和服务器将通过Unix域套接字进行高效通信，Unix域套接字是一种通过文件系统（如文件或目录）访问的进程间通信通道。对套接字的访问受文件系统权限控制。
- en: Other client programs may be able to communicate only over TCP network sockets.
    These clients may connect to the local server using the loopback interface and
    IP address of `127.0.0.1`.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 其他客户端程序可能只能通过TCP网络套接字进行通信。这些客户端可以通过回环接口和`127.0.0.1`的IP地址连接到本地服务器。
- en: However, if a client program is located on a machine other than the server,
    then communication between them must take place over the network using the TCP
    protocol. There are a number of ways to set up network connections for PostgreSQL.
    The most efficient but least secure method is to use a direct unencrypted connection
    between the client and server. This method has the drawback that unencrypted information
    could potentially be eavesdropped upon or even modified in transit over the network.
    Because database systems are usually designed to be as efficient as possible,
    this type of communication is used often, but should only be deployed inside of
    a secure network. We will describe how to enable this type of communication in
    this recipe.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，如果客户端程序位于不同于服务器的机器上，则它们之间的通信必须通过网络使用TCP协议进行。对于PostgreSQL，有多种方式可以设置网络连接。最有效但最不安全的方法是使用客户端与服务器之间的直接未加密连接。这种方法的缺点是未加密的信息可能会在网络传输过程中被窃听或篡改。由于数据库系统通常设计为尽可能高效，因此这种通信方式被广泛使用，但只能在安全的网络内部部署。在本教程中，我们将描述如何启用这种通信方式。
- en: Tip
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: In order to make network access to your PostgreSQL server more secure, you can
    choose to encrypt the transferred information using SSL. This prevents eavesdropping
    and man-in-the-middle attacks, but leaves the PostgreSQL server's network port
    exposed and potentially vulnerable to brute-force password guessing and other
    attacks.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使PostgreSQL服务器的网络访问更加安全，您可以选择使用SSL加密传输的信息。这可以防止窃听和中间人攻击，但会暴露PostgreSQL服务器的网络端口，可能会受到暴力破解密码和其他攻击的威胁。
- en: 'If you really need security, for instance, to access your database server over
    the Internet, you should probably choose a third option: send the PostgreSQL traffic
    over an encrypted SSH tunnel. This is the least efficient of the described transmission
    methods, but it generates the fewest security concerns. For more information,
    take a look at the recipe, *Accessing the PostgreSQL server over an SSH tunnel*.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您确实需要安全性，例如通过互联网访问您的数据库服务器，您可能应该选择第三种方式：通过加密的SSH隧道发送PostgreSQL流量。这是上述传输方法中效率最低的一种，但它带来的安全问题最少。有关更多信息，请查看教程*通过SSH隧道访问PostgreSQL服务器*。
- en: Getting ready
  id: totrans-77
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'In this recipe, we will prepare your PostgreSQL server to accept incoming network
    connections. In order to test the connection, we will need access to two computers
    attached to the same network: the server and a client machine. Make note of the
    server and client''s IP or domain name before starting.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我们将准备您的PostgreSQL服务器以接受传入的网络连接。为了测试连接，我们需要访问两台连接到同一网络的计算机：服务器和客户端机器。在开始之前，请记下服务器和客户端的IP或域名。
- en: How to do it...
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'The steps in this recipe will be divided into five sections:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 本教程中的步骤将分为五个部分：
- en: First, we'll instruct PostgreSQL to listen for incoming network connections
    on the standard port (`5432`).
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 首先，我们将指示PostgreSQL在标准端口（`5432`）上监听传入的网络连接。
- en: Next, we'll create a database user named `dbuser`.
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接下来，我们将创建一个名为`dbuser`的数据库用户。
- en: Then, we will create a database named `testtdb`.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 然后，我们将创建一个名为`testtdb`的数据库。
- en: We will allow remote access to the database.
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们将允许远程访问数据库。
- en: And finally, we will test the setup by connecting to our server from a secondary
    client machine.
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最后，我们将通过从辅助客户端机器连接到我们的服务器来测试设置。
- en: 'Perform the following steps to instruct the PostgreSQL server to listen for
    network connections:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤，指示PostgreSQL服务器监听网络连接：
- en: Follow steps described in the recipe, *Allowing access to a service through
    the firewall*in [Chapter 3](ch03.html "Chapter 3. Securing Your System"), *Securing
    Your System*, to allow incoming TCP traffic to port 5432 through your firewall.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照配方《通过防火墙允许访问服务》中的步骤，在[第3章](ch03.html "第3章 安全化您的系统")《保护您的系统》中，允许TCP流量通过防火墙进入5432端口。
- en: Find the location of the PostgreSQL main server configuration file (`postgresql.conf`).
    Refer to the recipe, *Locating the PostgreSQL server configuration files*, for
    detailed instructions.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 查找PostgreSQL主服务器配置文件（`postgresql.conf`）的位置。有关详细说明，请参阅配方《定位PostgreSQL服务器配置文件》。
- en: 'Within the `postgresql.conf` file, find the line with the `listen_addresses`
    directive. This line may be commented out (start with the `#` character). Change
    the line to the following:'
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`postgresql.conf`文件中，找到包含`listen_addresses`指令的行。该行可能被注释掉（以`#`字符开头）。将该行更改为以下内容：
- en: '[PRE3]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Tip
  id: totrans-91
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: The most effective way to edit files on your server is to use an editor such
    as Vim or Nano in a terminal session (for example, over SSH). But to make a small
    change in a configuration file, you do not need to leave Webmin. Take a look at
    the *Editing a file on the server* section of the *Managing files and directories
    on the server* recipe from [Chapter 6](ch06.html "Chapter 6. Managing Files on
    Your System"), *Managing Files on Your System*.
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在服务器上编辑文件的最有效方式是使用Vim或Nano等编辑器在终端会话中进行（例如，通过SSH）。但是，要对配置文件进行小的更改时，您无需离开Webmin。请查看[第6章](ch06.html
    "第6章 管理系统中的文件")《管理系统中的文件》配方中的*在服务器上编辑文件*部分。
- en: We must restart the server after making configuration changes. Navigate to **Servers**
    | **PostgreSQL Database Server**, click the **Stop PostgreSQL Server** button,
    and then click the **Start PostgreSQL Server** button.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在进行配置更改后，我们必须重启服务器。导航到**服务器** | **PostgreSQL数据库服务器**，点击**停止PostgreSQL服务器**按钮，然后点击**启动PostgreSQL服务器**按钮。
- en: Your PostgreSQL server will now listen for incoming network connections on port
    5432.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您的PostgreSQL服务器将监听端口5432上的传入网络连接。
- en: 'Perform the following steps to create a new user:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以创建新用户：
- en: Navigate to **Servers** | **PostgreSQL Database Server** | **PostgreSQL Users**.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器** | **PostgreSQL用户**。
- en: Click the **Create new user** link.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建新用户**链接。
- en: Set **Username** to `dbuser` and assign a strong password in the **Password**
    field.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**用户名**设置为`dbuser`，并在**密码**字段中设置一个强密码。
- en: Answer **No** to the **Can create databases?** and **Can create users?** questions.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对**可以创建数据库？**和**可以创建用户？**的问题选择**否**。
- en: Set **Valid until** to **Forever**:![How to do it...](img/5849OS_10_01a.jpg)
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**有效期至**设置为**永久**：![如何操作...](img/5849OS_10_01a.jpg)
- en: Click the **Create** button.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**按钮。
- en: 'Perform the following steps to create a database:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以创建数据库：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the **Create a new database** link.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建新数据库**链接。
- en: Set **Database name** to `testdb`.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**数据库名称**设置为`testdb`。
- en: Set **Owned by user** to `dbuser`.
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**所有者用户**设置为`dbuser`。
- en: Set **Template database** to `template1`:![How to do it...](img/5849OS_10_01b.jpg)
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**模板数据库**设置为`template1`：![如何操作...](img/5849OS_10_01b.jpg)
- en: Click the **Create** button.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**按钮。
- en: 'Perform the following steps to grant a user remote access to the database:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以授予用户远程访问数据库的权限：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the **Allowed Hosts** icon.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**允许的主机**图标。
- en: Click the **Create a new allowed host** link.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建新允许的主机**链接。
- en: Set **Host address** to **Single host** and enter the IP address of the client
    computer (for example, `10.10.10.100`).
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**主机地址**设置为**单一主机**，并输入客户端计算机的IP地址（例如，`10.10.10.100`）。
- en: Tip
  id: totrans-114
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If the client can connect from more then one IP, you can specify a subnet by
    providing a network and netmask or CIDR length. For instance, to grant access
    to all computers in the `10.10.10.*` subnet, you could specify the network as
    `10.10.10.0` and either the netmask as `255.255.255.0` or the CIDR length as `24`.
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果客户端可以从多个IP连接，您可以通过提供网络和子网掩码或CIDR长度来指定子网。例如，要允许`10.10.10.*`子网中的所有计算机访问，您可以指定网络为`10.10.10.0`，并选择子网掩码`255.255.255.0`或CIDR长度`24`。
- en: Set **SSL connection required?** to **Yes**.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**需要SSL连接？**设置为**是**。
- en: Tip
  id: totrans-117
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You can shave off a little performance overhead by not using SSL, but you should
    only do that on entirely trusted networks.
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 不使用SSL可以减少一些性能开销，但只有在完全信任的网络上才能这样做。
- en: Set **Database** to `testdb`.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**数据库**设置为`testdb`。
- en: Set **Users** to **Listed users** and enter `dbuser`.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**用户**设置为**列出用户**并输入`dbuser`。
- en: Set **Authentication mode** to **MD5 encrypted password**:![How to do it...](img/5849OS_10_02.jpg)
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**身份验证模式**设置为**MD5 加密密码**：![如何操作...](img/5849OS_10_02.jpg)
- en: Click the **Create** button.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**按钮。
- en: We'll need to restart the server one more time to load the new access configuration.
    Navigate to **Servers** | **PostgreSQL Database Server**, click the **Stop PostgreSQL
    Server** button, and then click the **Start PostgreSQL Server** button.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要重新启动服务器一次，以加载新的访问配置。导航到**服务器** | **PostgreSQL 数据库服务器**，点击**停止 PostgreSQL
    服务器**按钮，然后点击**启动 PostgreSQL 服务器**按钮。
- en: Tip
  id: totrans-124
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: 'On a busy production system it would be a bad idea to restart the database
    server unnecessarily, although that is the sure way of reloading all settings.
    After changing access settings, you don''t really need to restart the server.
    You could send it a `SIGHUP` signal instead. This signal instructs Postgres to
    reload its configuration. On systems equipped with the `pg_ctl` program, this
    can be achieved by issuing the following command:'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在繁忙的生产系统中，不必要地重启数据库服务器是一个不好的主意，尽管这是重新加载所有设置的可靠方法。在更改访问设置后，实际上不需要重启服务器。您可以改为发送一个`SIGHUP`信号。该信号指示
    Postgres 重新加载其配置。在配备有`pg_ctl`程序的系统上，可以通过发出以下命令来实现：
- en: '[PRE4]'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'On systems with the `pg_ctlcluster` command, you will need to specify the server
    version and cluster name, for example:'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在具有`pg_ctlcluster`命令的系统上，您需要指定服务器版本和集群名称，例如：
- en: '[PRE5]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'For testing the connection, try to connect to your database server from the
    client machine that uses the IP we specified. If your other machine has the PostgreSQL
    command-line client installed, you can test the connection by typing in this command
    at the terminal. However, substitute `postgresql-host` with the IP or domain name
    of your Postgres server as follows:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试连接，尝试从我们指定的 IP 的客户端机器连接到您的数据库服务器。如果您的另一台机器上安装了 PostgreSQL 命令行客户端，您可以在终端中输入以下命令来测试连接。但请将`postgresql-host`替换为您的
    Postgres 服务器的 IP 或域名，如下所示：
- en: '[PRE6]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: If the connection is successful, you should arrive at the PostgreSQL prompt
    (`testdb=#`). Type `\q` and press *Enter* to exit.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 如果连接成功，您应该会看到 PostgreSQL 提示符（`testdb=#`）。输入`\q`并按*Enter*退出。
- en: How it works...
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: In order to enable network access to the PostgreSQL database server, we needed
    to modify two configuration files. We edited the main configuration file (`postgresql.conf`)
    manually to instruct the server to listen for incoming network connections on
    all network interfaces. The second file, which was edited through Webmin's interface,
    is the host-based authentication configuration (`pg_hba.conf`). This file instructs
    the server which users should be allowed to connect from which network hosts and
    how they should be required to authenticate.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 为了启用对 PostgreSQL 数据库服务器的网络访问，我们需要修改两个配置文件。我们手动编辑了主配置文件（`postgresql.conf`），指示服务器监听所有网络接口上的传入网络连接。第二个文件通过
    Webmin 的界面进行了编辑，是基于主机的身份验证配置文件（`pg_hba.conf`）。该文件指示服务器允许哪些用户从哪些网络主机连接，并要求他们如何进行身份验证。
- en: 'Webmin added the following line to `pg_hba.conf`:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 将以下行添加到`pg_hba.conf`：
- en: '[PRE7]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The preceding line instructs the server to accept SSL connections to the `testdb`
    database by the `dbuser` user if the connection originated from the IP address
    `10.10.10.100`. The user should be asked to provide an MD5-encrypted password
    for authentication.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 前一行指示服务器接受来自 IP 地址`10.10.10.100`的`dbuser`用户对`testdb`数据库的 SSL 连接。要求用户提供一个 MD5
    加密的密码进行身份验证。
- en: 'Another line in `pg_hba.conf` can look like the following:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '`pg_hba.conf`中的另一行可能如下所示：'
- en: '[PRE8]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This line instructs the server to accept connections made locally over the Unix
    socket. These connections use the `peer` authentication method, which checks the
    username of the system account running the connecting client program. If the system
    username matches a Postgres account name, then the connection is considered authenticated.
    Password checking is not performed in `peer` authentication. The preceding line
    of code will allow the system account `postgres` to access `all` databases.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这一行指示服务器接受通过 Unix 套接字进行的本地连接。这些连接使用`peer`身份验证方法，它检查运行连接客户端程序的系统账户的用户名。如果系统用户名与
    Postgres 账户名匹配，则该连接被视为已通过身份验证。在`peer`身份验证中不会执行密码检查。前一行代码将允许系统账户`postgres`访问`所有`数据库。
- en: See also
  id: totrans-140
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: In order to make remote access and management of your PostgreSQL databases more
    secure, you can tunnel your connection over SSH. Take a look at the recipe, *Accessing
    the PostgreSQL server over an SSH tunnel*, for instructions.
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为了使 PostgreSQL 数据库的远程访问和管理更加安全，你可以通过 SSH 隧道化连接。有关说明，请查看配方 *通过 SSH 隧道访问 PostgreSQL
    服务器*。
- en: Accessing the PostgreSQL server over an SSH tunnel
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过 SSH 隧道访问 PostgreSQL 服务器
- en: If your server is hosting a website on the Internet and running a database system
    on the same machine, it is safer to disable remote network access to the database.
    On the other hand, you may still want to manage your databases remotely. You can
    do so by tunneling PostgreSQL traffic over an SSH connection.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的服务器正在互联网上托管一个网站，并且在同一台机器上运行数据库系统，那么禁用数据库的远程网络访问是更安全的。另一方面，你可能仍然希望远程管理你的数据库。你可以通过将
    PostgreSQL 流量通过 SSH 连接进行隧道化来实现这一点。
- en: Note
  id: totrans-144
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: One of the most important aspects of a database system is the speed with which
    it can find and return the data that you ask for. Tunneling traffic over SSH will
    add significant overhead to this communication. This solution is great for intermittent
    management tasks, but not suitable as a replacement for a direct connection to
    your database system.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库系统的一个重要方面是它能够多快地查找并返回你请求的数据。通过 SSH 隧道传输流量将为这种通信增加显著的开销。这个解决方案非常适合间歇性的管理任务，但不适合作为直接连接到数据库系统的替代方案。
- en: Getting ready
  id: totrans-146
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: 'Before you can access the PostgreSQL server through an SSH tunnel, you will
    need to make sure that an allowed hosts entry exists in the `pg_hba.conf` file.
    This entry should allow users from the loopback IP `127.0.0.1` to authenticate
    using MD5-encrypted passwords. Take a look at the recipe, *Allowing access to
    PostgreSQL over the network*, for more information. This is what the appropriate
    line in `pg_hba.conf` would look like:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在通过 SSH 隧道访问 PostgreSQL 服务器之前，你需要确保在 `pg_hba.conf` 文件中存在一个允许的主机条目。该条目应该允许来自回送
    IP `127.0.0.1` 的用户使用 MD5 加密的密码进行身份验证。有关更多信息，请查看配方 *允许通过网络访问 PostgreSQL*。在 `pg_hba.conf`
    文件中的适当条目如下所示：
- en: '[PRE9]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: The server you want to connect to must run both the PostgreSQL server and an
    SSH server. The remote client machine must have an SSH client and PostgreSQL client
    software installed. Make a note of the IP address or domain name of the server
    (`postgresql-host`), the SSH username (`ssh-user`), the PostgreSQL user (`postgresql-user`),
    and the database name (`database-name`). Substitute them in the following recipe.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 你想连接的服务器必须同时运行 PostgreSQL 服务器和 SSH 服务器。远程客户端机器必须安装 SSH 客户端和 PostgreSQL 客户端软件。请记录下服务器的
    IP 地址或域名（`postgresql-host`）、SSH 用户名（`ssh-user`）、PostgreSQL 用户（`postgresql-user`）和数据库名称（`database-name`）。在下面的步骤中用它们替换相应内容。
- en: How to do it...
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何执行此操作...
- en: 'In order to create an SSH tunnel for PostgreSQL, follow these steps:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 为了创建一个 PostgreSQL 的 SSH 隧道，请按照以下步骤操作：
- en: 'Issue the following command on your client machine:'
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在客户端机器上执行以下命令：
- en: '[PRE10]'
  id: totrans-153
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This creates a tunnel between port `15000` on your client machine and port `5432`
    of the server. You can now access the remote database by making a PostgreSQL connection
    to your client computer's local port `15000`.
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这将在客户端机器的 `15000` 端口与服务器的 `5432` 端口之间创建一个隧道。你现在可以通过连接到客户端计算机的本地 `15000` 端口来访问远程数据库。
- en: 'Issue the following command on the client system to test the connection:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在客户端系统上执行以下命令以测试连接：
- en: '[PRE11]'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: How it works...
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: The SSH client acts as an intermediary in the communication between the PostgreSQL
    client running on your machine and the remote server. It opens port `15000` on
    the client machine and listens for incoming connections. All packets arriving
    at port `15000` are encrypted and forwarded over SSH to the server. On the server
    side, SSH receives the packets, decrypts them, and sends them to port `5432`.
    Answers are sent back in the opposite direction over the same channel.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: SSH 客户端充当你机器上运行的 PostgreSQL 客户端和远程服务器之间通信的中介。它在客户端机器上打开 `15000` 端口，并监听传入连接。所有到达
    `15000` 端口的数据包都会被加密，并通过 SSH 转发到服务器。在服务器端，SSH 接收这些数据包，解密后将它们发送到 `5432` 端口。答案会沿相同的通道反向发送回来。
- en: See also
  id: totrans-159
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参阅
- en: There are many tools that allow you to connect to and control your PostgreSQL
    databases. Webmin provides a wide range of tools to perform most common tasks,
    and these are described in recipes in this chapter.
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有许多工具可以让你连接和控制 PostgreSQL 数据库。Webmin 提供了多种工具来执行大多数常见任务，相关配方在本章中有描述。
- en: An even more powerful web-based solution dedicated to PostgreSQL is phpPgAdmin.
    It is discussed in the recipe, *Installing phpPgAdmin*.
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个更强大的基于 Web 的 PostgreSQL 解决方案是 phpPgAdmin。它在食谱中有所讨论，*安装 phpPgAdmin*。
- en: More information about SSH tunnels is provided in the recipe, *Connecting to
    Webmin securely over an SSH tunnel*,in [Chapter 3](ch03.html "Chapter 3. Securing
    Your System"), *Securing Your System*.
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关于 SSH 隧道的更多信息，请参考食谱，*通过 SSH 隧道安全连接到 Webmin*，[第 3 章](ch03.html "第 3 章。保护您的系统")，*保护您的系统*。
- en: Creating a new database
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建新数据库
- en: Creating a new PostgreSQL database through Webmin's interface is very quick
    and simple.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Webmin 界面创建 PostgreSQL 数据库非常快捷简便。
- en: How to do it...
  id: totrans-165
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Follow these steps to create a database:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤创建数据库：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL 数据库服务器**。
- en: Click the **Create a new database** link.
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建新数据库**链接。
- en: Enter a **Database name**, for instance, `new_db`.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入**数据库名称**，例如`new_db`。
- en: Select the user who will have administrative rights to the database from the
    **Owned by user** dropdown.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**所有者**下拉菜单中选择将拥有数据库管理权限的用户。
- en: Leave **Character set encoding** and **Database file path** set to **Default**.
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**字符集编码**和**数据库文件路径**保持为**默认**。
- en: Set **Template database** to `template1`.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**模板数据库**设置为`template1`。
- en: Click the **Create** button.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**按钮。
- en: How it works...
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: 'Webmin takes the information you provide and creates a new database by connecting
    to the PostgreSQL server and executing the following command:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin会根据你提供的信息，通过连接 PostgreSQL 服务器并执行以下命令来创建一个新数据库：
- en: '[PRE12]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Postgres creates the new database by making a copy of a selected template. The
    database, `template1`, is installed by default to serve as a source of default
    settings for newly created databases. If you want new databases to have different
    settings, for instance, character set and collation, you can introduce these changes
    to your template database.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: Postgres通过复制所选模板来创建新数据库。数据库`template1`默认安装，用作新创建数据库的默认设置源。如果你希望新数据库具有不同的设置，例如字符集和排序规则，你可以对模板数据库进行这些更改。
- en: 'Another way to create a database is to execute the `createdb` command as the
    user, `postgres`, for instance:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 创建数据库的另一种方式是以用户`postgres`执行`createdb`命令，例如：
- en: '[PRE13]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: See also
  id: totrans-180
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: If you have an initial database structure or contents, you can upload them to
    the server using an SQL commands file. Take a look at the recipe, *Executing custom
    SQL commands*, for more information.
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你有初始数据库结构或内容，可以通过 SQL 命令文件将它们上传到服务器。有关更多信息，请查看食谱，*执行自定义 SQL 命令*。
- en: Creating users and granting permissions
  id: totrans-182
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建用户并授予权限
- en: Creating PostgreSQL users through Webmin is very simple. Users can be designated
    as owners of newly created databases and will have complete access and administrative
    rights to the databases they own. Users may also be granted limited privileges
    on specific database tables.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Webmin 创建 PostgreSQL 用户非常简单。用户可以被指定为新创建数据库的所有者，并拥有完全访问和管理权限。用户也可以被授予特定数据库表的有限权限。
- en: How to do it...
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: In this recipe, we will create a new user called `dbuser` and grant selected
    privileges on a table named `dbtable` in a database called `testdb`.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 在本食谱中，我们将创建一个名为`dbuser`的新用户，并在名为`testdb`的数据库中的表`dbtable`上授予选定的权限。
- en: 'Perform the following steps to create a user:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤创建用户：
- en: Navigate to **Servers** | **PostgreSQL Database Server** | **PostgreSQL Users**.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL 数据库服务器** | **PostgreSQL 用户**。
- en: Click the **Create new user** link.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建新用户**链接。
- en: Set **Username** to `dbuser` and set a strong password in the **Password** field.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**用户名**设置为`dbuser`，并在**密码**字段中设置强密码。
- en: Answer **No** to the **Can create databases?** and **Can create users?** questions.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对**可以创建数据库吗？**和**可以创建用户吗？**问题选择**否**。
- en: Set **Valid** **until** to **Forever**.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**有效期至**设置为**永久**。
- en: Click the **Create** button.
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**按钮。
- en: 'Perform the following steps to grant user privileges on a database table:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤在数据库表上授予用户权限：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL 数据库服务器**。
- en: Click the **Granted Privileges** icon.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**已授予权限**图标。
- en: Click the name of the database object for which you want to modify permissions
    (for instance, the table name, `dbtable`).
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击要修改权限的数据库对象名称（例如，表名`dbtable`）。
- en: Select the user, `dbuser`, from the **User** dropdown.
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从**用户**下拉菜单中选择用户`dbuser`。
- en: Mark the checkboxes next to the privileges you would like to grant:![How to
    do it...](img/5849OS_10_03.jpg)
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 勾选你希望授予的权限旁边的复选框：![如何操作...](img/5849OS_10_03.jpg)
- en: Click the **Save** button.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **保存** 按钮。
- en: How it works...
  id: totrans-200
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: 'Webmin creates a new database user by connecting to the PostgreSQL server and
    executing the following command:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 通过连接到 PostgreSQL 服务器并执行以下命令来创建一个新的数据库用户：
- en: '[PRE14]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Another way to create a database user is to execute the `createuser` command
    as the user `postgres`, for instance:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 创建数据库用户的另一种方法是以 `postgres` 用户身份执行 `createuser` 命令，例如：
- en: '[PRE15]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'Privileges are assigned to users through the `GRANT` command, for instance:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 权限通过 `GRANT` 命令分配给用户，例如：
- en: '[PRE16]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The PostgreSQL manual provides the following definitions of privileges:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 手册提供了以下权限定义：
- en: '| Privilege | Definition |'
  id: totrans-208
  prefs: []
  type: TYPE_TB
  zh: '| 权限 | 定义 |'
- en: '| --- | --- |'
  id: totrans-209
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `SELECT` | This allows `SELECT` from any column of the specified table. |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '| `SELECT` | 允许从指定表的任何列执行 `SELECT` 操作。 |'
- en: '| `UPDATE` | This allows `UPDATE` of any column of the specified table. |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| `UPDATE` | 允许对指定表的任何列执行 `UPDATE` 操作。 |'
- en: '| `INSERT` | This allows `INSERT` of a new row into the specified table. |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| `INSERT` | 允许在指定表中插入新行。 |'
- en: '| `DELETE` | This allows `DELETE` of a row from the specified table. |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '| `DELETE` | 允许从指定表中删除一行。 |'
- en: '| `RULE` | This allows the creation of a rule on the table. |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '| `RULE` | 允许在表上创建规则。 |'
- en: '| `REFERENCES` | To create a foreign key constraint, it is necessary to have
    this privilege on both the referencing and referenced tables. |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '| `REFERENCES` | 要创建外键约束，必须在引用表和被引用表上都拥有此权限。 |'
- en: '| `TRIGGER` | This allows the creation of a trigger on the specified table.
    |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| `TRIGGER` | 允许在指定表上创建触发器。 |'
- en: There's more...
  id: totrans-217
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: 'PostgreSQL does not make it easy to grant privileges to an entire database.
    In order to grant the user named `dbuser` access to all the tables defined in
    the `public` schema, execute the following command:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 并不容易授予整个数据库的权限。为了授予名为 `dbuser` 的用户访问 `public` schema 中所有表的权限，可以执行以下命令：
- en: '[PRE17]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Note
  id: totrans-220
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Postgres databases may be subdivided into **schemas**. Each schema contains
    its own set of tables independent of other schemas and may use different user
    privileges. By default, each database contains only one schema called `public`,
    and all tables are assigned to it.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: PostgreSQL 数据库可能会被划分为 **schemas**。每个 schema 包含一组独立于其他 schema 的表，并且可能使用不同的用户权限。默认情况下，每个数据库仅包含一个名为
    `public` 的 schema，所有表都分配给它。
- en: 'Inserting new objects also requires access to sequence objects, which may be
    granted as follows:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 插入新对象也需要对序列对象的访问权限，可以按如下方式授予：
- en: '[PRE18]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Unfortunately, when you add new tables to the database or add another schema,
    you will have to execute the commands again. Another option is to set default
    permissions for the objects by using the `ALTER DEFAULT PRIVILEGES` command:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，当你向数据库添加新表或添加另一个 schema 时，你将不得不重新执行这些命令。另一种选择是通过使用 `ALTER DEFAULT PRIVILEGES`
    命令设置对象的默认权限：
- en: '[PRE19]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: See also
  id: totrans-226
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: Refer to the recipe, *Executing custom SQL commands*, for information about
    executing commands.
  id: totrans-227
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 请参阅配方，*执行自定义 SQL 命令*，了解执行命令的相关信息。
- en: 'You can find more information about granting privileges in the PostgreSQL manual:'
  id: totrans-228
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以在 PostgreSQL 手册中找到更多关于授予权限的信息：
- en: '[http://www.postgresql.org/docs/9.3/static/sql-grant.html](http://www.postgresql.org/docs/9.3/static/sql-grant.html)'
  id: totrans-229
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://www.postgresql.org/docs/9.3/static/sql-grant.html](http://www.postgresql.org/docs/9.3/static/sql-grant.html)'
- en: '[http://www.postgresql.org/docs/9.3/static/sql-alterdefaultprivileges.html](http://www.postgresql.org/docs/9.3/static/sql-alterdefaultprivileges.html)'
  id: totrans-230
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[http://www.postgresql.org/docs/9.3/static/sql-alterdefaultprivileges.html](http://www.postgresql.org/docs/9.3/static/sql-alterdefaultprivileges.html)'
- en: Creating a backup of your database
  id: totrans-231
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建数据库备份
- en: Webmin can help you make backups of your PostgreSQL databases. With just a few
    clicks, you can make a backup of any database. Webmin can also help you set cron
    jobs to create backups automatically on a regular schedule.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 可以帮助你备份 PostgreSQL 数据库。只需几次点击，你就可以备份任何数据库。Webmin 还可以帮助你设置 cron 作业，定期自动创建备份。
- en: Getting ready
  id: totrans-233
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: Before starting, create a directory to store local backup files. You can keep
    these files in `/backups` in the root directory, `/root/backups`, or in any location
    you find convenient.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始之前，创建一个目录来存储本地备份文件。你可以将这些文件保存在根目录的 `/backups`、`/root/backups` 或你觉得方便的任何位置。
- en: The backup directory should be owned by and be accessible only to the `postgres`
    user. Take a look at the recipe, *Changing file ownership and permissions,* in
    [Chapter 6](ch06.html "Chapter 6. Managing Files on Your System"), *Managing Files
    on Your System*, for more information.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 备份目录应由`postgres`用户拥有，并且仅限该用户访问。有关更多信息，请查看[第6章](ch06.html "第6章 管理系统文件")，*管理文件*，其中包含“更改文件所有权和权限”的相关内容。
- en: To get general background information about backups, refer to [Chapter 7](ch07.html
    "Chapter 7. Backing Up Your System"), *Backing Up Your System* .
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取有关备份的一般背景信息，请参考[第7章](ch07.html "第7章 备份系统")，*备份系统*。
- en: How to do it...
  id: totrans-237
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Follow these steps to create a backup of a database:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤创建数据库备份：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon that represents the database you would like to back up.
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击表示您想要备份的数据库的图标。
- en: Click the **Backup** button.
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**备份**按钮。
- en: Set **Backup file path** to `/backups/database-name.sql`.
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份文件路径**设置为`/backups/database-name.sql`。
- en: Set **Backup file format** to **Plain SQL Text**.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份文件格式**设置为**纯SQL文本**。
- en: Note
  id: totrans-244
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The backup will be stored as a series of SQL statements in plain text. If you
    are exporting a large database, use the compressed **Custom archive** format.
  id: totrans-245
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 备份将作为一系列SQL语句以纯文本格式存储。如果您正在导出一个大型数据库，请使用压缩的**自定义归档**格式。
- en: Set **Tables to backup** to **All tables**.
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**要备份的表**设置为**所有表**。
- en: Click the **Backup Now** button.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即备份**按钮。
- en: How it works...
  id: totrans-248
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Webmin executes the `pg_dump` command to output a series of SQL commands that
    would be needed to recreate the entire database. The command is run as a user
    who has administrative access to the database. On most systems, the user is called
    `postgres`.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin执行`pg_dump`命令，输出一系列SQL命令，这些命令用于重新创建整个数据库。该命令以具有数据库管理员访问权限的用户身份运行。在大多数系统中，该用户被称为`postgres`。
- en: 'The database dump is saved to the specified output file. If you wanted to do
    the same kind of backup in the terminal, you could run a command similar to the
    following:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 数据库转储将保存到指定的输出文件中。如果您想在终端中执行相同的备份操作，您可以运行如下命令：
- en: '[PRE20]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: There's more...
  id: totrans-252
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Webmin is quite a capable tool to create backups. Here are a few other easily
    accessible functions.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin是一个非常强大的备份工具。以下是一些其他容易访问的功能。
- en: Backing up all databases automatically
  id: totrans-254
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 自动备份所有数据库
- en: Webmin can help you make an automated backup of some or all databases hosted
    by your server. These backups will be executed on a regular schedule by cron.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin可以帮助您自动备份服务器托管的部分或所有数据库。这些备份将由cron按常规计划执行。
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the **Backup Databases** button.
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**备份数据库**按钮。
- en: Set **Backup to directory** to the location of your backup directory, for instance,
    `/backups`.
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份到目录**设置为您的备份目录的位置，例如`/backups`。
- en: Set **Backup file format** to **Custom archive**.
  id: totrans-259
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**备份文件格式**设置为**自定义归档**。
- en: Note
  id: totrans-260
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The custom archive format is compressed to save the disk space. It's also very
    flexible and allows manual selection of archived items during the restore phase.
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 自定义归档格式经过压缩以节省磁盘空间。它也非常灵活，允许在恢复阶段手动选择归档项目。
- en: Open the **Backup schedule** section.
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开**备份计划**部分。
- en: Set **Scheduled backup enabled?** to **Yes, at times chosen below**; set **Simple
    schedule** and select **Daily (at midnight)**.
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**启用定期备份？**设置为**是，在下面选择的时间**；设置**简单计划**并选择**每天（午夜时分）**。
- en: Note
  id: totrans-264
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Note that many things may be scheduled to start at midnight on your system,
    so you can choose another time if your system resources are limited. Choose a
    more complex schedule by marking the minutes, hours, and days of the month at
    which the job is to be performed.
  id: totrans-265
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请注意，系统中可能有许多任务被安排在午夜启动，因此如果系统资源有限，您可以选择其他时间。通过标记任务要执行的分钟、小时和日期，选择更复杂的计划。
- en: Click the **Save** button.
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: Exporting a database table to CSV
  id: totrans-267
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将数据库表导出为CSV
- en: 'Webmin can export a single table of your database into a CSV file that can
    be opened by spreadsheet programs such as Excel, Calc, or Gnumeric:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin可以将您数据库的单个表导出为CSV文件，该文件可以被Excel、Calc或Gnumeric等电子表格程序打开：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon of the database, and then click the icon of the table you would
    like to export.
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击数据库的图标，然后点击您想要导出的表的图标。
- en: Click the **Export as CSV** button.
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**导出为CSV**按钮。
- en: Set **File format** to **CSV with quotes**.
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**文件格式**设置为**带引号的 CSV**。
- en: Set **Include column names in CSV?** to **Yes**.
  id: totrans-273
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**在 CSV 中包含列名？**设置为**是**。
- en: Set **Export destination** to **Display in browser**.
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将**导出目标**设置为**在浏览器中显示**。
- en: Click the **Export Now** button.
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即导出**按钮。
- en: See also
  id: totrans-276
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: You can easily perform backups to a remote host using a network file sharing
    protocol such as NFS or CIFS. You start by creating a network volume on the remote
    server and then mount the volume on your server. You can then back up to directories
    on the remote system just as easily as if they were stored locally. Take a look
    at [Chapter 6](ch06.html "Chapter 6. Managing Files on Your System"), *Managing
    Files on Your System*, for instructions to set up network file sharing using NFS
    or CIFS.
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以使用网络文件共享协议（如 NFS 或 CIFS）轻松地将备份存储到远程主机。首先，你需要在远程服务器上创建一个网络卷，然后将该卷挂载到你的服务器上。然后，你可以像操作本地目录一样，轻松地将数据备份到远程系统的目录中。有关如何使用
    NFS 或 CIFS 设置网络文件共享的说明，请查看[第 6 章](ch06.html "第 6 章。管理系统中的文件")，*管理系统中的文件*。
- en: Another way to store spare copies of your databases remotely is to send your
    backup directory to a remote server using the SSH protocol. Take a look at recipe,
    *Backing up to a remote host*, in [Chapter 7](ch07.html "Chapter 7. Backing Up
    Your System"), *Backing Up Your System*, for more information.
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 另一个将数据库备份副本远程存储的方法是通过 SSH 协议将备份目录发送到远程服务器。有关更多信息，请查看[第 7 章](ch07.html "第 7 章。备份您的系统")，*备份到远程主机*部分。
- en: Executing custom SQL commands
  id: totrans-279
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行自定义 SQL 命令
- en: Webmin provides a simple interface to your Postgres database server, which allows
    you to execute arbitrary SQL commands. This can be a useful feature when you want
    to quickly find something in a database or perform a bulk update of multiple rows
    of data.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 提供了一个简单的界面与您的 Postgres 数据库服务器交互，允许你执行任意 SQL 命令。当你想快速查找数据库中的某些内容或对多行数据执行批量更新时，这是一个非常有用的功能。
- en: How to do it...
  id: totrans-281
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to execute custom SQL commands:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以执行自定义 SQL 命令：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-283
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL 数据库服务器**。
- en: Click the icon that represents the database you would like to use.
  id: totrans-284
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表你希望使用的数据库的图标。
- en: Click the **Execute SQL** button.
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**执行 SQL**按钮。
- en: 'Enter SQL commands in the text area, for instance:'
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在文本框中输入 SQL 命令，例如：
- en: '[PRE21]'
  id: totrans-287
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '![How to do it...](img/5849OS_10_04.jpg)'
  id: totrans-288
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5849OS_10_04.jpg)'
- en: Click the **Execute** button.
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**执行**按钮。
- en: You will be presented with a sortable display of data returned by the `SELECT`
    command. The presented data will come from a temporary `films` table created by
    the first command. Temporary tables are not stored when the client who created
    them disconnects, so you will not see this table in your database later.
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 你将看到由`SELECT`命令返回的数据的可排序显示。展示的数据来自第一个命令创建的临时`films`表。临时表在创建它们的客户端断开连接时不会被存储，因此你以后在数据库中看不到这个表。
- en: How it works...
  id: totrans-291
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Webmin simply passes the SQL commands to the database server. If the command
    returns an error, it will be displayed on screen. If the command returns rows
    of data, Webmin will convert them into an HTML page and display them on screen.
    Please note that Webmin is running as the administrative user (`postgres`), so
    caution should be used when executing commands.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 仅将 SQL 命令传递给数据库服务器。如果命令返回错误，将在屏幕上显示。如果命令返回数据行，Webmin 会将其转换为 HTML 页面并在屏幕上显示。请注意，Webmin
    是以管理员用户（`postgres`）身份运行的，因此在执行命令时要小心。
- en: There's more...
  id: totrans-293
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多...
- en: Webmin also allows you to execute the SQL scripts saved in files. These can
    be used to restore databases from plain SQL text backups.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 还允许你执行保存在文件中的 SQL 脚本。这些脚本可以用于从纯 SQL 文本备份恢复数据库。
- en: Executing a SQL script from a file
  id: totrans-295
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从文件执行 SQL 脚本
- en: 'Perform the following steps to execute a SQL script from a file:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤从文件执行 SQL 脚本：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL 数据库服务器**。
- en: Click the icon that represents the database you would like to use.
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表你希望使用的数据库的图标。
- en: Click the **Execute SQL** button.
  id: totrans-299
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**执行 SQL**按钮。
- en: Select the **Run SQL from file** tab.
  id: totrans-300
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**从文件运行 SQL**选项卡。
- en: If you uploaded the file onto the server, select **From local file** and enter
    the file's location in the text box. Otherwise, select **From uploaded file**
    and choose a file from your disk.
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你已将文件上传到服务器，选择**从本地文件**并在文本框中输入文件的位置。否则，选择**从上传的文件**并从你的磁盘中选择一个文件。
- en: Click the **Execute** button.
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**执行**按钮。
- en: See also
  id: totrans-303
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: You can save the commands that you execute often in an easy-to-use control panel
    in Webmin. Take a look at the recipe, *Creating a panel with the database commands
    that you execute often*, in [Chapter 4](ch04.html "Chapter 4. Controlling Your
    System"), *Controlling Your System*, for more information.
  id: totrans-304
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你可以将经常执行的命令保存在 Webmin 中的一个易于使用的控制面板里。有关更多信息，请查看 [第4章](ch04.html "Chapter 4.
    Controlling Your System") *控制你的系统* 中的食谱，*创建一个面板来执行你经常执行的数据库命令*。
- en: If you find that you need a more full-fledged, web-based PostgreSQL management
    tool, consider installing phpPgAdmin. This is described in the *Install phpPgAdmin*
    recipe.
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你发现需要一个更全面的 Web 基于 PostgreSQL 的管理工具，可以考虑安装 phpPgAdmin。该过程在 *安装 phpPgAdmin*
    食谱中有详细描述。
- en: Restoring a database from backup
  id: totrans-306
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从备份恢复数据库
- en: Backups of Postgres databases are created using the `pg_dump` command that can
    output a variety of formats. By default, backups are created as plain text SQL
    scripts, but a compressed custom PostgreSQL format is more efficient. Webmin helps
    you to create backups in both of these formats as well as in the `TAR` format.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: Postgres 数据库的备份是通过 `pg_dump` 命令创建的，该命令可以输出多种格式。默认情况下，备份会作为普通的 SQL 脚本文件创建，但压缩的自定义
    PostgreSQL 格式更加高效。Webmin 帮助你以这两种格式以及 `TAR` 格式创建备份。
- en: The method of restoring your database will depend on the file format chosen
    during backup. If you chose the plain SQL text format, then simply running your
    backup script will restore the database. Take a look at the recipe, *Execute custom
    SQL commands,* for more information.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 恢复数据库的方法将取决于备份时选择的文件格式。如果你选择了普通的 SQL 文本格式，只需运行备份脚本即可恢复数据库。有关更多信息，请查看食谱，*执行自定义
    SQL 命令*。
- en: If you chose the custom archive or `TAR` file format, you should use the procedure
    described in this recipe.
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你选择了自定义存档或 `TAR` 文件格式，你应该使用本食谱中描述的过程。
- en: How to do it...
  id: totrans-310
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作……
- en: 'Follow these steps to restore a database from backup:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤从备份恢复数据库：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 **服务器** | **PostgreSQL 数据库服务器**。
- en: Click the icon that represents the database you would like to restore.
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表你希望恢复的数据库图标。
- en: Click the **Restore** button.
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **恢复** 按钮。
- en: Choose **Restore from Uploaded file**, click **Browse**, and choose the file
    from your computer.
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 **从上传的文件恢复**，点击 **浏览**，然后从你的计算机中选择文件。
- en: Tip
  id: totrans-316
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If the backup file is larger then a few MB, it will be safer to upload the file
    to the server first, before running the restore. Take a look at the recipe, *Uploading
    files to the server*, in [Chapter 6](ch06.html "Chapter 6. Managing Files on Your
    System"), *Managing Files on Your System*, for more information.
  id: totrans-317
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果备份文件大于几 MB，最好先将文件上传到服务器，然后再执行恢复操作。有关更多信息，请查看 [第6章](ch06.html "Chapter 6. Managing
    Files on Your System") *管理你的系统上的文件* 中的食谱，*上传文件到服务器*。
- en: Set **Only restore data, not tables?** to **No**.
  id: totrans-318
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **只恢复数据，不恢复表？** 设置为 **否**。
- en: Set **Delete tables before restoring?** to **Yes**.
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **恢复前删除表？** 设置为 **是**。
- en: Set **Tables to restore** to **All in backup file**.
  id: totrans-320
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **恢复的表** 设置为 **备份文件中的所有表**。
- en: Click the **Restore** button.
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **恢复** 按钮。
- en: How it works...
  id: totrans-322
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的……
- en: 'Webmin uploads your file onto your server and then executes the `pg_restore`
    command to load contents of the backup into a database. If you wanted to restore
    a backup in the terminal, you could run a command similar to the following:'
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 将你的文件上传到服务器，然后执行 `pg_restore` 命令，将备份的内容加载到数据库中。如果你希望在终端中恢复备份，可以运行类似以下的命令：
- en: '[PRE22]'
  id: totrans-324
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Command-line options are as specified:'
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 命令行选项如下所示：
- en: '`-c`: This option drops database objects before recreating them'
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-c`：此选项会在重新创建数据库对象之前删除它们。'
- en: '`-d`: This option specifies the database you want to restore'
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-d`：此选项指定你希望恢复的数据库。'
- en: There's more...
  id: totrans-328
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 还有更多……
- en: Webmin can import data into a table of your database from a CSV file that can
    be created by spreadsheet programs such as Excel, Calc, or Gnumeric.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 可以从 CSV 文件中将数据导入到数据库表中，CSV 文件可以通过 Excel、Calc 或 Gnumeric 等电子表格程序创建。
- en: 'Follow these steps to restore a database table from a properly formatted CSV
    file:'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤从格式正确的 CSV 文件中恢复数据库表：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 **服务器** | **PostgreSQL 数据库服务器**。
- en: Click the icon that represents the database to which you would like to import
    data.
  id: totrans-332
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表你希望导入数据的数据库图标。
- en: Click the **Execute SQL** button.
  id: totrans-333
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **执行 SQL** 按钮。
- en: Select the **Import text file** tab.
  id: totrans-334
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 **导入文本文件** 标签。
- en: If you uploaded the file onto the server, select **From local file** and enter
    the file's location in the text box. Otherwise, select **From uploaded file**
    and choose a file from your disk.
  id: totrans-335
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你将文件上传到服务器，请选择 **从本地文件** 并在文本框中输入文件的位置。否则，选择 **从上传文件** 并从磁盘中选择一个文件。
- en: Select a table from the **Table to import data into** dropdown.
  id: totrans-336
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 **导入数据的表** 下拉菜单中选择一个表。
- en: Set **Delete data in table first** to **No**.
  id: totrans-337
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **首先删除表中的数据** 设置为 **否**。
- en: Set **Ignore duplicate rows** to **Yes**.
  id: totrans-338
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **忽略重复行** 设置为 **是**。
- en: Set **File format** to **CVS with quotes**.
  id: totrans-339
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **文件格式** 设置为 **带引号的 CVS**。
- en: Tip
  id: totrans-340
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You will have to select the same format when exporting data from your spreadsheet
    program. Experiment with the other formats if you run into problems.
  id: totrans-341
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当从你的电子表格程序导出数据时，你必须选择相同的格式。如果遇到问题，尝试其他格式。
- en: Click the **Execute** button.
  id: totrans-342
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **执行** 按钮。
- en: You will be presented with an information screen that describes how many rows
    were successfully imported or what errors were encountered.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 你将看到一个信息屏幕，描述成功导入了多少行或遇到了哪些错误。
- en: Editing the structure of your database
  id: totrans-344
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 编辑数据库结构
- en: 'Webmin allows you to quickly modify the structure of tables in your PostgreSQL
    database through an easy-to-use interface. In this recipe, we will demonstrate
    how to perform the following list of tasks:'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 允许你通过一个易于使用的界面快速修改 PostgreSQL 数据库中表的结构。在本节中，我们将演示如何执行以下任务：
- en: Create a table in a database
  id: totrans-346
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在数据库中创建一个表
- en: Add a field to a database table
  id: totrans-347
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向数据库表中添加一个字段
- en: Create an index
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个索引
- en: Delete an index
  id: totrans-349
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除一个索引
- en: Delete a field
  id: totrans-350
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除一个字段
- en: Delete a table from the database
  id: totrans-351
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除数据库中的表
- en: Getting ready
  id: totrans-352
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备工作
- en: For demonstration purposes, we will be using a database called `testdb`. You
    can create a database with this name through Webmin by following steps described
    in the recipe, *Creating a new database*.
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 为了演示目的，我们将使用名为 `testdb` 的数据库。你可以通过 Webmin 按照本节中的步骤创建一个同名的数据库，*创建一个新数据库*。
- en: How to do it...
  id: totrans-354
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: In the `testdb` database, we'll create a table called `people` and add a field
    called `name` to the table. We'll then change the name of the field, add a unique
    index, and finally delete the index, field, and table from the database.
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `testdb` 数据库中，我们将创建一个名为 `people` 的表，并向该表添加一个名为 `name` 的字段。然后，我们将更改字段的名称，添加一个唯一索引，最后从数据库中删除该索引、字段和表。
- en: 'Perform the following steps to create a table in a database:'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以在数据库中创建一个表：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-357
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 **服务器** | **PostgreSQL 数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-358
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表 `testdb` 数据库的图标。
- en: Click the **Create Table** button.
  id: totrans-359
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **创建表** 按钮。
- en: Specify `people` as the **Table name**.
  id: totrans-360
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定 `people` 为 **表名**。
- en: 'Provide the definition of the field that will be the primary key for this table.
    Fill in the following field definition:'
  id: totrans-361
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供将作为该表主键的字段定义。填写以下字段定义：
- en: Type `id` in **Field name**.
  id: totrans-362
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 **字段名称** 中输入 `id`。
- en: Type `serial` in **Data type**.
  id: totrans-363
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 **数据类型** 中输入 `serial`。
- en: Check the boxes **Primary key** and **Unique**.
  id: totrans-364
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 勾选 **主键** 和 **唯一** 复选框。
- en: 'Uncheck the boxes **Array** and **Allow nulls**:'
  id: totrans-365
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 取消勾选 **数组** 和 **允许空值** 复选框：
- en: '![How to do it...](img/5849OS_10_05.jpg)'
  id: totrans-366
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![如何操作...](img/5849OS_10_05.jpg)'
- en: Click the **Create** button.
  id: totrans-367
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **创建** 按钮。
- en: 'Perform the following steps to add a field to a database table:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以向数据库表中添加一个字段：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-369
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 **服务器** | **PostgreSQL 数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-370
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表 `testdb` 数据库的图标。
- en: Click the icon representing the `people` table.
  id: totrans-371
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表 `people` 表的图标。
- en: Select **varchar** from the types dropdown and click the **Add field of type**
    button.
  id: totrans-372
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从类型下拉菜单中选择 **varchar** 并点击 **添加字段类型** 按钮。
- en: 'Fill in the following field definition:'
  id: totrans-373
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写以下字段定义：
- en: '**Field name**: `name`'
  id: totrans-374
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**字段名称**：`name`'
- en: '**Type width**: `80`'
  id: totrans-375
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**类型宽度**：`80`'
- en: '**Array field**: `No`'
  id: totrans-376
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数组字段**：`否`'
- en: Click the **Create** button.
  id: totrans-377
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **创建** 按钮。
- en: 'Perform the following steps to create an index:'
  id: totrans-378
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以创建一个索引：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-379
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 **服务器** | **PostgreSQL 数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-380
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表 `testdb` 数据库的图标。
- en: Click the icon that represents the `people` table.
  id: totrans-381
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表 `people` 表的图标。
- en: Click the **Create Index** button.
  id: totrans-382
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **创建索引** 按钮。
- en: Set **Index name** to `unique_name`.
  id: totrans-383
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **索引名称** 设置为 `unique_name`。
- en: Select the field `name`, in the **Fields in index** list.
  id: totrans-384
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **索引中的字段** 列表中选择字段 `name`。
- en: Set **Index type** to **Unique**.
  id: totrans-385
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将 **索引类型** 设置为 **唯一**。
- en: Click the **Create** button.
  id: totrans-386
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**按钮。
- en: 'Perform the following steps to delete an index:'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以删除一个索引：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-388
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-389
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`testdb`数据库的图标。
- en: Click the icon that represents the `unique_name` index.
  id: totrans-390
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`unique_name`索引的图标。
- en: Click the **Delete** button.
  id: totrans-391
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**删除**按钮。
- en: 'Perform the following steps to delete a field:'
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以删除一个字段：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-393
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-394
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`testdb`数据库的图标。
- en: Click the icon that represents the `people` table.
  id: totrans-395
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`people`表的图标。
- en: Mark the checkbox next to the `name` field.
  id: totrans-396
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在`name`字段旁边勾选复选框。
- en: Click the **Delete Selected Fields** button.
  id: totrans-397
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**删除选定字段**按钮。
- en: 'Perform the following steps to delete a table from the database:'
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以从数据库中删除一个表：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-399
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-400
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`testdb`数据库的图标。
- en: Click the icon that represents the `people` table.
  id: totrans-401
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`people`表的图标。
- en: Click the **Drop Table** button and confirm on the screen that follows.
  id: totrans-402
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**删除表**按钮，并在随后的屏幕中确认。
- en: How it works...
  id: totrans-403
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Webmin prepares syntax for the appropriate `CREATE`, `DROP`, and `ALTER TABLE`
    SQL commands to perform all of the preceding actions and executes those commands
    on your PostgreSQL server as the `postgres` user.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin为适当的`CREATE`、`DROP`和`ALTER TABLE` SQL命令准备语法，并作为`postgres`用户在你的PostgreSQL服务器上执行这些命令。
- en: See also
  id: totrans-405
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另见
- en: If you find that you need a more full-fledged, web-based PostgreSQL management
    tool, consider installing phpPgAdmin. This is described in the *Installing phpPgAdmin*
    recipe
  id: totrans-406
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果你发现需要一个更完整的基于网页的PostgreSQL管理工具，可以考虑安装phpPgAdmin。安装过程在《安装phpPgAdmin》一节中有描述。
- en: Editing records in a database
  id: totrans-407
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 编辑数据库中的记录
- en: Webmin allows you to quickly edit data in your PostgreSQL database through a
    simple interface. In this recipe, we will demonstrate how to add, edit, and delete
    records in a database table.
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin允许你通过简单的界面快速编辑PostgreSQL数据库中的数据。在本食谱中，我们将演示如何在数据库表中添加、编辑和删除记录。
- en: Getting ready
  id: totrans-409
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备中
- en: In this recipe, we will use examples based on the `testdb` database and `people`
    table created in the recipe, *Editing the structure of your database*.
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: 在本食谱中，我们将使用基于`testdb`数据库和在食谱《编辑数据库结构》中创建的`people`表的示例。
- en: How to do it...
  id: totrans-411
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: We'll add a record to the `people` table of the `testdb` database; we'll edit
    the same record, and finally delete it to show how to perform these actions in
    Webmin.
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将向`testdb`数据库的`people`表中添加一条记录；我们将编辑相同的记录，最后删除它，展示如何在Webmin中执行这些操作。
- en: 'Perform the following steps to add a row to a database table:'
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以向数据库表中添加一行：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-414
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-415
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`testdb`数据库的图标。
- en: Click the icon that represents the `people` table.
  id: totrans-416
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`people`表的图标。
- en: Click the **View Data** button.
  id: totrans-417
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**查看数据**按钮。
- en: Click the **Add row** button.
  id: totrans-418
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加行**按钮。
- en: Fill in a numeric `id` and type in a `name` in the text box.
  id: totrans-419
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写数字`id`并在文本框中输入`name`。
- en: Click the **Save** button.
  id: totrans-420
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: 'Perform the following steps to edit a row:'
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以编辑一行：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-422
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-423
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`testdb`数据库的图标。
- en: Click the icon that represents the `people` table.
  id: totrans-424
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`people`表的图标。
- en: Click the **View Data** button.
  id: totrans-425
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**查看数据**按钮。
- en: Mark the checkbox next to the record you would like to edit.
  id: totrans-426
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你想要编辑的记录旁边勾选复选框。
- en: Click the **Edit selected rows** button.
  id: totrans-427
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**编辑选定行**按钮。
- en: Change the `name` value in the text box.
  id: totrans-428
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更改文本框中的`name`值。
- en: Click the **Save** button.
  id: totrans-429
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**保存**按钮。
- en: 'Perform the following steps to delete a row:'
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以删除一行：
- en: Navigate to **Servers** | **PostgreSQL Database Server**.
  id: totrans-431
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**服务器** | **PostgreSQL数据库服务器**。
- en: Click the icon that represents the `testdb` database.
  id: totrans-432
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`testdb`数据库的图标。
- en: Click the icon that represents the `people` table.
  id: totrans-433
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击代表`people`表的图标。
- en: Click the **View Data** button.
  id: totrans-434
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**查看数据**按钮。
- en: Mark the checkbox next to the record you would like to edit.
  id: totrans-435
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你想要编辑的记录旁边勾选复选框。
- en: Click the **Delete selected rows** button.
  id: totrans-436
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**删除选定行**按钮。
- en: How it works...
  id: totrans-437
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 它是如何工作的...
- en: Webmin prepares syntax for the appropriate `INSERT`, `UPDATE`, and `DELETE`
    SQL commands to perform the preceding actions and executes those commands on your
    PostgreSQL server as the `postgres` user.
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: Webmin 准备了适当的语法，用于执行 `INSERT`、`UPDATE` 和 `DELETE` SQL 命令，并作为 `postgres` 用户在
    PostgreSQL 服务器上执行这些命令。
- en: See also
  id: totrans-439
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 另请参见
- en: If you find that you need a more full-fledged, web-based PostgreSQL management
    tool, consider installing phpPgAdmin. This is described in the *Installing phpPgAdmin*
    recipe.
  id: totrans-440
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果您发现需要一个功能更全的、基于 Web 的 PostgreSQL 管理工具，请考虑安装 phpPgAdmin。有关详细信息，请参见《安装 phpPgAdmin》食谱。
- en: Installing phpPgAdmin
  id: totrans-441
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装 phpPgAdmin
- en: phpPgAdmin is a database administration tool for PostgreSQL. It is a web-based
    application, like Webmin itself, but dedicated to all tasks related to the administration
    of a PostgreSQL server. It's easy to use and can be a helpful tool for your database
    users and administrators.
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: phpPgAdmin 是一个用于 PostgreSQL 的数据库管理工具。它是一个基于 Web 的应用程序，类似于 Webmin，但专门用于 PostgreSQL
    服务器的管理任务。它易于使用，可以成为数据库用户和管理员的有力工具。
- en: Note
  id: totrans-443
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: System packages are configured to run phpPgAdmin on Apache. The Apache web server
    and PHP are installed as package dependencies. If you're not already using Apache
    and PHP, this exposes a potential attack vector on your database server. Consider
    the security implications of installing phpPgAdmin and keeping it up to date.
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: 系统软件包已配置为在 Apache 上运行 phpPgAdmin。Apache Web 服务器和 PHP 被安装为包依赖项。如果您尚未使用 Apache
    和 PHP，这可能会暴露数据库服务器的潜在攻击面。在安装 phpPgAdmin 并保持其更新时，请考虑安全性问题。
- en: How to do it...
  id: totrans-445
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何操作...
- en: 'Perform the following steps to install phpPgAdmin:'
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤来安装 phpPgAdmin：
- en: Install the package named `phpPgAdmin` (or `phppgadmin` depending on your system).
    Refer to the recipe, *Installing software packages*,in [Chapter 1](ch01.html "Chapter 1. Setting
    Up Your System"), *Setting Up Your System* for more information.
  id: totrans-447
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装名为 `phpPgAdmin`（或 `phppgadmin`，具体取决于您的系统）的软件包。有关更多信息，请参见食谱《安装软件包》中的[第 1 章](ch01.html
    "第 1 章：设置系统")，*设置系统*。
- en: Tip
  id: totrans-448
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: On some systems, you may need to add an additional repository to install the
    package. For instance, if you're running a Linux distribution from the RedHat
    family (RHEL, CentOS, Fedora, and so on), you should add the **Extra Packages
    for Enterprise Linux** (**EPEL**) repository. Information about setting up EPEL
    can be found in the recipe, *Giving users access to your server via FTP,* in [Chapter
    6](ch06.html "Chapter 6. Managing Files on Your System"), *Managing Files on Your
    System*.
  id: totrans-449
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在某些系统中，您可能需要添加额外的仓库来安装该软件包。例如，如果您使用的是来自 RedHat 系列的 Linux 发行版（如 RHEL、CentOS、Fedora
    等），则需要添加 **企业 Linux 的附加软件包**（**EPEL**）仓库。有关设置 EPEL 的信息，请参见食谱《通过 FTP 给用户提供访问权限》中的[第
    6 章](ch06.html "第 6 章：管理系统中的文件")，*管理系统中的文件*。
- en: Since phpPgAdmin runs on top of Apache, you should make sure that this server
    is installed on your system and accessible to a browser. Follow the steps in the
    recipe, *Installing Apache on your system*, from [Chapter 8](ch08.html "Chapter 8. Running
    an Apache Web Server"), *Running an Apache Web Server*, to get Apache up and running.
  id: totrans-450
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于 phpPgAdmin 运行在 Apache 之上，您需要确保该服务器已经安装在您的系统上并且可以通过浏览器访问。请按照食谱《在系统上安装 Apache》中的步骤，从[第
    8 章](ch08.html "第 8 章：运行 Apache Web 服务器")，*运行 Apache Web 服务器*，使 Apache 启动并正常运行。
- en: 'Navigate to the following URL, but substitute `webmin-host` for the IP or domain
    name of your server: `http://webmin-host/phppgadmin` or `http://webmin-host/phpPgAdmin`
    (depending on distribution).'
  id: totrans-451
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请访问以下 URL，但将 `webmin-host` 替换为您的服务器的 IP 或域名：`http://webmin-host/phppgadmin`
    或 `http://webmin-host/phpPgAdmin`（具体取决于发行版）。
- en: Tip
  id: totrans-452
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: On some systems, phpPgAdmin is configured to be accessible to connections originating
    from the local host only. If you wish to change this behavior, go to **Servers**
    | **Apache Webserver** | **Default Server**, select the **Per-Directory Options**
    for phpPgAdmin's directory, and change its **Access Control** settings. More information
    is provided in the recipe, *Setting options for directories, files, and locations*,
    in [Chapter 8](ch08.html "Chapter 8. Running an Apache Web Server"), *Running
    an Apache Web Server*.
  id: totrans-453
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在某些系统中，phpPgAdmin 默认仅允许来自本地主机的连接。如果你希望更改此行为，请转到**服务器** | **Apache Web 服务器**
    | **默认服务器**，选择 phpPgAdmin 目录的**每目录选项**，并更改其**访问控制**设置。更多信息请参见食谱《设置目录、文件和位置的选项》中的[第
    8 章](ch08.html "第 8 章：运行 Apache Web 服务器")，*运行 Apache Web 服务器*。
- en: Information about additional steps that may be necessary to set up phpPgAdmin
    in your system distribution can be found in package documentation files. Refer
    to the recipe, *Reading documentation of installed software* in [Chapter 1](ch01.html
    "Chapter 1. Setting Up Your System"), *Setting Up Your System*.
  id: totrans-454
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 有关在系统分发中设置phpPgAdmin可能需要的其他步骤的信息可以在软件包文档文件中找到。请参阅第1章的*阅读已安装软件的文档*部分，*设置您的系统*。
- en: You can now log in using the username and password of a PostgreSQL account.
  id: totrans-455
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您现在可以使用PostgreSQL帐户的用户名和密码登录。
- en: 'Depending on the how phpPgAdmin''s configuration is defined, it will connect
    to your Postgres server over a Unix socket or TCP network socket. The following
    line in `config.inc.php` decides how connections are established:'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 根据phpPgAdmin配置的方式定义，它将通过Unix套接字或TCP网络套接字连接到您的Postgres服务器。在`config.inc.php`中的以下行决定如何建立连接：
- en: '[PRE23]'
  id: totrans-457
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: If the host value for a server is set to `'localhost'`, connections are made
    over a network socket. If the value is set as an empty string `''`, then connections
    are made over a Unix socket.
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 如果服务器的主机值设置为`'localhost'`，则通过网络套接字进行连接。如果该值设置为空字符串`''`，则通过Unix套接字进行连接。
- en: Your Postgres server must be set up to handle the chosen type of connection
    and allow users to authenticate using a password. Take a look at the recipe, *Allowing
    access to PostgreSQL over the network*, for more information.
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 您的Postgres服务器必须设置为处理所选类型的连接并允许用户使用密码进行身份验证。有关更多信息，请参阅*允许通过网络访问PostgreSQL*部分。
- en: Tip
  id: totrans-460
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: 'If you are running a RedHat-based system with **Security Enhanced Linux** (**SELinux**),
    you may have to allow Apache to connect to databases by setting the following
    flag:'
  id: totrans-461
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您运行基于RedHat的系统并启用了**安全增强Linux**（**SELinux**），您可能需要设置以下标志以允许Apache连接到数据库：
- en: '[PRE24]'
  id: totrans-462
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: How it works...
  id: totrans-463
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 工作原理...
- en: phpPgAdmin is an application written in PHP. The main configuration file of
    phpPgAdmin is named `config.inc.php`, and is usually installed inside the `/etc/`
    directory. Example locations for different distributions are listed in the following
    table. The code of the application itself is stored in the form of PHP script
    files in a directory named `phpPgAdmin`.
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: phpPgAdmin是用PHP编写的应用程序。phpPgAdmin的主配置文件名为`config.inc.php`，通常安装在`/etc/`目录内。不同分发版的示例位置列在以下表格中。应用程序的代码本身以PHP脚本文件形式存储在名为`phpPgAdmin`的目录中。
- en: 'Because phpPgAdmin is served by Apache, the installation package includes an
    application-specific configuration file that will be loaded by the web server.
    This file informs Apache where phpPgAdmin is stored on disk and which of its directories
    should be made available on the Web:'
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
  zh: 由于phpPgAdmin由Apache提供支持，安装包包含一个应用程序特定的配置文件，该文件将由Web服务器加载。此文件告知Apache在磁盘上存储phpPgAdmin的位置以及应在Web上提供其哪些目录：
- en: '| File | OS / distro | Location |'
  id: totrans-466
  prefs: []
  type: TYPE_TB
  zh: '| 文件 | 操作系统 / 发行版 | 位置 |'
- en: '| --- | --- | --- |'
  id: totrans-467
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| phpPgAdmin configuration | Debian | `/etc/phppgadmin/config.inc.php` |'
  id: totrans-468
  prefs: []
  type: TYPE_TB
  zh: '| phpPgAdmin配置 | Debian | `/etc/phppgadmin/config.inc.php` |'
- en: '| CentOS | `/etc/phpPgAdmin/config.inc.php` |'
  id: totrans-469
  prefs: []
  type: TYPE_TB
  zh: '| CentOS | `/etc/phpPgAdmin/config.inc.php` |'
- en: '| OpenSUSE | `/etc/phpPgAdmin/config.inc.php` |'
  id: totrans-470
  prefs: []
  type: TYPE_TB
  zh: '| OpenSUSE | `/etc/phpPgAdmin/config.inc.php` |'
- en: '| phpPgAdmin files | Debian | `/usr/share/phppgadmin` |'
  id: totrans-471
  prefs: []
  type: TYPE_TB
  zh: '| phpPgAdmin文件 | Debian | `/usr/share/phppgadmin` |'
- en: '| CentOS | `/usr/share/phpPgAdmin` |'
  id: totrans-472
  prefs: []
  type: TYPE_TB
  zh: '| CentOS | `/usr/share/phpPgAdmin` |'
- en: '| OpenSUSE | `/srv/www/htdocs/phpPgAdmin` |'
  id: totrans-473
  prefs: []
  type: TYPE_TB
  zh: '| OpenSUSE | `/srv/www/htdocs/phpPgAdmin` |'
- en: '| Apache configuration file for phpPgAdmin | Debian | `/etc/apache2/conf.d/phppgadmin`
    |'
  id: totrans-474
  prefs: []
  type: TYPE_TB
  zh: '| phpPgAdmin的Apache配置文件 | Debian | `/etc/apache2/conf.d/phppgadmin` |'
- en: '| CentOS | `/etc/httpd/conf.d/phpPgAdmin.conf` |'
  id: totrans-475
  prefs: []
  type: TYPE_TB
  zh: '| CentOS | `/etc/httpd/conf.d/phpPgAdmin.conf` |'
- en: '| OpenSUSE | `/etc/apache2/conf.d/phpPgAdmin.conf` |'
  id: totrans-476
  prefs: []
  type: TYPE_TB
  zh: '| OpenSUSE | `/etc/apache2/conf.d/phpPgAdmin.conf` |'
- en: Regardless of how the package maintainers decided to prepare it, you can tweak
    the Apache configuration for phpPgAdmin by going to **Servers** | **Apache Webserver**
    | **Default Server** and selecting the **Per-Directory Options** for the phpPgAdmin
    directory.
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
  zh: 无论包维护者决定如何准备它，您都可以通过转到**服务器** | **Apache Web服务器** | **默认服务器**并选择phpPgAdmin目录的**每目录选项**来调整phpPgAdmin的Apache配置。
